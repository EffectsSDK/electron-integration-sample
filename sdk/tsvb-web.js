/*! For license information please see tsvb-web.js.LICENSE.txt */
var __webpack_modules__={4912:e=>{var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,l,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,n),!0;case 4:return h.fn.call(h.context,t,n,i),!0;case 5:return h.fn.call(h.context,t,n,i,o),!0;case 6:return h.fn.call(h.context,t,n,i,o,a),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h.fn.apply(h.context,u)}else{var d,f=h.length;for(l=0;l<f;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),c){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,n);break;case 4:h[l].fn.call(h[l].context,t,n,i);break;default:if(!u)for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];h[l].fn.apply(h[l].context,u)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,l=[],h=s.length;u<h;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},6240:function(e){var t;t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isNotPNG=function(e){return e===s},t.isNotAPNG=function(e){return e===u},t.default=function(e){var t=new Uint8Array(e);if(Array.prototype.some.call(l,(function(e,r){return e!==t[r]})))return s;var r=!1;if(h(t,(function(e){return!(r="acTL"===e)})),!r)return u;var n=[],i=[],o=null,c=null,y=0,g=new a.APNG;if(h(t,(function(e,t,r,s){var u=new DataView(t.buffer);switch(e){case"IHDR":o=t.subarray(r+8,r+8+s),g.width=u.getUint32(r+8),g.height=u.getUint32(r+12);break;case"acTL":g.numPlays=u.getUint32(r+8+4);break;case"fcTL":c&&(g.frames.push(c),y++),(c=new a.Frame).width=u.getUint32(r+8+4),c.height=u.getUint32(r+8+8),c.left=u.getUint32(r+8+12),c.top=u.getUint32(r+8+16);var l=u.getUint16(r+8+20),h=u.getUint16(r+8+22);0===h&&(h=100),c.delay=1e3*l/h,c.delay<=10&&(c.delay=100),g.playTime+=c.delay,c.disposeOp=u.getUint8(r+8+24),c.blendOp=u.getUint8(r+8+25),c.dataParts=[],0===y&&2===c.disposeOp&&(c.disposeOp=1);break;case"fdAT":c&&c.dataParts.push(t.subarray(r+8+4,r+8+s));break;case"IDAT":c&&c.dataParts.push(t.subarray(r+8,r+8+s));break;case"IEND":i.push(d(t,r,12+s));break;default:n.push(d(t,r,12+s))}})),c&&g.frames.push(c),0==g.frames.length)return u;var m=new Blob(n),w=new Blob(i);return g.frames.forEach((function(e){var t=[];t.push(l),o.set(p(e.width),0),o.set(p(e.height),4),t.push(f("IHDR",o)),t.push(m),e.dataParts.forEach((function(e){return t.push(f("IDAT",e))})),t.push(w),e.imageData=new Blob(t,{type:"image/png"}),delete e.dataParts,t=null})),g};var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(2),s=new Error("Not a PNG"),u=new Error("Not an animated PNG"),l=new Uint8Array([137,80,78,71,13,10,26,10]);function h(e,t){var r=new DataView(e.buffer),n=8,i=void 0,o=void 0,a=void 0;do{o=r.getUint32(n),a=t(i=c(e,n+4,4),e,n,o),n+=12+o}while(!1!==a&&"IEND"!=i&&n<e.length)}function c(e,t,r){var n=Array.prototype.slice.call(e.subarray(t,t+r));return String.fromCharCode.apply(String,n)}function d(e,t,r){var n=new Uint8Array(r);return n.set(e.subarray(t,t+r)),n}var f=function(e,t){var r=e.length+t.length,n=new Uint8Array(r+8),i=new DataView(n.buffer);i.setUint32(0,t.length),n.set(function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e),4),n.set(t,8);var a=(0,o.default)(n,4,r);return i.setUint32(r+4,a),n},p=function(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,i=t,o=t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-t);i<o;i++)n=n>>>8^r[255&(n^e[i])];return-1^n};for(var r=new Uint32Array(256),n=0;n<256;n++){for(var i=n,o=0;o<8;o++)i=0!=(1&i)?3988292384^i>>>1:i>>>1;r[n]=i}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Frame=t.APNG=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(3),a=(n=o)&&n.__esModule?n:{default:n};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.APNG=function(){function e(){s(this,e),this.width=0,this.height=0,this.numPlays=0,this.playTime=0,this.frames=[]}return i(e,[{key:"createImages",value:function(){return Promise.all(this.frames.map((function(e){return e.createImage()})))}},{key:"getPlayer",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.createImages().then((function(){return new a.default(t,e,r)}))}}]),e}(),t.Frame=function(){function e(){s(this,e),this.left=0,this.top=0,this.width=0,this.height=0,this.delay=0,this.disposeOp=0,this.blendOp=0,this.imageData=null,this.imageElement=null}return i(e,[{key:"createImage",value:function(){var e=this;return this.imageElement?Promise.resolve():new Promise((function(t,r){var n=URL.createObjectURL(e.imageData);e.imageElement=document.createElement("img"),e.imageElement.onload=function(){URL.revokeObjectURL(n),t()},e.imageElement.onerror=function(){URL.revokeObjectURL(n),e.imageElement=null,r(new Error("Image creation error"))},e.imageElement.src=n}))}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(4),a=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.playbackRate=1,i._currentFrameNumber=0,i._ended=!1,i._paused=!0,i._numPlays=0,i._apng=e,i.context=r,i.stop(),n&&i.play(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length,this._currentFrameNumber===this._apng.frames.length-1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._ended=!0,this._paused=!0)),this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var e=this.currentFrame;this._prevFrame=e,this._prevFrameData=null,2==e.disposeOp&&(this._prevFrameData=this.context.getImageData(e.left,e.top,e.width,e.height)),0==e.blendOp&&this.context.clearRect(e.left,e.top,e.width,e.height),this.context.drawImage(e.imageElement,e.left,e.top),this.emit("frame",this._currentFrameNumber),this._ended&&this.emit("end")}},{key:"play",value:function(){var e=this;this.emit("play"),this._ended&&this.stop(),this._paused=!1;var t=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame((function r(n){if(!e._ended&&!e._paused){if(n>=t){for(;n-t>=e._apng.playTime/e.playbackRate;)t+=e._apng.playTime/e.playbackRate,e._numPlays++;do{e.renderNextFrame(),t+=e.currentFrame.delay/e.playbackRate}while(!e._ended&&n>t)}requestAnimationFrame(r)}}))}},{key:"pause",value:function(){this._paused||(this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this.emit("stop"),this._numPlays=0,this._ended=!1,this._paused=!0,this._currentFrameNumber=-1,this.context.clearRect(0,0,this._apng.width,this._apng.height),this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]),t}(((n=o)&&n.__esModule?n:{default:n}).default);t.default=a},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,a,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(o(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(i(r))for(s=Array.prototype.slice.call(arguments,1),a=(l=r.slice()).length,u=0;u<a;u++)l[u].apply(this,s);return!0},r.prototype.addListener=function(e,t){var a;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(a=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},r.prototype.removeListener=function(e,t){var r,o,a,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(r=this._events[e]).length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(s=a;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){o=s;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}}])},e.exports=t()},9899:(e,t,r)=>{e.exports=r(2860)},1816:(e,t,r)=>{var n=r(2652),i=r(1776),o=r(2484),a=r(3640),s=r(6784),u=r(320),l=r(8104),h=r(5108),c=r(288),d=r(6432);e.exports=function(e){return new Promise((function(t,r){var f,p=e.data,y=e.headers,g=e.responseType;function m(){e.cancelToken&&e.cancelToken.unsubscribe(f),e.signal&&e.signal.removeEventListener("abort",f)}n.isFormData(p)&&delete y["Content-Type"];var w=new XMLHttpRequest;if(e.auth){var b=e.auth.username||"",v=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";y.Authorization="Basic "+btoa(b+":"+v)}var x=s(e.baseURL,e.url);function _(){if(w){var n="getAllResponseHeaders"in w?u(w.getAllResponseHeaders()):null,o={data:g&&"text"!==g&&"json"!==g?w.response:w.responseText,status:w.status,statusText:w.statusText,headers:n,config:e,request:w};i((function(e){t(e),m()}),(function(e){r(e),m()}),o),w=null}}if(w.open(e.method.toUpperCase(),a(x,e.params,e.paramsSerializer),!0),w.timeout=e.timeout,"onloadend"in w?w.onloadend=_:w.onreadystatechange=function(){w&&4===w.readyState&&(0!==w.status||w.responseURL&&0===w.responseURL.indexOf("file:"))&&setTimeout(_)},w.onabort=function(){w&&(r(h("Request aborted",e,"ECONNABORTED",w)),w=null)},w.onerror=function(){r(h("Network Error",e,null,w)),w=null},w.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",n=e.transitional||c;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(h(t,e,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",w)),w=null},n.isStandardBrowserEnv()){var I=(e.withCredentials||l(x))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;I&&(y[e.xsrfHeaderName]=I)}"setRequestHeader"in w&&n.forEach(y,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete y[t]:w.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(w.withCredentials=!!e.withCredentials),g&&"json"!==g&&(w.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&w.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&w.upload&&w.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(f=function(e){w&&(r(!e||e&&e.type?new d("canceled"):e),w.abort(),w=null)},e.cancelToken&&e.cancelToken.subscribe(f),e.signal&&(e.signal.aborted?f():e.signal.addEventListener("abort",f))),p||(p=null),w.send(p)}))}},2860:(e,t,r)=>{var n=r(2652),i=r(9504),o=r(2508),a=r(6183);var s=function e(t){var r=new o(t),s=i(o.prototype.request,r);return n.extend(s,o.prototype,r),n.extend(s,r),s.create=function(r){return e(a(t,r))},s}(r(5260));s.Axios=o,s.Cancel=r(6432),s.CancelToken=r(6312),s.isCancel=r(9864),s.VERSION=r(8340).version,s.all=function(e){return Promise.all(e)},s.spread=r(9092),s.isAxiosError=r(6288),e.exports=s,e.exports.default=s},6432:e=>{function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},6312:(e,t,r)=>{var n=r(6432);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;this.promise.then((function(e){if(r._listeners){var t,n=r._listeners.length;for(t=0;t<n;t++)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},9864:e=>{e.exports=function(e){return!(!e||!e.__CANCEL__)}},2508:(e,t,r)=>{var n=r(2652),i=r(3640),o=r(2747),a=r(9088),s=r(6183),u=r(5984),l=u.validators;function h(e){this.defaults=e,this.interceptors={request:new o,response:new o}}h.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&u.assertOptions(r,{silentJSONParsing:l.transitional(l.boolean),forcedJSONParsing:l.transitional(l.boolean),clarifyTimeoutError:l.transitional(l.boolean)},!1);var n=[],i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var o,h=[];if(this.interceptors.response.forEach((function(e){h.push(e.fulfilled,e.rejected)})),!i){var c=[a,void 0];for(Array.prototype.unshift.apply(c,n),c=c.concat(h),o=Promise.resolve(t);c.length;)o=o.then(c.shift(),c.shift());return o}for(var d=t;n.length;){var f=n.shift(),p=n.shift();try{d=f(d)}catch(e){p(e);break}}try{o=a(d)}catch(e){return Promise.reject(e)}for(;h.length;)o=o.then(h.shift(),h.shift());return o},h.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){h.prototype[e]=function(t,r){return this.request(s(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){h.prototype[e]=function(t,r,n){return this.request(s(n||{},{method:e,url:t,data:r}))}})),e.exports=h},2747:(e,t,r)=>{var n=r(2652);function i(){this.handlers=[]}i.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},6784:(e,t,r)=>{var n=r(7992),i=r(344);e.exports=function(e,t){return e&&!n(t)?i(e,t):t}},5108:(e,t,r)=>{var n=r(7544);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o)}},9088:(e,t,r)=>{var n=r(2652),i=r(712),o=r(9864),a=r(5260),s=r(6432);function u(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}e.exports=function(e){return u(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},7544:e=>{e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},6183:(e,t,r)=>{var n=r(2652);e.exports=function(e,t){t=t||{};var r={};function i(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function o(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(e[r],t[r])}function a(e){if(!n.isUndefined(t[e]))return i(void 0,t[e])}function s(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(void 0,t[r])}function u(r){return r in t?i(e[r],t[r]):r in e?i(void 0,e[r]):void 0}var l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:u};return n.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=l[e]||o,i=t(e);n.isUndefined(i)&&t!==u||(r[e]=i)})),r}},1776:(e,t,r)=>{var n=r(5108);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},712:(e,t,r)=>{var n=r(2652),i=r(5260);e.exports=function(e,t,r){var o=this||i;return n.forEach(r,(function(r){e=r.call(o,e,t)})),e}},5260:(e,t,r)=>{var n=r(6512),i=r(2652),o=r(7700),a=r(7544),s=r(288),u={"Content-Type":"application/x-www-form-urlencoded"};function l(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var h,c={transitional:s,adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==n&&"[object process]"===Object.prototype.toString.call(n))&&(h=r(1816)),h),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(l(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(l(t,"application/json"),function(e,t,r){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||c.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||n&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw a(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){c.headers[e]=i.merge(u)})),e.exports=c},288:e=>{e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},8340:e=>{e.exports={version:"0.26.1"}},9504:e=>{e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},3640:(e,t,r)=>{var n=r(2652);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},344:e=>{e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},2484:(e,t,r)=>{var n=r(2652);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},7992:e=>{e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},6288:(e,t,r)=>{var n=r(2652);e.exports=function(e){return n.isObject(e)&&!0===e.isAxiosError}},8104:(e,t,r)=>{var n=r(2652);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},7700:(e,t,r)=>{var n=r(2652);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},320:(e,t,r)=>{var n=r(2652),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,a={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},9092:e=>{e.exports=function(e){return function(t){return e.apply(null,t)}}},5984:(e,t,r)=>{var n=r(8340).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var o={};i.transitional=function(e,t,r){function i(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new Error(i(n," has been removed"+(t?" in "+t:"")));return t&&!o[n]&&(o[n]=!0,console.warn(i(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},e.exports={assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-- >0;){var o=n[i],a=t[o];if(a){var s=e[o],u=void 0===s||a(s,o,e);if(!0!==u)throw new TypeError("option "+o+" must be "+u)}else if(!0!==r)throw Error("Unknown option "+o)}},validators:i}},2652:(e,t,r)=>{var n=r(9504),i=Object.prototype.toString;function o(e){return Array.isArray(e)}function a(e){return void 0===e}function s(e){return"[object ArrayBuffer]"===i.call(e)}function u(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function h(e){return"[object Function]"===i.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:s,isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===i.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&s(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isPlainObject:l,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:h,isStream:function(e){return u(e)&&h(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===i.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function e(){var t={};function r(r,n){l(t[n])&&l(r)?t[n]=e(t[n],r):l(r)?t[n]=e({},r):o(r)?t[n]=r.slice():t[n]=r}for(var n=0,i=arguments.length;n<i;n++)c(arguments[n],r);return t},extend:function(e,t,r){return c(t,(function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},5620:(e,t,r)=>{r.d(t,{M:()=>c});const n="3.2.3";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:String(t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l={overlay:!1,overlay_attrs:{url:"https://effectssdk.ai/assets/videos/overlay/esdk.mp4"},lowerthird:!1,lowerthird_type:"lowerthird_3",lowerthird_text:{text:{title:"Max Troshin",subtitle:"CEO at Effects SDK / effectssdk.com"}},lowerthird_color:{color:{primary:161271}},lowerthird_offset:{offset:{x:15/1280,y:75/720}},emoji_duration:{duration:3500},emoji_size:{size:.3},emoji_position:{position:{placement:"top-left"}},giphy_duration:{duration:3500},giphy_size:{size:.3},giphy_position:{position:{placement:"top-left"}},seg_mode:"balanced",background:"none",layout:"center",layout_custom:void 0,blur:!0,blur_power:.6,beautification:!0,beauty_power:.68,boundary:0,frameskipping:!1,sz_switch:!0,sz_facearea:.1,sz_drawface:!1,sz_drawprefaces:!1,sz_accuracy:.75,sz_smoothing:.2,sz_period:100,cc_switch:!1,cc_power:1,cc_part:1,cc_period:1e3,cf_switch:!1,cf_lut:{lut:"none"},cf_part:{part:1},cf_power:{power:1},cf_capacity:{capacity:5},sh_switch:!1,sh_power:.5},h=a((function e(){u(this,e)}));h.APP_ENV="web",h.API_URL="https://effectssdk.ai/sdk/session/",h.STATS_URL="https://effectssdk.ai/sdk/stats/",h.BASE_URL="https://effectssdk.ai/",h.SDK_URL=h.BASE_URL+"sdk/",h.VB_MODEL=h.SDK_URL+"models/model-1.2.1.tsvb",h.PRESET="balanced",h.DEMO_IMAGE=h.SDK_URL+"100.jpg",h.DEMO_VIDEO=h.SDK_URL+"video-background.mp4";var c=function(){function e(){u(this,e)}return a(e,null,[{key:"getModelUrl",value:function(t){return e.SDK_URL+t}},{key:"getPresetUrl",value:function(t){return e.SDK_URL+t}},{key:"setVersion",value:function(){e.VERSION=n}}]),e}();c.VERSION="0.0.0",c.CUSTOMER_ID="",c.APP_ENV=h.APP_ENV,c.API_URL=h.API_URL,c.STATS_URL=h.STATS_URL,c.MODEL_URL=h.SDK_URL+"models/model-1.2.1.tsvb",c.PRESET=h.PRESET,c.SDK_URL=h.SDK_URL,c.MODELS={colorcorrector:"models/model-cc-1.0.0.tsvb",facedetector:"models/model-fd-1.1.0.tsvb",lowlighter:"models/model-ll-1.2.0.tsvb"},c.PROXY=!0,c.STATS=!1,c.PROVIDER="wasm",c.WASM_PATHS={},c.PRESETS={quality:"models/model-1.0.1.tsvb",balanced:"models/model-5.5.0.tsvb",speed:"models/model-3.1.1.tsvb",lightning:"models/model-4.0.1.tsvb"},c.PRESETS_PORTRAIT={quality:"models/m-model-1.0.1.tsvb",balanced:"models/m-model-5.5.0.tsvb",speed:"models/m-model-3.1.1.tsvb",lightning:"models/m-model-4.0.1.tsvb"},c.STATES_PRESET=l},3744:(e,t,r)=>{r.d(t,{O:()=>Ik});var n={};r.r(n),r.d(n,{BaseTextureCache:()=>Mt,BoundingBox:()=>Rt,CanvasRenderTarget:()=>Nt,DATA_URI:()=>vt,EventEmitter:()=>ve,ProgramCache:()=>Bt,TextureCache:()=>Dt,clearTextureCache:()=>Ft,correctBlendMode:()=>gt,createIndicesForQuads:()=>xt,decomposeDataUri:()=>Vt,deprecation:()=>Ae,destroyTextureCache:()=>Lt,detectVideoAlphaMode:()=>Pe,determineCrossOrigin:()=>Ht,earcut:()=>xe,getBufferType:()=>_t,getCanvasBoundingBox:()=>Gt,getResolutionOfUrl:()=>Wt,hex2rgb:()=>ct,hex2string:()=>dt,interleaveTypedArrays:()=>At,isMobile:()=>be,isPow2:()=>Tt,isWebGLSupported:()=>Be,log2:()=>Ct,nextPow2:()=>St,path:()=>Ee,premultiplyBlendMode:()=>yt,premultiplyRgba:()=>mt,premultiplyTint:()=>wt,premultiplyTintToRgba:()=>bt,removeItems:()=>Et,rgb2hex:()=>pt,sayHello:()=>Re,sign:()=>Ot,skipHello:()=>$e,string2hex:()=>ft,trimCanvas:()=>zt,uid:()=>Pt,url:()=>Se});var i={};r.r(i),r.d(i,{ALPHA_MODES:()=>W,AbstractMultiResource:()=>Zi,AccessibilityManager:()=>Ho,AlphaFilter:()=>xo,AnimatedSprite:()=>Qu,Application:()=>Yo,ArrayResource:()=>qi,Assets:()=>Ra,AssetsClass:()=>$a,Attribute:()=>fr,BLEND_MODES:()=>L,BUFFER_BITS:()=>M,BUFFER_TYPE:()=>Q,BackgroundSystem:()=>mn,BaseImageResource:()=>In,BasePrepare:()=>Yu,BaseRenderTexture:()=>_n,BaseTexture:()=>lr,BatchDrawCall:()=>hr,BatchGeometry:()=>br,BatchRenderer:()=>pn,BatchShaderGenerator:()=>hn,BatchSystem:()=>wn,BatchTextureArray:()=>cn,BitmapFont:()=>vl,BitmapFontData:()=>hl,BitmapText:()=>Sl,BlobResource:()=>Qa,BlurFilter:()=>So,BlurFilterPass:()=>Ao,Bounds:()=>uo,BrowserAdapter:()=>ee,Buffer:()=>dr,BufferResource:()=>ar,BufferSystem:()=>Wi,CLEAR_MODES:()=>Y,COLOR_MASK_BITS:()=>q,Cache:()=>Qo,CanvasResource:()=>Ji,Circle:()=>Cr,Color:()=>ht,ColorMatrixFilter:()=>To,CompressedTextureResource:()=>es,Container:()=>yo,ContextSystem:()=>vn,CountLimiter:()=>Fu,CubeResource:()=>eo,DEG_TO_RAD:()=>_r,DRAW_MODES:()=>F,DisplacementFilter:()=>Co,DisplayObject:()=>lo,ENV:()=>B,Ellipse:()=>Er,EventBoundary:()=>Fo,EventSystem:()=>jo,ExtensionType:()=>Yt,Extract:()=>Bs,FORMATS:()=>N,FORMATS_TO_COMPONENTS:()=>Ss,FXAAFilter:()=>Eo,FederatedDisplayObject:()=>zo,FederatedEvent:()=>$o,FederatedMouseEvent:()=>Ro,FederatedPointerEvent:()=>Bo,FederatedWheelEvent:()=>Do,FillStyle:()=>iu,Filter:()=>gn,FilterState:()=>Rn,FilterSystem:()=>Mn,Framebuffer:()=>xn,FramebufferSystem:()=>Nn,GC_MODES:()=>K,GLFramebuffer:()=>Ln,GLProgram:()=>ui,GLTexture:()=>Pi,GRAPHICS_CURVES:()=>zs,GenerateTextureSystem:()=>ni,Geometry:()=>wr,GeometrySystem:()=>jn,Graphics:()=>uu,GraphicsData:()=>Qs,GraphicsGeometry:()=>nu,HTMLText:()=>Pl,HTMLTextStyle:()=>Ol,IGLUniformData:()=>si,INSTALLED:()=>rr,INTERNAL_FORMATS:()=>Ya,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:()=>Ka,ImageBitmapResource:()=>to,ImageResource:()=>An,LINE_CAP:()=>js,LINE_JOIN:()=>Us,LineStyle:()=>ou,LoaderParserPriority:()=>ra,MASK_TYPES:()=>Z,MIPMAP_MODES:()=>H,MSAA_QUALITY:()=>J,MaskData:()=>Hn,MaskSystem:()=>Wn,Matrix:()=>Pr,Mesh:()=>pu,MeshBatchUvs:()=>hu,MeshGeometry:()=>yu,MeshMaterial:()=>gu,MultisampleSystem:()=>Vi,NineSlicePlane:()=>vu,NoiseFilter:()=>Oo,ObjectRenderer:()=>dn,ObjectRendererSystem:()=>Yi,ObservablePoint:()=>Ur,PI_2:()=>vr,PRECISION:()=>X,ParticleContainer:()=>Iu,ParticleRenderer:()=>Su,PlaneGeometry:()=>mu,PluginSystem:()=>Qn,Point:()=>Ar,Polygon:()=>Or,Prepare:()=>qu,Program:()=>an,ProjectionSystem:()=>ei,Quad:()=>Pn,QuadUv:()=>$n,RAD_TO_DEG:()=>xr,RENDERER_TYPE:()=>D,Rectangle:()=>Tr,RenderTexture:()=>On,RenderTexturePool:()=>kn,RenderTextureSystem:()=>ai,Renderer:()=>Xi,ResizePlugin:()=>Ko,Resource:()=>or,RopeGeometry:()=>wu,RoundedRectangle:()=>kr,Runner:()=>ir,SAMPLER_TYPES:()=>G,SCALE_MODES:()=>z,SHAPES:()=>Ir,SVGResource:()=>no,ScissorSystem:()=>qn,Shader:()=>ln,ShaderSystem:()=>Ai,SimpleMesh:()=>xu,SimplePlane:()=>bu,SimpleRope:()=>_u,Sprite:()=>wo,SpriteMaskFilter:()=>Vn,Spritesheet:()=>al,StartupSystem:()=>Si,State:()=>tr,StateSystem:()=>Ci,StencilSystem:()=>Jn,SystemManager:()=>Ei,TARGETS:()=>U,TEXT_GRADIENT:()=>Tu,TYPES:()=>j,TYPES_TO_BYTES_PER_COMPONENT:()=>As,TYPES_TO_BYTES_PER_PIXEL:()=>Ts,TemporaryDisplayObject:()=>ho,Text:()=>Lu,TextFormat:()=>cl,TextMetrics:()=>Ou,TextStyle:()=>$u,Texture:()=>En,TextureGCSystem:()=>ki,TextureMatrix:()=>zn,TextureSystem:()=>$i,TextureUvs:()=>Sn,Ticker:()=>Fi,TickerPlugin:()=>Ni,TilingSprite:()=>tl,TilingSpriteRenderer:()=>il,TimeLimiter:()=>Ju,Transform:()=>Gr,TransformFeedback:()=>ao,TransformFeedbackSystem:()=>Ri,UPDATE_PRIORITY:()=>Di,UniformGroup:()=>un,VERSION:()=>so,VideoResource:()=>oo,ViewSystem:()=>Bi,ViewableBuffer:()=>qt,WRAP_MODES:()=>V,XMLFormat:()=>dl,XMLStringFormat:()=>fl,accessibleTarget:()=>Vo,autoDetectFormat:()=>yl,autoDetectRenderer:()=>ji,autoDetectResource:()=>nr,cacheTextureArray:()=>Ba,checkDataUrl:()=>na,checkExtension:()=>qo,checkMaxIfStatementsInShader:()=>er,convertToList:()=>Jo,copySearchParams:()=>Wa,createStringVariations:()=>ka,createTexture:()=>va,createUBOElements:()=>mi,curves:()=>Gs,defaultFilterVertex:()=>zi,defaultVertex:()=>Gi,detectAvif:()=>Ma,detectCompressedTextures:()=>Ja,detectDefaults:()=>Na,detectMp4:()=>za,detectOgv:()=>Va,detectWebm:()=>Ga,detectWebp:()=>La,extensions:()=>Zt,filters:()=>ko,generateProgram:()=>fi,generateUniformBufferSync:()=>bi,getFontFamilyName:()=>ha,getTestContext:()=>Xr,getUBOData:()=>wi,graphicsUtils:()=>lu,groupD8:()=>Nr,isMobile:()=>be,isSingleItem:()=>ea,loadBitmapFont:()=>Cl,loadDDS:()=>Os,loadImageBitmap:()=>Ia,loadJson:()=>ia,loadKTX:()=>ks,loadSVG:()=>Sa,loadTextures:()=>Aa,loadTxt:()=>oa,loadVideo:()=>Ea,loadWebFont:()=>da,parseDDS:()=>bs,parseKTX:()=>Cs,resolveCompressedTextureUrl:()=>Ps,resolveTextureUrl:()=>Ha,settings:()=>te,spritesheetAsset:()=>ll,uniformParsers:()=>zr,unsafeEvalSupported:()=>xi,utils:()=>n});var o=r(1140),a=r(9328);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(){u=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",h=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new $(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",y="suspendedYield",g="executing",m="completed",w={};function b(){}function v(){}function x(){}var _={};c(_,a,(function(){return this}));var I=Object.getPrototypeOf,A=I&&I(I(R([])));A&&A!==r&&n.call(A,a)&&(_=A);var S=x.prototype=b.prototype=Object.create(_);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,o,a,u){var l=f(e[i],e,o);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==s(c)&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,a,u)}),(function(e){r("throw",e,a,u)})):t.resolve(c).then((function(e){h.value=e,a(h)}),(function(e){return r("throw",e,a,u)}))}u(l.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function E(t,r,n){var i=p;return function(o,a){if(i===g)throw new Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===w)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=g;var l=f(t,r,n);if("normal"===l.type){if(i=n.done?m:y,l.arg===w)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=m,n.method="throw",n.arg=l.arg)}}}function O(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,O(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var o=f(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,w;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,w):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,w)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(s(t)+" is not iterable")}return v.prototype=x,i(S,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:v,configurable:!0}),v.displayName=c(x,h,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,h,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(C.prototype),c(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new C(d(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),c(S,h,"Generator"),c(S,a,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,$.prototype={constructor:$,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),w}},t}function l(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:String(t)}function d(e,t,r){return t=p(t),function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(e,f()?Reflect.construct(t,r||[],p(e).constructor):t.apply(e,r))}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}var m,w,b,v=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},x=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=d(this,t),m.set(y(e),void 0),w.set(y(e),2),b.set(y(e),0),e.width=0,e.height=0,e}var r,n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,e),r=t,n=[{key:"setSkipCount",value:function(e){v(this,w,e,"f")}},{key:"set",value:function(e){var t=this;e instanceof MediaStream?v(this,m,e.getVideoTracks()[0],"f"):v(this,m,e,"f"),null!=x(this,m,"f").getSettings().width&&(this.width=x(this,m,"f").getSettings().width),null!=x(this,m,"f").getSettings().height&&(this.height=x(this,m,"f").getSettings().height),x(this,m,"f").onended&&(x(this,m,"f").onended=function(){return t.emit("ended",t)})}},{key:"stop",value:function(){x(this,m,"f")&&x(this,m,"f").stop()}},{key:"update",value:function(e,t){var r;if(x(this,m,"f")&&(v(this,b,(r=x(this,b,"f"),++r),"f"),!(x(this,b,"f")%x(this,w,"f")))){var n=!1;if(!e&&!t){var i=x(this,m,"f").getSettings();i.width,i.height}this.width!=e&&(n=!0,this.width=e),this.height!=t&&(n=!0,this.height=t),n&&this.emit("update",this)}}},{key:"getSettings",value:function(e){return x(this,m,"f"),e||(e={width:this.width,height:this.height,aspectRatio:this.width/this.height}),Object.assign(x(this,m,"f").getSettings(),e)}},{key:"getConstraints",value:function(e){return x(this,m,"f"),e||(e={width:this.width,height:this.height}),Object.assign(x(this,m,"f").getConstraints(),e)}},{key:"getCapabilities",value:function(e){return x(this,m,"f"),Object.assign(x(this,m,"f").getCapabilities(),e)}},{key:"applyConstraints",value:(o=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){l(o,n,i,a,s,"next",e)}function s(e){l(o,n,i,a,s,"throw",e)}a(void 0)}))}}(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(this,m,"f")){e.next=2;break}return e.abrupt("return");case 2:x(this,m,"f").applyConstraints(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})}],n&&h(r.prototype,n),i&&h(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(a);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C(n.key),n)}}function T(e,t,r){return t&&S(e.prototype,t),r&&S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:String(t)}m=new WeakMap,w=new WeakMap,b=new WeakMap;var E=function(){function e(){A(this,e),this.frame_count=30,this.frames=[1]}return T(e,[{key:"start",value:function(){this.t0=performance.now()}},{key:"finish",value:function(){var e=performance.now()-this.t0;this.frames.push(e),this.frames.length>this.frame_count&&this.frames.shift()}},{key:"getFrameFps",value:function(){var e=this.frames.reduce((function(e,t){return e+t}),0);return 0==e||isNaN(e)?1:Math.round(1e3/(e/this.frame_count))}},{key:"getFrameDuration",value:function(){return Math.round(1e6/this.getFrameFps())}},{key:"getFrameTime",value:function(){return Math.round(this.frames.reduce((function(e,t){return e+t}),0)/this.frame_count)}}]),e}(),O=function(){function e(){A(this,e),this.pattern="Output FPS: {{output_fps}}\nFrame Draw Time: {{frame_time}}ms\nInference Time: {{inference_time}}ms",this.stats=new Map}return T(e,[{key:"updateStats",value:function(e,t){return this.stats.set(e,t),!0}},{key:"getText",value:function(){var e=this.pattern;return this.stats.forEach((function(t,r){e=e.replaceAll("{{"+r+"}}",t.toString())})),e}}]),e}();function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$(n.key),n)}}function $(e){var t=function(e,t){if("object"!=k(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==k(t)?t:String(t)}var R=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=null,this.stream=null,this.videoTrack=null,this.audioTrack=null,this.transformFrame=null,this.updateVideoTrack=null,this.toCanvas=null,this.lastFrameTime=0,this.fpsLimit=30,this.timestamp=0,this.isRunning=!1,this.isPaused=!1,this.sdkOptions=t,this.outputCanvas=document.createElement("canvas"),this.outputCanvas.width=this.sdkOptions.width,this.outputCanvas.height=this.sdkOptions.height,this.bufferCanvas=document.createElement("canvas"),this.bufferCanvas.width=this.sdkOptions.width,this.bufferCanvas.height=this.sdkOptions.height,this.frameTimer=new E,this.frameTime=0,this.fps=0,this.enableFps=!1,this.frame_count=0,this.videoTrackWrapper=new _,this.videoTrackWrapper.on("update",this.onTrackUpdate,this)}var t,r,n;return t=e,r=[{key:"onTrackUpdate",value:function(){this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height),"function"==typeof this.changeInputResolutionFuncition&&this.changeInputResolutionFuncition()}},{key:"clearBuffers",value:function(){}},{key:"onChangeInputResolution",value:function(e){var t="function"==typeof e;this.changeInputResolutionFuncition=t?e:void 0}},{key:"onFrameDraw",value:function(e){var t="function"==typeof e;this.frameDrawFunction=t?e:void 0}},{key:"setOutputResolution",value:function(e,t){this.sdkOptions.setCustomSize(e,t)}},{key:"clearOutputResolution",value:function(){this.sdkOptions.customSize=!1,this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height)}},{key:"useEffectProcessor",value:function(e){this.effectProcessor=e}},{key:"pause",value:function(){this.isPaused=!0}},{key:"unpause",value:function(){this.isPaused=!1}},{key:"setRenderer",value:function(e){this.renderer=e}},{key:"destroy",value:function(){this.videoTrackWrapper.off("update",this.onTrackUpdate,this)}},{key:"setFpsLimit",value:function(e){var t;this.fpsLimit=e,null===(t=this.getInputVideoTrack())||void 0===t||t.applyConstraints({frameRate:this.fpsLimit})}},{key:"useStream",value:function(e){this.stream=e,this.useVideoTrack(this.stream.getVideoTracks()[0])}},{key:"useVideoTrack",value:function(e){this.videoTrack=e,this.videoTrackWrapper.set(this.videoTrack)}},{key:"getInputStream",value:function(){return this.stream?this.stream:null}},{key:"getInputVideoTrack",value:function(){return this.videoTrack?this.videoTrack:null}},{key:"showFps",value:function(){this.enableFps=!0}},{key:"hideFps",value:function(){this.enableFps=!1,this.renderer.hideStatistics()}},{key:"drawFps",value:function(){this.enableFps&&this.frame_count%30==0&&(this.renderer.updateStatistics("output_fps",this.frameTimer.getFrameFps()),this.renderer.drawStatistics())}},{key:"process",value:function(){this.transformFrame&&this.transformFrame()}},{key:"clearTransformCallback",value:function(){this.transformFrame=null}},{key:"transformCallback",value:function(e){this.transformFrame=e}},{key:"renderToCanvas",value:function(e){this.toCanvas=e}},{key:"getCanvas",value:function(){return this.outputCanvas}},{key:"getStream",value:function(){return this.stream}}],r&&P(t.prototype,r),n&&P(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),B=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(B||{}),D=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(D||{}),M=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(M||{}),L=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(L||{}),F=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(F||{}),N=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(N||{}),U=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(U||{}),j=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(j||{}),G=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(G||{}),z=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(z||{}),V=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(V||{}),H=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(H||{}),W=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(W||{}),Y=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(Y||{}),K=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(K||{}),X=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(X||{}),Z=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(Z||{}),q=(e=>(e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e))(q||{}),J=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(J||{}),Q=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(Q||{});const ee={createCanvas:(e,t)=>{const r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>(new DOMParser).parseFromString(e,"text/xml")},te={ADAPTER:ee,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var re=/iPhone/i,ne=/iPod/i,ie=/iPad/i,oe=/\biOS-universal(?:.+)Mac\b/i,ae=/\bAndroid(?:.+)Mobile\b/i,se=/Android/i,ue=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,le=/Silk/i,he=/Windows Phone/i,ce=/\bWindows(?:.+)ARM\b/i,de=/BlackBerry/i,fe=/BB10/i,pe=/Opera Mini/i,ye=/\b(CriOS|Chrome)(?:.+)Mobile/i,ge=/Mobile(?:.+)Firefox\b/i,me=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function we(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=t.userAgent,n=r.split("[FBAN");void 0!==n[1]&&(r=n[0]),void 0!==(n=r.split("Twitter"))[1]&&(r=n[0]);var i=function(e){return function(t){return t.test(e)}}(r),o={apple:{phone:i(re)&&!i(he),ipod:i(ne),tablet:!i(re)&&(i(ie)||me(t))&&!i(he),universal:i(oe),device:(i(re)||i(ne)||i(ie)||i(oe)||me(t))&&!i(he)},amazon:{phone:i(ue),tablet:!i(ue)&&i(le),device:i(ue)||i(le)},android:{phone:!i(he)&&i(ue)||!i(he)&&i(ae),tablet:!i(he)&&!i(ue)&&!i(ae)&&(i(le)||i(se)),device:!i(he)&&(i(ue)||i(le)||i(ae)||i(se))||i(/\bokhttp\b/i)},windows:{phone:i(he),tablet:i(ce),device:i(he)||i(ce)},other:{blackberry:i(de),blackberry10:i(fe),opera:i(pe),firefox:i(ge),chrome:i(ye),device:i(de)||i(fe)||i(pe)||i(ge)||i(ye)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const be=(we.default??we)(globalThis.navigator);te.RETINA_PREFIX=/@([0-9\.]+)x/,te.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ve=r(4912),xe=r(1948),_e=r(4776);const Ie={};function Ae(e,t,r=3){if(Ie[t])return;let n=(new Error).stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}\nDeprecated since v${e}`):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}\nDeprecated since v${e}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}\nDeprecated since v${e}`),console.warn(n))),Ie[t]=!0}const Se={get parse(){return Ae("7.3.0","utils.url.parse is deprecated, use native URL API instead."),_e.K0},get format(){return Ae("7.3.0","utils.url.format is deprecated, use native URL API instead."),_e.E9},get resolve(){return Ae("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),_e.WI}};function Te(e){if("string"!=typeof e)throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Ce(e){return e.split("?")[0].split("#")[0]}const Ee={toPosix(e){return t="\\",r="/",e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),r);var t,r},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl:e=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e),isBlobUrl:e=>e.startsWith("blob:"),hasProtocol(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol(e){Te(e),e=this.toPosix(e);const t=/^file:\/\/\//.exec(e);if(t)return t[0];const r=/^[^/:]+:\/{0,2}/.exec(e);return r?r[0]:""},toAbsolute(e,t,r){if(Te(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;const n=Ce(this.toPosix(t??te.ADAPTER.getBaseUrl())),i=Ce(this.toPosix(r??this.rootname(n)));return(e=this.toPosix(e)).startsWith("/")?Ee.join(i,e.slice(1)):this.isAbsolute(e)?e:this.join(n,e)},normalize(e){if(Te(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;let t="";const r=(e=this.toPosix(e)).startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const n=e.endsWith("/");return e=function(e,t){let r="",n=0,i=-1,o=0,a=-1;for(let s=0;s<=e.length;++s){if(s<e.length)a=e.charCodeAt(s);else{if(47===a)break;a=47}if(47===a){if(i!==s-1&&1!==o)if(i!==s-1&&2===o){if(r.length<2||2!==n||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){const e=r.lastIndexOf("/");if(e!==r.length-1){-1===e?(r="",n=0):(r=r.slice(0,e),n=r.length-1-r.lastIndexOf("/")),i=s,o=0;continue}}else if(2===r.length||1===r.length){r="",n=0,i=s,o=0;continue}t&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+=`/${e.slice(i+1,s)}`:r=e.slice(i+1,s),n=s-i-1;i=s,o=0}else 46===a&&-1!==o?++o:o=-1}return r}(e,!1),e.length>0&&n&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return Te(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join(...e){if(0===e.length)return".";let t;for(let r=0;r<e.length;++r){const n=e[r];if(Te(n),n.length>0)if(void 0===t)t=n;else{const i=e[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?t+=`/../${n}`:t+=`/${n}`}}return void 0===t?".":this.normalize(t)},dirname(e){if(Te(e),0===e.length)return".";let t=(e=this.toPosix(e)).charCodeAt(0);const r=47===t;let n=-1,i=!0;const o=this.getProtocol(e),a=e;for(let r=(e=e.slice(o.length)).length-1;r>=1;--r)if(t=e.charCodeAt(r),47===t){if(!i){n=r;break}}else i=!1;return-1===n?r?"/":this.isUrl(a)?o+e:o:r&&1===n?"//":o+e.slice(0,n)},rootname(e){Te(e);let t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){const r=e.indexOf("/",t.length);t=-1!==r?e.slice(0,r):e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Te(e),t&&Te(t),e=Ce(this.toPosix(e));let r,n=0,i=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let a=t.length-1,s=-1;for(r=e.length-1;r>=0;--r){const u=e.charCodeAt(r);if(47===u){if(!o){n=r+1;break}}else-1===s&&(o=!1,s=r+1),a>=0&&(u===t.charCodeAt(a)?-1==--a&&(i=r):(a=-1,i=s))}return n===i?i=s:-1===i&&(i=e.length),e.slice(n,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){n=r+1;break}}else-1===i&&(o=!1,i=r+1);return-1===i?"":e.slice(n,i)},extname(e){Te(e);let t=-1,r=0,n=-1,i=!0,o=0;for(let a=(e=Ce(this.toPosix(e))).length-1;a>=0;--a){const s=e.charCodeAt(a);if(47!==s)-1===n&&(i=!1,n=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){r=a+1;break}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===r+1?"":e.slice(t,n)},parse(e){Te(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;let r=(e=Ce(this.toPosix(e))).charCodeAt(0);const n=this.isAbsolute(e);let i;t.root=this.rootname(e),i=n||this.hasProtocol(e)?1:0;let o=-1,a=0,s=-1,u=!0,l=e.length-1,h=0;for(;l>=i;--l)if(r=e.charCodeAt(l),47!==r)-1===s&&(u=!1,s=l+1),46===r?-1===o?o=l:1!==h&&(h=1):-1!==o&&(h=-1);else if(!u){a=l+1;break}return-1===o||-1===s||0===h||1===h&&o===s-1&&o===a+1?-1!==s&&(t.base=t.name=0===a&&n?e.slice(1,s):e.slice(a,s)):(0===a&&n?(t.name=e.slice(1,o),t.base=e.slice(1,s)):(t.name=e.slice(a,o),t.base=e.slice(a,s)),t.ext=e.slice(o,s)),t.dir=this.dirname(e),t},sep:"/",delimiter:":",joinExtensions:[".html"]};let Oe,ke;async function Pe(){return Oe??(Oe=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return W.UNPACK;const t=await new Promise((e=>{const t=document.createElement("video");t.onloadeddata=()=>e(t),t.onerror=()=>e(null),t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load()}));if(!t)return W.UNPACK;const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(r),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?W.PMA:W.UNPACK})()),Oe}function $e(){Ae("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Re(){Ae("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option')}function Be(){return typeof ke>"u"&&(ke=function(){const e={stencil:!0,failIfMajorPerformanceCaveat:te.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!te.ADAPTER.getWebGLRenderingContext())return!1;const t=te.ADAPTER.createCanvas();let r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const n=!!r?.getContextAttributes()?.stencil;if(r){const e=r.getExtension("WEBGL_lose_context");e&&e.loseContext()}return r=null,n}catch{return!1}}()),ke}var De={grad:.9,turn:360,rad:360/(2*Math.PI)},Me=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},Le=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},Fe=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},Ne=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Ue=function(e){return{r:Fe(e.r,0,255),g:Fe(e.g,0,255),b:Fe(e.b,0,255),a:Fe(e.a)}},je=function(e){return{r:Le(e.r),g:Le(e.g),b:Le(e.b),a:Le(e.a,3)}},Ge=/^#([0-9a-f]{3,8})$/i,ze=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},Ve=function(e){var t=e.r,r=e.g,n=e.b,i=e.a,o=Math.max(t,r,n),a=o-Math.min(t,r,n),s=a?o===t?(r-n)/a:o===r?2+(n-t)/a:4+(t-r)/a:0;return{h:60*(s<0?s+6:s),s:o?a/o*100:0,v:o/255*100,a:i}},He=function(e){var t=e.h,r=e.s,n=e.v,i=e.a;t=t/360*6,r/=100,n/=100;var o=Math.floor(t),a=n*(1-r),s=n*(1-(t-o)*r),u=n*(1-(1-t+o)*r),l=o%6;return{r:255*[n,s,a,a,u,n][l],g:255*[u,n,n,s,a,a][l],b:255*[a,a,u,n,n,s][l],a:i}},We=function(e){return{h:Ne(e.h),s:Fe(e.s,0,100),l:Fe(e.l,0,100),a:Fe(e.a)}},Ye=function(e){return{h:Le(e.h),s:Le(e.s),l:Le(e.l),a:Le(e.a,3)}},Ke=function(e){return He((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n},Xe=function(e){return{h:(t=Ve(e)).h,s:(i=(200-(r=t.s))*(n=t.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,r,n,i},Ze=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,qe=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Je=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Qe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,et={string:[[function(e){var t=Ge.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?Le(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?Le(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=Je.exec(e)||Qe.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Ue({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=Ze.exec(e)||qe.exec(e);if(!t)return null;var r,n,i=We({h:(r=t[1],n=t[2],void 0===n&&(n="deg"),Number(r)*(De[n]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return Ke(i)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,n=e.b,i=e.a,o=void 0===i?1:i;return Me(t)&&Me(r)&&Me(n)?Ue({r:Number(t),g:Number(r),b:Number(n),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,r=e.s,n=e.l,i=e.a,o=void 0===i?1:i;if(!Me(t)||!Me(r)||!Me(n))return null;var a=We({h:Number(t),s:Number(r),l:Number(n),a:Number(o)});return Ke(a)},"hsl"],[function(e){var t=e.h,r=e.s,n=e.v,i=e.a,o=void 0===i?1:i;if(!Me(t)||!Me(r)||!Me(n))return null;var a=function(e){return{h:Ne(e.h),s:Fe(e.s,0,100),v:Fe(e.v,0,100),a:Fe(e.a)}}({h:Number(t),s:Number(r),v:Number(n),a:Number(o)});return He(a)},"hsv"]]},tt=function(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]]}return[null,void 0]},rt=function(e){return"string"==typeof e?tt(e.trim(),et.string):"object"==typeof e&&null!==e?tt(e,et.object):[null,void 0]},nt=function(e,t){var r=Xe(e);return{h:r.h,s:Fe(r.s+100*t,0,100),l:r.l,a:r.a}},it=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},ot=function(e,t){var r=Xe(e);return{h:r.h,s:r.s,l:Fe(r.l+100*t,0,100),a:r.a}},at=function(){function e(e){this.parsed=rt(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return Le(it(this.rgba),2)},e.prototype.isDark=function(){return it(this.rgba)<.5},e.prototype.isLight=function(){return it(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=je(this.rgba)).r,r=e.g,n=e.b,o=(i=e.a)<1?ze(Le(255*i)):"","#"+ze(t)+ze(r)+ze(n)+o;var e,t,r,n,i,o},e.prototype.toRgb=function(){return je(this.rgba)},e.prototype.toRgbString=function(){return t=(e=je(this.rgba)).r,r=e.g,n=e.b,(i=e.a)<1?"rgba("+t+", "+r+", "+n+", "+i+")":"rgb("+t+", "+r+", "+n+")";var e,t,r,n,i},e.prototype.toHsl=function(){return Ye(Xe(this.rgba))},e.prototype.toHslString=function(){return t=(e=Ye(Xe(this.rgba))).h,r=e.s,n=e.l,(i=e.a)<1?"hsla("+t+", "+r+"%, "+n+"%, "+i+")":"hsl("+t+", "+r+"%, "+n+"%)";var e,t,r,n,i},e.prototype.toHsv=function(){return e=Ve(this.rgba),{h:Le(e.h),s:Le(e.s),v:Le(e.v),a:Le(e.a,3)};var e},e.prototype.invert=function(){return st({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),st(nt(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),st(nt(this.rgba,-e))},e.prototype.grayscale=function(){return st(nt(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),st(ot(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),st(ot(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?st({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):Le(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=Xe(this.rgba);return"number"==typeof e?st({h:e,s:t.s,l:t.l,a:t.a}):Le(t.h)},e.prototype.isEqual=function(e){return this.toHex()===st(e).toHex()},e}(),st=function(e){return e instanceof at?e:new at(e)},ut=[];!function(e){e.forEach((function(e){ut.indexOf(e)<0&&(e(at,et),ut.push(e))}))}([function(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var o={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,a,s=n[this.toHex()];if(s)return s;if(null==t?void 0:t.closest){var u=this.toRgb(),l=1/0,h="black";if(!o.length)for(var c in r)o[c]=new e(r[c]).toRgb();for(var d in r){var f=(i=u,a=o[d],Math.pow(i.r-a.r,2)+Math.pow(i.g-a.g,2)+Math.pow(i.b-a.b,2));f<l&&(l=f,h=d)}return h}},t.string.push([function(t){var n=t.toLowerCase(),i="transparent"===n?"#0000":r[n];return i?new e(i).toRgb():null},"name"])}]);const lt=class e{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(t){if(t instanceof e)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"==typeof e&&null!==e?{...e}:e}isSourceEqual(e,t){const r=typeof e;if(r!==typeof t)return!1;if("number"===r||"string"===r||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length&&e.every(((e,r)=>e===t[r]));if(null!==e&&null!==t){const r=Object.keys(e),n=Object.keys(t);return r.length===n.length&&r.every((r=>e[r]===t[r]))}return e===t}toRgba(){const[e,t,r,n]=this._components;return{r:e,g:t,b:r,a:n}}toRgb(){const[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){const[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){const[t,r,n]=this._components;return(e=e??[])[0]=Math.round(255*t),e[1]=Math.round(255*r),e[2]=Math.round(255*n),e}toRgbArray(e){e=e??[];const[t,r,n]=this._components;return e[0]=t,e[1]=r,e[2]=n,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}multiply(t){const[r,n,i,o]=e.temp.setValue(t)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=o,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(1===e)return(255<<24)+this._int;if(0===e)return t?0:this._int;let r=this._int>>16&255,n=this._int>>8&255,i=255&this._int;return t&&(r=r*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(255*e<<24)+(r<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,r,n]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(n*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,r,n,i]=this._components;return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}normalize(t){let r,n,i,o;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){r=(t>>16&255)/255,n=(t>>8&255)/255,i=(255&t)/255,o=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[r,n,i,o=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[r,n,i,o=255]=t,r/=255,n/=255,i/=255,o/=255;else if("string"==typeof t||"object"==typeof t){if("string"==typeof t){const r=e.HEX_PATTERN.exec(t);r&&(t=`#${r[2]}`)}const a=st(t);a.isValid()&&(({r,g:n,b:i,a:o}=a.rgba),r/=255,n/=255,i/=255)}if(void 0===r)throw new Error(`Unable to convert color ${t}`);this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=o,this.refreshInt()}refreshInt(){this._clamp(this._components);const[e,t,r]=this._components;this._int=(255*e<<16)+(255*t<<8)+(255*r|0)}_clamp(e,t=0,r=1){return"number"==typeof e?Math.min(Math.max(e,t),r):(e.forEach(((n,i)=>{e[i]=Math.min(Math.max(n,t),r)})),e)}};lt.shared=new lt,lt.temp=new lt,lt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ht=lt;function ct(e,t=[]){return Ae("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),ht.shared.setValue(e).toRgbArray(t)}function dt(e){return Ae("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),ht.shared.setValue(e).toHex()}function ft(e){return Ae("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),ht.shared.setValue(e).toNumber()}function pt(e){return Ae("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),ht.shared.setValue(e).toNumber()}const yt=function(){const e=[],t=[];for(let r=0;r<32;r++)e[r]=r,t[r]=r;e[L.NORMAL_NPM]=L.NORMAL,e[L.ADD_NPM]=L.ADD,e[L.SCREEN_NPM]=L.SCREEN,t[L.NORMAL]=L.NORMAL_NPM,t[L.ADD]=L.ADD_NPM,t[L.SCREEN]=L.SCREEN_NPM;const r=[];return r.push(t),r.push(e),r}();function gt(e,t){return yt[t?1:0][e]}function mt(e,t,r,n=!0){return Ae("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),ht.shared.setValue(e).premultiply(t,n).toArray(r??new Float32Array(4))}function wt(e,t){return Ae("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),ht.shared.setValue(e).toPremultiplied(t)}function bt(e,t,r,n=!0){return Ae("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),ht.shared.setValue(e).premultiply(t,n).toArray(r??new Float32Array(4))}const vt=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function xt(e,t=null){const r=6*e;if((t=t||new Uint16Array(r)).length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let e=0,n=0;e<r;e+=6,n+=4)t[e+0]=n+0,t[e+1]=n+1,t[e+2]=n+2,t[e+3]=n+0,t[e+4]=n+2,t[e+5]=n+3;return t}function _t(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}const It={Float32Array,Uint32Array,Int32Array,Uint8Array};function At(e,t){let r=0,n=0;const i={};for(let i=0;i<e.length;i++)n+=t[i],r+=e[i].length;const o=new ArrayBuffer(4*r);let a=null,s=0;for(let r=0;r<e.length;r++){const u=t[r],l=e[r],h=_t(l);i[h]||(i[h]=new It[h](o)),a=i[h];for(let e=0;e<l.length;e++){a[(e/u|0)*n+s+e%u]=l[e]}s+=u}return new Float32Array(o)}function St(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function Tt(e){return!(e&e-1||!e)}function Ct(e){let t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,r=((e>>>=r)>15?1:0)<<2,t|=r,r=((e>>>=r)>3?1:0)<<1,t|=r,t|(e>>>=r)>>1}function Et(e,t,r){const n=e.length;let i;if(t>=n||0===r)return;const o=n-(r=t+r>n?n-t:r);for(i=t;i<o;++i)e[i]=e[i+r];e.length=o}function Ot(e){return 0===e?0:e<0?-1:1}let kt=0;function Pt(){return++kt}const $t=class{constructor(e,t,r,n){this.left=e,this.top=t,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};$t.EMPTY=new $t(0,0,0,0);let Rt=$t;const Bt={},Dt=Object.create(null),Mt=Object.create(null);function Lt(){let e;for(e in Dt)Dt[e].destroy();for(e in Mt)Mt[e].destroy()}function Ft(){let e;for(e in Dt)delete Dt[e];for(e in Mt)delete Mt[e]}class Nt{constructor(e,t,r){this._canvas=te.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||te.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Ut(e,t,r){for(let n=0,i=4*r*t;n<t;++n,i+=4)if(0!==e[i+3])return!1;return!0}function jt(e,t,r,n,i){const o=4*t;for(let t=n,a=n*o+4*r;t<=i;++t,a+=o)if(0!==e[a+3])return!1;return!0}function Gt(e){const{width:t,height:r}=e,n=e.getContext("2d",{willReadFrequently:!0});if(null===n)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,t,r).data;let o=0,a=0,s=t-1,u=r-1;for(;a<r&&Ut(i,t,a);)++a;if(a===r)return Rt.EMPTY;for(;Ut(i,t,u);)--u;for(;jt(i,t,o,a,u);)++o;for(;jt(i,t,s,a,u);)--s;return++s,++u,new Rt(o,a,s,u)}function zt(e){const t=Gt(e),{width:r,height:n}=t;let i=null;if(!t.isEmpty()){const o=e.getContext("2d");if(null===o)throw new TypeError("Failed to get canvas 2D context");i=o.getImageData(t.left,t.top,r,n)}return{width:r,height:n,data:i}}function Vt(e){const t=vt.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function Ht(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location;const r=new URL(e,document.baseURI);return r.hostname!==t.hostname||r.port!==t.port||r.protocol!==t.protocol?"anonymous":""}function Wt(e,t=1){const r=te.RETINA_PREFIX?.exec(e);return r?parseFloat(r[1]):t}var Yt=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(Yt||{});const Kt=e=>{if("function"==typeof e||"object"==typeof e&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={..."object"!=typeof e.extension?{type:e.extension}:e.extension,ref:e}}if("object"!=typeof e)throw new Error("Invalid extension type");return"string"==typeof(e={...e}).type&&(e.type=[e.type]),e},Xt=(e,t)=>Kt(e).priority??t,Zt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Kt).forEach((e=>{e.type.forEach((t=>this._removeHandlers[t]?.(e)))})),this},add(...e){return e.map(Kt).forEach((e=>{e.type.forEach((t=>{const r=this._addHandlers,n=this._queue;r[t]?r[t]?.(e):(n[t]=n[t]||[],n[t]?.push(e))}))})),this},handle(e,t,r){const n=this._addHandlers,i=this._removeHandlers;if(n[e]||i[e])throw new Error(`Extension type ${e} already has a handler`);n[e]=t,i[e]=r;const o=this._queue;return o[e]&&(o[e]?.forEach((e=>t(e))),delete o[e]),this},handleByMap(e,t){return this.handle(e,(e=>{e.name&&(t[e.name]=e.ref)}),(e=>{e.name&&delete t[e.name]}))},handleByList(e,t,r=-1){return this.handle(e,(e=>{t.includes(e.ref)||(t.push(e.ref),t.sort(((e,t)=>Xt(t,r)-Xt(e,r))))}),(e=>{const r=t.indexOf(e.ref);-1!==r&&t.splice(r,1)}))}};class qt{constructor(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const Jt=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Qt(e){let t="";for(let r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function er(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=t.createShader(t.FRAGMENT_SHADER);for(;;){const n=Jt.replace(/%forloop%/gi,Qt(e));if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}class tr{constructor(){this.data=0,this.blendMode=L.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(e){!!(1&this.data)!==e&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(e){!!(2&this.data)!==e&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(e){!!(4&this.data)!==e&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(e){!!(8&this.data)!==e&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(e){!!(32&this.data)!==e&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(e){!!(16&this.data)!==e&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==L.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new tr;return e.depthTest=!1,e.blend=!0,e}}tr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const rr=[];function nr(e,t){if(!e)return null;let r="";if("string"==typeof e){const t=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);t&&(r=t[1].toLowerCase())}for(let n=rr.length-1;n>=0;--n){const i=rr[n];if(i.test&&i.test(e,r))return new i(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class ir{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,r,n,i,o,a,s){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:l}=this;this._aliasCount++;for(let h=0,c=l.length;h<c;h++)l[h][u](e,t,r,n,i,o,a,s);return l===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(ir.prototype,{dispatch:{value:ir.prototype.emit},run:{value:ir.prototype.emit}});class or{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new ir("setRealSize"),this.onUpdate=new ir("update"),this.onError=new ir("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class ar extends or{constructor(e,t){const{width:r,height:n}=t||{};if(!r||!n)throw new Error("BufferResource width or height invalid");super(r,n),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,r){const n=e.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,this.unpackAlignment),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===W.UNPACK);const i=t.realWidth,o=t.realHeight;return r.width===i&&r.height===o?n.texSubImage2D(t.target,0,0,0,i,o,t.format,r.type,this.data):(r.width=i,r.height=o,n.texImage2D(t.target,0,r.internalFormat,i,o,0,t.format,r.type,this.data)),!0}dispose(){this.data=null}static test(e){return null===e||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const sr={scaleMode:z.NEAREST,alphaMode:W.NPM},ur=class e extends ve{constructor(t=null,r=null){super(),r=Object.assign({},e.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:o,scaleMode:a,width:s,height:u,wrapMode:l,format:h,type:c,target:d,resolution:f,resourceOptions:p}=r;t&&!(t instanceof or)&&((t=nr(t,p)).internal=!0),this.resolution=f||te.RESOLUTION,this.width=Math.round((s||0)*this.resolution)/this.resolution,this.height=Math.round((u||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=o,this._wrapMode=l,this._scaleMode=a,this.format=h,this.type=c,this.target=d,this.alphaMode=n,this.uid=Pt(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=s>0&&u>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Tt(this.realWidth)&&Tt(this.realHeight)}setResolution(e){const t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT()),this}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Mt[this.cacheId],delete Dt[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,r,n=te.STRICT_TEXTURE_CACHE){const i="string"==typeof t;let o=null;if(i)o=t;else{if(!t._pixiId){const e=r?.pixiIdPrefix||"pixiid";t._pixiId=`${e}_${Pt()}`}o=t._pixiId}let a=Mt[o];if(i&&n&&!a)throw new Error(`The cacheId "${o}" does not exist in BaseTextureCache.`);return a||(a=new e(t,r),a.cacheId=o,e.addToCache(a,o)),a}static fromBuffer(t,r,n,i){t=t||new Float32Array(r*n*4);const o=new ar(t,{width:r,height:n,...i?.resourceOptions});let a,s;return t instanceof Float32Array?(a=N.RGBA,s=j.FLOAT):t instanceof Int32Array?(a=N.RGBA_INTEGER,s=j.INT):t instanceof Uint32Array?(a=N.RGBA_INTEGER,s=j.UNSIGNED_INT):t instanceof Int16Array?(a=N.RGBA_INTEGER,s=j.SHORT):t instanceof Uint16Array?(a=N.RGBA_INTEGER,s=j.UNSIGNED_SHORT):t instanceof Int8Array?(a=N.RGBA,s=j.BYTE):(a=N.RGBA,s=j.UNSIGNED_BYTE),o.internal=!0,new e(o,Object.assign({},sr,{type:s,format:a},i))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Mt[t]&&Mt[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Mt[t]=e)}static removeFromCache(e){if("string"==typeof e){const t=Mt[e];if(t){const r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Mt[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete Mt[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};ur.defaultOptions={mipmap:H.POW2,anisotropicLevel:0,scaleMode:z.LINEAR,wrapMode:V.CLAMP,alphaMode:W.UNPACK,target:U.TEXTURE_2D,format:N.RGBA,type:j.UNSIGNED_BYTE},ur._globalBatch=0;let lr=ur;class hr{constructor(){this.texArray=null,this.blend=0,this.type=F.TRIANGLES,this.start=0,this.size=0,this.data=null}}let cr=0;class dr{constructor(e,t=!0,r=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=cr++,this.disposeRunner=new ir("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Q.ELEMENT_ARRAY_BUFFER:Q.ARRAY_BUFFER}get index(){return this.type===Q.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new dr(e)}}class fr{constructor(e,t=0,r=!1,n=j.FLOAT,i,o,a,s=1){this.buffer=e,this.size=t,this.normalized=r,this.type=n,this.stride=i,this.start=o,this.instance=a,this.divisor=s}destroy(){this.buffer=null}static from(e,t,r,n,i){return new fr(e,t,r,n,i)}}const pr={Float32Array,Uint32Array,Int32Array,Uint8Array};const yr={5126:4,5123:2,5121:1};let gr=0;const mr={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class wr{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=gr++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ir("disposeGeometry"),this.refCount=0}addAttribute(e,t,r=0,n=!1,i,o,a,s=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof dr||(t instanceof Array&&(t=new Float32Array(t)),t=new dr(t));const u=e.split("|");if(u.length>1){for(let e=0;e<u.length;e++)this.addAttribute(u[e],t,r,n,i);return this}let l=this.buffers.indexOf(t);return-1===l&&(this.buffers.push(t),l=this.buffers.length-1),this.attributes[e]=new fr(l,r,n,i,o,a,s),this.instanced=this.instanced||s,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof dr||(e instanceof Array&&(e=new Uint16Array(e)),e=new dr(e)),e.type=Q.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const e=[],t=[],r=new dr;let n;for(n in this.attributes){const r=this.attributes[n],i=this.buffers[r.buffer];e.push(i.data),t.push(r.size*yr[r.type]/4),r.buffer=0}for(r.data=function(e,t){let r=0,n=0;const i={};for(let i=0;i<e.length;i++)n+=t[i],r+=e[i].length;const o=new ArrayBuffer(4*r);let a=null,s=0;for(let r=0;r<e.length;r++){const u=t[r],l=e[r],h=_t(l);i[h]||(i[h]=new pr[h](o)),a=i[h];for(let e=0;e<l.length;e++)a[(e/u|0)*n+s+e%u]=l[e];s+=u}return new Float32Array(o)}(e,t),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new wr;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new dr(this.buffers[t].data.slice(0));for(const t in this.attributes){const r=this.attributes[t];e.attributes[t]=new fr(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Q.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new wr,r=[],n=[],i=[];let o;for(let t=0;t<e.length;t++){o=e[t];for(let e=0;e<o.buffers.length;e++)n[e]=n[e]||0,n[e]+=o.buffers[e].data.length,i[e]=0}for(let e=0;e<o.buffers.length;e++)r[e]=new(mr[_t(o.buffers[e].data)])(n[e]),t.buffers[e]=new dr(r[e]);for(let t=0;t<e.length;t++){o=e[t];for(let e=0;e<o.buffers.length;e++)r[e].set(o.buffers[e].data,i[e]),i[e]+=o.buffers[e].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=Q.ELEMENT_ARRAY_BUFFER;let r=0,n=0,i=0,a=0;for(let e=0;e<o.buffers.length;e++)if(o.buffers[e]!==o.indexBuffer){a=e;break}for(const e in o.attributes){const t=o.attributes[e];(0|t.buffer)===a&&(n+=t.size*yr[t.type]/4)}for(let o=0;o<e.length;o++){const s=e[o].indexBuffer.data;for(let e=0;e<s.length;e++)t.indexBuffer.data[e+i]+=r;r+=e[o].buffers[a].data.length/n,i+=s.length}}return t}}class br extends wr{constructor(e=!1){super(),this._buffer=new dr(null,e,!1),this._indexBuffer=new dr(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,j.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,j.FLOAT).addAttribute("aColor",this._buffer,4,!0,j.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,j.FLOAT).addIndex(this._indexBuffer)}}const vr=2*Math.PI,xr=180/Math.PI,_r=Math.PI/180;var Ir=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(Ir||{});class Ar{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Ar(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}Ar.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Sr=[new Ar,new Ar,new Ar,new Ar];class Tr{constructor(e=0,t=0,r=0,n=0){this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(n),this.type=Ir.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Tr(0,0,0,0)}clone(){return new Tr(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)}intersects(e,t){if(!t){const t=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=t)return!1;const r=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>r}const r=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=r||o<=i)return!1;const a=Sr[0].set(e.left,e.top),s=Sr[1].set(e.left,e.bottom),u=Sr[2].set(e.right,e.top),l=Sr[3].set(e.right,e.bottom);if(u.x<=a.x||s.y<=a.y)return!1;const h=Math.sign(t.a*t.d-t.b*t.c);if(0===h||(t.apply(a,a),t.apply(s,s),t.apply(u,u),t.apply(l,l),Math.max(a.x,s.x,u.x,l.x)<=r||Math.min(a.x,s.x,u.x,l.x)>=n||Math.max(a.y,s.y,u.y,l.y)<=i||Math.min(a.y,s.y,u.y,l.y)>=o))return!1;const c=h*(s.y-a.y),d=h*(a.x-s.x),f=c*r+d*i,p=c*n+d*i,y=c*r+d*o,g=c*n+d*o;if(Math.max(f,p,y,g)<=c*a.x+d*a.y||Math.min(f,p,y,g)>=c*l.x+d*l.y)return!1;const m=h*(a.y-u.y),w=h*(u.x-a.x),b=m*r+w*i,v=m*n+w*i,x=m*r+w*o,_=m*n+w*o;return!(Math.max(b,v,x,_)<=m*a.x+w*a.y||Math.min(b,v,x,_)>=m*l.x+w*l.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}fit(e){const t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,t=.001){const r=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=n-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=n,this.height=i-n,this}}Tr.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Cr{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.radius=r,this.type=Ir.CIRC}clone(){return new Cr(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const r=this.radius*this.radius;let n=this.x-e,i=this.y-t;return n*=n,i*=i,n+i<=r}getBounds(){return new Tr(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}Cr.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Er{constructor(e=0,t=0,r=0,n=0){this.x=e,this.y=t,this.width=r,this.height=n,this.type=Ir.ELIP}clone(){return new Er(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let r=(e-this.x)/this.width,n=(t-this.y)/this.height;return r*=r,n*=n,r+n<=1}getBounds(){return new Tr(this.x-this.width,this.y-this.height,this.width,this.height)}}Er.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Or{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if("number"!=typeof t[0]){const e=[];for(let r=0,n=t.length;r<n;r++)e.push(t[r].x,t[r].y);t=e}this.points=t,this.type=Ir.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new Or(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let r=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const n=this.points[2*i],a=this.points[2*i+1],s=this.points[2*o],u=this.points[2*o+1];a>t!=u>t&&e<(t-a)/(u-a)*(s-n)+n&&(r=!r)}return r}}Or.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(((e,t)=>`${e}, ${t}`),"")}]`};class kr{constructor(e=0,t=0,r=0,n=0,i=20){this.x=e,this.y=t,this.width=r,this.height=n,this.radius=i,this.type=Ir.RREC}clone(){return new kr(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+r&&t<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let n=e-(this.x+r),i=t-(this.y+r);const o=r*r;if(n*n+i*i<=o||(n=e-(this.x+this.width-r),n*n+i*i<=o)||(i=t-(this.y+this.height-r),n*n+i*i<=o)||(n=e-(this.x+r),n*n+i*i<=o))return!0}return!1}}kr.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Pr{constructor(e=1,t=0,r=0,n=1,i=0,o=0){this.array=null,this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,r,n,i,o){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,t){t=t||new Ar;const r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t}applyInverse(e,t){t=t||new Ar;const r=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return t.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,o=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=i*t-this.d*r,this.d=i*r+this.d*t,this.tx=o*t-this.ty*r,this.ty=o*r+this.ty*t,this}append(e){const t=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this}setTransform(e,t,r,n,i,o,a,s,u){return this.a=Math.cos(a+u)*i,this.b=Math.sin(a+u)*i,this.c=-Math.sin(a-s)*o,this.d=Math.cos(a-s)*o,this.tx=e-(r*this.a+n*this.c),this.ty=t-(r*this.b+n*this.d),this}prepend(e){const t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const t=this.a,r=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,r=this.b,n=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-n,i),s=Math.atan2(r,t),u=Math.abs(a+s);return u<1e-5||Math.abs(vr-u)<1e-5?(e.rotation=s,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=s),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(o.x*t+o.y*n),e.position.y=this.ty+(o.x*r+o.y*i),e}invert(){const e=this.a,t=this.b,r=this.c,n=this.d,i=this.tx,o=e*n-t*r;return this.a=n/o,this.b=-t/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(e*this.ty-t*i)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Pr;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Pr}static get TEMP_MATRIX(){return new Pr}}Pr.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const $r=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Rr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Br=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Dr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Mr=[],Lr=[],Fr=Math.sign;!function(){for(let e=0;e<16;e++){const t=[];Mr.push(t);for(let r=0;r<16;r++){const n=Fr($r[e]*$r[r]+Br[e]*Rr[r]),i=Fr(Rr[e]*$r[r]+Dr[e]*Rr[r]),o=Fr($r[e]*Br[r]+Br[e]*Dr[r]),a=Fr(Rr[e]*Br[r]+Dr[e]*Dr[r]);for(let e=0;e<16;e++)if($r[e]===n&&Rr[e]===i&&Br[e]===o&&Dr[e]===a){t.push(e);break}}}for(let e=0;e<16;e++){const t=new Pr;t.set($r[e],Rr[e],Br[e],Dr[e],0,0),Lr.push(t)}}();const Nr={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>$r[e],uY:e=>Rr[e],vX:e=>Br[e],vY:e=>Dr[e],inv:e=>8&e?15&e:7&-e,add:(e,t)=>Mr[e][t],sub:(e,t)=>Mr[e][Nr.inv(t)],rotate180:e=>4^e,isVertical:e=>2==(3&e),byDirection:(e,t)=>2*Math.abs(e)<=Math.abs(t)?t>=0?Nr.S:Nr.N:2*Math.abs(t)<=Math.abs(e)?e>0?Nr.E:Nr.W:t>0?e>0?Nr.SE:Nr.SW:e>0?Nr.NE:Nr.NW,matrixAppendRotationInv:(e,t,r=0,n=0)=>{const i=Lr[Nr.inv(t)];i.tx=r,i.ty=n,e.append(i)}};class Ur{constructor(e,t,r=0,n=0){this._x=r,this._y=n,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new Ur(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Ur.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const jr=class{constructor(){this.worldTransform=new Pr,this.localTransform=new Pr,this.position=new Ur(this.onChange,this,0,0),this.scale=new Ur(this.onChange,this,1,1),this.pivot=new Ur(this.onChange,this,0,0),this.skew=new Ur(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const r=e.worldTransform,n=this.worldTransform;n.a=t.a*r.a+t.b*r.c,n.b=t.a*r.b+t.b*r.d,n.c=t.c*r.a+t.d*r.c,n.d=t.c*r.b+t.d*r.d,n.tx=t.tx*r.a+t.ty*r.c+r.tx,n.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};jr.IDENTITY=new jr;let Gr=jr;Gr.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};const zr=[{test:e=>"float"===e.type&&1===e.size&&!e.isArray,code:e=>`\n            if(uv["${e}"] !== ud["${e}"].value)\n            {\n                ud["${e}"].value = uv["${e}"]\n                gl.uniform1f(ud["${e}"].location, uv["${e}"])\n            }\n            `},{test:(e,t)=>!("sampler2D"!==e.type&&"samplerCube"!==e.type&&"sampler2DArray"!==e.type||1!==e.size||e.isArray||null!=t&&void 0===t.castToBaseTexture),code:e=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${e}"], t);\n\n            if(ud["${e}"].value !== t)\n            {\n                ud["${e}"].value = t;\n                gl.uniform1i(ud["${e}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(e,t)=>"mat3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.a,code:e=>`\n            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));\n            `,codeUbo:e=>`\n                var ${e}_matrix = uv.${e}.toArray(true);\n\n                data[offset] = ${e}_matrix[0];\n                data[offset+1] = ${e}_matrix[1];\n                data[offset+2] = ${e}_matrix[2];\n        \n                data[offset + 4] = ${e}_matrix[3];\n                data[offset + 5] = ${e}_matrix[4];\n                data[offset + 6] = ${e}_matrix[5];\n        \n                data[offset + 8] = ${e}_matrix[6];\n                data[offset + 9] = ${e}_matrix[7];\n                data[offset + 10] = ${e}_matrix[8];\n            `},{test:(e,t)=>"vec2"===e.type&&1===e.size&&!e.isArray&&void 0!==t.x,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${e}"].location, v.x, v.y);\n                }`,codeUbo:e=>`\n                v = uv.${e};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:e=>"vec2"===e.type&&1===e.size&&!e.isArray,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);\n                }\n            `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.width,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(e,t)=>"vec3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:e=>"vec4"===e.type&&1===e.size&&!e.isArray,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])\n                }`}],Vr={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},Hr={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};const Wr={};let Yr,Kr=Wr;function Xr(){if(Kr===Wr||Kr?.isContextLost()){const e=te.ADAPTER.createCanvas();let t;te.PREFER_ENV>=B.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Kr=t}return Kr}const Zr={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function qr(e){return Zr[e]}let Jr=null;const Qr={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function en(e,t){if(!Jr){const t=Object.keys(Qr);Jr={};for(let r=0;r<t.length;++r){const n=t[r];Jr[e[n]]=Qr[n]}}return Jr[t]}function tn(e,t,r){if("precision"!==e.substring(0,9)){let n=t;return t===X.HIGH&&r!==X.HIGH&&(n=X.MEDIUM),`precision ${n} float;\n${e}`}return r!==X.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}let rn=0;const nn={},on=class e{constructor(t,r,n="pixi-shader",i={}){this.extra={},this.id=rn++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),nn[n]?(nn[n]++,n+=`-${nn[n]}`):nn[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}\n${this.fragmentSrc}`,this.vertexSrc=tn(this.vertexSrc,e.defaultVertexPrecision,X.HIGH),this.fragmentSrc=tn(this.fragmentSrc,e.defaultFragmentPrecision,function(){if(!Yr){Yr=X.MEDIUM;const e=Xr();if(e&&e.getShaderPrecisionFormat){const t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);t&&(Yr=t.precision?X.HIGH:X.MEDIUM)}}return Yr}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(t,r,n){const i=t+r;let o=Bt[i];return o||(Bt[i]=o=new e(t,r,n)),o}};on.defaultVertexPrecision=X.HIGH,on.defaultFragmentPrecision=be.apple.device?X.HIGH:X.MEDIUM;let an=on,sn=0;class un{constructor(e,t,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=sn++,this.static=!!t,this.ubo=!!r,e instanceof dr?(this.buffer=e,this.buffer.type=Q.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new dr(new Float32Array(1)),this.buffer.type=Q.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new un(t,r)}static from(e,t,r){return new un(e,t,r)}static uboFrom(e,t){return new un(e,t??!0,!0)}}class ln{constructor(e,t){this.uniformBindCount=0,this.program=e,this.uniformGroup=t?t instanceof un?t:new un(t):new un({}),this.disposeRunner=new ir("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const r in t.uniforms){const n=t.uniforms[r];if(!0===n.group&&this.checkUniformExists(e,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,r){const n=an.from(e,t);return new ln(n,r)}}class hn{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=un.from({uSamplers:t},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${e}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new an(this.vertexSrc,r)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pr,default:this.defaultGroupCache[e]};return new ln(this.programCache[e],t)}generateSampleSrc(e){let t="";t+="\n",t+="\n";for(let r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+=`if(vTextureId < ${r}.5)`),t+="\n{",t+=`\n\tcolor = texture2D(uSamplers[${r}], vTextureCoord);`,t+="\n}";return t+="\n",t+="\n",t}}class cn{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}class dn{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}const fn=class e extends dn{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=br,this.vertexSize=6,this.state=tr.for2d(),this.size=4*e.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??function(e){let t=!0;const r=te.ADAPTER.getNavigator();if(be.tablet||be.phone){if(be.apple.device){const e=r.userAgent.match(/OS (\d+)_(\d+)?/);e&&parseInt(e[1],10)<11&&(t=!1)}if(be.android.device){const e=r.userAgent.match(/Android\s([0-9.]*)/);e&&parseInt(e[1],10)<7&&(t=!1)}}return t?e:4}(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??!be.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Ae("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:t=e.defaultVertexSrc,fragment:r=e.defaultFragmentTemplate}={}){this.shaderGenerator=new hn(t,r)}contextChange(){const t=this.renderer.gl;te.PREFER_ENV===B.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),e.defaultMaxTextures),this.maxTextures=er(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:r}=e,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;t.length<n;)t.push(new hr);for(;r.length<i;)r.push(new cn);for(let e=0;e<this.maxTextures;e++)this._tempBoundTextures[e]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:r}=this,n=e._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count;let s=++lr._globalBatch,u=0,l=n[0],h=0;i.copyBoundTextures(o,r);for(let e=0;e<this._bufferSize;++e){const c=t[e];t[e]=null,c._batchEnabled!==s&&(l.count>=r&&(i.boundArray(l,o,s,r),this.buildDrawCalls(l,h,e),h=e,l=n[++u],++s),c._batchEnabled=s,c.touched=a,l.elements[l.count++]=c)}l.count>0&&(i.boundArray(l,o,s,r),this.buildDrawCalls(l,h,this._bufferSize),++u,++s);for(let e=0;e<o.length;e++)o[e]=null;lr._globalBatch=s}buildDrawCalls(t,r,n){const{_bufferedElements:i,_attributeBuffer:o,_indexBuffer:a,vertexSize:s}=this,u=e._drawCallPool;let l=this._dcIndex,h=this._aIndex,c=this._iIndex,d=u[l];d.start=this._iIndex,d.texArray=t;for(let e=r;e<n;++e){const n=i[e],f=n._texture.baseTexture,p=yt[f.alphaMode?1:0][n.blendMode];i[e]=null,r<e&&d.blend!==p&&(d.size=c-d.start,r=e,d=u[++l],d.texArray=t,d.start=c),this.packInterleavedGeometry(n,o,a,h,c),h+=n.vertexData.length/2*s,c+=n.indices.length,d.blend=p}r<n&&(d.size=c-d.start,++l),this._dcIndex=l,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(e){const t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:r,_indexBuffer:n}=this;e.canUploadSameBuffer?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:r,state:n}=this.renderer,i=e._drawCallPool;let o=null;for(let e=0;e<t;e++){const{texArray:t,type:a,size:s,start:u,blend:l}=i[e];o!==t&&(o=t,this.bindAndClearTexArray(t)),this.state.blendMode=l,n.set(this.state),r.drawElements(a,s,r.UNSIGNED_SHORT,2*u)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),e.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=St(Math.ceil(e/8)),r=Ct(t),n=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new qt(n*this.vertexSize*4)),i}getIndexBuffer(e){const t=St(Math.ceil(e/12)),r=Ct(t),n=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(n)),i}packInterleavedGeometry(e,t,r,n,i){const{uint32View:o,float32View:a}=t,s=n/this.vertexSize,u=e.uvs,l=e.indices,h=e.vertexData,c=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),f=ht.shared.setValue(e._tintRGB).toPremultiplied(d,e._texture.baseTexture.alphaMode>0);for(let e=0;e<h.length;e+=2)a[n++]=h[e],a[n++]=h[e+1],a[n++]=u[e],a[n++]=u[e+1],o[n++]=f,a[n++]=c;for(let e=0;e<l.length;e++)r[i++]=s+l[e]}};fn.defaultBatchSize=4096,fn.extension={name:"batch",type:Yt.RendererPlugin},fn._drawCallPool=[],fn._textureArrayPool=[];let pn=fn;Zt.add(pn);const yn=class e extends ln{constructor(t,r,n){super(an.from(t||e.defaultVertexSrc,r||e.defaultFragmentSrc),n),this.padding=0,this.resolution=e.defaultResolution,this.multisample=e.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new tr}apply(e,t,r,n,i){e.applyFilter(this,t,r,n)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};yn.defaultResolution=1,yn.defaultMultisample=J.NONE;let gn=yn;class mn{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new ht(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:t,background:r,backgroundAlpha:n}=e,i=r??t;void 0!==i&&(this.color=i),this.alpha=n}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}mn.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},mn.extension={type:[Yt.RendererSystem,Yt.CanvasRendererSystem],name:"background"},Zt.add(mn);class wn{constructor(e){this.renderer=e,this.emptyRenderer=new dn(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:r}=this.renderer.texture;for(let n=t-1;n>=0;--n)e[n]=r[n]||null,e[n]&&(e[n]._batchLocation=n)}boundArray(e,t,r,n){const{elements:i,ids:o,count:a}=e;let s=0;for(let e=0;e<a;e++){const a=i[e],u=a._batchLocation;if(u>=0&&u<n&&t[u]===a)o[e]=u;else for(;s<n;){const n=t[s];if(!n||n._batchEnabled!==r||n._batchLocation!==s){o[e]=s,a._batchLocation=s,t[s]=a;break}s++}}}destroy(){this.renderer=null}}wn.extension={type:Yt.RendererSystem,name:"batch"},Zt.add(wn);let bn=0;class vn{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=bn++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,r=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=bn++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;void 0!==t.addEventListener&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let r;if(te.PREFER_ENV>=B.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout((()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()}),0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}vn.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},vn.extension={type:Yt.RendererSystem,name:"context"},Zt.add(vn);class xn{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ir("disposeFramebuffer"),this.multisample=J.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new lr(null,{scaleMode:z.NEAREST,resolution:1,mipmap:H.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new lr(null,{scaleMode:z.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:H.OFF,format:N.DEPTH_COMPONENT,type:j.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const n=this.colorTextures[r],i=n.resolution;n.setSize(e/i,t/i)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(e/r,t/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class _n extends lr{constructor(e={}){if("number"==typeof e){e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=J.NONE),super(null,e),this.mipmap=H.OFF,this.valid=!0,this._clear=new ht([0,0,0,0]),this.framebuffer=new xn(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class In extends or{constructor(e){const t=e;super(t.naturalWidth||t.videoWidth||t.displayWidth||t.width,t.naturalHeight||t.videoHeight||t.displayHeight||t.height),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,r){void 0!==r||t.startsWith("data:")?!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous"):e.crossOrigin=Ht(t)}upload(e,t,r,n){const i=e.gl,o=t.realWidth,a=t.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||0===n.naturalWidth)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===W.UNPACK),this.noSubImage||t.target!==i.TEXTURE_2D||r.width!==o||r.height!==a?(r.width=o,r.height=a,i.texImage2D(t.target,0,r.internalFormat,t.format,r.type,n)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,r.type,n),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(t,r),super.update()}dispose(){this.source=null}}class An extends In{constructor(e,t){if(t=t||{},"string"==typeof e){const r=new Image;In.crossOrigin(r,e,t.crossorigin),r.src=e,e=r}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??te.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.bitmap=null,this._load=null,!1!==t.autoLoad&&this.load()}load(e){return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise(((e,t)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=e=>{t(e),this.onError.emit(e)})}))),this._load}process(){const e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,r=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then((e=>e.blob())).then((r=>t(r,0,0,e.width,e.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===W.UNPACK?"premultiply":"none"}))).then((e=>this.destroyed?Promise.reject():(this.bitmap=e,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(e,t,r){if("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,r,this.bitmap),!this.preserveBitmap){let e=!0;const n=t._glTextures;for(const i in n){const o=n[i];if(o!==r&&o.dirtyId!==t.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&("string"==typeof e||e instanceof HTMLImageElement)}}class Sn{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,r){const n=t.width,i=t.height;if(r){const t=e.width/2/n,o=e.height/2/i,a=e.x/n+t,s=e.y/i+o;r=Nr.add(r,Nr.NW),this.x0=a+t*Nr.uX(r),this.y0=s+o*Nr.uY(r),r=Nr.add(r,2),this.x1=a+t*Nr.uX(r),this.y1=s+o*Nr.uY(r),r=Nr.add(r,2),this.x2=a+t*Nr.uX(r),this.y2=s+o*Nr.uY(r),r=Nr.add(r,2),this.x3=a+t*Nr.uX(r),this.y3=s+o*Nr.uY(r)}else this.x0=e.x/n,this.y0=e.y/i,this.x1=(e.x+e.width)/n,this.y1=e.y/i,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/i,this.x3=e.x/n,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Sn.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Tn=new Sn;function Cn(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class En extends ve{constructor(e,t,r,n,i,o,a){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new Tr(0,0,1,1)),e instanceof En&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=n,this.valid=!1,this.destroyed=!1,this._uvs=Tn,this.uvMatrix=null,this.orig=r||t,this._rotate=Number(i||0),!0===i)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Ar(o.x,o.y):new Ar(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:e}=this.baseTexture;e?.url&&Dt[e.url]&&En.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,En.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),r=new En(this.baseTexture,!this.noFrame&&e,t,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=e),r}updateUvs(){this._uvs===Tn&&(this._uvs=new Sn),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},r=te.STRICT_TEXTURE_CACHE){const n="string"==typeof e;let i=null;if(n)i=e;else if(e instanceof lr){if(!e.cacheId){const r=t?.pixiIdPrefix||"pixiid";e.cacheId=`${r}-${Pt()}`,lr.addToCache(e,e.cacheId)}i=e.cacheId}else{if(!e._pixiId){const r=t?.pixiIdPrefix||"pixiid";e._pixiId=`${r}_${Pt()}`}i=e._pixiId}let o=Dt[i];if(n&&r&&!o)throw new Error(`The cacheId "${i}" does not exist in TextureCache.`);return o||e instanceof lr?!o&&e instanceof lr&&(o=new En(e),En.addToCache(o,i)):(t.resolution||(t.resolution=Wt(e)),o=new En(new lr(e,t)),o.baseTexture.cacheId=i,lr.addToCache(o.baseTexture,i),En.addToCache(o,i)),o}static fromURL(e,t){const r=Object.assign({autoLoad:!1},t?.resourceOptions),n=En.from(e,Object.assign({resourceOptions:r},t),!1),i=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):i.load().then((()=>Promise.resolve(n)))}static fromBuffer(e,t,r,n){return new En(lr.fromBuffer(e,t,r,n))}static fromLoader(e,t,r,n){const i=new lr(e,Object.assign({scaleMode:lr.defaultOptions.scaleMode,resolution:Wt(t)},n)),{resource:o}=i;o instanceof An&&(o.url=t);const a=new En(i);return r||(r=t),lr.addToCache(a.baseTexture,r),En.addToCache(a,r),r!==t&&(lr.addToCache(a.baseTexture,t),En.addToCache(a,t)),a.baseTexture.valid?Promise.resolve(a):new Promise((e=>{a.baseTexture.once("loaded",(()=>e(a)))}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Dt[t]&&Dt[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),Dt[t]=e)}static removeFromCache(e){if("string"==typeof e){const t=Dt[e];if(t){const r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Dt[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)Dt[e.textureCacheIds[t]]===e&&delete Dt[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:r,width:n,height:i}=e,o=t+n>this.baseTexture.width,a=r+i>this.baseTexture.height;if(o||a){const e=o&&a?"and":"or",s=`X: ${t} + ${n} = ${t+n} > ${this.baseTexture.width}`,u=`Y: ${r} + ${i} = ${r+i} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${s} ${e} ${u}`)}this.valid=n&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return En._EMPTY||(En._EMPTY=new En(new lr),Cn(En._EMPTY),Cn(En._EMPTY.baseTexture)),En._EMPTY}static get WHITE(){if(!En._WHITE){const e=te.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),En._WHITE=new En(lr.from(e)),Cn(En._WHITE),Cn(En._WHITE.baseTexture)}return En._WHITE}}class On extends En{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,r=!0){const n=this.baseTexture.resolution,i=Math.round(e*n)/n,o=Math.round(t*n)/n;this.valid=i>0&&o>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(i,o),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new On(new _n(e))}}class kn{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,r=J.NONE){const n=new _n(Object.assign({width:e,height:t,resolution:1,multisample:r},this.textureOptions));return new On(n)}getOptimalTexture(e,t,r=1,n=J.NONE){let i;e=Math.max(Math.ceil(e*r-1e-6),1),t=Math.max(Math.ceil(t*r-1e-6),1),this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight?i=n>1?-n:-1:(i=((65535&(e=St(e)))<<16|65535&(t=St(t)))>>>0,n>1&&(i+=4294967296*n)),this.texturePool[i]||(this.texturePool[i]=[]);let o=this.texturePool[i].pop();return o||(o=this.createTexture(e,t,n)),o.filterPoolKey=i,o.setResolution(r),o}getFilterTexture(e,t,r){const n=this.getOptimalTexture(e.width,e.height,t||e.resolution,r||J.NONE);return n.filterFrame=e.filterFrame,n}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=!1!==e)for(const e in this.texturePool){const t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0)}this.texturePool={}}setScreenSize(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){this.enableFullScreen=e.width>0&&e.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}kn.SCREEN_KEY=-1;class Pn extends wr{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class $n extends wr{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new dr(this.vertices),this.uvBuffer=new dr(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+t.width/e.width,this.uvs[3]=n,this.uvs[4]=r+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=r,this.uvs[7]=n+t.height/e.height,r=t.x,n=t.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+t.width,this.vertices[3]=n,this.vertices[4]=r+t.width,this.vertices[5]=n+t.height,this.vertices[6]=r,this.vertices[7]=n+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Rn{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=J.NONE,this.sourceFrame=new Tr,this.destinationFrame=new Tr,this.bindingSourceFrame=new Tr,this.bindingDestinationFrame=new Tr,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Bn=[new Ar,new Ar,new Ar,new Ar],Dn=new Pr;class Mn{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new kn,this.statePool=[],this.quad=new Pn,this.quadUv=new $n,this.tempRect=new Tr,this.activeState={},this.globalUniforms=new un({outputFrame:new Tr,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const r=this.renderer,n=this.defaultFilterStack,i=this.statePool.pop()||new Rn,o=r.renderTexture;let a,s;if(o.current){const e=o.current;a=e.resolution,s=e.multisample}else a=r.resolution,s=r.multisample;let u=t[0].resolution||a,l=t[0].multisample??s,h=t[0].padding,c=t[0].autoFit,d=t[0].legacy??!0;for(let e=1;e<t.length;e++){const r=t[e];u=Math.min(u,r.resolution||a),l=Math.min(l,r.multisample??s),h=this.useMaxPadding?Math.max(h,r.padding):h+r.padding,c=c&&r.autoFit,d=d||(r.legacy??!0)}1===n.length&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(i),i.resolution=u,i.multisample=l,i.legacy=d,i.target=e,i.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),i.sourceFrame.pad(h);const f=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(Dn.copyFrom(r.projection.transform).invert(),f),c?(i.sourceFrame.fit(f),(i.sourceFrame.width<=0||i.sourceFrame.height<=0)&&(i.sourceFrame.width=0,i.sourceFrame.height=0)):i.sourceFrame.intersects(f)||(i.sourceFrame.width=0,i.sourceFrame.height=0),this.roundFrame(i.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,u,l),i.filters=t,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=i.sourceFrame.width,p.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(o.sourceFrame),i.bindingDestinationFrame.copyFrom(o.destinationFrame),i.transform=r.projection.transform,r.projection.transform=null,o.bind(i.renderTexture,i.sourceFrame,p),r.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;const n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;const i=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=Math.round(i[0]*t.resolution),o[1]=Math.round(i[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*i[2]-.5*o[2],a[3]=t.sourceFrame.height*i[3]-.5*o[3],t.legacy){const e=n.filterArea;e[0]=t.destinationFrame.width,e[1]=t.destinationFrame.height,e[2]=t.sourceFrame.x,e[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const s=e[e.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,s.renderTexture,Y.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let e=t.renderTexture,n=this.getOptimalFilterTexture(e.width,e.height,t.resolution);n.filterFrame=e.filterFrame;let i=0;for(i=0;i<r.length-1;++i){1===i&&t.multisample>1&&(n=this.getOptimalFilterTexture(e.width,e.height,t.resolution),n.filterFrame=e.filterFrame),r[i].apply(this,e,n,Y.CLEAR,t);const o=e;e=n,n=o}r[i].apply(this,e,s.renderTexture,Y.BLEND,t),i>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(e),this.returnFilterTexture(n)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=Y.CLEAR){const{renderTexture:r,state:n}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e?.filterFrame){const t=this.tempRect;t.x=0,t.y=0,t.width=e.filterFrame.width,t.height=e.filterFrame.height,r.bind(e,e.filterFrame,t)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const i=1&n.stateId||this.forceClear;(t===Y.CLEAR||t===Y.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,r,n){const i=this.renderer;i.state.set(e.state),this.bindAndClear(r,n),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(F.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(F.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:r,destinationFrame:n}=this.activeState,{orig:i}=t._texture,o=e.set(n.width,0,0,n.height,r.x,r.y),a=t.worldTransform.copyTo(Pr.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/i.width,1/i.height),o.translate(t.anchor.x,t.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,r=1,n=J.NONE){return this.texturePool.getOptimalTexture(e,t,r,n)}getFilterTexture(e,t,r){if("number"==typeof e){const r=e;e=t,t=r}e=e||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,r||J.NONE);return n.filterFrame=e.filterFrame,n}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const r=Bn[0],n=Bn[1],i=Bn[2],o=Bn[3];r.set(t.left,t.top),n.set(t.left,t.bottom),i.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(r,r),e.apply(n,n),e.apply(i,i),e.apply(o,o);const a=Math.min(r.x,n.x,i.x,o.x),s=Math.min(r.y,n.y,i.y,o.y),u=Math.max(r.x,n.x,i.x,o.x),l=Math.max(r.y,n.y,i.y,o.y);t.x=a,t.y=s,t.width=u-a,t.height=l-s}roundFrame(e,t,r,n,i){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(i){const{a:e,b:t,c:r,d:n}=i;if((Math.abs(t)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4))return}(i=i?Dn.copyFrom(i):Dn.identity()).translate(-r.x,-r.y).scale(n.width/r.width,n.height/r.height).translate(n.x,n.y),this.transformAABB(i,e),e.ceil(t),this.transformAABB(i.invert(),e)}}}Mn.extension={type:Yt.RendererSystem,name:"filter"},Zt.add(Mn);class Ln{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=J.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Fn=new Tr;class Nn{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new xn(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Tr,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;te.PREFER_ENV===B.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=e=>t.drawBuffersWEBGL(e):(this.hasMRT=!1,e.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,r=0){const{gl:n}=this;if(e){const i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==r&&(e.dirtyId++,e.dirtyFormat++,i.mipLevel=r),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat!==e.dirtyFormat?(i.dirtyFormat=e.dirtyFormat,i.dirtySize=e.dirtySize,this.updateFramebuffer(e,r)):i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let t=0;t<e.colorTextures.length;t++){const r=e.colorTextures[t];this.renderer.texture.unbind(r.parentTextureArray||r)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const e=t.width>>r,n=t.height>>r,i=e/t.width;this.setViewport(t.x*i,t.y*i,e,n)}else{const t=e.width>>r,n=e.height>>r;this.setViewport(0,0,t,n)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,r,n){const i=this.viewport;e=Math.round(e),t=Math.round(t),r=Math.round(r),n=Math.round(n),(i.width!==r||i.height!==n||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=r,i.height=n,this.gl.viewport(e,t,r,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,r,n,i=M.COLOR|M.DEPTH){const{gl:o}=this;o.clearColor(e,t,r,n),o.clear(i)}initFramebuffer(e){const{gl:t}=this,r=new Ln(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r}resizeFramebuffer(e){const{gl:t}=this,r=e.glFramebuffers[this.CONTEXT_UID];if(r.stencil){let n;t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),n=1===this.renderer.context.webGLVersion?t.DEPTH_STENCIL:e.depth&&e.stencil?t.DEPTH24_STENCIL8:e.depth?t.DEPTH_COMPONENT24:t.STENCIL_INDEX8,r.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,n,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,n,e.width,e.height)}const n=e.colorTextures;let i=n.length;t.drawBuffers||(i=Math.min(i,1));for(let o=0;o<i;o++){const i=n[o],a=i.parentTextureArray||i;this.renderer.texture.bind(a,0),0===o&&r.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures;let o=i.length;r.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(e)?n.msaaBuffer=n.msaaBuffer||r.createRenderbuffer():n.msaaBuffer&&(r.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const a=[];for(let s=0;s<o;s++){const o=i[s],u=o.parentTextureArray||o;this.renderer.texture.bind(u,0),0===s&&n.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,n.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+s,o.target,u._glTextures[this.CONTEXT_UID].texture,t),a.push(r.COLOR_ATTACHMENT0+s))}if(a.length>1&&r.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const n=e.depthTexture;this.renderer.texture.bind(n,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,n._glTextures[this.CONTEXT_UID].texture,t)}if(!e.stencil&&!e.depth||e.depthTexture&&this.writeDepthTexture)n.stencil&&(r.deleteRenderbuffer(n.stencil),n.stencil=null);else{let t,i;n.stencil=n.stencil||r.createRenderbuffer(),1===this.renderer.context.webGLVersion?(t=r.DEPTH_STENCIL_ATTACHMENT,i=r.DEPTH_STENCIL):e.depth&&e.stencil?(t=r.DEPTH_STENCIL_ATTACHMENT,i=r.DEPTH24_STENCIL8):e.depth?(t=r.DEPTH_ATTACHMENT,i=r.DEPTH_COMPONENT24):(t=r.STENCIL_ATTACHMENT,i=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,n.stencil),n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,i,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,i,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,n.stencil)}}canMultisampleFramebuffer(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let r=J.NONE;if(e<=1||null===t)return r;for(let n=0;n<t.length;n++)if(t[n]<=e){r=t[n];break}return 1===r&&(r=J.NONE),r}blit(e,t,r){const{current:n,renderer:i,gl:o,CONTEXT_UID:a}=this;if(2!==i.context.webGLVersion||!n)return;const s=n.glFramebuffers[a];if(!s)return;if(!e){if(!s.msaaBuffer)return;const t=n.colorTextures[0];if(!t)return;s.blitFramebuffer||(s.blitFramebuffer=new xn(n.width,n.height),s.blitFramebuffer.addColorTexture(0,t)),(e=s.blitFramebuffer).colorTextures[0]!==t&&(e.colorTextures[0]=t,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++)}t||((t=Fn).width=n.width,t.height=n.height),r||(r=t);const u=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,s.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){const r=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!r)return;delete e.glFramebuffers[this.CONTEXT_UID];const i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&n.deleteRenderbuffer(r.msaaBuffer),r.stencil&&n.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,t)}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;const r=e.width,n=e.height,i=this.gl,o=t.stencil=i.createRenderbuffer();let a,s;i.bindRenderbuffer(i.RENDERBUFFER,o),1===this.renderer.context.webGLVersion?(a=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH_STENCIL):e.depth?(a=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH24_STENCIL8):(a=i.STENCIL_ATTACHMENT,s=i.STENCIL_INDEX8),t.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,t.multisample,s,r,n):i.renderbufferStorage(i.RENDERBUFFER,s,r,n),i.framebufferRenderbuffer(i.FRAMEBUFFER,a,i.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Tr}destroy(){this.renderer=null}}Nn.extension={type:Yt.RendererSystem,name:"framebuffer"},Zt.add(Nn);const Un={5126:4,5123:2,5121:1};class jn{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){let t=this.renderer.context.extensions.vertexArrayObject;te.PREFER_ENV===B.WEBGL_LEGACY&&(t=null),t?(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(2!==t.webGLVersion){const t=e.getExtension("ANGLE_instanced_arrays");t?(e.vertexAttribDivisor=(e,r)=>t.vertexAttribDivisorANGLE(e,r),e.drawElementsInstanced=(e,r,n,i,o)=>t.drawElementsInstancedANGLE(e,r,n,i,o),e.drawArraysInstanced=(e,r,n,i)=>t.drawArraysInstancedANGLE(e,r,n,i)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:r}=this;let n=e.glVertexArrayObjects[this.CONTEXT_UID],i=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},i=!0);const o=n[t.program.id]||this.initGeometryVao(e,t,i);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let r=0;r<e.buffers.length;r++){const n=e.buffers[r];t.update(n)}}checkCompatibility(e,t){const r=e.attributes,n=t.attributeData;for(const e in n)if(!r[e])throw new Error(`shader and geometry incompatible, geometry missing the "${e}" attribute`)}getSignature(e,t){const r=e.attributes,n=t.attributeData,i=["g",e.id];for(const e in r)n[e]&&i.push(e,n[e].location);return i.join("-")}initGeometryVao(e,t,r=!0){const n=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[i]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);const s=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let l=u[s];if(l)return u[a.id]=l,l;const h=e.buffers,c=e.attributes,d={},f={};for(const e in h)d[e]=0,f[e]=0;for(const e in c)!c[e].size&&a.attributeData[e]?c[e].size=a.attributeData[e].size:c[e].size||console.warn(`PIXI Geometry attribute '${e}' size cannot be determined (likely the bound shader does not have the attribute)`),d[c[e].buffer]+=c[e].size*Un[c[e].type];for(const e in c){const t=c[e],r=t.size;void 0===t.stride&&(d[t.buffer]===r*Un[t.type]?t.stride=0:t.stride=d[t.buffer]),void 0===t.start&&(t.start=f[t.buffer],f[t.buffer]+=r*Un[t.type])}l=n.createVertexArray(),n.bindVertexArray(l);for(let e=0;e<h.length;e++){const t=h[e];o.bind(t),r&&t._glBuffers[i].refCount++}return this.activateVao(e,a),u[a.id]=l,u[s]=l,n.bindVertexArray(null),o.unbind(Q.ARRAY_BUFFER),l}disposeGeometry(e,t){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const r=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,i=e.buffers,o=this.renderer?.buffer;if(e.disposeRunner.remove(this),r){if(o)for(let e=0;e<i.length;e++){const r=i[e]._glBuffers[this.CONTEXT_UID];r&&(r.refCount--,0===r.refCount&&!t&&o.dispose(i[e],t))}if(!t)for(const e in r)if("g"===e[0]){const t=r[e];this._activeVao===t&&this.unbind(),n.deleteVertexArray(t)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e)}activateVao(e,t){const r=this.gl,n=this.CONTEXT_UID,i=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);let s=null;for(const e in a){const u=a[e],l=o[u.buffer],h=l._glBuffers[n];if(t.attributeData[e]){s!==h&&(i.bind(l),s=h);const n=t.attributeData[e].location;if(r.enableVertexAttribArray(n),r.vertexAttribPointer(n,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(n,u.divisor)}}}}draw(e,t,r,n){const{gl:i}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,s=2===a?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(e,t||o.indexBuffer.data.length,s,(r||0)*a,n||1):i.drawElements(e,t||o.indexBuffer.data.length,s,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?i.drawArraysInstanced(e,r,t||o.getSize(),n||1):i.drawArrays(e,r,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}jn.extension={type:Yt.RendererSystem,name:"geometry"},Zt.add(jn);const Gn=new Pr;class zn{constructor(e,t){this._texture=e,this.mapCoord=new Pr,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){void 0===t&&(t=e);const r=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],o=e[n+1];t[n]=i*r.a+o*r.c+r.tx,t[n+1]=i*r.b+o*r.d+r.ty}return t}update(e){const t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const n=t.orig,i=t.trim;i&&(Gn.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Gn));const o=t.baseTexture,a=this.uClampFrame,s=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+s+u)/o.width,a[1]=(t._frame.y+s+u)/o.height,a[2]=(t._frame.x+t._frame.width-s+u)/o.width,a[3]=(t._frame.y+t._frame.height-s+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&0===t.rotate,!0}}class Vn extends gn{constructor(e,t,r){let n=null;"string"!=typeof e&&void 0===t&&void 0===r&&(n=e,e=void 0,t=void 0,r=void 0),super(e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",t||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",r),this.maskSprite=n,this.maskMatrix=new Pr}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,r,n){const i=this._maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new zn(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,r,n))}}class Hn{constructor(e=null){this.type=Z.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=gn.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Z.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Wn{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let r=t;if(!r.isMaskData){const e=this.maskDataPool.pop()||new Hn;e.pooled=!0,e.maskObject=t,r=e}const n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(n),r._colorMask=n?n._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==Z.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case Z.SCISSOR:this.renderer.scissor.push(r);break;case Z.STENCIL:this.renderer.stencil.push(r);break;case Z.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case Z.COLOR:this.pushColorMask(r)}r.type===Z.SPRITE&&this.maskStack.push(r)}pop(e){const t=this.maskStack.pop();if(t&&t._target===e){if(t.enabled)switch(t.type){case Z.SCISSOR:this.renderer.scissor.pop(t);break;case Z.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Z.SPRITE:this.popSpriteMask(t);break;case Z.COLOR:this.popColorMask(t)}if(t.reset(),t.pooled&&this.maskDataPool.push(t),0!==this.maskStack.length){const e=this.maskStack[this.maskStack.length-1];e.type===Z.SPRITE&&e._filters&&(e._filters[0].maskSprite=e.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=Z.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Z.SCISSOR:e.type=Z.STENCIL:e.type=Z.COLOR}pushSpriteMask(e){const{maskObject:t}=e,r=e._target;let n=e._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Vn])),n[0].resolution=e.resolution,n[0].multisample=e.multisample,n[0].maskSprite=t;const i=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,n),r.filterArea=i,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,r=e._colorMask=t&e.colorMask;r!==t&&this.renderer.gl.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))}popColorMask(e){const t=e._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==t&&this.renderer.gl.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))}destroy(){this.renderer=null}}Wn.extension={type:Yt.RendererSystem,name:"mask"},Zt.add(Wn);class Yn{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,r=this.getStackLength();this.maskStack=e;const n=this.getStackLength();n!==r&&(0===n?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Kn=new Pr,Xn=[],Zn=class e extends Yn{constructor(e){super(e),this.glConst=te.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:r}=e,{renderer:n}=this,i=n.renderTexture,o=r.getBounds(!0,Xn.pop()??new Tr);this.roundFrameToPixels(o,i.current?i.current.resolution:n.resolution,i.sourceFrame,i.destinationFrame,n.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:r,c:n,d:i}=e;return(Math.abs(r)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}testScissor(t){const{maskObject:r}=t;if(!r.isFastRect||!r.isFastRect()||e.isMatrixRotated(r.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const n=t._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(t,r,n,i,o){e.isMatrixRotated(o)||((o=o?Kn.copyFrom(o):Kn.identity()).translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(o,t),t.fit(i),t.x=Math.round(t.x*r),t.y=Math.round(t.y*r),t.width=Math.round(t.width*r),t.height=Math.round(t.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&Xn.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};Zn.extension={type:Yt.RendererSystem,name:"scissor"};let qn=Zn;Zt.add(qn);class Jn extends Yn{constructor(e){super(e),this.glConst=te.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:r}=this.renderer,n=e._stencilCounter;0===n&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++;const i=e._colorMask;0!==i&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,n,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==i&&(e._colorMask=i,r.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))),this._useCurrent()}pop(e){const t=this.renderer.gl;if(0===this.getStackLength())t.disable(t.STENCIL_TEST);else{const r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,n=r?r._colorMask:15;0!==n&&(r._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==n&&(r._colorMask=n,t.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}Jn.extension={type:Yt.RendererSystem,name:"stencil"},Zt.add(Jn);class Qn{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(Ae("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract)},prepare:{enumerable:!1,get:()=>(Ae("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare)},interaction:{enumerable:!1,get:()=>(Ae("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events)}})}init(){const e=this.rendererPlugins;for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}Qn.extension={type:[Yt.RendererSystem,Yt.CanvasRendererSystem],name:"_plugin"},Zt.add(Qn);class ei{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Pr,this.transform=null}update(e,t,r,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,n),this.transform&&this.projectionMatrix.append(this.transform);const i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}calculateProjection(e,t,r,n){const i=this.projectionMatrix,o=n?-1:1;i.identity(),i.a=1/t.width*2,i.d=o*(1/t.height*2),i.tx=-1-t.x*i.a,i.ty=-o-t.y*i.d}setTransform(e){}destroy(){this.renderer=null}}ei.extension={type:Yt.RendererSystem,name:"projection"},Zt.add(ei);const ti=new Gr,ri=new Tr;class ni{constructor(e){this.renderer=e,this._tempMatrix=new Pr}generateTexture(e,t){const{region:r,...n}=t||{},i=r?.copyTo(ri)||e.getLocalBounds(ri,!0),o=n.resolution||this.renderer.resolution;i.width=Math.max(i.width,1/o),i.height=Math.max(i.height,1/o),n.width=i.width,n.height=i.height,n.resolution=o,n.multisample??(n.multisample=this.renderer.multisample);const a=On.create(n);this._tempMatrix.tx=-i.x,this._tempMatrix.ty=-i.y;const s=e.transform;return e.transform=ti,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=s,a}destroy(){}}ni.extension={type:[Yt.RendererSystem,Yt.CanvasRendererSystem],name:"textureGenerator"},Zt.add(ni);const ii=new Tr,oi=new Tr;class ai{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Tr,this.destinationFrame=new Tr,this.viewportFrame=new Tr}contextChange(){const e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,r){const n=this.renderer;let i,o,a;this.current=e,e?(i=e.baseTexture,a=i.resolution,t||(ii.width=e.frame.width,ii.height=e.frame.height,t=ii),r||(oi.x=e.frame.x,oi.y=e.frame.y,oi.width=t.width,oi.height=t.height,r=oi),o=i.framebuffer):(a=n.resolution,t||(ii.width=n._view.screen.width,ii.height=n._view.screen.height,t=ii),r||((r=ii).width=t.width,r.height=t.height));const s=this.viewportFrame;s.x=r.x*a,s.y=r.y*a,s.width=r.width*a,s.height=r.height*a,e||(s.y=n.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(o,s),this.renderer.projection.update(r,t,a,!o),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)}clear(e,t){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=ht.shared.setValue(e||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);const i=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=i.width!==o.width||i.height!==o.height;if(a){let{x:e,y:t,width:r,height:n}=this.viewportFrame;e=Math.round(e),t=Math.round(t),r=Math.round(r),n=Math.round(n),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(e,t,r,n)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,t),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}ai.extension={type:Yt.RendererSystem,name:"renderTexture"},Zt.add(ai);class si{}class ui{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function li(e,t,r){const n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function hi(e){const t=new Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return t}function ci(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return hi(2*t);case"bvec3":return hi(3*t);case"bvec4":return hi(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function di(e,t){const r=e.getShaderSource(t).split("\n").map(((e,t)=>`${t}: ${e}`)),n=e.getShaderInfoLog(t),i=n.split("\n"),o={},a=i.map((e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((e=>!(!e||o[e])&&(o[e]=!0,!0))),s=[""];a.forEach((e=>{r[e-1]=`%c${r[e-1]}%c`,s.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const u=r.join("\n");s[0]=u,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...s),console.groupEnd()}function fi(e,t){const r=li(e,e.VERTEX_SHADER,t.vertexSrc),n=li(e,e.FRAGMENT_SHADER,t.fragmentSrc),i=e.createProgram();e.attachShader(i,r),e.attachShader(i,n);const o=t.extra?.transformFeedbackVaryings;if(o&&("function"!=typeof e.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(i,o.names,"separate"===o.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||function(e,t,r,n){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||di(e,r),e.getShaderParameter(n,e.COMPILE_STATUS)||di(e,n),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}(e,i,r,n),t.attributeData=function(e,t){const r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const n=t.getActiveAttrib(e,i);if(n.name.startsWith("gl_"))continue;const o=en(t,n.type),a={type:o,name:n.name,size:qr(o),location:t.getAttribLocation(e,n.name)};r[n.name]=a}return r}(i,e),t.uniformData=function(e,t){const r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const n=t.getActiveUniform(e,i),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),s=en(t,n.type);r[o]={name:o,index:i,type:s,size:n.size,isArray:a,value:ci(s,n.size)}}return r}(i,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const r=Object.keys(t.attributeData);r.sort(((e,t)=>e>t?1:-1));for(let n=0;n<r.length;n++)t.attributeData[r[n]].location=n,e.bindAttribLocation(i,n,r[n]);e.linkProgram(i)}e.deleteShader(r),e.deleteShader(n);const a={};for(const r in t.uniformData){const n=t.uniformData[r];a[r]={location:e.getUniformLocation(i,r),value:ci(n.type,n.size)}}return new ui(i,a)}function pi(e,t,r,n,i){r.buffer.update(i)}const yi={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},gi={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function mi(e){const t=e.map((e=>({data:e,offset:0,dataLen:0,dirty:0})));let r=0,n=0,i=0;for(let e=0;e<t.length;e++){const o=t[e];if(r=gi[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!=0&&n<16){const e=n%r%16;n+=e,i+=e}n+r>16?(i=16*Math.ceil(i/16),o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=16*Math.ceil(i/16),{uboElements:t,size:i}}function wi(e,t){const r=[];for(const n in e)t[n]&&r.push(t[n]);return r.sort(((e,t)=>e.index-t.index)),r}function bi(e,t){if(!e.autoManage)return{size:0,syncFunc:pi};const r=wi(e.uniforms,t),{uboElements:n,size:i}=mi(r),o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let t=0;t<n.length;t++){const r=n[t],i=e.uniforms[r.data.name],a=r.data.name;let s=!1;for(let e=0;e<zr.length;e++){const t=zr[e];if(t.codeUbo&&t.test(r.data,i)){o.push(`offset = ${r.offset/4};`,zr[e].codeUbo(r.data.name,i)),s=!0;break}}if(!s)if(r.data.size>1){const e=qr(r.data.type),t=Math.max(gi[r.data.type]/16,1),n=e/t,i=(4-n%4)%4;o.push(`\n                cv = ud.${a}.value;\n                v = uv.${a};\n                offset = ${r.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${r.data.size*t}; i++)\n                {\n                    for(var j = 0; j < ${n}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${i};\n                }\n\n                `)}else{const e=yi[r.data.type];o.push(`\n                cv = ud.${a}.value;\n                v = uv.${a};\n                offset = ${r.offset/4};\n                ${e};\n                `)}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))}}let vi;function xi(){if("boolean"==typeof vi)return vi;try{vi=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{vi=!1}return vi}let _i=0;const Ii={textureCount:0,uboCount:0};class Ai{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=_i++}systemCheck(){if(!xi())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const r=e.program,n=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(n.program)),t||(Ii.textureCount=0,Ii.uboCount=0,this.syncUniformGroup(e.uniformGroup,Ii)),n}setUniforms(e){const t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)}syncUniformGroup(e,t){const r=this.getGlProgram();(!e.static||e.dirtyId!==r.uniformDirtyGroups[e.id])&&(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))}syncUniforms(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=function(e,t){const r=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const n in e.uniforms){const i=t[n];if(!i){!0===e.uniforms[n]?.group&&(e.uniforms[n].ubo?r.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${n}, '${n}');\n                    `):r.push(`\n                        renderer.shader.syncUniformGroup(uv.${n}, syncData);\n                    `));continue}const o=e.uniforms[n];let a=!1;for(let e=0;e<zr.length;e++)if(zr[e].test(i,o)){r.push(zr[e].code(n,o)),a=!0;break}if(!a){const e=(1!==i.size||i.isArray?Hr:Vr)[i.type].replace("location",`ud["${n}"].location`);r.push(`\n            cu = ud["${n}"];\n            cv = cu.value;\n            v = uv["${n}"];\n            ${e};`)}}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const r=this.getGlProgram();if(!e.static||0!==e.dirtyId||!r.uniformGroups[e.id]){e.dirtyId=0;const n=r.uniformGroups[e.id]||this.createSyncBufferGroup(e,r,t);e.buffer.update(),n(r.uniformData,e.uniforms,this.renderer,Ii,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,r.uniformBufferBindings[t])}createSyncBufferGroup(e,t,r){const{gl:n}=this.renderer;this.renderer.buffer.bind(e.buffer);const i=this.gl.getUniformBlockIndex(t.program,r);t.uniformBufferBindings[r]=this.shader.uniformBindCount,n.uniformBlockBinding(t.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=bi(e,this.shader.program.uniformData)),e.autoManage){const t=new Float32Array(a.size/4);e.buffer.update(t)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,r){const n=e.uniforms,i=[`${r}-`];for(const e in n)i.push(e),t[e]&&i.push(t[e].type);return i.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,r=e.program,n=fi(t,r);return r.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Ai.extension={type:Yt.RendererSystem,name:"shader"},Zt.add(Ai);class Si{constructor(e){this.renderer=e}run(e){const{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.4.0 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}Si.defaultOptions={hello:!1},Si.extension={type:[Yt.RendererSystem,Yt.CanvasRendererSystem],name:"startup"},Zt.add(Si);const Ti=class e{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=L.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new tr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=function(e,t=[]){return t[L.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.ADD]=[e.ONE,e.ONE],t[L.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.NONE]=[0,0],t[L.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[L.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[L.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[L.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[L.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[L.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[L.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[L.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[L.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[L.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[L.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):!t&&-1!==r&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};Ti.extension={type:Yt.RendererSystem,name:"state"};let Ci=Ti;Zt.add(Ci);class Ei extends ve{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter((t=>e.systems[t])),r=[...t,...Object.keys(e.systems).filter((e=>!t.includes(e)))];for(const t of r)this.addSystem(e.systems[t],t)}addRunners(...e){e.forEach((e=>{this.runners[e]=new ir(e)}))}addSystem(e,t){const r=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=r,this._systemsHash[t]=r;for(const e in this.runners)this.runners[e].add(r);return this}emitWithCustomOptions(e,t){const r=Object.keys(this._systemsHash);e.items.forEach((n=>{const i=r.find((e=>this._systemsHash[e]===n));n[e.name](t[i])}))}destroy(){Object.values(this.runners).forEach((e=>{e.destroy()})),this._systemsHash={}}}const Oi=class e{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=e.defaultMaxIdle,this.checkCountMax=e.defaultCheckCountMax,this.mode=e.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==K.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let r=!1;for(let n=0;n<t.length;n++){const i=t[n];i.resource&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[n]=null,r=!0)}if(r){let e=0;for(let r=0;r<t.length;r++)null!==t[r]&&(t[e++]=t[r]);t.length=e}}unload(e){const t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let t=e.children.length-1;t>=0;t--)this.unload(e.children[t])}destroy(){this.renderer=null}};Oi.defaultMode=K.AUTO,Oi.defaultMaxIdle=3600,Oi.defaultCheckCountMax=600,Oi.extension={type:Yt.RendererSystem,name:"textureGC"};let ki=Oi;Zt.add(ki);class Pi{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=j.UNSIGNED_BYTE,this.internalFormat=N.RGBA,this.samplerType=0}}class $i{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new lr,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(e){let t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[j.UNSIGNED_BYTE]:{[N.RGBA]:e.RGBA8,[N.RGB]:e.RGB8,[N.RG]:e.RG8,[N.RED]:e.R8,[N.RGBA_INTEGER]:e.RGBA8UI,[N.RGB_INTEGER]:e.RGB8UI,[N.RG_INTEGER]:e.RG8UI,[N.RED_INTEGER]:e.R8UI,[N.ALPHA]:e.ALPHA,[N.LUMINANCE]:e.LUMINANCE,[N.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[j.BYTE]:{[N.RGBA]:e.RGBA8_SNORM,[N.RGB]:e.RGB8_SNORM,[N.RG]:e.RG8_SNORM,[N.RED]:e.R8_SNORM,[N.RGBA_INTEGER]:e.RGBA8I,[N.RGB_INTEGER]:e.RGB8I,[N.RG_INTEGER]:e.RG8I,[N.RED_INTEGER]:e.R8I},[j.UNSIGNED_SHORT]:{[N.RGBA_INTEGER]:e.RGBA16UI,[N.RGB_INTEGER]:e.RGB16UI,[N.RG_INTEGER]:e.RG16UI,[N.RED_INTEGER]:e.R16UI,[N.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[j.SHORT]:{[N.RGBA_INTEGER]:e.RGBA16I,[N.RGB_INTEGER]:e.RGB16I,[N.RG_INTEGER]:e.RG16I,[N.RED_INTEGER]:e.R16I},[j.UNSIGNED_INT]:{[N.RGBA_INTEGER]:e.RGBA32UI,[N.RGB_INTEGER]:e.RGB32UI,[N.RG_INTEGER]:e.RG32UI,[N.RED_INTEGER]:e.R32UI,[N.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[j.INT]:{[N.RGBA_INTEGER]:e.RGBA32I,[N.RGB_INTEGER]:e.RGB32I,[N.RG_INTEGER]:e.RG32I,[N.RED_INTEGER]:e.R32I},[j.FLOAT]:{[N.RGBA]:e.RGBA32F,[N.RGB]:e.RGB32F,[N.RG]:e.RG32F,[N.RED]:e.R32F,[N.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[j.HALF_FLOAT]:{[N.RGBA]:e.RGBA16F,[N.RGB]:e.RGB16F,[N.RG]:e.RG16F,[N.RED]:e.R16F},[j.UNSIGNED_SHORT_5_6_5]:{[N.RGB]:e.RGB565},[j.UNSIGNED_SHORT_4_4_4_4]:{[N.RGBA]:e.RGBA4},[j.UNSIGNED_SHORT_5_5_5_1]:{[N.RGBA]:e.RGB5_A1},[j.UNSIGNED_INT_2_10_10_10_REV]:{[N.RGBA]:e.RGB10_A2,[N.RGBA_INTEGER]:e.RGB10_A2UI},[j.UNSIGNED_INT_10F_11F_11F_REV]:{[N.RGB]:e.R11F_G11F_B10F},[j.UNSIGNED_INT_5_9_9_9_REV]:{[N.RGB]:e.RGB9_E5},[j.UNSIGNED_INT_24_8]:{[N.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[j.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[N.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:{[j.UNSIGNED_BYTE]:{[N.RGBA]:e.RGBA,[N.RGB]:e.RGB,[N.ALPHA]:e.ALPHA,[N.LUMINANCE]:e.LUMINANCE,[N.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[j.UNSIGNED_SHORT_5_6_5]:{[N.RGB]:e.RGB},[j.UNSIGNED_SHORT_4_4_4_4]:{[N.RGBA]:e.RGBA},[j.UNSIGNED_SHORT_5_5_5_1]:{[N.RGBA]:e.RGBA}},t}(e),this.samplerTypes=function(e){let t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[e.RGB]:G.FLOAT,[e.RGBA]:G.FLOAT,[e.ALPHA]:G.FLOAT,[e.LUMINANCE]:G.FLOAT,[e.LUMINANCE_ALPHA]:G.FLOAT,[e.R8]:G.FLOAT,[e.R8_SNORM]:G.FLOAT,[e.RG8]:G.FLOAT,[e.RG8_SNORM]:G.FLOAT,[e.RGB8]:G.FLOAT,[e.RGB8_SNORM]:G.FLOAT,[e.RGB565]:G.FLOAT,[e.RGBA4]:G.FLOAT,[e.RGB5_A1]:G.FLOAT,[e.RGBA8]:G.FLOAT,[e.RGBA8_SNORM]:G.FLOAT,[e.RGB10_A2]:G.FLOAT,[e.RGB10_A2UI]:G.FLOAT,[e.SRGB8]:G.FLOAT,[e.SRGB8_ALPHA8]:G.FLOAT,[e.R16F]:G.FLOAT,[e.RG16F]:G.FLOAT,[e.RGB16F]:G.FLOAT,[e.RGBA16F]:G.FLOAT,[e.R32F]:G.FLOAT,[e.RG32F]:G.FLOAT,[e.RGB32F]:G.FLOAT,[e.RGBA32F]:G.FLOAT,[e.R11F_G11F_B10F]:G.FLOAT,[e.RGB9_E5]:G.FLOAT,[e.R8I]:G.INT,[e.R8UI]:G.UINT,[e.R16I]:G.INT,[e.R16UI]:G.UINT,[e.R32I]:G.INT,[e.R32UI]:G.UINT,[e.RG8I]:G.INT,[e.RG8UI]:G.UINT,[e.RG16I]:G.INT,[e.RG16UI]:G.UINT,[e.RG32I]:G.INT,[e.RG32UI]:G.UINT,[e.RGB8I]:G.INT,[e.RGB8UI]:G.UINT,[e.RGB16I]:G.INT,[e.RGB16UI]:G.UINT,[e.RGB32I]:G.INT,[e.RGB32UI]:G.UINT,[e.RGBA8I]:G.INT,[e.RGBA8UI]:G.UINT,[e.RGBA16I]:G.INT,[e.RGBA16UI]:G.UINT,[e.RGBA32I]:G.INT,[e.RGBA32UI]:G.UINT,[e.DEPTH_COMPONENT16]:G.FLOAT,[e.DEPTH_COMPONENT24]:G.FLOAT,[e.DEPTH_COMPONENT32F]:G.FLOAT,[e.DEPTH_STENCIL]:G.FLOAT,[e.DEPTH24_STENCIL8]:G.FLOAT,[e.DEPTH32F_STENCIL8]:G.FLOAT}:{[e.RGB]:G.FLOAT,[e.RGBA]:G.FLOAT,[e.ALPHA]:G.FLOAT,[e.LUMINANCE]:G.FLOAT,[e.LUMINANCE_ALPHA]:G.FLOAT,[e.DEPTH_STENCIL]:G.FLOAT},t}(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let e=0;e<t;e++)this.boundTextures[e]=null;this.emptyTextures={};const r=new Pi(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Pi(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let t=0;t<6;t++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let e=0;e<this.boundTextures.length;e++)this.bind(null,e)}bind(e,t=0){const{gl:r}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)):n.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let e=0;e<r.length;e++)r[e]===this.unknownTexture&&this.bind(null,e)}for(let n=0;n<r.length;n++)r[n]===e&&(this.currentLocation!==n&&(t.activeTexture(t.TEXTURE0+n),this.currentLocation=n),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[n]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:r,CONTEXT_UID:n}=this;if(r)for(let r=e-1;r>=0;--r){const e=t[r];e&&e._glTextures[n].samplerType!==G.FLOAT&&this.renderer.texture.unbind(e)}}initTexture(e){const t=new Pi(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){t.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??G.FLOAT,2===this.webGLVersion&&e.type===j.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const r=this.renderer;if(this.initTextureType(e,t),e.resource?.upload(r,e,t))t.samplerType!==G.FLOAT&&(this.hasIntegerTextures=!0);else{const n=e.realWidth,i=e.realHeight,o=r.gl;(t.width!==n||t.height!==i||t.dirtyId<0)&&(t.width=n,t.height=i,o.texImage2D(e.target,0,t.internalFormat,n,i,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:r}=this;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const t=this.managedTextures.indexOf(e);-1!==t&&Et(this.managedTextures,t,1)}}updateTextureStyle(e){const t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==H.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=V.CLAMP,e.resource?.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const r=this.gl;if(t.mipmap&&e.mipmap!==H.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===z.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const t=this.renderer.context.extensions.anisotropicFiltering;if(t&&e.anisotropicLevel>0&&e.scaleMode===z.LINEAR){const n=Math.min(e.anisotropicLevel,r.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===z.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===z.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}$i.extension={type:Yt.RendererSystem,name:"texture"},Zt.add($i);class Ri{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:r}=this,n=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:r,renderer:n}=this;t&&n.shader.bind(t),r.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:r,CONTEXT_UID:n}=this,i=t.createTransformFeedback();e._glTransformFeedbacks[n]=i,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,i);for(let i=0;i<e.buffers.length;i++){const o=e.buffers[i];o&&(r.buffer.update(o),o._glBuffers[n].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,o._glBuffers[n].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),i}disposeTransformFeedback(e,t){const r=e._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this);const i=this.renderer.buffer;if(i)for(let r=0;r<e.buffers.length;r++){const n=e.buffers[r];if(!n)continue;const o=n._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,0===o.refCount&&!t&&i.dispose(n,t))}r&&(t||n.deleteTransformFeedback(r),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Ri.extension={type:Yt.RendererSystem,name:"transformFeedback"},Zt.add(Ri);class Bi{constructor(e){this.renderer=e}init(e){this.screen=new Tr(0,0,e.width,e.height),this.element=e.view||te.ADAPTER.createCanvas(),this.resolution=e.resolution||te.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const r=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=r,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",r,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}Bi.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Bi.extension={type:[Yt.RendererSystem,Yt.CanvasRendererSystem],name:"_view"},Zt.add(Bi),te.PREFER_ENV=B.WEBGL2,te.STRICT_TEXTURE_CACHE=!1,te.RENDER_OPTIONS={...vn.defaultOptions,...mn.defaultOptions,...Bi.defaultOptions,...Si.defaultOptions},Object.defineProperties(te,{WRAP_MODE:{get:()=>lr.defaultOptions.wrapMode,set(e){Ae("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),lr.defaultOptions.wrapMode=e}},SCALE_MODE:{get:()=>lr.defaultOptions.scaleMode,set(e){Ae("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),lr.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get:()=>lr.defaultOptions.mipmap,set(e){Ae("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),lr.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get:()=>lr.defaultOptions.anisotropicLevel,set(e){Ae("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),lr.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get:()=>(Ae("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),gn.defaultResolution),set(e){gn.defaultResolution=e}},FILTER_MULTISAMPLE:{get:()=>(Ae("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),gn.defaultMultisample),set(e){gn.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get:()=>pn.defaultMaxTextures,set(e){Ae("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),pn.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get:()=>pn.defaultBatchSize,set(e){Ae("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),pn.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get:()=>pn.canUploadSameBuffer,set(e){Ae("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),pn.canUploadSameBuffer=e}},GC_MODE:{get:()=>ki.defaultMode,set(e){Ae("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ki.defaultMode=e}},GC_MAX_IDLE:{get:()=>ki.defaultMaxIdle,set(e){Ae("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ki.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get:()=>ki.defaultCheckCountMax,set(e){Ae("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ki.defaultCheckCountMax=e}},PRECISION_VERTEX:{get:()=>an.defaultVertexPrecision,set(e){Ae("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),an.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get:()=>an.defaultFragmentPrecision,set(e){Ae("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),an.defaultFragmentPrecision=e}}});var Di=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(Di||{});class Mi{constructor(e,t=null,r=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=r,this.once=n}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const Li=class e{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Mi(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=Di.NORMAL){return this._addListener(new Mi(e,t,r))}addOnce(e,t,r=Di.NORMAL){return this._addListener(new Mi(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let r;if(t>this.lastTime){if(r=this.elapsedMS=t-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*e.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const r=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,r)/1e3,e.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(0===e)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!e._shared){const t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared}static get system(){if(!e._system){const t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system}};Li.targetFPMS=.06;let Fi=Li;Object.defineProperties(te,{TARGET_FPMS:{get:()=>Fi.targetFPMS,set(e){Ae("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Fi.targetFPMS=e}}});class Ni{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Di.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Fi.shared:new Fi,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}Ni.extension=Yt.Application,Zt.add(Ni);const Ui=[];function ji(e){for(const t of Ui)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}Zt.handleByList(Yt.Renderer,Ui);const Gi="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",zi="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class Vi{constructor(e){this.renderer=e}contextChange(e){let t;if(1===this.renderer.context.webGLVersion){const r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{const r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}t>=J.HIGH?this.multisample=J.HIGH:t>=J.MEDIUM?this.multisample=J.MEDIUM:t>=J.LOW?this.multisample=J.LOW:this.multisample=J.NONE}destroy(){}}Vi.extension={type:Yt.RendererSystem,name:"_multisample"},Zt.add(Vi);class Hi{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Wi{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:r}=this,n=e._glBuffers[r]||this.createGLBuffer(e);t.bindBuffer(e.type,n.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:r,CONTEXT_UID:n}=this;if(this.boundBufferBases[t]!==e){const i=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,i.buffer)}}bindBufferRange(e,t,r){const{gl:n,CONTEXT_UID:i}=this;r=r||0;const o=e._glBuffers[i]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,o.buffer,256*r,256)}update(e){const{gl:t,CONTEXT_UID:r}=this,n=e._glBuffers[r]||this.createGLBuffer(e);if(e._updateID!==n.updateID)if(n.updateID=e._updateID,t.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const r=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,r)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const r=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),r&&(t||n.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let r=0;r<t.length;r++)this.dispose(this.managedBuffers[t[r]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:r}=this;return e._glBuffers[t]=new Hi(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}Wi.extension={type:Yt.RendererSystem,name:"buffer"},Zt.add(Wi);class Yi{constructor(e){this.renderer=e}render(e,t){const r=this.renderer;let n,i,o,a;if(t&&(n=t.renderTexture,i=t.clear,o=t.transform,a=t.skipUpdateTransform),this.renderingToScreen=!n,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=o,!r.context.isLost){if(n||(this.lastObjectRendered=e),!a){const t=e.enableTempParent();e.updateTransform(),e.disableTempParent(t)}r.renderTexture.bind(n),r.batch.currentRenderer.start(),(i??r.background.clearBeforeRender)&&r.renderTexture.clear(),e.render(r),r.batch.currentRenderer.flush(),n&&(t.blit&&r.framebuffer.blit(),n.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Yi.extension={type:Yt.RendererSystem,name:"objectRenderer"},Zt.add(Yi);const Ki=class e extends Ei{constructor(t){super(),this.type=D.WEBGL,t=Object.assign({},te.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new un({projectionMatrix:new Pr},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:e.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in t&&(Ae("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,t.backgroundAlpha=!1===t.useContextAlpha?1:t.backgroundAlpha),this._plugin.rendererPlugins=e.__plugins,this.options=t,this.startup.run(this.options)}static test(e){return!e?.forceCanvas&&Be()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Ae("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Ae("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Ae("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Ae("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Ae("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Ae("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Ae("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Ae("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};Ki.extension={type:Yt.Renderer,priority:1},Ki.__plugins={},Ki.__systems={};let Xi=Ki;Zt.handleByMap(Yt.RendererPlugin,Xi.__plugins),Zt.handleByMap(Yt.RendererSystem,Xi.__systems),Zt.add(Xi);class Zi extends or{constructor(e,t){const{width:r,height:n}=t||{};super(r,n),this.items=[],this.itemDirtyIds=[];for(let t=0;t<e;t++){const e=new lr;this.items.push(e),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof or?this.addResourceAt(e[r],r):this.addResourceAt(nr(e[r],t),r))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map((e=>e.resource)).filter((e=>e)).map((e=>e.load()));return this._load=Promise.all(e).then((()=>{const{realWidth:e,realHeight:t}=this.items[0];return this.resize(e,t),this.update(),Promise.resolve(this)})),this._load}}class qi extends Zi{constructor(e,t){const{width:r,height:n}=t||{};let i,o;Array.isArray(e)?(i=e,o=e.length):o=e,super(o,{width:r,height:n}),i&&this.initFromArray(i,t)}addBaseTextureAt(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this}bind(e){super.bind(e),e.target=U.TEXTURE_2D_ARRAY}upload(e,t,r){const{length:n,itemDirtyIds:i,items:o}=this,{gl:a}=e;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,n,0,t.format,r.type,null);for(let e=0;e<n;e++){const n=o[e];i[e]<n.dirtyId&&(i[e]=n.dirtyId,n.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,e,n.resource.width,n.resource.height,1,t.format,r.type,n.resource.source))}return!0}}class Ji extends In{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return!!(t&&e instanceof t)||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const Qi=class e extends Zi{constructor(t,r){const{width:n,height:i,autoLoad:o,linkBaseTexture:a}=r||{};if(t&&t.length!==e.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:n,height:i});for(let t=0;t<e.SIDES;t++)this.items[t].target=U.TEXTURE_CUBE_MAP_POSITIVE_X+t;this.linkBaseTexture=!1!==a,t&&this.initFromArray(t,r),!1!==o&&this.load()}bind(e){super.bind(e),e.target=U.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=U.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(t,r,n){const i=this.itemDirtyIds;for(let o=0;o<e.SIDES;o++){const e=this.items[o];(i[o]<e.dirtyId||n.dirtyId<r.dirtyId)&&(e.valid&&e.resource?(e.resource.upload(t,e,n),i[o]=e.dirtyId):i[o]<-1&&(t.gl.texImage2D(e.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[o]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===e.SIDES}};Qi.SIDES=6;let eo=Qi;class to extends In{constructor(e,t){let r,n,i;t=t||{},"string"==typeof e?(r=to.EMPTY,n=e,i=!0):(r=e,n=null,i=!1),super(r),this.url=n,this.crossOrigin=t.crossOrigin??!0,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??i,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((async(e,t)=>{if(null!==this.url)try{const t=await te.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await t.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===W.UNPACK?"premultiply":"none"});if(this.destroyed)return void n.close();this.source=n,this.update(),e(this)}catch(e){if(this.destroyed)return;t(e),this.onError.emit(e)}else e(this)}))),this._load}upload(e,t,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),super.upload(e,t,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&("string"==typeof e||e instanceof ImageBitmap)}static get EMPTY(){return to._EMPTY=to._EMPTY??te.ADAPTER.createCanvas(0,0),to._EMPTY}}const ro=class e extends In{constructor(e,t){t=t||{},super(te.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((t=>{if(this._resolve=()=>{this.update(),t(this)},e.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const e=new Image;In.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,i=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/r*t,i=this._overrideHeight||this._overrideWidth/t*r),n=Math.round(n),i=Math.round(i);const o=this.source;o.width=n,o.height=i,o._pixiId=`canvas_${Pt()}`,o.getContext("2d").drawImage(e,0,0,t,r,0,0,n,i),this._resolve(),this._resolve=null}}static getSize(t){const r=e.SVG_SIZE.exec(t),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,r){return"svg"===r||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&e.SVG_XML.test(t)}};ro.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,ro.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let no=ro;const io=class e extends In{constructor(t,r){if(r=r||{},!(t instanceof HTMLVideoElement)){const n=document.createElement("video");!1!==r.autoLoad&&n.setAttribute("preload","auto"),!1!==r.playsinline&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),!0===r.muted&&(n.setAttribute("muted",""),n.muted=!0),!0===r.loop&&n.setAttribute("loop",""),!1!==r.autoPlay&&n.setAttribute("autoplay",""),"string"==typeof t&&(t=[t]);const i=t[0].src||t[0];In.crossOrigin(n,i,r.crossorigin);for(let r=0;r<t.length;++r){const i=document.createElement("source");let{src:o,mime:a}=t[r];if(o=o||t[r],o.startsWith("data:"))a=o.slice(5,o.indexOf(";"));else if(!o.startsWith("blob:")){const t=o.split("?").shift().toLowerCase(),r=t.slice(t.lastIndexOf(".")+1);a=a||e.MIME_TYPES[r]||`video/${r}`}i.src=o,a&&(i.type=a),n.appendChild(i)}t=n}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==r.autoLoad&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const e=Fi.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(((t,r)=>{this.valid?t(this):(this._resolve=t,this._reject=r,e.load())})),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Fi.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Fi.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Fi.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,r){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.includes(r)}};io.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],io.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let oo=io;rr.push(to,An,Ji,oo,class extends In{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}},no,ar,eo,qi);class ao{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new ir("disposeTransformFeedback")}bindBuffer(e,t){this.buffers[e]=t}destroy(){this.disposeRunner.emit(this,!1)}}const so="7.4.0";class uo{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Tr.EMPTY:((e=e||new Tr(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:r,b:n,c:i,d:o,tx:a,ty:s}=e,u=r*t.x+i*t.y+a,l=n*t.x+o*t.y+s;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)}addQuad(e){let t=this.minX,r=this.minY,n=this.maxX,i=this.maxY,o=e[0],a=e[1];t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[2],a=e[3],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[4],a=e[5],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[6],a=e[7],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,this.minX=t,this.minY=r,this.maxX=n,this.maxY=i}addFrame(e,t,r,n,i){this.addFrameMatrix(e.worldTransform,t,r,n,i)}addFrameMatrix(e,t,r,n,i){const o=e.a,a=e.b,s=e.c,u=e.d,l=e.tx,h=e.ty;let c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,y=o*t+s*r+l,g=a*t+u*r+h;c=y<c?y:c,d=g<d?g:d,f=y>f?y:f,p=g>p?g:p,y=o*n+s*r+l,g=a*n+u*r+h,c=y<c?y:c,d=g<d?g:d,f=y>f?y:f,p=g>p?g:p,y=o*t+s*i+l,g=a*t+u*i+h,c=y<c?y:c,d=g<d?g:d,f=y>f?y:f,p=g>p?g:p,y=o*n+s*i+l,g=a*n+u*i+h,c=y<c?y:c,d=g<d?g:d,f=y>f?y:f,p=g>p?g:p,this.minX=c,this.minY=d,this.maxX=f,this.maxY=p}addVertexData(e,t,r){let n=this.minX,i=this.minY,o=this.maxX,a=this.maxY;for(let s=t;s<r;s+=2){const t=e[s],r=e[s+1];n=t<n?t:n,i=r<i?r:i,o=t>o?t:o,a=r>a?r:a}this.minX=n,this.minY=i,this.maxX=o,this.maxY=a}addVertices(e,t,r,n){this.addVerticesMatrix(e.worldTransform,t,r,n)}addVerticesMatrix(e,t,r,n,i=0,o=i){const a=e.a,s=e.b,u=e.c,l=e.d,h=e.tx,c=e.ty;let d=this.minX,f=this.minY,p=this.maxX,y=this.maxY;for(let e=r;e<n;e+=2){const r=t[e],n=t[e+1],g=a*r+u*n+h,m=l*n+s*r+c;d=Math.min(d,g-i),p=Math.max(p,g+i),f=Math.min(f,m-o),y=Math.max(y,m+o)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=y}addBounds(e){const t=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>i?e.maxY:i}addBoundsMask(e,t){const r=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=i&&n<=o){const e=this.minX,t=this.minY,a=this.maxX,s=this.maxY;this.minX=r<e?r:e,this.minY=n<t?n:t,this.maxX=i>a?i:a,this.maxY=o>s?o:s}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const r=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=i&&n<=o){const e=this.minX,t=this.minY,a=this.maxX,s=this.maxY;this.minX=r<e?r:e,this.minY=n<t?n:t,this.maxX=i>a?i:a,this.maxY=o>s?o:s}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,r,n,i,o){e-=i,t-=o,r+=i,n+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>n?this.maxY:n}}class lo extends ve{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Gr,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new uo,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let r=0;r<t.length;++r){const n=t[r];Object.defineProperty(lo.prototype,n,Object.getOwnPropertyDescriptor(e,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new Tr),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Tr),e=this._localBoundsRect),this._localBounds||(this._localBounds=new uo);const t=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=r?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;const n=this._bounds,i=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=r,this.transform=t,this._bounds=n,this._bounds.updateID+=this._boundsID-i,o}toGlobal(e,t,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,r,n){return t&&(e=t.toGlobal(e,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){this.parent?.removeChild(this)}setTransform(e=0,t=0,r=1,n=1,i=0,o=0,a=0,s=0,u=0){return this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=o,this.skew.y=a,this.pivot.x=s,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new ho),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*xr}set angle(e){this.transform.rotation=e*_r}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1))}if(this._mask=e,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(0===e._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class ho extends lo{constructor(){super(...arguments),this.sortDirty=null}}lo.prototype.displayObjectUpdateTransform=lo.prototype.updateTransform;const co=new Pr;function fo(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const po=class e extends lo{constructor(){super(),this.children=[],this.sortableChildren=e.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const r=this.getChildIndex(e),n=this.getChildIndex(t);this.children[r]=t,this.children[n]=e,this.onChildrenChange(r<n?r:n)}getChildIndex(e){const t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(e);Et(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],r=this.children.indexOf(t);if(-1===r)return null;t.parent=null,t.transform._parentID=-1,Et(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Et(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const r=e,n=t-r;let i;if(n>0&&n<=t){i=this.children.splice(r,n);for(let e=0;e<i.length;++e)i[e].parent=null,i[e].transform&&(i[e].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let e=0;e<i.length;++e)i[e].emit("removed",this),this.emit("childRemoved",i[e],this,e);return i}if(0===n&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){const r=this.children[t];r._lastSortedIndex=t,!e&&0!==r.zIndex&&(e=!0)}e&&this.children.length>1&&this.children.sort(fo),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const t=this.children[e];t.visible&&t.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(t.visible&&t.renderable)if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const r=super.getLocalBounds(e);if(!t)for(let e=0,t=this.children.length;e<t;++e){const t=this.children[e];t.visible&&t.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){const r=t.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==e.prototype._render&&(n=this.getBounds(!0));const o=t.projection.transform;if(o&&(i?(i=co.copyFrom(i),i.prepend(o)):i=o),n&&r.intersects(n,i))this._render(t);else if(this.cullArea)return;for(let e=0,r=this.children.length;e<r;++e){const r=this.children[e],n=r.cullable;r.cullable=n||!this.cullArea,r.render(t),r.cullable=n}}render(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}}renderAdvanced(e){const t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let e=0;e<t.length;e++)t[e].enabled&&this._enabledFilters.push(t[e])}const n=t&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==Z.NONE));if(n&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}n&&e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t="boolean"==typeof e?e:e?.children,r=this.removeChildren(0,this.children.length);if(t)for(let t=0;t<r.length;++t)r[t].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e}};po.defaultSortableChildren=!1;let yo=po;yo.prototype.containerUpdateTransform=yo.prototype.updateTransform,Object.defineProperties(te,{SORTABLE_CHILDREN:{get:()=>yo.defaultSortableChildren,set(e){Ae("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),yo.defaultSortableChildren=e}}});const go=new Ar,mo=new Uint16Array([0,1,2,0,2,3]);class wo extends yo{constructor(e){super(),this._anchor=new Ur(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new ht(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=L.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||En.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=mo,this.pluginName="batch",this.isSprite=!0,this._roundPixels=te.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ot(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ot(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,u=this.vertexData,l=e.trim,h=e.orig,c=this._anchor;let d=0,f=0,p=0,y=0;if(l?(f=l.x-c._x*h.width,d=f+l.width,y=l.y-c._y*h.height,p=y+l.height):(f=-c._x*h.width,d=f+h.width,y=-c._y*h.height,p=y+h.height),u[0]=r*f+i*y+a,u[1]=o*y+n*f+s,u[2]=r*d+i*y+a,u[3]=o*y+n*d+s,u[4]=r*d+i*p+a,u[5]=o*p+n*d+s,u[6]=r*f+i*p+a,u[7]=o*p+n*f+s,this._roundPixels){const e=te.RESOLUTION;for(let t=0;t<u.length;++t)u[t]=Math.round(u[t]*e)/e}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,r=e.orig,n=this._anchor,i=this.transform.worldTransform,o=i.a,a=i.b,s=i.c,u=i.d,l=i.tx,h=i.ty,c=-n._x*r.width,d=c+r.width,f=-n._y*r.height,p=f+r.height;if(t[0]=o*c+s*f+l,t[1]=u*f+a*c+h,t[2]=o*d+s*f+l,t[3]=u*f+a*d+h,t[4]=o*d+s*p+l,t[5]=u*p+a*d+h,t[6]=o*c+s*p+l,t[7]=u*p+a*c+h,this._roundPixels){const e=te.RESOLUTION;for(let r=0;r<t.length;++r)t[r]=Math.round(t[r]*e)/e}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new uo),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Tr),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,go);const t=this._texture.orig.width,r=this._texture.orig.height,n=-t*this.anchor.x;let i=0;return go.x>=n&&go.x<n+t&&(i=-r*this.anchor.y,go.y>=i&&go.y<i+r)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e?.texture){const t="boolean"==typeof e?e:e?.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){const r=e instanceof En?e:En.from(e,t);return new wo(r)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=Ot(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=Ot(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||En.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const bo=new Pr;lo.prototype._cacheAsBitmap=!1,lo.prototype._cacheData=null,lo.prototype._cacheAsBitmapResolution=null,lo.prototype._cacheAsBitmapMultisample=null;class vo{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(lo.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;let t;this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new vo),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}),lo.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},lo.prototype._initCachedDisplayObject=function(e){if(this._cacheData?.sprite)return;const t=this.alpha;this.alpha=1,e.batch.flush();const r=this.getLocalBounds(new Tr,!0);if(this.filters?.length){const e=this.filters[0].padding;r.pad(e)}const n=this.cacheAsBitmapResolution||e.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=e.renderTexture.current,o=e.renderTexture.sourceFrame.clone(),a=e.renderTexture.destinationFrame.clone(),s=e.projection.transform,u=On.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??e.multisample}),l=`cacheAsBitmap_${Pt()}`;this._cacheData.textureCacheId=l,lr.addToCache(u.baseTexture,l),En.addToCache(u,l);const h=this.transform.localTransform.copyTo(bo).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:u,clear:!0,transform:h,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=s,e.renderTexture.bind(i,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const c=new wo(u);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-r.x/r.width,c.anchor.y=-r.y/r.height,c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)},lo.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},lo.prototype._initCachedDisplayObjectCanvas=function(e){if(this._cacheData?.sprite)return;const t=this.getLocalBounds(new Tr,!0),r=this.alpha;this.alpha=1;const n=e.canvasContext.activeContext,i=e._projTransform,o=this.cacheAsBitmapResolution||e.resolution;t.ceil(o),t.width=Math.max(t.width,1/o),t.height=Math.max(t.height,1/o);const a=On.create({width:t.width,height:t.height,resolution:o}),s=`cacheAsBitmap_${Pt()}`;this._cacheData.textureCacheId=s,lr.addToCache(a.baseTexture,s),En.addToCache(a,s);const u=bo;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=t.x,u.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:a,clear:!0,transform:u,skipUpdateTransform:!1}),e.canvasContext.activeContext=n,e._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const l=new wo(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-t.x/t.width,l.anchor.y=-t.y/t.height,l.alpha=r,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)},lo.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},lo.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},lo.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,lr.removeFromCache(this._cacheData.textureCacheId),En.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},lo.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},lo.prototype.name=null,yo.prototype.getChildByName=function(e,t){for(let t=0,r=this.children.length;t<r;t++)if(this.children[t].name===e)return this.children[t];if(t)for(let t=0,r=this.children.length;t<r;t++){const r=this.children[t];if(!r.getChildByName)continue;const n=r.getChildByName(e,!0);if(n)return n}return null},lo.prototype.getGlobalPosition=function(e=new Ar,t=!1){return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};class xo extends gn{constructor(e=1){super(Gi,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const _o={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Io=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");class Ao extends gn{constructor(e,t=8,r=4,n=gn.defaultResolution,i=5){const o=function(e,t){const r=Math.ceil(e/2);let n,i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";n=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let t=0;t<e;t++){let e=n.replace("%index%",t.toString());e=e.replace("%sampleIndex%",t-(r-1)+".0"),o+=e,o+="\n"}return i=i.replace("%blur%",o),i=i.replace("%size%",e.toString()),i}(i,e),a=function(e){const t=_o[e],r=t.length;let n,i=Io,o="";for(let i=0;i<e;i++){let a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",i.toString());n=i,i>=r&&(n=e-i-1),a=a.replace("%value%",t[n].toString()),o+=a,o+="\n"}return i=i.replace("%blur%",o),i=i.replace("%size%",e.toString()),i}(i);super(o,a),this.horizontal=e,this.resolution=n,this._quality=0,this.quality=r,this.blur=t}apply(e,t,r,n){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/t.width):this.uniforms.strength=1/r.height*(r.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,n);else{const i=e.getFilterTexture(),o=e.renderer;let a=t,s=i;this.state.blend=!1,e.applyFilter(this,a,s,Y.CLEAR);for(let t=1;t<this.passes-1;t++){e.bindAndClear(a,Y.BLIT),this.uniforms.uSampler=s;const t=s;s=a,a=t,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,s,r,n),e.returnFilterTexture(i)}}get blur(){return this.strength}set blur(e){this.padding=1+2*Math.abs(e),this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class So extends gn{constructor(e=8,t=4,r=gn.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Ao(!0,e,t,r,n),this.blurYFilter=new Ao(!1,e,t,r,n),this.resolution=r,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,r,n){const i=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(i&&o){const i=e.getFilterTexture();this.blurXFilter.apply(e,t,i,Y.CLEAR),this.blurYFilter.apply(e,i,r,n),e.returnFilterTexture(i)}else o?this.blurYFilter.apply(e,t,r,n):this.blurXFilter.apply(e,t,r,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}class To extends gn{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(zi,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e),this.alpha=1}_loadMatrix(e,t=!1){let r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}tint(e,t){const[r,n,i]=ht.shared.setValue(e).toArray(),o=[r,0,0,0,0,0,n,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(o,t)}greyscale(e,t){const r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}hue(e,t){e=(e||0)/180*Math.PI;const r=Math.cos(e),n=Math.sin(e),i=1/3,o=(0,Math.sqrt)(i),a=[r+(1-r)*i,i*(1-r)-o*n,i*(1-r)+o*n,0,0,i*(1-r)+o*n,r+i*(1-r),i*(1-r)-o*n,0,0,i*(1-r)-o*n,i*(1-r)+o*n,r+i*(1-r),0,0,0,0,0,1,0];this._loadMatrix(a,t)}contrast(e,t){const r=(e||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,t)}saturate(e=0,t){const r=2*e/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,t)}desaturate(){this.saturate(-1)}negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}colorTone(e,t,r,n,i){e=e||.2,t=t||.15,r=r||16770432,n=n||3375104;const o=ht.shared,[a,s,u]=o.setValue(r).toArray(),[l,h,c]=o.setValue(n).toArray(),d=[.3,.59,.11,0,0,a,s,u,e,0,l,h,c,t,0,a-l,s-h,u-c,0,0];this._loadMatrix(d,i)}night(e,t){const r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}predator(e,t){const r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,t)}lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}To.prototype.grayscale=To.prototype.greyscale;class Co extends gn{constructor(e,t){const r=new Pr;e.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==t&&(t=20),this.scale=new Ar(t,t)}apply(e,t,r,n){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),a=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/a,this.uniforms.rotation[3]=i.d/a),e.applyFilter(this,t,r,n)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}class Eo extends gn{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}}class Oo extends gn{constructor(e=.5,t=Math.random()){super(zi,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const ko={AlphaFilter:xo,BlurFilter:So,BlurFilterPass:Ao,ColorMatrixFilter:To,DisplacementFilter:Co,FXAAFilter:Eo,NoiseFilter:Oo};Object.entries(ko).forEach((([e,t])=>{Object.defineProperty(ko,e,{get:()=>(Ae("7.1.0",`filters.${e} has moved to ${e}`),t)})}));const Po=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Fi.system.add(this.tickerUpdate,this,Di.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Fi.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}};class $o{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=$o.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Ar,this.page=new Ar,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,r,n,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Ro extends $o{constructor(){super(...arguments),this.client=new Ar,this.movement=new Ar,this.offset=new Ar,this.global=new Ar,this.screen=new Ar}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,r,n,i,o,a,s,u,l,h,c,d,f,p){throw new Error("Method not implemented.")}}class Bo extends Ro{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Do extends Ro{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Do.DOM_DELTA_PIXEL=0,Do.DOM_DELTA_LINE=1,Do.DOM_DELTA_PAGE=2;const Mo=new Ar,Lo=new Ar;class Fo{constructor(e){this.dispatch=new ve,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(((e,t)=>e.priority-t.priority))}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let r=0,n=t.length;r<n;r++)t[r].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){Po.pauseUpdate=!0;const r=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,Mo.set(e,t),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(e,t){if(!e.target)return;const r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let n=0,i=r.length-1;n<i;n++)if(e.currentTarget=r[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(let n=r.length-2;n>=0;n--)if(e.currentTarget=r[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,r=this._allInteractiveElements){if(0===r.length)return;e.eventPhase=e.BUBBLING_PHASE;const n=Array.isArray(t)?t:[t];for(let t=r.length-1;t>=0;t--)n.forEach((n=>{e.currentTarget=r[t],this.notifyTarget(e,n)}))}propagationPath(e){const t=[e];for(let r=0;r<2048&&e!==this.rootTarget;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,r,n,i,o=!1){let a=!1;if(this._interactivePrune(e))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(Po.pauseUpdate=!1),e.interactiveChildren&&e.children){const s=e.children;for(let u=s.length-1;u>=0;u--){const l=s[u],h=this.hitTestMoveRecursive(l,this._isInteractive(t)?t:l.eventMode,r,n,i,o||i(e,r));if(h){if(h.length>0&&!h[h.length-1].parent)continue;const t=e.isInteractive();(h.length>0||t)&&(t&&this._allInteractiveElements.push(e),h.push(e)),0===this._hitElements.length&&(this._hitElements=h),a=!0}}}const s=this._isInteractive(t),u=e.isInteractive();return s&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:s&&!i(e,r)&&n(e,r)?u?[e]:[]:null}hitTestRecursive(e,t,r,n,i){if(this._interactivePrune(e)||i(e,r))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(Po.pauseUpdate=!1),e.interactiveChildren&&e.children){const o=e.children;for(let a=o.length-1;a>=0;a--){const s=o[a],u=this.hitTestRecursive(s,this._isInteractive(t)?t:s.eventMode,r,n,i);if(u){if(u.length>0&&!u[u.length-1].parent)continue;const t=e.isInteractive();return(u.length>0||t)&&u.push(e),u}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&n(e,r)?a?[e]:[]:null}_isInteractive(e){return"static"===e||"dynamic"===e}_interactivePrune(e){return!(e&&!e.isMask&&e.visible&&e.renderable&&"none"!==e.eventMode&&("passive"!==e.eventMode||e.interactiveChildren)&&!e.isMask)}hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,Lo),!e.hitArea.contains(Lo.x,Lo.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!r.containsPoint?.(t))return!0}return!1}hitTestFn(e,t){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(t))}notifyTarget(e,t){const r=`on${t=t??e.type}`;e.currentTarget[r]?.(e);const n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof Bo))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){const e=2===t.button;this.dispatchEvent(t,e?"rightdown":"mousedown")}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){if(!(e instanceof Bo))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const r="mouse"===t.pointerType||"pen"===t.pointerType,n=this.trackingData(e.pointerId),i=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&i!==t.target){const n="mousemove"===e.type?"mouseout":"pointerout",o=this.createPointerEvent(e,n,i);if(this.dispatchEvent(o,"pointerout"),r&&this.dispatchEvent(o,"mouseout"),!t.composedPath().includes(i)){const n=this.createPointerEvent(e,"pointerleave",i);for(n.eventPhase=n.AT_TARGET;n.target&&!t.composedPath().includes(n.target);)n.currentTarget=n.target,this.notifyTarget(n),r&&this.notifyTarget(n,"mouseleave"),n.target=n.target.parent;this.freeEvent(n)}this.freeEvent(o)}if(i!==t.target){const n="mousemove"===e.type?"mouseover":"pointerover",o=this.clonePointerEvent(t,n);this.dispatchEvent(o,"pointerover"),r&&this.dispatchEvent(o,"mouseover");let a=i?.parent;for(;a&&a!==this.rootTarget.parent&&a!==t.target;)a=a.parent;if(!a||a===this.rootTarget.parent){const e=this.clonePointerEvent(t,"pointerenter");for(e.eventPhase=e.AT_TARGET;e.target&&e.target!==i&&e.target!==this.rootTarget.parent;)e.currentTarget=e.target,this.notifyTarget(e),r&&this.notifyTarget(e,"mouseenter"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(o)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),"touch"===t.pointerType&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=t.target?.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){if(!(e instanceof Bo))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),r=this.createPointerEvent(e),n="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),n&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=r.target?.cursor);const i=this.clonePointerEvent(r,"pointerenter");for(i.eventPhase=i.AT_TARGET;i.target&&i.target!==this.rootTarget.parent;)i.currentTarget=i.target,this.notifyTarget(i),n&&this.notifyTarget(i,"mouseenter"),i.target=i.target.parent;t.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(i)}mapPointerOut(e){if(!(e instanceof Bo))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId);if(t.overTargets){const r="mouse"===e.pointerType||"pen"===e.pointerType,n=this.findMountedTarget(t.overTargets),i=this.createPointerEvent(e,"pointerout",n);this.dispatchEvent(i),r&&this.dispatchEvent(i,"mouseout");const o=this.createPointerEvent(e,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(i),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Bo))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),"touch"===r.pointerType)this.dispatchEvent(r,"touchend");else if("mouse"===r.pointerType||"pen"===r.pointerType){const e=2===r.button;this.dispatchEvent(r,e?"rightup":"mouseup")}const n=this.trackingData(e.pointerId),i=this.findMountedTarget(n.pressTargetsByButton[e.button]);let o=i;if(i&&!r.composedPath().includes(i)){let t=i;for(;t&&!r.composedPath().includes(t);){if(r.currentTarget=t,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType)this.notifyTarget(r,"touchendoutside");else if("mouse"===r.pointerType||"pen"===r.pointerType){const e=2===r.button;this.notifyTarget(r,e?"rightupoutside":"mouseupoutside")}t=t.parent}delete n.pressTargetsByButton[e.button],o=t}if(o){const i=this.clonePointerEvent(r,"click");i.target=o,i.path=null,n.clicksByButton[e.button]||(n.clicksByButton[e.button]={clickCount:0,target:i.target,timeStamp:t});const a=n.clicksByButton[e.button];if(a.target===i.target&&t-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=i.target,a.timeStamp=t,i.detail=a.clickCount,"mouse"===i.pointerType){const e=2===i.button;this.dispatchEvent(i,e?"rightclick":"click")}else"touch"===i.pointerType&&this.dispatchEvent(i,"tap");this.dispatchEvent(i,"pointertap"),this.freeEvent(i)}this.freeEvent(r)}mapPointerUpOutside(e){if(!(e instanceof Bo))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),r=this.findMountedTarget(t.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(r){let i=r;for(;i;)n.currentTarget=i,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):("mouse"===n.pointerType||"pen"===n.pointerType)&&this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(n)}mapWheel(e){if(!(e instanceof Do))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let r=1;r<e.length&&e[r].parent===t;r++)t=e[r];return t}createPointerEvent(e,t,r){const n=this.allocateEvent(Bo);return this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=r??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],"string"==typeof t&&(n.type=t),n}createWheelEvent(e){const t=this.allocateEvent(Do);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const r=this.allocateEvent(Bo);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t??r.type,r}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof Bo&&t instanceof Bo&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof Ro&&t instanceof Ro&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const r=e.currentTarget._events[t];if(r&&e.currentTarget.isInteractive())if("fn"in r)r.once&&e.currentTarget.removeListener(t,r.fn,void 0,!0),r.fn.call(r.context,e);else for(let n=0,i=r.length;n<i&&!e.propagationImmediatelyStopped;n++)r[n].once&&e.currentTarget.removeListener(t,r[n].fn,void 0,!0),r[n].fn.call(r[n].context,e)}}const No={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Uo=class e{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new Fo(null),Po.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Bo(null),this.rootWheelEvent=new Do(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...e.defaultEventFeatures},{set:(e,t,r)=>("globalMove"===t&&(this.rootBoundary.enableGlobalMoveEvents=r),e[t]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,e._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let e=0,r=t.length;e<r;e++){const r=t[e],n=this.bootstrapEvent(this.rootPointerEvent,r);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Po.pointerMoved();const t=this.normalizeToPointerData(e);for(let e=0,r=t.length;e<r;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const r=t!==this.domElement?"outside":"",n=this.normalizeToPointerData(e);for(let e=0,t=n.length;e<t;e++){const t=this.bootstrapEvent(this.rootPointerEvent,n[e]);t.type+=r,this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);for(let e=0,r=t.length;e<r;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,Po.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Po.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Po.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){const n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;e.x=(t-n.left)*(this.domElement.width/n.width)*i,e.y=(r-n.top)*(this.domElement.height/n.height)*i}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,n=e.changedTouches.length;r<n;r++){const n=e.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=1===e.touches.length&&"touchstart"===e.type),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=e.type,t.push(n)}else if(globalThis.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof globalThis.PointerEvent))t.push(e);else{const r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=1),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=No[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};Uo.extension={name:"events",type:[Yt.RendererSystem,Yt.CanvasRendererSystem]},Uo.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let jo=Uo;function Go(e){return"dynamic"===e||"static"===e}Zt.add(jo);const zo={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Go(jo.defaultEventMode)},set interactive(e){Ae("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??jo.defaultEventMode},set eventMode(e){this._internalInteractive=Go(e),this._internalEventMode=e},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){const n="boolean"==typeof r&&r||"object"==typeof r&&r.capture,i="object"==typeof r?r.signal:void 0,o="object"==typeof r&&!0===r.once,a="function"==typeof t?void 0:t;e=n?`${e}capture`:e;const s="function"==typeof t?t:t.handleEvent,u=this;i&&i.addEventListener("abort",(()=>{u.off(e,s,a)})),o?u.once(e,s,a):u.on(e,s,a)},removeEventListener(e,t,r){const n="function"==typeof t?void 0:t;e="boolean"==typeof r&&r||"object"==typeof r&&r.capture?`${e}capture`:e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof $o))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};lo.mixin(zo);const Vo={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};lo.mixin(Vo);class Ho{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(be.tablet||be.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex=2..toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let e=0;e<t.length;e++)this.updateAccessibleObjects(t[e])}update(){const e=performance.now();if(be.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:r,width:n,height:i}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:s}=this.renderer,u=n/o*s,l=i/a*s;let h=this.div;h.style.left=`${t}px`,h.style.top=`${r}px`,h.style.width=`${o}px`,h.style.height=`${a}px`;for(let e=0;e<this.children.length;e++){const t=this.children[e];if(t.renderId!==this.renderId)t._accessibleActive=!1,Et(this.children,e,1),this.div.removeChild(t._accessibleDiv),this.pool.push(t._accessibleDiv),t._accessibleDiv=null,e--;else{h=t._accessibleDiv;let e=t.hitArea;const r=t.worldTransform;t.hitArea?(h.style.left=(r.tx+e.x*r.a)*u+"px",h.style.top=(r.ty+e.y*r.d)*l+"px",h.style.width=e.width*r.a*u+"px",h.style.height=e.height*r.d*l+"px"):(e=t.getBounds(),this.capHitArea(e),h.style.left=e.x*u+"px",h.style.top=e.y*l+"px",h.style.width=e.width*u+"px",h.style.height=e.height*l+"px",h.title!==t.accessibleTitle&&null!==t.accessibleTitle&&(h.title=t.accessibleTitle),h.getAttribute("aria-label")!==t.accessibleHint&&null!==t.accessibleHint&&h.setAttribute("aria-label",t.accessibleHint)),(t.accessibleTitle!==h.title||t.tabIndex!==h.tabIndex)&&(h.title=t.accessibleTitle,h.tabIndex=t.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:r}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>r&&(e.height=r-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=2..toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:(!e.accessibleHint||null===e.accessibleHint)&&(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:r}=e.target,n=this.renderer.events.rootBoundary,i=Object.assign(new $o(n),{target:r});n.rootTarget=this.renderer.lastObjectRendered,t.forEach((e=>n.dispatchEvent(i,e)))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){9===e.keyCode&&this.activate()}_onMouseMove(e){0===e.movementX&&0===e.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Ho.extension={name:"accessibility",type:[Yt.RendererPlugin,Yt.CanvasRendererPlugin]},Zt.add(Ho);const Wo=class e{constructor(t){this.stage=new yo,t=Object.assign({forceCanvas:!1},t),this.renderer=ji(t),e._plugins.forEach((e=>{e.init.call(this,t)}))}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(t,r){const n=e._plugins.slice(0);n.reverse(),n.forEach((e=>{e.destroy.call(this)})),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Wo._plugins=[];let Yo=Wo;Zt.handleByList(Yt.Application,Yo._plugins);class Ko{static init(e){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let e,t;if(this.cancelResize(),this._resizeTo===globalThis.window)e=globalThis.innerWidth,t=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;e=r,t=n}this.renderer.resize(e,t),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Ko.extension=Yt.Application,Zt.add(Ko);const Xo={loader:Yt.LoadParser,resolver:Yt.ResolveParser,cache:Yt.CacheParser,detection:Yt.DetectionParser};Zt.handle(Yt.Asset,(e=>{const t=e.ref;Object.entries(Xo).filter((([e])=>!!t[e])).forEach((([e,r])=>Zt.add(Object.assign(t[e],{extension:t[e].extension??r}))))}),(e=>{const t=e.ref;Object.keys(Xo).filter((e=>!!t[e])).forEach((e=>Zt.remove(t[e])))}));class Zo{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach((e=>{this._assetList.push(e)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<t;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function qo(e,t){const r=e.split("?")[0],n=Ee.extname(r).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const Jo=(e,t,r=!1)=>(Array.isArray(e)||(e=[e]),t?e.map((e=>"string"==typeof e||r?t(e):e)):e);const Qo=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const r=Jo(e);let n;for(let e=0;e<this.parsers.length;e++){const i=this.parsers[e];if(i.test(t)){n=i.getCacheableAssets(r,t);break}}n||(n={},r.forEach((e=>{n[e]=t})));const i=Object.keys(n),o={cacheKeys:i,keys:r};if(r.forEach((e=>{this._cacheMap.set(e,o)})),i.forEach((e=>{this._cache.has(e)&&this._cache.get(e)!==t&&console.warn("[Cache] already has key:",e),this._cache.set(e,n[e])})),t instanceof En){const e=t;r.forEach((t=>{e.baseTexture!==En.EMPTY.baseTexture&&lr.addToCache(e.baseTexture,t),En.addToCache(e,t)}))}}remove(e){if(!this._cacheMap.has(e))return void console.warn(`[Assets] Asset id ${e} was not found in the Cache`);const t=this._cacheMap.get(e);t.cacheKeys.forEach((e=>{this._cache.delete(e)})),t.keys.forEach((e=>{this._cacheMap.delete(e)}))}get parsers(){return this._parsers}},ea=e=>!Array.isArray(e);class ta{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,r)=>(this._parsersValidated=!1,e[t]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const r={promise:null,parser:null};return r.promise=(async()=>{let n=null,i=null;if(t.loadParser&&(i=this._parserHash[t.loadParser],i||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!i){for(let r=0;r<this.parsers.length;r++){const n=this.parsers[r];if(n.load&&n.test?.(e,t,this)){i=n;break}}if(!i)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(e,t,this),r.parser=i;for(let e=0;e<this.parsers.length;e++){const i=this.parsers[e];i.parse&&i.parse&&await(i.testParse?.(n,t,this))&&(n=await i.parse(n,t,this)||n,r.parser=i)}return n})(),r}async load(e,t){this._parsersValidated||this._validateParsers();let r=0;const n={},i=ea(e),o=Jo(e,(e=>({alias:[e],src:e}))),a=o.length,s=o.map((async e=>{const i=Ee.toAbsolute(e.src);if(!n[e.src])try{this.promiseCache[i]||(this.promiseCache[i]=this._getLoadPromiseAndParser(i,e)),n[e.src]=await this.promiseCache[i].promise,t&&t(++r/a)}catch(t){throw delete this.promiseCache[i],delete n[e.src],new Error(`[Loader.load] Failed to load ${i}.\n${t}`)}}));return await Promise.all(s),i?n[o[0].src]:n}async unload(e){const t=Jo(e,(e=>({alias:[e],src:e}))).map((async e=>{const t=Ee.toAbsolute(e.src),r=this.promiseCache[t];if(r){const n=await r.promise;delete this.promiseCache[t],r.parser?.unload?.(n,e,this)}}));await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((e=>e.name)).reduce(((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t})),{})}}var ra=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(ra||{});function na(e,t){if(Array.isArray(t)){for(const r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}const ia={extension:{type:Yt.LoadParser,priority:ra.Low},name:"loadJson",test:e=>na(e,"application/json")||qo(e,".json"),load:async e=>await(await te.ADAPTER.fetch(e)).json()};Zt.add(ia);const oa={name:"loadTxt",extension:{type:Yt.LoadParser,priority:ra.Low},test:e=>na(e,"text/plain")||qo(e,".txt"),load:async e=>await(await te.ADAPTER.fetch(e)).text()};Zt.add(oa);const aa=["normal","bold","100","200","300","400","500","600","700","800","900"],sa=[".ttf",".otf",".woff",".woff2"],ua=["font/ttf","font/otf","font/woff","font/woff2"],la=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function ha(e){const t=Ee.extname(e),r=Ee.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1)));let n=r.length>0;for(const e of r)if(!e.match(la)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const ca=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;const da={extension:{type:Yt.LoadParser,priority:ra.Low},name:"loadWebFont",test:e=>na(e,ua)||qo(e,sa),async load(e,t){const r=te.ADAPTER.getFontFaceSet();if(r){const i=[],o=t.data?.family??ha(e),a=t.data?.weights?.filter((e=>aa.includes(e)))??["normal"],s=t.data??{};for(let t=0;t<a.length;t++){const u=a[t],l=new FontFace(o,`url(${n=e,ca.test(n)?n:encodeURI(n)})`,{...s,weight:u});await l.load(),r.add(l),i.push(l)}return 1===i.length?i[0]:i}var n;return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach((e=>te.ADAPTER.getFontFaceSet().delete(e)))}};Zt.add(da);let fa=null;class pa extends Worker{constructor(){fa||(fa=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n  async function checkImageBitmap() {\n    try {\n      if (typeof createImageBitmap != "function")\n        return !1;\n      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);\n      return imageBitmap.width === 1 && imageBitmap.height === 1;\n    } catch {\n      return !1;\n    }\n  }\n  checkImageBitmap().then((result) => {\n    self.postMessage(result);\n  });\n})();\n'],{type:"application/javascript"}))),super(fa)}}pa.revokeObjectURL=function(){fa&&(URL.revokeObjectURL(fa),fa=null)};let ya=null;class ga extends Worker{constructor(){ya||(ya=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  async function loadImageBitmap(url) {\n    const response = await fetch(url);\n    if (!response.ok)\n      throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n    const imageBlob = await response.blob();\n    return await createImageBitmap(imageBlob);\n  }\n  self.onmessage = async (event) => {\n    try {\n      const imageBitmap = await loadImageBitmap(event.data.data[0]);\n      self.postMessage({\n        data: imageBitmap,\n        uuid: event.data.uuid,\n        id: event.data.id\n      }, [imageBitmap]);\n    } catch (e) {\n      self.postMessage({\n        error: e,\n        uuid: event.data.uuid,\n        id: event.data.id\n      });\n    }\n  };\n})();\n'],{type:"application/javascript"}))),super(ya)}}ga.revokeObjectURL=function(){ya&&(URL.revokeObjectURL(ya),ya=null)};let ma,wa=0;const ba=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((e=>{const t=new pa;t.addEventListener("message",(r=>{t.terminate(),pa.revokeObjectURL(),e(r.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===ma&&(ma=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<ma&&(this._createdWorkers++,e=new ga,e.addEventListener("message",(e=>{this.complete(e.data),this.returnWorker(e.target),this.next()}))),e}returnWorker(e){this.workerPool.push(e)}complete(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const r=new Promise(((r,n)=>{this.queue.push({id:e,arguments:t,resolve:r,reject:n})}));return this.next(),r}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),r=t.id;this.resolveHash[wa]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:wa++,id:r})}};function va(e,t,r){e.resource.internal=!0;const n=new En(e),i=()=>{delete t.promiseCache[r],Qo.has(r)&&Qo.remove(r)};return n.baseTexture.once("destroyed",(()=>{r in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())})),n.once("destroyed",(()=>{e.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())})),n}const xa=[".jpeg",".jpg",".png",".webp",".avif"],_a=["image/jpeg","image/png","image/webp","image/avif"];async function Ia(e){const t=await te.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const r=await t.blob();return await createImageBitmap(r)}const Aa={name:"loadTextures",extension:{type:Yt.LoadParser,priority:ra.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:e=>na(e,_a)||qo(e,xa),async load(e,t,r){const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;i=n?this.config.preferWorkers&&await ba.isImageBitmapSupported()?await ba.loadImageBitmap(e):await Ia(e):await new Promise(((t,r)=>{const n=new Image;n.crossOrigin=this.config.crossOrigin,n.src=e,n.complete?t(n):(n.onload=()=>t(n),n.onerror=e=>r(e))}));const o={...t.data};o.resolution??(o.resolution=Wt(e)),n&&void 0===o.resourceOptions?.ownsImageBitmap&&(o.resourceOptions={...o.resourceOptions},o.resourceOptions.ownsImageBitmap=!0);const a=new lr(i,o);return a.resource.src=e,va(a,r,e)},unload(e){e.destroy(!0)}};Zt.add(Aa);const Sa={extension:{type:Yt.LoadParser,priority:ra.High},name:"loadSVG",test:e=>na(e,"image/svg+xml")||qo(e,".svg"),testParse:async e=>no.test(e),async parse(e,t,r){const n=new no(e,t?.data?.resourceOptions);await n.load();const i=new lr(n,{resolution:Wt(e),...t?.data});return i.resource.src=t.src,va(i,r,t.src)},load:async(e,t)=>(await te.ADAPTER.fetch(e)).text(),unload:Aa.unload};Zt.add(Sa);const Ta=[".mp4",".m4v",".webm",".ogv"],Ca=["video/mp4","video/webm","video/ogg"],Ea={name:"loadVideo",extension:{type:Yt.LoadParser,priority:ra.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test:e=>na(e,Ca)||qo(e,Ta),async load(e,t,r){let n;const i=await(await te.ADAPTER.fetch(e)).blob(),o=URL.createObjectURL(i);try{const i={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...t?.data?.resourceOptions,autoLoad:!0},a=new oo(o,i);await a.load();const s=new lr(a,{alphaMode:await Pe(),resolution:Wt(e),...t?.data});s.resource.src=e,n=va(s,r,e),n.baseTexture.once("destroyed",(()=>{URL.revokeObjectURL(o)}))}catch(e){throw URL.revokeObjectURL(o),e}return n},unload(e){e.destroy(!0)}};function Oa(e,t,r,n,i){const o=t[r];for(let a=0;a<o.length;a++){const s=o[a];r<t.length-1?Oa(e.replace(n[r],s),t,r+1,n,i):i.push(e.replace(n[r],s))}}function ka(e){const t=e.match(/\{(.*?)\}/g),r=[];if(t){const n=[];t.forEach((e=>{const t=e.substring(1,e.length-1).split(",");n.push(t)})),Oa(e,n,0,t,r)}else r.push(e);return r}Zt.add(Ea);class Pa{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach((e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))})),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if("string"==typeof e)this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`)).join("&")}}getAlias(e){const{alias:t,name:r,src:n,srcs:i}=e;return Jo(t||r||n||i,(e=>"string"==typeof e?e:Array.isArray(e)?e.map((e=>e?.src??e?.srcs??e)):e?.src||e?.srcs?e.src??e.srcs:e),!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach((e=>{this.addBundle(e.name,e.assets)}))}addBundle(e,t){const r=[];Array.isArray(t)?t.forEach((t=>{const n=t.src??t.srcs,i=t.alias??t.name;let o;if("string"==typeof i){const t=this._createBundleAssetId(e,i);r.push(t),o=[i,t]}else{const t=i.map((t=>this._createBundleAssetId(e,t)));r.push(...t),o=[...i,...t]}this.add({...t,alias:o,src:n})})):Object.keys(t).forEach((n=>{const i=[n,this._createBundleAssetId(e,n)];if("string"==typeof t[n])this.add({alias:i,src:t[n]});else if(Array.isArray(t[n]))this.add({alias:i,src:t[n]});else{const e=t[n],r=e.src??e.srcs;this.add({...e,alias:i,src:Array.isArray(r)?r:[r]})}r.push(...i)})),this._bundles[e]=r}add(e,t,r,n,i){const o=[];let a;"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]?(Ae("7.2.0","Assets.add now uses an object instead of individual parameters.\nPlease use Assets.add({ alias, src, data, format, loadParser }) instead."),o.push({alias:e,src:t,data:r,format:n,loadParser:i})):Array.isArray(e)?o.push(...e):o.push(e),a=e=>{this.hasKey(e)&&console.warn(`[Resolver] already has key: ${e} overwriting`)},Jo(o).forEach((e=>{const{src:t,srcs:r}=e;let{data:n,format:i,loadParser:o}=e;const s=Jo(t||r).map((e=>"string"==typeof e?ka(e):Array.isArray(e)?e:[e])),u=this.getAlias(e);Array.isArray(u)?u.forEach(a):a(u);const l=[];s.forEach((e=>{e.forEach((e=>{let t={};if("object"!=typeof e){t.src=e;for(let r=0;r<this._parsers.length;r++){const n=this._parsers[r];if(n.test(e)){t=n.parse(e);break}}}else n=e.data??n,i=e.format??i,o=e.loadParser??o,t={...t,...e};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${t.src}`);t=this.buildResolvedAsset(t,{aliases:u,data:n,format:i,loadParser:o}),l.push(t)}))})),u.forEach((e=>{this._assetMap[e]=l}))}))}resolveBundle(e){const t=ea(e);e=Jo(e);const r={};return e.forEach((e=>{const t=this._bundles[e];if(t){const n=this.resolve(t),i={};for(const t in n){const r=n[t];i[this._extractAssetIdFromBundle(e,t)]=r}r[e]=i}})),t?r[e[0]]:r}resolveUrl(e){const t=this.resolve(e);if("string"!=typeof e){const e={};for(const r in t)e[r]=t[r].src;return e}return t.src}resolve(e){const t=ea(e);e=Jo(e);const r={};return e.forEach((e=>{if(!this._resolverHash[e])if(this._assetMap[e]){let t=this._assetMap[e];const r=t[0],n=this._getPreferredOrder(t);n?.priority.forEach((e=>{n.params[e].forEach((r=>{const n=t.filter((t=>!!t[e]&&t[e]===r));n.length&&(t=n)}))})),this._resolverHash[e]=t[0]??r}else this._resolverHash[e]=this.buildResolvedAsset({alias:[e],src:e},{});r[e]=this._resolverHash[e]})),t?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const t=e[0],r=this._preferredOrder.find((e=>e.params.format.includes(t.format)));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;return`${e}${/\?/.test(e)?"&":"?"}${this._defaultSearchParams}`}buildResolvedAsset(e,t){const{aliases:r,data:n,loadParser:i,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=Ee.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=i??e.loadParser,e.format=o??Ee.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class $a{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Pa,this.loader=new ta,this.cache=Qo,this._backgroundLoader=new Zo(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;"string"==typeof t&&(t=await this.load(t)),this.resolver.addManifest(t)}const t=e.texturePreference?.resolution??1,r="number"==typeof t?[t]:t,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:r}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,r,n,i){this.resolver.add(e,t,r,n,i)}async load(e,t){this._initialized||await this.init();const r=ea(e),n=Jo(e).map((e=>{if("string"!=typeof e){const t=this.resolver.getAlias(e);return t.some((e=>!this.resolver.hasKey(e)))&&this.add(e),Array.isArray(t)?t[0]:t}return this.resolver.hasKey(e)||this.add({alias:e,src:e}),e})),i=this.resolver.resolve(n),o=await this._mapLoadToResolve(i,t);return r?o[n[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let r=!1;"string"==typeof e&&(r=!0,e=[e]);const n=this.resolver.resolveBundle(e),i={},o=Object.keys(n);let a=0,s=0;const u=()=>{t?.(++a/s)},l=o.map((e=>{const t=n[e];return s+=Object.keys(t).length,this._mapLoadToResolve(t,u).then((t=>{i[e]=t}))}));return await Promise.all(l),r?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach((e=>{this._backgroundLoader.add(Object.values(e))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if("string"==typeof e)return Qo.get(e);const t={};for(let r=0;r<e.length;r++)t[r]=Qo.get(e[r]);return t}async _mapLoadToResolve(e,t){const r=Object.values(e),n=Object.keys(e);this._backgroundLoader.active=!1;const i=await this.loader.load(r,t);this._backgroundLoader.active=!0;const o={};return r.forEach(((e,t)=>{const r=i[e.src],a=[e.src];e.alias&&a.push(...e.alias),o[n[t]]=r,Qo.set(a,r)})),o}async unload(e){this._initialized||await this.init();const t=Jo(e).map((e=>"string"!=typeof e?e.src:e)),r=this.resolver.resolve(t);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=Jo(e);const t=this.resolver.resolveBundle(e),r=Object.keys(t).map((e=>this._unloadFromResolved(t[e])));await Promise.all(r)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach((e=>{Qo.remove(e.src)})),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?t=await r.add(t):e.skipDetections||(t=await r.remove(t));return t=t.filter(((e,r)=>t.indexOf(e)===r)),t}get detections(){return this._detections}get preferWorkers(){return Aa.config.preferWorkers}set preferWorkers(e){Ae("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach((t=>{t.config&&Object.keys(t.config).filter((t=>t in e)).forEach((r=>{t.config[r]=e[r]}))}))}}const Ra=new $a;Zt.handleByList(Yt.LoadParser,Ra.loader.parsers).handleByList(Yt.ResolveParser,Ra.resolver.parsers).handleByList(Yt.CacheParser,Ra.cache.parsers).handleByList(Yt.DetectionParser,Ra.detections);const Ba={extension:Yt.CacheParser,test:e=>Array.isArray(e)&&e.every((e=>e instanceof En)),getCacheableAssets:(e,t)=>{const r={};return e.forEach((e=>{t.forEach(((t,n)=>{r[e+(0===n?"":n+1)]=t}))})),r}};async function Da(e){if("Image"in globalThis)return new Promise((t=>{const r=new Image;r.onload=()=>{t(!0)},r.onerror=()=>{t(!1)},r.src=e}));if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(e)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}Zt.add(Ba);const Ma={extension:{type:Yt.DetectionParser,priority:1},test:async()=>Da("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter((e=>"avif"!==e))};Zt.add(Ma);const La={extension:{type:Yt.DetectionParser,priority:0},test:async()=>Da("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter((e=>"webp"!==e))};Zt.add(La);const Fa=["png","jpg","jpeg"],Na={extension:{type:Yt.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...Fa],remove:async e=>e.filter((e=>!Fa.includes(e)))};Zt.add(Na);const Ua="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function ja(e){return!Ua&&""!==document.createElement("video").canPlayType(e)}const Ga={extension:{type:Yt.DetectionParser,priority:0},test:async()=>ja("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter((e=>"webm"!==e))};Zt.add(Ga);const za={extension:{type:Yt.DetectionParser,priority:0},test:async()=>ja("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter((e=>"mp4"!==e&&"m4v"!==e))};Zt.add(za);const Va={extension:{type:Yt.DetectionParser,priority:0},test:async()=>ja("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter((e=>"ogv"!==e))};Zt.add(Va);const Ha={extension:Yt.ResolveParser,test:Aa.test,parse:e=>({resolution:parseFloat(te.RETINA_PREFIX.exec(e)?.[1]??"1"),format:Ee.extname(e).slice(1),src:e})};Zt.add(Ha);const Wa=(e,t)=>{const r=t.split("?")[1];return r&&(e+=`?${r}`),e};var Ya=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e))(Ya||{});const Ka={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Xa,Za;function qa(){Za={s3tc:Xa.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Xa.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Xa.getExtension("WEBGL_compressed_texture_etc"),etc1:Xa.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Xa.getExtension("WEBGL_compressed_texture_pvrtc")||Xa.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Xa.getExtension("WEBGL_compressed_texture_atc"),astc:Xa.getExtension("WEBGL_compressed_texture_astc"),bptc:Xa.getExtension("EXT_texture_compression_bptc")}}const Ja={extension:{type:Yt.DetectionParser,priority:2},test:async()=>{const e=te.ADAPTER.createCanvas().getContext("webgl");return e?(Xa=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{Za||qa();const t=[];for(const e in Za)Za[e]&&t.push(e);return[...t,...e]},remove:async e=>(Za||qa(),e.filter((e=>!(e in Za))))};Zt.add(Ja);class Qa extends ar{constructor(e,t={width:1,height:1,autoLoad:!0}){let r,n;"string"==typeof e?(r=e,n=new Uint8Array):(r=null,n=e),super(n,t),this.origin=r,this.buffer=n?new qt(n):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==t.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load||(this._load=fetch(this.origin).then((e=>e.blob())).then((e=>e.arrayBuffer())).then((e=>(this.data=new Uint32Array(e),this.buffer=new qt(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)))),this._load}}class es extends Qa{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=es._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||es._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,r){const n=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;n.pixelStorei(n.UNPACK_ALIGNMENT,4);for(let e=0,t=this.levels;e<t;e++){const{levelID:t,levelWidth:r,levelHeight:i,levelBuffer:o}=this._levelBuffers[e];n.compressedTexImage2D(n.TEXTURE_2D,t,this.format,r,i,0,o)}return!0}onBlobLoaded(){this._levelBuffers=es._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(36196===e)return"etc1";if(35986===e||35987===e||34798===e)return"atc";if(e>=36492&&e<=36495)return"bptc";if(37808===e)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,t,r,n,i,o,a){const s=new Array(r);let u=e.byteOffset,l=o,h=a,c=l+n-1&~(n-1),d=h+i-1&~(i-1),f=c*d*Ka[t];for(let o=0;o<r;o++)s[o]={levelID:o,levelWidth:r>1?l:c,levelHeight:r>1?h:d,levelBuffer:new Uint8Array(e.buffer,u,f)},u+=f,l=l>>1||1,h=h>>1||1,c=l+n-1&~(n-1),d=h+i-1&~(i-1),f=c*d*Ka[t];return s}}const ts=4,rs=124,ns=32,is=20,os=542327876,as={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},ss={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},us={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},ls=1,hs=2,cs=4,ds=64,fs=512,ps=131072,ys=808540228,gs=4,ms={827611204:Ya.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:Ya.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:Ya.COMPRESSED_RGBA_S3TC_DXT5_EXT},ws={70:Ya.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ya.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ya.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ya.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ya.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ya.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ya.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ya.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ya.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Ya.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Ya.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Ya.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Ya.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function bs(e){const t=new Uint32Array(e);if(t[0]!==os)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(e,0,rs/Uint32Array.BYTES_PER_ELEMENT),n=r[as.HEIGHT],i=r[as.WIDTH],o=r[as.MIPMAP_COUNT],a=new Uint32Array(e,as.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,ns/Uint32Array.BYTES_PER_ELEMENT),s=a[ls];if(s&cs){const r=a[ss.FOURCC];if(r!==ys){const t=ms[r],a=new Uint8Array(e,ts+rs);return[new es(a,{format:t,width:i,height:n,levels:o})]}const s=ts+rs,u=new Uint32Array(t.buffer,s,is/Uint32Array.BYTES_PER_ELEMENT),l=u[us.DXGI_FORMAT],h=u[us.RESOURCE_DIMENSION],c=u[us.MISC_FLAG],d=u[us.ARRAY_SIZE],f=ws[l];if(void 0===f)throw new Error(`DDSParser cannot parse texture data with DXGI format ${l}`);if(c===gs)throw new Error("DDSParser does not support cubemap textures");if(6===h)throw new Error("DDSParser does not supported 3D texture data");const p=new Array,y=ts+rs+is;if(1===d)p.push(new Uint8Array(e,y));else{const t=Ka[f];let r=0,a=i,s=n;for(let e=0;e<o;e++){r+=Math.max(1,a+3&-4)*Math.max(1,s+3&-4)*t,a>>>=1,s>>>=1}let u=y;for(let t=0;t<d;t++)p.push(new Uint8Array(e,u,r)),u+=r}return p.map((e=>new es(e,{format:f,width:i,height:n,levels:o})))}throw s&ds?new Error("DDSParser does not support uncompressed texture data."):s&fs?new Error("DDSParser does not supported YUV uncompressed texture data."):s&ps?new Error("DDSParser does not support single-channel (lumninance) texture data!"):s&hs?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const vs=[171,75,84,88,32,49,49,187,13,10,26,10],xs=67305985,_s={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Is=64,As={[j.UNSIGNED_BYTE]:1,[j.UNSIGNED_SHORT]:2,[j.INT]:4,[j.UNSIGNED_INT]:4,[j.FLOAT]:4,[j.HALF_FLOAT]:8},Ss={[N.RGBA]:4,[N.RGB]:3,[N.RG]:2,[N.RED]:1,[N.LUMINANCE]:1,[N.LUMINANCE_ALPHA]:2,[N.ALPHA]:1},Ts={[j.UNSIGNED_SHORT_4_4_4_4]:2,[j.UNSIGNED_SHORT_5_5_5_1]:2,[j.UNSIGNED_SHORT_5_6_5]:2};function Cs(e,t,r=!1){const n=new DataView(t);if(!function(e,t){for(let r=0;r<vs.length;r++)if(t.getUint8(r)!==vs[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}(e,n))return null;const i=n.getUint32(_s.ENDIANNESS,!0)===xs,o=n.getUint32(_s.GL_TYPE,i),a=n.getUint32(_s.GL_FORMAT,i),s=n.getUint32(_s.GL_INTERNAL_FORMAT,i),u=n.getUint32(_s.PIXEL_WIDTH,i),l=n.getUint32(_s.PIXEL_HEIGHT,i)||1,h=n.getUint32(_s.PIXEL_DEPTH,i)||1,c=n.getUint32(_s.NUMBER_OF_ARRAY_ELEMENTS,i)||1,d=n.getUint32(_s.NUMBER_OF_FACES,i),f=n.getUint32(_s.NUMBER_OF_MIPMAP_LEVELS,i),p=n.getUint32(_s.BYTES_OF_KEY_VALUE_DATA,i);if(0===l||1!==h)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==c)throw new Error("WebGL does not support array textures");const y=u+3&-4,g=l+3&-4,m=new Array(c);let w,b=u*l;if(0===o&&(b=y*g),w=0!==o?As[o]?As[o]*Ss[a]:Ts[o]:Ka[s],void 0===w)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const v=r?function(e,t,r){const n=new Map;let i=0;for(;i<t;){const o=e.getUint32(Is+i,r),a=Is+i+4,s=3-(o+3)%4;if(0===o||o>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let u=0;for(;u<o&&0!==e.getUint8(a+u);u++);if(-1===u){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const l=(new TextDecoder).decode(new Uint8Array(e.buffer,a,u)),h=new DataView(e.buffer,a+u+1,o-u-1);n.set(l,h),i+=4+o+s}return n}(n,p,i):null;let x=b*w,_=u,I=l,A=y,S=g,T=Is+p;for(let e=0;e<f;e++){const r=n.getUint32(T,i);let a=T+4;for(let r=0;r<c;r++){let n=m[r];n||(n=m[r]=new Array(f)),n[e]={levelID:e,levelWidth:f>1||0!==o?_:A,levelHeight:f>1||0!==o?I:S,levelBuffer:new Uint8Array(t,a,x)},a+=x}T+=r+4,T=T%4!=0?T+4-T%4:T,_=_>>1||1,I=I>>1||1,A=_+4-1&-4,S=I+4-1&-4,x=A*S*w}return 0!==o?{uncompressed:m.map((e=>{let t=e[0].levelBuffer,r=!1;return o===j.FLOAT?t=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):o===j.UNSIGNED_INT?(r=!0,t=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):o===j.INT&&(r=!0,t=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new ar(t,{width:e[0].levelWidth,height:e[0].levelHeight}),type:o,format:r?Es(a):a}})),kvData:v}:{compressed:m.map((e=>new es(null,{format:s,width:u,height:l,levels:f,levelBuffers:e}))),kvData:v}}function Es(e){switch(e){case N.RGBA:return N.RGBA_INTEGER;case N.RGB:return N.RGB_INTEGER;case N.RG:return N.RG_INTEGER;case N.RED:return N.RED_INTEGER;default:return e}}const Os={extension:{type:Yt.LoadParser,priority:ra.High},name:"loadDDS",test:e=>qo(e,".dds"),async load(e,t,r){const n=bs(await(await te.ADAPTER.fetch(e)).arrayBuffer()).map((n=>va(new lr(n,{mipmap:H.OFF,alphaMode:W.NO_PREMULTIPLIED_ALPHA,resolution:Wt(e),...t.data}),r,e)));return 1===n.length?n[0]:n},unload(e){Array.isArray(e)?e.forEach((e=>e.destroy(!0))):e.destroy(!0)}};Zt.add(Os);const ks={extension:{type:Yt.LoadParser,priority:ra.High},name:"loadKTX",test:e=>qo(e,".ktx"),async load(e,t,r){const n=await(await te.ADAPTER.fetch(e)).arrayBuffer(),{compressed:i,uncompressed:o,kvData:a}=Cs(e,n),s=i??o,u={mipmap:H.OFF,alphaMode:W.NO_PREMULTIPLIED_ALPHA,resolution:Wt(e),...t.data},l=s.map((t=>{s===o&&Object.assign(u,{type:t.type,format:t.format});const n=t.resource??t,i=new lr(n,u);return i.ktxKeyValueData=a,va(i,r,e)}));return 1===l.length?l[0]:l},unload(e){Array.isArray(e)?e.forEach((e=>e.destroy(!0))):e.destroy(!0)}};Zt.add(ks);const Ps={extension:Yt.ResolveParser,test:e=>{const t=Ee.extname(e).slice(1);return["basis","ktx","dds"].includes(t)},parse:e=>{const t=Ee.extname(e).slice(1);if("ktx"===t){const t=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx",".bptc.ktx"];if(t.some((t=>e.endsWith(t))))return{resolution:parseFloat(te.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t.find((t=>e.endsWith(t))),src:e}}return{resolution:parseFloat(te.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t,src:e}}};Zt.add(Ps);const $s=new Tr,Rs=class e{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){const e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,r,n){const i=new Image;return i.src=await this.base64(e,t,r,n),i}async base64(e,t,r,n){const i=this.canvas(e,n);if(void 0!==i.toBlob)return new Promise(((e,n)=>{i.toBlob((t=>{if(!t)return void n(new Error("ICanvas.toBlob failed!"));const r=new FileReader;r.onload=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}),t,r)}));if(void 0!==i.toDataURL)return i.toDataURL(t,r);if(void 0!==i.convertToBlob){const e=await i.convertToBlob({type:t,quality:r});return new Promise(((t,r)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,r){const{pixels:n,width:i,height:o,flipY:a,premultipliedAlpha:s}=this._rawPixels(t,r);a&&e._flipY(n,i,o),s&&e._unpremultiplyAlpha(n);const u=new Nt(i,o,1),l=new ImageData(new Uint8ClampedArray(n.buffer),i,o);return u.context.putImageData(l,0,0),u.canvas}pixels(t,r){const{pixels:n,width:i,height:o,flipY:a,premultipliedAlpha:s}=this._rawPixels(t,r);return a&&e._flipY(n,i,o),s&&e._unpremultiplyAlpha(n),n}_rawPixels(e,t){const r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let n,i,o=!1,a=!1,s=!1;e&&(e instanceof On?i=e:(i=r.generateTexture(e,{region:t,resolution:r.resolution,multisample:r.multisample}),s=!0,t&&($s.width=t.width,$s.height=t.height,t=$s)));const u=r.gl;if(i){if(n=i.baseTexture.resolution,t=t??i.frame,o=!1,a=i.baseTexture.alphaMode>0&&i.baseTexture.format===N.RGBA,!s){r.renderTexture.bind(i);const e=i.framebuffer.glFramebuffers[r.CONTEXT_UID];e.blitFramebuffer&&r.framebuffer.bind(e.blitFramebuffer)}}else n=r.resolution,t||((t=$s).width=r.width/n,t.height=r.height/n),o=!0,a=this._rendererPremultipliedAlpha,r.renderTexture.bind();const l=Math.max(Math.round(t.width*n),1),h=Math.max(Math.round(t.height*n),1),c=new Uint8Array(4*l*h);return u.readPixels(Math.round(t.x*n),Math.round(t.y*n),l,h,u.RGBA,u.UNSIGNED_BYTE,c),s&&i?.destroy(!0),{pixels:c,width:l,height:h,flipY:o,premultipliedAlpha:a}}destroy(){this.renderer=null}static _flipY(e,t,r){const n=t<<2,i=r>>1,o=new Uint8Array(n);for(let t=0;t<i;t++){const i=t*n,a=(r-t-1)*n;o.set(e.subarray(i,i+n)),e.copyWithin(i,a,a+n),e.set(o,a)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let r=0;r<t;r+=4){const t=e[r+3];if(0!==t){const n=255.001/t;e[r]=e[r]*n+.5,e[r+1]=e[r+1]*n+.5,e[r+2]=e[r+2]*n+.5}}}};Rs.extension={name:"extract",type:Yt.RendererSystem};let Bs=Rs;Zt.add(Bs);const Ds={build(e){const t=e.points;let r,n,i,o,a,s;if(e.type===Ir.CIRC){const t=e.shape;r=t.x,n=t.y,a=s=t.radius,i=o=0}else if(e.type===Ir.ELIP){const t=e.shape;r=t.x,n=t.y,a=t.width,s=t.height,i=o=0}else{const t=e.shape,u=t.width/2,l=t.height/2;r=t.x+u,n=t.y+l,a=s=Math.max(0,Math.min(t.radius,Math.min(u,l))),i=u-a,o=l-s}if(!(a>=0&&s>=0&&i>=0&&o>=0))return void(t.length=0);const u=Math.ceil(2.3*Math.sqrt(a+s)),l=8*u+(i?4:0)+(o?4:0);if(t.length=l,0===l)return;if(0===u)return t.length=8,t[0]=t[6]=r+i,t[1]=t[3]=n+o,t[2]=t[4]=r-i,void(t[5]=t[7]=n-o);let h=0,c=4*u+(i?2:0)+2,d=c,f=l;{const e=i+a,s=o,u=r+e,l=r-e,p=n+s;if(t[h++]=u,t[h++]=p,t[--c]=p,t[--c]=l,o){const e=n-s;t[d++]=l,t[d++]=e,t[--f]=e,t[--f]=u}}for(let e=1;e<u;e++){const l=Math.PI/2*(e/u),p=i+Math.cos(l)*a,y=o+Math.sin(l)*s,g=r+p,m=r-p,w=n+y,b=n-y;t[h++]=g,t[h++]=w,t[--c]=w,t[--c]=m,t[d++]=m,t[d++]=b,t[--f]=b,t[--f]=g}{const e=o+s,a=r+i,u=r-i,l=n+e,c=n-e;t[h++]=a,t[h++]=l,t[--f]=c,t[--f]=a,i&&(t[h++]=u,t[h++]=l,t[--f]=c,t[--f]=u)}},triangulate(e,t){const r=e.points,n=t.points,i=t.indices;if(0===r.length)return;let o=n.length/2;const a=o;let s,u;if(e.type!==Ir.RREC){const t=e.shape;s=t.x,u=t.y}else{const t=e.shape;s=t.x+t.width/2,u=t.y+t.height/2}const l=e.matrix;n.push(e.matrix?l.a*s+l.c*u+l.tx:s,e.matrix?l.b*s+l.d*u+l.ty:u),o++,n.push(r[0],r[1]);for(let e=2;e<r.length;e+=2)n.push(r[e],r[e+1]),i.push(o++,a,o);i.push(a+1,a,o)}};function Ms(e,t=!1){const r=e.length;if(r<6)return;let n=0;for(let t=0,i=e[r-2],o=e[r-1];t<r;t+=2){const r=e[t],a=e[t+1];n+=(r-i)*(a+o),i=r,o=a}if(!t&&n>0||t&&n<=0){const t=r/2;for(let n=t+t%2;n<r;n+=2){const t=r-n-2,i=r-n-1,o=n,a=n+1;[e[t],e[o]]=[e[o],e[t]],[e[i],e[a]]=[e[a],e[i]]}}}const Ls={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points;const n=e.holes,i=t.points,o=t.indices;if(r.length>=6){Ms(r,!1);const e=[];for(let t=0;t<n.length;t++){const i=n[t];Ms(i.points,!0),e.push(r.length/2),r=r.concat(i.points)}const t=xe(r,e,2);if(!t)return;const a=i.length/2;for(let e=0;e<t.length;e+=3)o.push(t[e]+a),o.push(t[e+1]+a),o.push(t[e+2]+a);for(let e=0;e<r.length;e++)i.push(r[e])}}},Fs={build(e){const t=e.shape,r=t.x,n=t.y,i=t.width,o=t.height,a=e.points;a.length=0,i>=0&&o>=0&&a.push(r,n,r+i,n,r+i,n+o,r,n+o)},triangulate(e,t){const r=e.points,n=t.points;if(0===r.length)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Ns={build(e){Ds.build(e)},triangulate(e,t){Ds.triangulate(e,t)}};var Us=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(Us||{}),js=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(js||{});const Gs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},zs=Gs;class Vs{static curveTo(e,t,r,n,i,o){const a=o[o.length-2],s=o[o.length-1]-t,u=a-e,l=n-t,h=r-e,c=Math.abs(s*h-u*l);if(c<1e-8||0===i)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;const d=s*s+u*u,f=l*l+h*h,p=s*l+u*h,y=i*Math.sqrt(d)/c,g=i*Math.sqrt(f)/c,m=y*p/d,w=g*p/f,b=y*h+g*u,v=y*l+g*s,x=u*(g+m),_=s*(g+m),I=h*(y+w),A=l*(y+w);return{cx:b+e,cy:v+t,radius:i,startAngle:Math.atan2(_-v,x-b),endAngle:Math.atan2(A-v,I-b),anticlockwise:u*l>h*s}}static arc(e,t,r,n,i,o,a,s,u){const l=a-o,h=Gs._segmentsCount(Math.abs(l)*i,40*Math.ceil(Math.abs(l)/vr)),c=l/(2*h),d=2*c,f=Math.cos(c),p=Math.sin(c),y=h-1,g=y%1/y;for(let e=0;e<=y;++e){const t=c+o+d*(e+g*e),a=Math.cos(t),s=-Math.sin(t);u.push((f*a+p*s)*i+r,(f*-s+p*a)*i+n)}}}class Hs{static curveLength(e,t,r,n,i,o,a,s){let u=0,l=0,h=0,c=0,d=0,f=0,p=0,y=0,g=0,m=0,w=0,b=e,v=t;for(let x=1;x<=10;++x)l=x/10,h=l*l,c=h*l,d=1-l,f=d*d,p=f*d,y=p*e+3*f*l*r+3*d*h*i+c*a,g=p*t+3*f*l*n+3*d*h*o+c*s,m=b-y,w=v-g,b=y,v=g,u+=Math.sqrt(m*m+w*w);return u}static curveTo(e,t,r,n,i,o,a){const s=a[a.length-2],u=a[a.length-1];a.length-=2;const l=Gs._segmentsCount(Hs.curveLength(s,u,e,t,r,n,i,o));let h=0,c=0,d=0,f=0,p=0;a.push(s,u);for(let y=1,g=0;y<=l;++y)g=y/l,h=1-g,c=h*h,d=c*h,f=g*g,p=f*g,a.push(d*s+3*c*g*e+3*h*f*r+p*i,d*u+3*c*g*t+3*h*f*n+p*o)}}function Ws(e,t,r,n,i,o,a,s){let u,l;a?(u=n,l=-r):(u=-n,l=r);const h=e-r*i+u,c=t-n*i+l,d=e+r*o+u,f=t+n*o+l;return s.push(h,c,d,f),2}function Ys(e,t,r,n,i,o,a,s){const u=r-e,l=n-t;let h=Math.atan2(u,l),c=Math.atan2(i-e,o-t);s&&h<c?h+=2*Math.PI:!s&&h>c&&(c+=2*Math.PI);let d=h;const f=c-h,p=Math.abs(f),y=Math.sqrt(u*u+l*l),g=1+(15*p*Math.sqrt(y)/Math.PI>>0),m=f/g;if(d+=m,s){a.push(e,t,r,n);for(let r=1,n=d;r<g;r++,n+=m)a.push(e,t,e+Math.sin(n)*y,t+Math.cos(n)*y);a.push(e,t,i,o)}else{a.push(r,n,e,t);for(let r=1,n=d;r<g;r++,n+=m)a.push(e+Math.sin(n)*y,t+Math.cos(n)*y,e,t);a.push(i,o,e,t)}return 2*g}function Ks(e,t){e.lineStyle.native?function(e,t){let r=0;const n=e.shape,i=e.points||n.points,o=n.type!==Ir.POLY||n.closeStroke;if(0===i.length)return;const a=t.points,s=t.indices,u=i.length/2,l=a.length/2;let h=l;for(a.push(i[0],i[1]),r=1;r<u;r++)a.push(i[2*r],i[2*r+1]),s.push(h,h+1),h++;o&&s.push(h,l)}(e,t):function(e,t){const r=e.shape;let n=e.points||r.points.slice();const i=t.closePointEps;if(0===n.length)return;const o=e.lineStyle,a=new Ar(n[0],n[1]),s=new Ar(n[n.length-2],n[n.length-1]),u=r.type!==Ir.POLY||r.closeStroke,l=Math.abs(a.x-s.x)<i&&Math.abs(a.y-s.y)<i;if(u){n=n.slice(),l&&(n.pop(),n.pop(),s.set(n[n.length-2],n[n.length-1]));const e=.5*(a.x+s.x),t=.5*(s.y+a.y);n.unshift(e,t),n.push(e,t)}const h=t.points,c=n.length/2;let d=n.length;const f=h.length/2,p=o.width/2,y=p*p,g=o.miterLimit*o.miterLimit;let m=n[0],w=n[1],b=n[2],v=n[3],x=0,_=0,I=-(w-v),A=m-b,S=0,T=0,C=Math.sqrt(I*I+A*A);I/=C,A/=C,I*=p,A*=p;const E=o.alignment,O=2*(1-E),k=2*E;u||(o.cap===js.ROUND?d+=Ys(m-I*(O-k)*.5,w-A*(O-k)*.5,m-I*O,w-A*O,m+I*k,w+A*k,h,!0)+2:o.cap===js.SQUARE&&(d+=Ws(m,w,I,A,O,k,!0,h))),h.push(m-I*O,w-A*O,m+I*k,w+A*k);for(let e=1;e<c-1;++e){m=n[2*(e-1)],w=n[2*(e-1)+1],b=n[2*e],v=n[2*e+1],x=n[2*(e+1)],_=n[2*(e+1)+1],I=-(w-v),A=m-b,C=Math.sqrt(I*I+A*A),I/=C,A/=C,I*=p,A*=p,S=-(v-_),T=b-x,C=Math.sqrt(S*S+T*T),S/=C,T/=C,S*=p,T*=p;const t=b-m,r=w-v,i=b-x,a=_-v,s=t*i+r*a,u=r*i-a*t,l=u<0;if(Math.abs(u)<.001*Math.abs(s)){h.push(b-I*O,v-A*O,b+I*k,v+A*k),s>=0&&(o.join===Us.ROUND?d+=Ys(b,v,b-I*O,v-A*O,b-S*O,v-T*O,h,!1)+4:d+=2,h.push(b-S*k,v-T*k,b+S*O,v+T*O));continue}const c=(-I+m)*(-A+v)-(-I+b)*(-A+w),f=(-S+x)*(-T+v)-(-S+b)*(-T+_),E=(t*f-i*c)/u,P=(a*c-r*f)/u,$=(E-b)*(E-b)+(P-v)*(P-v),R=b+(E-b)*O,B=v+(P-v)*O,D=b-(E-b)*k,M=v-(P-v)*k,L=l?O:k,F=$<=Math.min(t*t+r*r,i*i+a*a)+L*L*y;let N=o.join;if(N===Us.MITER&&$/y>g&&(N=Us.BEVEL),F)switch(N){case Us.MITER:h.push(R,B,D,M);break;case Us.BEVEL:l?h.push(R,B,b+I*k,v+A*k,R,B,b+S*k,v+T*k):h.push(b-I*O,v-A*O,D,M,b-S*O,v-T*O,D,M),d+=2;break;case Us.ROUND:l?(h.push(R,B,b+I*k,v+A*k),d+=Ys(b,v,b+I*k,v+A*k,b+S*k,v+T*k,h,!0)+4,h.push(R,B,b+S*k,v+T*k)):(h.push(b-I*O,v-A*O,D,M),d+=Ys(b,v,b-I*O,v-A*O,b-S*O,v-T*O,h,!1)+4,h.push(b-S*O,v-T*O,D,M))}else{switch(h.push(b-I*O,v-A*O,b+I*k,v+A*k),N){case Us.MITER:l?h.push(D,M,D,M):h.push(R,B,R,B),d+=2;break;case Us.ROUND:d+=l?Ys(b,v,b+I*k,v+A*k,b+S*k,v+T*k,h,!0)+2:Ys(b,v,b-I*O,v-A*O,b-S*O,v-T*O,h,!1)+2}h.push(b-S*O,v-T*O,b+S*k,v+T*k),d+=2}}m=n[2*(c-2)],w=n[2*(c-2)+1],b=n[2*(c-1)],v=n[2*(c-1)+1],I=-(w-v),A=m-b,C=Math.sqrt(I*I+A*A),I/=C,A/=C,I*=p,A*=p,h.push(b-I*O,v-A*O,b+I*k,v+A*k),u||(o.cap===js.ROUND?d+=Ys(b-I*(O-k)*.5,v-A*(O-k)*.5,b-I*O,v-A*O,b+I*k,v+A*k,h,!1)+2:o.cap===js.SQUARE&&(d+=Ws(b,v,I,A,O,k,!1,h)));const P=t.indices,$=Gs.epsilon*Gs.epsilon;for(let e=f;e<d+f-2;++e)m=h[2*e],w=h[2*e+1],b=h[2*(e+1)],v=h[2*(e+1)+1],x=h[2*(e+2)],_=h[2*(e+2)+1],!(Math.abs(m*(v-_)+b*(_-w)+x*(w-v))<$)&&P.push(e,e+1,e+2)}(e,t)}class Xs{static curveLength(e,t,r,n,i,o){const a=e-2*r+i,s=t-2*n+o,u=2*r-2*e,l=2*n-2*t,h=4*(a*a+s*s),c=4*(a*u+s*l),d=u*u+l*l,f=2*Math.sqrt(h+c+d),p=Math.sqrt(h),y=2*h*p,g=2*Math.sqrt(d),m=c/p;return(y*f+p*c*(f-g)+(4*d*h-c*c)*Math.log((2*p+m+f)/(m+g)))/(4*y)}static curveTo(e,t,r,n,i){const o=i[i.length-2],a=i[i.length-1],s=Gs._segmentsCount(Xs.curveLength(o,a,e,t,r,n));let u=0,l=0;for(let h=1;h<=s;++h){const c=h/s;u=o+(e-o)*c,l=a+(t-a)*c,i.push(u+(e+(r-e)*c-u)*c,l+(t+(n-t)*c-l)*c)}}}const Zs={[Ir.POLY]:Ls,[Ir.CIRC]:Ds,[Ir.ELIP]:Ds,[Ir.RECT]:Fs,[Ir.RREC]:Ns},qs=[],Js=[];class Qs{constructor(e,t=null,r=null,n=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=n,this.type=e.type}clone(){return new Qs(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class eu{constructor(){this.reset()}begin(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const tu=new Ar,ru=class e extends br{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new uo,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Js.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),qs.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,n=null){const i=new Qs(e,t,r,n);return this.graphicsData.push(i),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const r=new Qs(e,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=n.lineStyle,n.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let r=0;r<t.length;++r){const n=t[r];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(e,tu):tu.copyFrom(e),n.shape.contains(tu.x,tu.y))){let e=!1;if(n.holes)for(let t=0;t<n.holes.length;t++)if(n.holes[t].shape.contains(tu.x,tu.y)){e=!0;break}if(!e)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let r=null,n=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],n=r.style);for(let i=this.shapeIndex;i<t.length;i++){this.shapeIndex++;const o=t[i],a=o.fillStyle,s=o.lineStyle;Zs[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(a.visible||s.visible)&&this.processHoles(o.holes);for(let t=0;t<2;t++){const i=0===t?a:s;if(!i.visible)continue;const u=i.texture.baseTexture,l=this.indices.length,h=this.points.length/2;u.wrapMode=V.REPEAT,0===t?this.processFill(o):this.processLine(o);const c=this.points.length/2-h;0!==c&&(r&&!this._compareStyles(n,i)&&(r.end(l,h),r=null),r||(r=qs.pop()||new eu,r.begin(i,l,h),this.batches.push(r),n=i),this.addUvs(this.points,e,i.texture,h,c,i.matrix))}}const i=this.indices.length,o=this.points.length/2;if(r&&r.end(i,o),0===this.batches.length)return void(this.batchable=!0);const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const t=this.graphicsData[e],r=t.fillStyle,n=t.lineStyle;if(r&&!r.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,r=e.length;t<r;t++){const r=e[t];for(let e=0;e<r.size;e++){const t=r.start+e;this.indicesUint16[t]=this.indicesUint16[t]-r.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE}buildDrawCalls(){let e=++lr._globalBatch;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Js.push(this.drawCalls[e]);this.drawCalls.length=0;const t=this.colors,r=this.textureIds;let n=Js.pop();n||(n=new hr,n.texArray=new cn),n.texArray.count=0,n.start=0,n.size=0,n.type=F.TRIANGLES;let i=0,o=null,a=0,s=!1,u=F.TRIANGLES,l=0;this.drawCalls.push(n);for(let h=0;h<this.batches.length;h++){const c=this.batches[h],d=8,f=c.style,p=f.texture.baseTexture;s!==!!f.native&&(s=!!f.native,u=s?F.LINES:F.TRIANGLES,o=null,i=d,e++),o!==p&&(o=p,p._batchEnabled!==e&&(i===d&&(e++,i=0,n.size>0&&(n=Js.pop(),n||(n=new hr,n.texArray=new cn),this.drawCalls.push(n)),n.start=l,n.size=0,n.texArray.count=0,n.type=u),p.touched=1,p._batchEnabled=e,p._batchLocation=i,p.wrapMode=V.REPEAT,n.texArray.elements[n.texArray.count++]=p,i++)),n.size+=c.size,l+=c.size,a=p._batchLocation,this.addColors(t,f.color,f.alpha,c.attribSize,c.attribStart),this.addTextureIds(r,a,c.attribSize,c.attribStart)}lr._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,r=this.colors,n=this.textureIds,i=new ArrayBuffer(3*e.length*4),o=new Float32Array(i),a=new Uint32Array(i);let s=0;for(let i=0;i<e.length/2;i++)o[s++]=e[2*i],o[s++]=e[2*i+1],o[s++]=t[2*i],o[s++]=t[2*i+1],a[s++]=r[i],o[s++]=n[i];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?Ls.triangulate(e,this):Zs[e.type].triangulate(e,this)}processLine(e){Ks(e,this);for(let t=0;t<e.holes.length;t++)Ks(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const r=e[t];Zs[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){const n=e[2*r],i=e[2*r+1];e[2*r]=t.a*n+t.c*i+t.tx,e[2*r+1]=t.b*n+t.d*i+t.ty}}addColors(e,t,r,n,i=0){const o=ht.shared.setValue(t).toLittleEndianNumber(),a=ht.shared.setValue(o).toPremultiplied(r);e.length=Math.max(e.length,i+n);for(let t=0;t<n;t++)e[i+t]=a}addTextureIds(e,t,r,n=0){e.length=Math.max(e.length,n+r);for(let i=0;i<r;i++)e[n+i]=t}addUvs(e,t,r,n,i,o=null){let a=0;const s=t.length,u=r.frame;for(;a<i;){let r=e[2*(n+a)],i=e[2*(n+a)+1];if(o){const e=o.a*r+o.c*i+o.tx;i=o.b*r+o.d*i+o.ty,r=e}a++,t.push(r/u.width,i/u.height)}const l=r.baseTexture;(u.width<l.width||u.height<l.height)&&this.adjustUvs(t,r,s,i)}adjustUvs(e,t,r,n){const i=t.baseTexture,o=1e-6,a=r+2*n,s=t.frame,u=s.width/i.width,l=s.height/i.height;let h=s.x/s.width,c=s.y/s.height,d=Math.floor(e[r]+o),f=Math.floor(e[r+1]+o);for(let t=r+2;t<a;t+=2)d=Math.min(d,Math.floor(e[t]+o)),f=Math.min(f,Math.floor(e[t+1]+o));h-=d,c-=f;for(let t=r;t<a;t+=2)e[t]=(e[t]+h)*u,e[t+1]=(e[t+1]+c)*l}};ru.BATCHABLE_SIZE=100;let nu=ru;class iu{constructor(){this.color=16777215,this.alpha=1,this.texture=En.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new iu;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=En.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ou extends iu{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=js.BUTT,this.join=Us.MITER,this.miterLimit=10}clone(){const e=new ou;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=js.BUTT,this.join=Us.MITER,this.miterLimit=10}}const au={},su=class e extends yo{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new iu,this._lineStyle=new ou,this._matrix=null,this._holeMode=!1,this.state=tr.for2d(),this._geometry=e||new nu,this._geometry.refCount++,this._transformID=-1,this._tintColor=new ht(16777215),this.blendMode=L.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new e(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,n=.5,i=!1){return"number"==typeof e&&(e={width:e,color:t,alpha:r,alignment:n,native:i}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:En.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:js.BUTT,join:Us.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Or,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Or,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,n=r[r.length-2],i=r[r.length-1];return(n!==e||i!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,n){this._initCurve();const i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),Xs.curveTo(e,t,r,n,i),this}bezierCurveTo(e,t,r,n,i,o){return this._initCurve(),Hs.curveTo(e,t,r,n,i,o,this.currentPath.points),this}arcTo(e,t,r,n,i){this._initCurve(e,t);const o=this.currentPath.points,a=Vs.curveTo(e,t,r,n,i,o);if(a){const{cx:e,cy:t,radius:r,startAngle:n,endAngle:i,anticlockwise:o}=a;this.arc(e,t,r,n,i,o)}return this}arc(e,t,r,n,i,o=!1){if(n===i)return this;if(!o&&i<=n?i+=vr:o&&n<=i&&(n+=vr),i-n==0)return this;const a=e+Math.cos(n)*r,s=t+Math.sin(n)*r,u=this._geometry.closePointEps;let l=this.currentPath?this.currentPath.points:null;if(l){const e=Math.abs(l[l.length-2]-a),t=Math.abs(l[l.length-1]-s);e<u&&t<u||l.push(a,s)}else this.moveTo(a,s),l=this.currentPath.points;return Vs.arc(a,s,e,t,r,n,i,o,l),this}beginFill(e=0,t){return this.beginTextureFill({texture:En.WHITE,color:e,alpha:t})}normalizeColor(e){const t=ht.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:En.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,n){return this.drawShape(new Tr(e,t,r,n))}drawRoundedRect(e,t,r,n,i){return this.drawShape(new kr(e,t,r,n,i))}drawCircle(e,t,r){return this.drawShape(new Cr(e,t,r))}drawEllipse(e,t,r,n){return this.drawShape(new Er(e,t,r,n))}drawPolygon(...e){let t,r=!0;const n=e[0];n.points?(r=n.closeStroke,t=n.points):t=Array.isArray(e[0])?e[0]:e;const i=new Or(t);return i.closeStroke=r,this.drawShape(i),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return!(1!==e.length||e[0].shape.type!==Ir.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let n=0;n<r;n++){const r=e.batches[n],i=r.style.color,o=new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),a=new Float32Array(e.uvsFloat32.buffer,4*r.attribStart*2,2*r.attribSize),s={vertexData:o,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,2*r.start,r.size),uvs:a,_batchRGB:ht.shared.setValue(i).toRgbArray(),_tintRGB:i,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[n]=s}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){const r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}_renderDirect(e){const t=this._resolveDirectShader(e),r=this._geometry,n=this.worldAlpha,i=t.uniforms,o=r.drawCalls;i.translationMatrix=this.transform.worldTransform,ht.shared.setValue(this._tintColor).premultiply(n).toArray(i.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let t=0,n=o.length;t<n;t++)this._renderDrawCallDirect(e,r.drawCalls[t])}_renderDrawCallDirect(e,t){const{texArray:r,type:n,size:i,start:o}=t,a=r.count;for(let t=0;t<a;t++)e.texture.bind(r.elements[t],t);e.geometry.draw(n,i,o)}_resolveDirectShader(e){let t=this.shader;const r=this.pluginName;if(!t){if(!au[r]){const{maxTextures:t}=e.plugins[r],n=new Int32Array(t);for(let e=0;e<t;e++)n[e]=e;const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pr,default:un.from({uSamplers:n},!0)},o=e.plugins[r]._shader.program;au[r]=new ln(o,i)}t=au[r]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:r,maxX:n,maxY:i}=e.bounds;this._bounds.addFrame(this.transform,t,r,n,i)}containsPoint(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=ht.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,u=this._geometry.points,l=this.vertexData;let h=0;for(let e=0;e<u.length;e+=2){const t=u[e],c=u[e+1];l[h++]=r*t+i*c+a,l[h++]=o*c+n*t+s}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};su.curves=Gs,su._TEMP_POINT=new Ar;let uu=su;const lu={buildPoly:Ls,buildCircle:Ds,buildRectangle:Fs,buildRoundedRectangle:Ns,buildLine:Ks,ArcUtils:Vs,BezierUtils:Hs,QuadraticUtils:Xs,BatchPart:eu,FILL_COMMANDS:Zs,BATCH_POOL:qs,DRAW_CALL_POOL:Js};class hu{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const cu=new Ar,du=new Or,fu=class e extends yo{constructor(e,t,r,n=F.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||tr.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=te.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(t){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===F.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const n=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[n]),e.plugins[n].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,r=e._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const n=this.transform.worldTransform,i=n.a,o=n.b,a=n.c,s=n.d,u=n.tx,l=n.ty,h=this.vertexData;for(let e=0;e<h.length/2;e++){const r=t[2*e],n=t[2*e+1];h[2*e]=i*r+a*n+u,h[2*e+1]=o*r+s*n+l}if(this._roundPixels){const e=te.RESOLUTION;for(let t=0;t<h.length;++t)h[t]=Math.round(h[t]*e)/e}this.vertexDirty=r}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new hu(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,cu);const t=this.geometry.getBuffer("aVertexPosition").data,r=du.points,n=this.geometry.getIndex().data,i=n.length,o=4===this.drawMode?3:1;for(let e=0;e+2<i;e+=o){const i=2*n[e],o=2*n[e+1],a=2*n[e+2];if(r[0]=t[i],r[1]=t[i+1],r[2]=t[o],r[3]=t[o+1],r[4]=t[a],r[5]=t[a+1],du.contains(cu.x,cu.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};fu.BATCHABLE_SIZE=100;let pu=fu;class yu extends wr{constructor(e,t,r){super();const n=new dr(e),i=new dr(t,!0),o=new dr(r,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,j.FLOAT).addAttribute("aTextureCoord",i,2,!1,j.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class gu extends ln{constructor(e,t){const r={uSampler:e,alpha:1,uTextureMatrix:Pr.IDENTITY,uColor:new Float32Array([1,1,1,1])};(t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t)).uniforms&&Object.assign(r,t.uniforms),super(t.program||an.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r),this._colorDirty=!1,this.uvMatrix=new zn(e),this.batchable=void 0===t.program,this.pluginName=t.pluginName,this._tintColor=new ht(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;ht.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class mu extends yu{constructor(e=100,t=100,r=10,n=10){super(),this.segWidth=r,this.segHeight=n,this.width=e,this.height=t,this.build()}build(){const e=this.segWidth*this.segHeight,t=[],r=[],n=[],i=this.segWidth-1,o=this.segHeight-1,a=this.width/i,s=this.height/o;for(let n=0;n<e;n++){const e=n%this.segWidth,u=n/this.segWidth|0;t.push(e*a,u*s),r.push(e/i,u/o)}const u=i*o;for(let e=0;e<u;e++){const t=e%i,r=e/i|0,o=r*this.segWidth+t,a=r*this.segWidth+t+1,s=(r+1)*this.segWidth+t,u=(r+1)*this.segWidth+t+1;n.push(o,a,s,a,u,s)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class wu extends yu{constructor(e=200,t,r=0){super(new Float32Array(4*t.length),new Float32Array(4*t.length),new Uint16Array(6*(t.length-1))),this.points=t,this._width=e,this.textureScale=r,this.build()}get width(){return this._width}build(){const e=this.points;if(!e)return;const t=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),n=this.getIndex();if(e.length<1)return;t.data.length/4!==e.length&&(t.data=new Float32Array(4*e.length),r.data=new Float32Array(4*e.length),n.data=new Uint16Array(6*(e.length-1)));const i=r.data,o=n.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;let a=0,s=e[0];const u=this._width*this.textureScale,l=e.length;for(let t=0;t<l;t++){const r=4*t;if(this.textureScale>0){const r=s.x-e[t].x,n=s.y-e[t].y,i=Math.sqrt(r*r+n*n);s=e[t],a+=i/u}else a=t/(l-1);i[r]=a,i[r+1]=0,i[r+2]=a,i[r+3]=1}let h=0;for(let e=0;e<l-1;e++){const t=2*e;o[h++]=t,o[h++]=t+1,o[h++]=t+2,o[h++]=t+2,o[h++]=t+1,o[h++]=t+3}r.update(),n.update(),this.updateVertices()}updateVertices(){const e=this.points;if(e.length<1)return;let t,r=e[0],n=0,i=0;const o=this.buffers[0].data,a=e.length,s=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let u=0;u<a;u++){const l=e[u],h=4*u;t=u<e.length-1?e[u+1]:l,i=-(t.x-r.x),n=t.y-r.y;let c=10*(1-u/(a-1));c>1&&(c=1);const d=Math.sqrt(n*n+i*i);d<1e-6?(n=0,i=0):(n/=d,i/=d,n*=s,i*=s),o[h]=l.x+n,o[h+1]=l.y+i,o[h+2]=l.x-n,o[h+3]=l.y-i,r=l}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class bu extends pu{constructor(e,t,r){super(new mu(e.width,e.height,t,r),new gu(En.WHITE)),this.texture=e,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const e=this.geometry,{width:t,height:r}=this.shader.texture;this.autoResize&&(e.width!==t||e.height!==r)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())}set texture(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(e)}destroy(e){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(e)}}class vu extends bu{constructor(e,t,r,n,i){super(En.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=t??e.defaultBorders?.left??10,this._rightWidth=n??e.defaultBorders?.right??10,this._topHeight=r??e.defaultBorders?.top??10,this._bottomHeight=i??e.defaultBorders?.bottom??10,this.texture=e}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}updateHorizontalVertices(){const e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height}updateVerticalVertices(){const e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width}_getMinScale(){const e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,r=this._topHeight+this._bottomHeight,n=this._height>r?1:this._height/r;return Math.min(t,n)}get width(){return this._width}set width(e){this._width=e,this._refresh()}get height(){return this._height}set height(e){this._height=e,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this._refresh()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this._refresh()}_refresh(){const e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;const r=1/this._origWidth,n=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=r*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-r*this._rightWidth,t[9]=t[11]=t[13]=t[15]=n*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class xu extends pu{constructor(e=En.EMPTY,t,r,n,i){const o=new yu(t,r,n);o.getBuffer("aVertexPosition").static=!1;super(o,new gu(e),null,i),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}_render(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(e)}}class _u extends pu{constructor(e,t,r=0){const n=new wu(e.height,t,r),i=new gu(e);r>0&&(e.baseTexture.wrapMode=V.REPEAT),super(n,i),this.autoUpdate=!0}_render(e){const t=this.geometry;(this.autoUpdate||t._width!==this.shader.texture.height)&&(t._width=this.shader.texture.height,t.update()),super._render(e)}}class Iu extends yo{constructor(e=1500,t,r=16384,n=!1){super();r>16384&&(r=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=r,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=L.NORMAL,this.autoResize=n,this.roundPixels=!0,this.baseTexture=null,this.setProperties(t),this._tintColor=new ht(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb)}render(e){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(()=>this.onChildrenChange(0)))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))}onChildrenChange(e){const t=Math.floor(e/this._batchSize);for(;this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID}dispose(){if(this._buffers){for(let e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}}destroy(e){super.destroy(e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class Au{constructor(e,t,r){this.geometry=new wr,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let n=e[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||j.FLOAT,offset:n.offset},t[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new dr(xt(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let e=0;e<this.dynamicProperties.length;++e){const r=this.dynamicProperties[e];r.offset=t,t+=r.size,this.dynamicStride+=r.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new dr(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let e=0;e<this.staticProperties.length;++e){const t=this.staticProperties[e];t.offset=n,n+=t.size,this.staticStride+=t.size}const i=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(i),this.staticDataUint32=new Uint32Array(i),this.staticBuffer=new dr(this.staticData,!0,!1);for(let t=0;t<this.dynamicProperties.length;++t){const r=this.dynamicProperties[t];e.addAttribute(r.attributeName,this.dynamicBuffer,0,r.type===j.UNSIGNED_BYTE,r.type,4*this.dynamicStride,4*r.offset)}for(let t=0;t<this.staticProperties.length;++t){const r=this.staticProperties[t];e.addAttribute(r.attributeName,this.staticBuffer,0,r.type===j.UNSIGNED_BYTE,r.type,4*this.staticStride,4*r.offset)}}uploadDynamic(e,t,r){for(let n=0;n<this.dynamicProperties.length;n++){const i=this.dynamicProperties[n];i.uploadFunction(e,t,r,i.type===j.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,r){for(let n=0;n<this.staticProperties.length;n++){const i=this.staticProperties[n];i.uploadFunction(e,t,r,i.type===j.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class Su extends dn{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Pr,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:j.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=ln.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=tr.for2d()}render(e){const t=e.children,r=e._maxSize,n=e._batchSize,i=this.renderer;let o=t.length;if(0===o)return;o>r&&!e.autoResize&&(o=r);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const s=t[0]._texture.baseTexture,u=s.alphaMode>0;this.state.blendMode=gt(e.blendMode,u),i.state.set(this.state);const l=i.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=ht.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);let c=!1;for(let r=0,s=0;r<o;r+=n,s+=1){let u=o-r;u>n&&(u=n),s>=a.length&&a.push(this._generateOneMoreBuffer(e));const h=a[s];h.uploadDynamic(t,r,u);const d=e._bufferUpdateIDs[s]||0;c=c||h._updateID<d,c&&(h._updateID=e._updateID,h.uploadStatic(t,r,u)),i.geometry.bind(h.geometry),l.drawElements(l.TRIANGLES,6*u,l.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],r=e._maxSize,n=e._batchSize,i=e._properties;for(let e=0;e<r;e+=n)t.push(new Au(this.properties,i,n));return t}_generateOneMoreBuffer(e){const t=e._batchSize,r=e._properties;return new Au(this.properties,r,t)}uploadVertices(e,t,r,n,i,o){let a=0,s=0,u=0,l=0;for(let h=0;h<r;++h){const r=e[t+h],c=r._texture,d=r.scale.x,f=r.scale.y,p=c.trim,y=c.orig;p?(s=p.x-r.anchor.x*y.width,a=s+p.width,l=p.y-r.anchor.y*y.height,u=l+p.height):(a=y.width*(1-r.anchor.x),s=y.width*-r.anchor.x,u=y.height*(1-r.anchor.y),l=y.height*-r.anchor.y),n[o]=s*d,n[o+1]=l*f,n[o+i]=a*d,n[o+i+1]=l*f,n[o+2*i]=a*d,n[o+2*i+1]=u*f,n[o+3*i]=s*d,n[o+3*i+1]=u*f,o+=4*i}}uploadPosition(e,t,r,n,i,o){for(let a=0;a<r;a++){const r=e[t+a].position;n[o]=r.x,n[o+1]=r.y,n[o+i]=r.x,n[o+i+1]=r.y,n[o+2*i]=r.x,n[o+2*i+1]=r.y,n[o+3*i]=r.x,n[o+3*i+1]=r.y,o+=4*i}}uploadRotation(e,t,r,n,i,o){for(let a=0;a<r;a++){const r=e[t+a].rotation;n[o]=r,n[o+i]=r,n[o+2*i]=r,n[o+3*i]=r,o+=4*i}}uploadUvs(e,t,r,n,i,o){for(let a=0;a<r;++a){const r=e[t+a]._texture._uvs;r?(n[o]=r.x0,n[o+1]=r.y0,n[o+i]=r.x1,n[o+i+1]=r.y1,n[o+2*i]=r.x2,n[o+2*i+1]=r.y2,n[o+3*i]=r.x3,n[o+3*i+1]=r.y3,o+=4*i):(n[o]=0,n[o+1]=0,n[o+i]=0,n[o+i+1]=0,n[o+2*i]=0,n[o+2*i+1]=0,n[o+3*i]=0,n[o+3*i+1]=0,o+=4*i)}}uploadTint(e,t,r,n,i,o){for(let a=0;a<r;++a){const r=e[t+a],s=ht.shared.setValue(r._tintRGB).toPremultiplied(r.alpha,r.texture.baseTexture.alphaMode>0);n[o]=s,n[o+i]=s,n[o+2*i]=s,n[o+3*i]=s,o+=4*i}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Su.extension={name:"particle",type:Yt.RendererPlugin},Zt.add(Su);var Tu=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(Tu||{});const Cu={willReadFrequently:!0},Eu=class e{static get experimentalLetterSpacingSupported(){let t=e._experimentalLetterSpacingSupported;if(void 0!==t){const r=te.ADAPTER.getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return t}constructor(e,t,r,n,i,o,a,s,u){this.text=e,this.style=t,this.width=r,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=s,this.fontProperties=u}static measureText(t,r,n,i=e._canvas){n=n??r.wordWrap;const o=r.toFontString(),a=e.measureFont(o);0===a.fontSize&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);const s=i.getContext("2d",Cu);s.font=o;const u=(n?e.wordWrap(t,r,i):t).split(/(?:\r\n|\r|\n)/),l=new Array(u.length);let h=0;for(let t=0;t<u.length;t++){const n=e._measureText(u[t],r.letterSpacing,s);l[t]=n,h=Math.max(h,n)}let c=h+r.strokeThickness;r.dropShadow&&(c+=r.dropShadowDistance);const d=r.lineHeight||a.fontSize+r.strokeThickness;let f=Math.max(d,a.fontSize+2*r.strokeThickness)+r.leading+(u.length-1)*(d+r.leading);return r.dropShadow&&(f+=r.dropShadowDistance),new e(t,r,c,f,u,l,d+r.leading,h,a)}static _measureText(t,r,n){let i=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let o=n.measureText(t).width;return o>0&&(i?o-=r:o+=(e.graphemeSegmenter(t).length-1)*r),o}static wordWrap(t,r,n=e._canvas){const i=n.getContext("2d",Cu);let o=0,a="",s="";const u=Object.create(null),{letterSpacing:l,whiteSpace:h}=r,c=e.collapseSpaces(h),d=e.collapseNewlines(h);let f=!c;const p=r.wordWrapWidth+l,y=e.tokenize(t);for(let t=0;t<y.length;t++){let n=y[t];if(e.isNewline(n)){if(!d){s+=e.addLine(a),f=!c,a="",o=0;continue}n=" "}if(c){const t=e.isBreakingSpace(n),r=e.isBreakingSpace(a[a.length-1]);if(t&&r)continue}const h=e.getFromCache(n,l,u,i);if(h>p)if(""!==a&&(s+=e.addLine(a),a="",o=0),e.canBreakWords(n,r.breakWords)){const t=e.wordWrapSplit(n);for(let h=0;h<t.length;h++){let c=t[h],d=c,y=1;for(;t[h+y];){const i=t[h+y];if(e.canBreakChars(d,i,n,h,r.breakWords))break;c+=i,d=i,y++}h+=y-1;const g=e.getFromCache(c,l,u,i);g+o>p&&(s+=e.addLine(a),f=!1,a="",o=0),a+=c,o+=g}}else{a.length>0&&(s+=e.addLine(a),a="",o=0);const r=t===y.length-1;s+=e.addLine(n,!r),f=!1,a="",o=0}else h+o>p&&(f=!1,s+=e.addLine(a),a="",o=0),(a.length>0||!e.isBreakingSpace(n)||f)&&(a+=n,o+=h)}return s+=e.addLine(a,!1),s}static addLine(t,r=!0){return t=e.trimRight(t),t=r?`${t}\n`:t}static getFromCache(t,r,n,i){let o=n[t];return"number"!=typeof o&&(o=e._measureText(t,r,i)+r,n[t]=o),o}static collapseSpaces(e){return"normal"===e||"pre-line"===e}static collapseNewlines(e){return"normal"===e}static trimRight(t){if("string"!=typeof t)return"";for(let r=t.length-1;r>=0;r--){const n=t[r];if(!e.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}static isNewline(t){return"string"==typeof t&&e._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,r){return"string"==typeof t&&e._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const r=[];let n="";if("string"!=typeof t)return r;for(let i=0;i<t.length;i++){const o=t[i],a=t[i+1];e.isBreakingSpace(o,a)||e.isNewline(o)?(""!==n&&(r.push(n),n=""),r.push(o)):n+=o}return""!==n&&r.push(n),r}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,n,i){return!0}static wordWrapSplit(t){return e.graphemeSegmenter(t)}static measureFont(t){if(e._fonts[t])return e._fonts[t];const r={ascent:0,descent:0,fontSize:0},n=e._canvas,i=e._context;i.font=t;const o=e.METRICS_STRING+e.BASELINE_SYMBOL,a=Math.ceil(i.measureText(o).width);let s=Math.ceil(i.measureText(e.BASELINE_SYMBOL).width);const u=Math.ceil(e.HEIGHT_MULTIPLIER*s);if(s=s*e.BASELINE_MULTIPLIER|0,0===a||0===u)return e._fonts[t]=r,r;n.width=a,n.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);const l=i.getImageData(0,0,a,u).data,h=l.length,c=4*a;let d=0,f=0,p=!1;for(d=0;d<s;++d){for(let e=0;e<c;e+=4)if(255!==l[f+e]){p=!0;break}if(p)break;f+=c}for(r.ascent=s-d,f=h-c,p=!1,d=u;d>s;--d){for(let e=0;e<c;e+=4)if(255!==l[f+e]){p=!0;break}if(p)break;f-=c}return r.descent=d-s,r.fontSize=r.ascent+r.descent,e._fonts[t]=r,r}static clearMetrics(t=""){t?delete e._fonts[t]:e._fonts={}}static get _canvas(){if(!e.__canvas){let t;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",Cu)?.measureText)return e.__canvas=r,r;t=te.ADAPTER.createCanvas()}catch{t=te.ADAPTER.createCanvas()}t.width=t.height=10,e.__canvas=t}return e.__canvas}static get _context(){return e.__context||(e.__context=e._canvas.getContext("2d",Cu)),e.__context}};Eu.METRICS_STRING="|q",Eu.BASELINE_SYMBOL="M",Eu.BASELINE_MULTIPLIER=1.4,Eu.HEIGHT_MULTIPLIER=2,Eu.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map((e=>e.segment))}return e=>[...e]})(),Eu.experimentalLetterSpacing=!1,Eu._fonts={},Eu._newlines=[10,13],Eu._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Ou=Eu;const ku=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Pu=class e{constructor(e){this.styleID=0,this.reset(),Bu(this,e,e)}clone(){const t={};return Bu(t,this,e.defaultStyle),new e(t)}reset(){Bu(this,e.defaultStyle,e.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Ru(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Ru(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0})(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Ru(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let r=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!ku.includes(r)&&(r=`"${r}"`),t[e]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};Pu.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Tu.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let $u=Pu;function Ru(e){const t=ht.shared,r=e=>{const r=t.setValue(e);return 1===r.alpha?r.toHex():r.toRgbaString()};return Array.isArray(e)?e.map(r):r(e)}function Bu(e,t,r){for(const n in r)Array.isArray(t[n])?e[n]=t[n].slice():e[n]=t[n]}const Du={texture:!0,children:!1,baseTexture:!0},Mu=class e extends wo{constructor(t,r,n){let i=!1;n||(n=te.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const o=En.from(n);o.orig=new Tr,o.trim=new Tr,super(o),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=e.defaultResolution??te.RESOLUTION,this._autoResolution=e.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return Ou.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Ae("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Ou.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const r=this.context,n=Ou.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=n.width,o=n.height,a=n.lines,s=n.lineHeight,u=n.lineWidths,l=n.maxLineWidth,h=n.fontProperties;let c,d;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+2*t.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+2*t.padding)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;const f=t.dropShadow?2:1;for(let e=0;e<f;++e){const i=t.dropShadow&&0===e,f=i?Math.ceil(Math.max(1,o)+2*t.padding):0,p=f*this._resolution;if(i){r.fillStyle="black",r.strokeStyle="black";const e=t.dropShadowColor,n=t.dropShadowBlur*this._resolution,i=t.dropShadowDistance*this._resolution;r.shadowColor=ht.shared.setValue(e).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=n,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*i,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*i+p}else r.fillStyle=this._generateFillStyle(t,a,n),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let y=(s-h.fontSize)/2;s-h.fontSize<0&&(y=0);for(let e=0;e<a.length;e++)c=t.strokeThickness/2,d=t.strokeThickness/2+e*s+h.ascent+y,"right"===t.align?c+=l-u[e]:"center"===t.align&&(c+=(l-u[e])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[e],c+t.padding,d+t.padding-f,!0),t.fill&&this.drawLetterSpacing(a[e],c+t.padding,d+t.padding-f)}this.updateTexture()}drawLetterSpacing(e,t,r,n=!1){const i=this._style.letterSpacing;let o=!1;if(Ou.experimentalLetterSpacingSupported&&(Ou.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===i||o)return void(n?this.context.strokeText(e,t,r):this.context.fillText(e,t,r));let a=t;const s=Ou.graphemeSegmenter(e);let u=this.context.measureText(e).width,l=0;for(let e=0;e<s.length;++e){const t=s[e];n?this.context.strokeText(t,a,r):this.context.fillText(t,a,r);let o="";for(let t=e+1;t<s.length;++t)o+=s[t];l=this.context.measureText(o).width,a+=u-l+i,u=l}}updateTexture(){const e=this.canvas;if(this._style.trim){const t=zt(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}const t=this._texture,r=this._style,n=r.trim?0:r.padding,i=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-2*n,t.orig.height=t._frame.height-2*n,this._onTextureUpdate(),i.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),-1===this._textureID&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){const n=e.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];let i;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,s=this.canvas.width/this._resolution-o-2*a,u=this.canvas.height/this._resolution-o-2*a,l=n.slice(),h=e.fillGradientStops.slice();if(!h.length){const e=l.length+1;for(let t=1;t<e;++t)h.push(t/e)}if(l.unshift(n[0]),h.unshift(0),l.push(n[n.length-1]),h.push(1),e.fillGradientType===Tu.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,a,s/2,u+a);const n=r.fontProperties.fontSize+e.strokeThickness;for(let e=0;e<t.length;e++){const o=r.lineHeight*(e-1)+n,a=r.lineHeight*e;let s=a;e>0&&o>a&&(s=(a+o)/2);const c=a+n,d=r.lineHeight*(e+1);let f=c;e+1<t.length&&d<c&&(f=(c+d)/2);const p=(f-s)/u;for(let e=0;e<l.length;e++){let t=0;t="number"==typeof h[e]?h[e]:e/l.length;let r=Math.min(1,Math.max(0,s/u+t*p));r=Number(r.toFixed(5)),i.addColorStop(r,l[e])}}}else{i=this.context.createLinearGradient(a,u/2,s+a,u/2);const e=l.length+1;let t=1;for(let r=0;r<l.length;r++){let n;n="number"==typeof h[r]?h[r]:t/e,i.addColorStop(n,l[r]),t++}}return i}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Du,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=Ot(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=Ot(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},this._style=e instanceof $u?e:new $u(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};Mu.defaultAutoResolution=!0;let Lu=Mu;class Fu{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Nu(e,t){let r=!1;if(e?._textures?.length)for(let n=0;n<e._textures.length;n++)if(e._textures[n]instanceof En){const i=e._textures[n].baseTexture;t.includes(i)||(t.push(i),r=!0)}return r}function Uu(e,t){if(e.baseTexture instanceof lr){const r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function ju(e,t){if(e._texture&&e._texture instanceof En){const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Gu(e,t){return t instanceof Lu&&(t.updateText(!0),!0)}function zu(e,t){if(t instanceof $u){const e=t.toFontString();return Ou.measureFont(e),!0}return!1}function Vu(e,t){if(e instanceof Lu){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Hu(e,t){return e instanceof $u&&(t.includes(e)||t.push(e),!0)}const Wu=class e{constructor(t){this.limiter=new Fu(e.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Vu),this.registerFindHook(Hu),this.registerFindHook(Nu),this.registerFindHook(Uu),this.registerFindHook(ju),this.registerUploadHook(Gu),this.registerUploadHook(zu)}upload(e){return new Promise((t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Fi.system.addOnce(this.tick,this,Di.UTILITY))):t()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed)for(let r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)Fi.system.addOnce(this.tick,this,Di.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof yo)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&Fi.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};Wu.uploadsPerFrame=4;let Yu=Wu;function Ku(e,t){return t instanceof lr&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function Xu(e,t){if(!(t instanceof uu))return!1;const{geometry:r}=t;t.finishPoly(),r.updateBatches();const{batches:n}=r;for(let t=0;t<n.length;t++){const{texture:r}=n[t].style;r&&Ku(e,r.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function Zu(e,t){return e instanceof uu&&(t.push(e),!0)}Object.defineProperties(te,{UPLOADS_PER_FRAME:{get:()=>Yu.uploadsPerFrame,set(e){Ae("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Yu.uploadsPerFrame=e}}});class qu extends Yu{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(Zu),this.registerUploadHook(Ku),this.registerUploadHook(Xu)}}qu.extension={name:"prepare",type:Yt.RendererSystem},Zt.add(qu);class Ju{constructor(e){this.maxMilliseconds=e,this.frameStart=0}beginFrame(){this.frameStart=Date.now()}allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds}}class Qu extends wo{constructor(e,t=!0){super(e[0]instanceof En?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=t,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Fi.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Fi.shared.add(this.update,this,Di.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const t=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=t/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(e){this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const t=[];for(let r=0;r<e.length;++r)t.push(En.from(e[r]));return new Qu(t)}static fromImages(e){const t=[];for(let r=0;r<e.length;++r)t.push(En.from(e[r]));return new Qu(t)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof En)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Fi.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Fi.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const el=new Ar;class tl extends wo{constructor(e,t=100,r=100){super(e),this.tileTransform=new Gr,this._width=t,this._height=r,this.uvMatrix=this.texture.uvMatrix||new zn(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(e){this.tileTransform.scale.copyFrom(e)}get tilePosition(){return this.tileTransform.position}set tilePosition(e){this.tileTransform.position.copyFrom(e)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(e){const t=this._texture;!t||!t.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))}_calculateBounds(){const e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,n)}getLocalBounds(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Tr),e=this._localBoundsRect),this._bounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,el);const t=this._width,r=this._height,n=-t*this.anchor._x;if(el.x>=n&&el.x<n+t){const e=-r*this.anchor._y;if(el.y>=e&&el.y<e+r)return!0}return!1}destroy(e){super.destroy(e),this.tileTransform=null,this.uvMatrix=null}static from(e,t){const r=e instanceof En?e:En.from(e,t);return new tl(r,t.width,t.height)}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}}var rl="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const nl=new Pr;class il extends dn{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new $n,this.state=tr.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=ln.from(rl,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",t),this.shader=e.context.webGLVersion>1?ln.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",t):ln.from(rl,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",t)}render(e){const t=this.renderer,r=this.quad;let n=r.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);const i=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;n=r.uvs,n[0]=n[6]=-i,n[1]=n[3]=-o,n[2]=n[4]=1-i,n[5]=n[7]=1-o,r.invalidate();const a=e._texture,s=a.baseTexture,u=s.alphaMode>0,l=e.tileTransform.localTransform,h=e.uvMatrix;let c=s.isPowerOfTwo&&a.frame.width===s.width&&a.frame.height===s.height;c&&(s._glTextures[t.CONTEXT_UID]?c=s.wrapMode!==V.CLAMP:s.wrapMode===V.CLAMP&&(s.wrapMode=V.REPEAT));const d=c?this.simpleShader:this.shader,f=a.width,p=a.height,y=e._width,g=e._height;nl.set(l.a*f/y,l.b*f/g,l.c*p/y,l.d*p/g,l.tx/y,l.ty/g),nl.invert(),c?nl.prepend(h.mapCoord):(d.uniforms.uMapCoord=h.mapCoord.toArray(!0),d.uniforms.uClampFrame=h.uClampFrame,d.uniforms.uClampOffset=h.uClampOffset),d.uniforms.uTransform=nl.toArray(!0),d.uniforms.uColor=ht.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(d.uniforms.uColor),d.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),d.uniforms.uSampler=a,t.shader.bind(d),t.geometry.bind(r),this.state.blendMode=gt(e.blendMode,u),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}il.extension={name:"tilingSprite",type:Yt.RendererPlugin},Zt.add(il);const ol=class e{constructor(e,t,r){this.linkedSheets=[],(e instanceof lr||e instanceof En)&&(e={texture:e,data:t,resolutionFilename:r});const{texture:n,data:i,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=n instanceof En?n:null,this.baseTexture=n instanceof lr?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=i;const s=this.baseTexture.resource;this.resolution=this._updateResolution(o||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let r=Wt(e,null);return null===r&&(r="number"==typeof t?t:parseFloat(t??"1")),1!==r&&this.baseTexture.setResolution(r),r}parse(){return new Promise((t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(t){let r=t;const n=e.BATCH_SIZE;for(;r-t<n&&r<this._frameKeys.length;){const e=this._frameKeys[r],t=this._frames[e],n=t.frame;if(n){let r=null,i=null;const o=!1!==t.trimmed&&t.sourceSize?t.sourceSize:t.frame,a=new Tr(0,0,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution);r=t.rotated?new Tr(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):new Tr(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),!1!==t.trimmed&&t.spriteSourceSize&&(i=new Tr(Math.floor(t.spriteSourceSize.x)/this.resolution,Math.floor(t.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[e]=new En(this.baseTexture,r,a,i,t.rotated?2:0,t.anchor,t.borders),En.addToCache(this.textures[e],this.cachePrefix+e.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){const n=e[t][r];this.animations[t].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*e.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(e=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};ol.BATCH_SIZE=1e3;let al=ol;const sl=["jpg","png","jpeg","avif","webp"];function ul(e,t,r){const n={};if(e.forEach((e=>{n[e]=t})),Object.keys(t.textures).forEach((e=>{n[`${t.cachePrefix}${e}`]=t.textures[e]})),!r){const r=Ee.dirname(e[0]);t.linkedSheets.forEach(((e,i)=>{Object.assign(n,ul([`${r}/${t.data.meta.related_multi_packs[i]}`],e,!0))}))}return n}const ll={extension:Yt.Asset,cache:{test:e=>e instanceof al,getCacheableAssets:(e,t)=>ul(e,t,!1)},resolver:{test:e=>{const t=e.split("?")[0].split("."),r=t.pop(),n=t.pop();return"json"===r&&sl.includes(n)},parse:e=>{const t=e.split(".");return{resolution:parseFloat(te.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:Yt.LoadParser,priority:ra.Normal},testParse:async(e,t)=>".json"===Ee.extname(t.src).toLowerCase()&&!!e.frames,async parse(e,t,r){const{texture:n,imageFilename:i,cachePrefix:o}=t?.data??{};let a,s=Ee.dirname(t.src);if(s&&s.lastIndexOf("/")!==s.length-1&&(s+="/"),n&&n.baseTexture)a=n;else{const n=Wa(s+(i??e.meta.image),t.src);a=(await r.load([n]))[n]}const u=new al({texture:a.baseTexture,data:e,resolutionFilename:t.src,cachePrefix:o});await u.parse();const l=e?.meta?.related_multi_packs;if(Array.isArray(l)){const e=[];for(const n of l){if("string"!=typeof n)continue;let i=s+n;t.data?.ignoreMultiPack||(i=Wa(i,t.src),e.push(r.load({src:i,data:{ignoreMultiPack:!0}})))}const n=await Promise.all(e);u.linkedSheets=n,n.forEach((e=>{e.linkedSheets=[u].concat(u.linkedSheets.filter((t=>t!==e)))}))}return u},unload(e){e.destroy(!0)}}};Zt.add(ll);class hl{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class cl{static test(e){return"string"==typeof e&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const e in t){const n=t[e].match(/^[a-z]+/gm)[0],i=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(const e in i){const t=i[e].split("="),r=t[0],n=t[1].replace(/"/gm,""),a=parseFloat(n),s=isNaN(a)?n:a;o[r]=s}r[n].push(o)}const n=new hl;return r.info.forEach((e=>n.info.push({face:e.face,size:parseInt(e.size,10)}))),r.common.forEach((e=>n.common.push({lineHeight:parseInt(e.lineHeight,10)}))),r.page.forEach((e=>n.page.push({id:parseInt(e.id,10),file:e.file}))),r.char.forEach((e=>n.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)}))),r.kerning.forEach((e=>n.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)}))),r.distanceField.forEach((e=>n.distanceField.push({distanceRange:parseInt(e.distanceRange,10),fieldType:e.fieldType}))),n}}class dl{static test(e){const t=e;return"string"!=typeof e&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")}static parse(e){const t=new hl,r=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),i=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),s=e.getElementsByTagName("distanceField");for(let e=0;e<r.length;e++)t.info.push({face:r[e].getAttribute("face"),size:parseInt(r[e].getAttribute("size"),10)});for(let e=0;e<n.length;e++)t.common.push({lineHeight:parseInt(n[e].getAttribute("lineHeight"),10)});for(let e=0;e<i.length;e++)t.page.push({id:parseInt(i[e].getAttribute("id"),10)||0,file:i[e].getAttribute("file")});for(let e=0;e<o.length;e++){const r=o[e];t.char.push({id:parseInt(r.getAttribute("id"),10),page:parseInt(r.getAttribute("page"),10)||0,x:parseInt(r.getAttribute("x"),10),y:parseInt(r.getAttribute("y"),10),width:parseInt(r.getAttribute("width"),10),height:parseInt(r.getAttribute("height"),10),xoffset:parseInt(r.getAttribute("xoffset"),10),yoffset:parseInt(r.getAttribute("yoffset"),10),xadvance:parseInt(r.getAttribute("xadvance"),10)})}for(let e=0;e<a.length;e++)t.kerning.push({first:parseInt(a[e].getAttribute("first"),10),second:parseInt(a[e].getAttribute("second"),10),amount:parseInt(a[e].getAttribute("amount"),10)});for(let e=0;e<s.length;e++)t.distanceField.push({fieldType:s[e].getAttribute("fieldType"),distanceRange:parseInt(s[e].getAttribute("distanceRange"),10)});return t}}class fl{static test(e){return!("string"!=typeof e||!e.includes("<font>"))&&dl.test(te.ADAPTER.parseXML(e))}static parse(e){return dl.parse(te.ADAPTER.parseXML(e))}}const pl=[cl,dl,fl];function yl(e){for(let t=0;t<pl.length;t++)if(pl[t].test(e))return pl[t];return null}function gl(e,t,r,n,i,o,a){const s=r.text,u=r.fontProperties;t.translate(n,i),t.scale(o,o);const l=a.strokeThickness/2,h=-a.strokeThickness/2;if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=function(e,t,r,n,i,o){const a=r.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];let s;const u=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,h=e.width/n-u-2*l,c=e.height/n-u-2*l,d=a.slice(),f=r.fillGradientStops.slice();if(!f.length){const e=d.length+1;for(let t=1;t<e;++t)f.push(t/e)}if(d.unshift(a[0]),f.unshift(0),d.push(a[a.length-1]),f.push(1),r.fillGradientType===Tu.LINEAR_VERTICAL){s=t.createLinearGradient(h/2,l,h/2,c+l);let e=0;const n=(o.fontProperties.fontSize+r.strokeThickness)/c;for(let t=0;t<i.length;t++){const r=o.lineHeight*t;for(let t=0;t<d.length;t++){let i=0;i="number"==typeof f[t]?f[t]:t/d.length;const o=r/c+i*n;let a=Math.max(e,o);a=Math.min(a,1),s.addColorStop(a,d[t]),e=a}}}else{s=t.createLinearGradient(l,c/2,h+l,c/2);const e=d.length+1;let r=1;for(let t=0;t<d.length;t++){let n;n="number"==typeof f[t]?f[t]:r/e,s.addColorStop(n,d[t]),r++}}return s}(e,t,a,o,[s],r),t.strokeStyle=a.stroke,a.dropShadow){const e=a.dropShadowColor,r=a.dropShadowBlur*o,n=a.dropShadowDistance*o;t.shadowColor=ht.shared.setValue(e).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=r,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*n,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*n}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(s,l,h+r.lineHeight-u.descent),a.fill&&t.fillText(s,l,h+r.lineHeight-u.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function ml(e){return Array.from?Array.from(e):e.split("")}function wl(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}const bl=class e{constructor(e,t,r){const[n]=e.info,[i]=e.common,[o]=e.page,[a]=e.distanceField,s=Wt(o.file),u={};this._ownsTextures=r,this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/s,this.chars={},this.pageTextures=u;for(let r=0;r<e.page.length;r++){const{id:n,file:i}=e.page[r];u[n]=t instanceof Array?t[r]:t[i],a?.fieldType&&"none"!==a.fieldType&&(u[n].baseTexture.alphaMode=W.NO_PREMULTIPLIED_ALPHA,u[n].baseTexture.mipmap=H.OFF)}for(let t=0;t<e.char.length;t++){const{id:r,page:n}=e.char[t];let{x:i,y:o,width:a,height:l,xoffset:h,yoffset:c,xadvance:d}=e.char[t];i/=s,o/=s,a/=s,l/=s,h/=s,c/=s,d/=s;const f=new Tr(i+u[n].frame.x/s,o+u[n].frame.y/s,a,l);this.chars[r]={xOffset:h,yOffset:c,xAdvance:d,kerning:{},texture:new En(u[n].baseTexture,f),page:n}}for(let t=0;t<e.kerning.length;t++){let{first:r,second:n,amount:i}=e.kerning[t];r/=s,n/=s,i/=s,this.chars[n]&&(this.chars[n].kerning[r]=i)}this.distanceFieldRange=a?.distanceRange,this.distanceFieldType=a?.fieldType?.toLowerCase()??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(t,r,n){let i;if(t instanceof hl)i=t;else{const e=yl(t);if(!e)throw new Error("Unrecognized data format for font.");i=e.parse(t)}r instanceof En&&(r=[r]);const o=new e(i,r,n);return e.available[o.font]=o,o}static uninstall(t){const r=e.available[t];if(!r)throw new Error(`No font found named '${t}'`);r.destroy(),delete e.available[t]}static from(t,r,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:o,resolution:a,textureWidth:s,textureHeight:u,...l}=Object.assign({},e.defaultOptions,n),h=function(e){"string"==typeof e&&(e=[e]);const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r];if(Array.isArray(n)){if(2!==n.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const e=n[0].charCodeAt(0),r=n[1].charCodeAt(0);if(r<e)throw new Error("[BitmapFont]: Invalid character range.");for(let n=e,i=r;n<=i;n++)t.push(String.fromCharCode(n))}else t.push(...ml(n))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}(i),c=r instanceof $u?r:new $u(r),d=s,f=new hl;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};let p,y,g,m=0,w=0,b=0;const v=[],x=[];for(let e=0;e<h.length;e++){p||(p=te.ADAPTER.createCanvas(),p.width=s,p.height=u,y=p.getContext("2d"),g=new lr(p,{resolution:a,...l}),v.push(g),x.push(new En(g)),f.page.push({id:x.length-1,file:""}));const t=h[e],r=Ou.measureText(t,c,!1,p),n=r.width,i=Math.ceil(r.height),_=Math.ceil(("italic"===c.fontStyle?2:1)*n);if(w>=u-i*a){if(0===w)throw new Error(`[BitmapFont] textureHeight ${u}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${t}')`);--e,p=null,y=null,g=null,w=0,m=0,b=0;continue}if(b=Math.max(i+r.fontProperties.descent,b),_*a+m>=d){if(0===m)throw new Error(`[BitmapFont] textureWidth ${s}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${t}')`);--e,w+=b*a,w=Math.ceil(w),m=0,b=0;continue}gl(p,y,r,m,w,a,c);const I=wl(r.text);f.char.push({id:I,page:x.length-1,x:m/a,y:w/a,width:_,height:i,xoffset:0,yoffset:0,xadvance:n-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),m+=(_+2*o)*a,m=Math.ceil(m)}if(!n?.skipKerning)for(let e=0,t=h.length;e<t;e++){const r=h[e];for(let e=0;e<t;e++){const t=h[e],n=y.measureText(r).width,i=y.measureText(t).width,o=y.measureText(r+t).width-(n+i);o&&f.kerning.push({first:wl(r),second:wl(t),amount:o})}}const _=new e(f,x,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=_,_}};bl.ALPHA=[["a","z"],["A","Z"]," "],bl.NUMERIC=[["0","9"]],bl.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],bl.ASCII=[[" ","~"]],bl.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:bl.ALPHANUMERIC},bl.available={};let vl=bl;const xl=[],_l=[],Il=[],Al=class e extends yo{constructor(t,r={}){super();const{align:n,tint:i,maxWidth:o,letterSpacing:a,fontName:s,fontSize:u}=Object.assign({},e.styleDefaults,r);if(!vl.available[s])throw new Error(`Missing BitmapFont "${s}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new ht(i),this._font=void 0,this._fontName=s,this._fontSize=u,this.text=t,this._maxWidth=o,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new Ur((()=>{this.dirty=!0}),this,0,0),this._roundPixels=te.ROUND_PIXELS,this.dirty=!0,this._resolution=te.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const e=vl.available[this._fontName],t=this.fontSize,r=t/e.size,n=new Ar,i=[],o=[],a=[],s=ml(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),u=this._maxWidth*e.size/t,l="none"===e.distanceFieldType?xl:_l;let h=null,c=0,d=0,f=0,p=-1,y=0,g=0,m=0,w=0;for(let t=0;t<s.length;t++){const r=s[t],l=wl(r);if(/(?:\s)/.test(r)&&(p=t,y=c,w++),"\r"===r||"\n"===r){o.push(c),a.push(-1),d=Math.max(d,c),++f,++g,n.x=0,n.y+=e.lineHeight,h=null,w=0;continue}const b=e.chars[l];if(!b)continue;h&&b.kerning[h]&&(n.x+=b.kerning[h]);const v=Il.pop()||{texture:En.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ar};v.texture=b.texture,v.line=f,v.charCode=l,v.position.x=Math.round(n.x+b.xOffset+this._letterSpacing/2),v.position.y=Math.round(n.y+b.yOffset),v.prevSpaces=w,i.push(v),c=v.position.x+Math.max(b.xAdvance-b.xOffset,b.texture.orig.width),n.x+=b.xAdvance+this._letterSpacing,m=Math.max(m,b.yOffset+b.texture.height),h=l,-1!==p&&u>0&&n.x>u&&(++g,Et(i,1+p-g,1+t-p),t=p,p=-1,o.push(y),a.push(i.length>0?i[i.length-1].prevSpaces:0),d=Math.max(d,y),f++,n.x=0,n.y+=e.lineHeight,h=null,w=0)}const b=s[s.length-1];"\r"!==b&&"\n"!==b&&(/(?:\s)/.test(b)&&(c=y),o.push(c),d=Math.max(d,c),a.push(-1));const v=[];for(let e=0;e<=f;e++){let t=0;"right"===this._align?t=d-o[e]:"center"===this._align?t=(d-o[e])/2:"justify"===this._align&&(t=a[e]<0?0:(d-o[e])/a[e]),v.push(t)}const x=i.length,_={},I=[],A=this._activePagesMeshData;l.push(...A);for(let t=0;t<x;t++){const r=i[t].texture,n=r.baseTexture.uid;if(!_[n]){let t=l.pop();if(!t){const r=new yu;let n,i;"none"===e.distanceFieldType?(n=new gu(En.EMPTY),i=L.NORMAL):(n=new gu(En.EMPTY,{program:an.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),i=L.NORMAL_NPM);const o=new pu(r,n);o.blendMode=i,t={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:o,vertices:null,uvs:null,indices:null}}t.index=0,t.indexCount=0,t.vertexCount=0,t.uvsCount=0,t.total=0;const{_textureCache:i}=this;i[n]=i[n]||new En(r.baseTexture),t.mesh.texture=i[n],t.mesh.tint=this._tintColor.value,I.push(t),_[n]=t}_[n].total++}for(let e=0;e<A.length;e++)I.includes(A[e])||this.removeChild(A[e].mesh);for(let e=0;e<I.length;e++)I[e].mesh.parent!==this&&this.addChild(I[e].mesh);this._activePagesMeshData=I;for(const e in _){const t=_[e],r=t.total;if(!(t.indices?.length>6*r)||t.vertices.length<2*pu.BATCHABLE_SIZE)t.vertices=new Float32Array(8*r),t.uvs=new Float32Array(8*r),t.indices=new Uint16Array(6*r);else{const e=t.total,r=t.vertices;for(let t=4*e*2;t<r.length;t++)r[t]=0}t.mesh.size=6*r}for(let e=0;e<x;e++){const t=i[e];let n=t.position.x+v[t.line]*("justify"===this._align?t.prevSpaces:1);this._roundPixels&&(n=Math.round(n));const o=n*r,a=t.position.y*r,s=t.texture,u=_[s.baseTexture.uid],l=s.frame,h=s._uvs,c=u.index++;u.indices[6*c+0]=0+4*c,u.indices[6*c+1]=1+4*c,u.indices[6*c+2]=2+4*c,u.indices[6*c+3]=0+4*c,u.indices[6*c+4]=2+4*c,u.indices[6*c+5]=3+4*c,u.vertices[8*c+0]=o,u.vertices[8*c+1]=a,u.vertices[8*c+2]=o+l.width*r,u.vertices[8*c+3]=a,u.vertices[8*c+4]=o+l.width*r,u.vertices[8*c+5]=a+l.height*r,u.vertices[8*c+6]=o,u.vertices[8*c+7]=a+l.height*r,u.uvs[8*c+0]=h.x0,u.uvs[8*c+1]=h.y0,u.uvs[8*c+2]=h.x1,u.uvs[8*c+3]=h.y1,u.uvs[8*c+4]=h.x2,u.uvs[8*c+5]=h.y2,u.uvs[8*c+6]=h.x3,u.uvs[8*c+7]=h.y3}this._textWidth=d*r,this._textHeight=(n.y+e.lineHeight)*r;for(const e in _){const t=_[e];if(0!==this.anchor.x||0!==this.anchor.y){let e=0;const r=this._textWidth*this.anchor.x,n=this._textHeight*this.anchor.y;for(let i=0;i<t.total;i++)t.vertices[e++]-=r,t.vertices[e++]-=n,t.vertices[e++]-=r,t.vertices[e++]-=n,t.vertices[e++]-=r,t.vertices[e++]-=n,t.vertices[e++]-=r,t.vertices[e++]-=n}this._maxLineHeight=m*r;const n=t.mesh.geometry.getBuffer("aVertexPosition"),i=t.mesh.geometry.getBuffer("aTextureCoord"),o=t.mesh.geometry.getIndex();n.data=t.vertices,i.data=t.uvs,o.data=t.indices,n.update(),i.update(),o.update()}for(let e=0;e<i.length;e++)Il.push(i[e]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:r,size:n}=vl.available[this._fontName];if("none"!==r){const{a:r,b:i,c:o,d:a}=this.worldTransform,s=Math.sqrt(r*r+i*i),u=Math.sqrt(o*o+a*a),l=(Math.abs(s)+Math.abs(u))/2,h=this.fontSize/n,c=e._view.resolution;for(const e of this._activePagesMeshData)e.mesh.shader.uniforms.uFWidth=l*t*h*c}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=vl.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!vl.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??vl.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,r="none"===vl.available[this._fontName].distanceFieldType?xl:_l;r.push(...this._activePagesMeshData);for(const e of this._activePagesMeshData)this.removeChild(e.mesh);this._activePagesMeshData=[],r.filter((e=>t[e.mesh.texture.baseTexture.uid])).forEach((e=>{e.mesh.texture=En.EMPTY}));for(const e in t)t[e].destroy(),delete t[e];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};Al.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let Sl=Al;const Tl=[".xml",".fnt"],Cl={extension:{type:Yt.LoadParser,priority:ra.Normal},name:"loadBitmapFont",test:e=>Tl.includes(Ee.extname(e).toLowerCase()),testParse:async e=>cl.test(e)||fl.test(e),async parse(e,t,r){const n=cl.test(e)?cl.parse(e):fl.parse(e),{src:i}=t,{page:o}=n,a=[];for(let e=0;e<o.length;++e){const t=o[e].file;let r=Ee.join(Ee.dirname(i),t);r=Wa(r,i),a.push(r)}const s=await r.load(a),u=a.map((e=>s[e]));return vl.install(n,u,!0)},load:async(e,t)=>(await te.ADAPTER.fetch(e)).text(),unload(e){e.destroy()}};Zt.add(Cl);const El=class e extends $u{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new e(Object.keys(e.defaultOptions).reduce(((e,r)=>({...e,[r]:t[r]})),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((t=>{URL.revokeObjectURL(t.src),t.refs--,0===t.refs&&(t.fontFace&&document.fonts.delete(t.fontFace),delete e.availableFonts[t.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,r={}){const{availableFonts:n}=e;if(n[t]){const e=n[t];return this._fonts.push(e),e.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return te.ADAPTER.fetch(t).then((e=>e.blob())).then((async e=>new Promise(((t,r)=>{const n=URL.createObjectURL(e),i=new FileReader;i.onload=()=>t([n,i.result]),i.onerror=r,i.readAsDataURL(e)})))).then((async([e,i])=>{const o=Object.assign({family:Ee.basename(t,Ee.extname(t)),weight:"normal",style:"normal",display:"auto",src:e,dataSrc:i,refs:1,originalUrl:t,fontFace:null},r);n[t]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...e){const t=e.filter((e=>!this._overrides.includes(e)));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter((e=>this._overrides.includes(e)));t.length>0&&(this._overrides=this._overrides.filter((e=>!t.includes(e))),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce(((e,t)=>`${e}\n            @font-face {\n                font-family: "${t.family}";\n                src: url('${t.dataSrc}');\n                font-weight: ${t.weight};\n                font-style: ${t.style};\n                font-display: ${t.display};\n            }`),this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=pt(e)),"number"==typeof e?dt(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),n=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(255*t|0).toString(16).padStart(2,"0"));const i=`${r}px ${n}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${i} ${e}`}reset(){Object.assign(this,e.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise((e=>setTimeout(e,100))):Promise.resolve()}get isSafari(){const{userAgent:e}=te.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};El.availableFonts={},El.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Ol=El;const kl=class e extends wo{constructor(t="",r={}){super(En.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=En.from(n,{scaleMode:te.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new Tr,i.trim=new Tr,this.texture=i;const o="http://www.w3.org/2000/svg",a="http://www.w3.org/1999/xhtml",s=document.createElementNS(o,"svg"),u=document.createElementNS(o,"foreignObject"),l=document.createElementNS(a,"div"),h=document.createElementNS(a,"style");u.setAttribute("width","10000"),u.setAttribute("height","10000"),u.style.overflow="hidden",s.appendChild(u),this.maxWidth=e.defaultMaxWidth,this.maxHeight=e.defaultMaxHeight,this._domElement=l,this._styleElement=h,this._svgRoot=s,this._foreignObject=u,this._foreignObject.appendChild(h),this._foreignObject.appendChild(l),this._image=n,this._loadImage=new Image,this._autoResolution=e.defaultAutoResolution,this._resolution=e.defaultResolution??te.RESOLUTION,this.text=t,this.style=r}measureText(e){const{text:t,style:r,resolution:n}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(n)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=i;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const s=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",u.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(n)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:s+2*r.padding,height:u+2*r.padding}}async updateText(e=!0){const{style:t,_image:r,_loadImage:n}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:i,height:o}=this.measureText();r.width=n.width=Math.ceil(Math.max(1,i)),r.height=n.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise((e=>{n.onload=async()=>{a<this._updateID||(await t.onBeforeDraw(),r.src=n.src,n.onload=null,n.src="",this.updateTexture()),e()};const i=(new XMLSerializer).serializeToString(this._svgRoot);n.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(i)}`}))}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:r,resolution:n}=this,{padding:i}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=r.width/n,t.trim.height=t._frame.height=r.height/n,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-2*i,t.orig.height=t._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(r.width,r.height,n),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},e.defaultDestroyOptions,t),super.destroy(t);const r=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=r,this._svgRoot?.remove(),this._svgRoot=r,this._domElement?.remove(),this._domElement=r,this._foreignObject?.remove(),this._foreignObject=r,this._styleElement?.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=Ot(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=Ot(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&((e=e||{})instanceof Ol?(this.ownsStyle=!1,this._style=e):e instanceof $u?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ol.from(e)):(this.ownsStyle=!0,this._style=new Ol(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(""===e||null==e?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};kl.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},kl.defaultMaxWidth=2024,kl.defaultMaxHeight=2024,kl.defaultAutoResolution=!0;let Pl=kl;var $l=r(3444);const Rl=((e,t)=>{let r=null;return()=>{if(null!==r)return r;const n=new Blob([t],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(n);return r=e(i),setTimeout((()=>URL.revokeObjectURL(i))),r}})((e=>{const t=new Map([[0,()=>{}]]),r=new Map([[0,()=>{}]]),n=new Map,i=new Worker(e);i.addEventListener("message",(({data:e})=>{if(void 0!==(i=e).method&&"call"===i.method){const{params:{timerId:i,timerType:o}}=e;if("interval"===o){const e=t.get(i);if("number"==typeof e){const t=n.get(e);if(void 0===t||t.timerId!==i||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e()}}else if("timeout"===o){const e=r.get(i);if("number"==typeof e){const t=n.get(e);if(void 0===t||t.timerId!==i||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e(),r.delete(i)}}}else{if(!(e=>null===e.error&&"number"==typeof e.id)(e)){const{error:{message:t}}=e;throw new Error(t)}{const{id:i}=e,o=n.get(i);if(void 0===o)throw new Error("The timer is in an undefined state.");const{timerId:a,timerType:s}=o;n.delete(i),"interval"===s?t.delete(a):r.delete(a)}}var i}));return{clearInterval:e=>{const r=(0,$l.generateUniqueNumber)(n);n.set(r,{timerId:e,timerType:"interval"}),t.set(e,r),i.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:e=>{const t=(0,$l.generateUniqueNumber)(n);n.set(t,{timerId:e,timerType:"timeout"}),r.set(e,t),i.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:(e,r=0)=>{const n=(0,$l.generateUniqueNumber)(t);return t.set(n,(()=>{e(),"function"==typeof t.get(n)&&i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}})})),i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}}),n},setTimeout:(e,t=0)=>{const n=(0,$l.generateUniqueNumber)(r);return r.set(n,e),i.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:n,timerType:"timeout"}}),n}}}),'(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'),Bl=e=>Rl().clearTimeout(e),Dl=(...e)=>Rl().setTimeout(...e);function Ml(e){return Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ml(e)}function Ll(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fl(n.key),n)}}function Fl(e){var t=function(e,t){if("object"!=Ml(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ml(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ml(t)?t:String(t)}function Nl(e,t,r){return t=Gl(t),Ul(e,jl()?Reflect.construct(t,r||[],Gl(e).constructor):t.apply(e,r))}function Ul(e,t){if(t&&("object"===Ml(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jl=function(){return!!e})()}function Gl(e){return Gl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gl(e)}function zl(e,t){return zl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zl(e,t)}var Vl=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Nl(this,t)).shouldBeDestroed=!0,e?(r.texture=e instanceof En?e:En.from(e),r):(r.texture=new En(new lr),Ul(r))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zl(e,t)}(t,e),r=t,n=[{key:"get",value:function(){return this.texture}},{key:"update",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return this.texture.update(),void this.emit("update",this);this.texture&&this.shouldBeDestroed&&this.texture.destroy(!0),this.texture=e instanceof En?e:En.from(e),this.shouldBeDestroed=t,this.emit("replace",this)}},{key:"destroy",value:function(){this.texture&&this.texture.destroy(!0),this.removeAllListeners()}}],n&&Ll(r.prototype,n),i&&Ll(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(a);function Hl(e){return Hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hl(e)}function Wl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yl(n.key),n)}}function Yl(e){var t=function(e,t){if("object"!=Hl(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Hl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Hl(t)?t:String(t)}function Kl(e,t,r){return t=Zl(t),function(e,t){if(t&&("object"===Hl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ql(e)}(e,Xl()?Reflect.construct(t,r||[],Zl(e).constructor):t.apply(e,r))}function Xl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Xl=function(){return!!e})()}function Zl(e){return Zl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zl(e)}function ql(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jl(e,t){return Jl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jl(e,t)}var Ql=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Kl(this,t)).active="origin",n.textures=new Map,n.buffers=new Map,e instanceof Vl?(n.frame=new wo(e.get()),n.textures.set("origin",e.get()),e.on("replace",n.onReplace,ql(n))):(n.frame=new wo(e),n.textures.set("origin",e)),n.frame.width=r.width,n.frame.height=r.height,n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jl(e,t)}(t,e),r=t,n=[{key:"onReplace",value:function(e){this.textures.set("origin",e.get()),"origin"==this.active&&(this.frame.texture=e.get())}},{key:"addTexture",value:function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.textures.has(e)&&(n&&(null===(r=this.textures.get(e))||void 0===r||r.destroy(!0)),this.textures.delete(e)),this.textures.set(e,t),!0}},{key:"getTexture",value:function(e){if(this.textures.has(e))return this.textures.get(e);throw new Error("There is no such texture")}},{key:"addBuffer",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.buffers.has(e)&&(r&&(null===(t=this.buffers.get(e))||void 0===t||t.destroy(!0)),this.buffers.delete(e)),this.buffers.set(e,On.create({width:this.frame.width,height:this.frame.height})),!0}},{key:"getBuffer",value:function(e){if(this.buffers.has(e))return this.buffers.get(e);throw new Error("There is no such buffer")}},{key:"resize",value:function(e,t){this.frame.width=e,this.frame.height=t,this.buffers.forEach((function(r,n){r.resize(e,t)}))}},{key:"activateBuffer",value:function(e){this.buffers.has(e)&&(this.frame.texture=this.buffers.get(e),this.active=e)}},{key:"activateTexture",value:function(e){this.textures.has(e)&&(this.frame.texture=this.textures.get(e),this.active=e)}}],n&&Wl(r.prototype,n),i&&Wl(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(a);function eh(e){return eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eh(e)}function th(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rh(n.key),n)}}function rh(e){var t=function(e,t){if("object"!=eh(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=eh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eh(t)?t:String(t)}Ql.defaultOptions={width:100,height:100};var nh=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state="pending",this.fate="unresolved",this.promise=new Promise((function(e,r){t._resolve=e,t._reject=r})),this.promise.then((function(){return t.state="fulfilled"}),(function(){return t.state="rejected"}))}var t,r,n;return t=e,(r=[{key:"resolve",value:function(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._resolve(e)}},{key:"reject",value:function(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._reject(e)}},{key:"isResolved",value:function(){return"resolved"===this.fate}},{key:"isPending",value:function(){return"pending"===this.state}},{key:"isFulfilled",value:function(){return"fulfilled"===this.state}},{key:"isRejected",value:function(){return"rejected"===this.state}}])&&th(t.prototype,r),n&&th(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ih(e){return ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ih(e)}function oh(){oh=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==ih(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(ih(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function ah(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function sh(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){ah(o,n,i,a,s,"next",e)}function s(e){ah(o,n,i,a,s,"throw",e)}a(void 0)}))}}function uh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lh(n.key),n)}}function lh(e){var t=function(e,t){if("object"!=ih(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ih(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ih(t)?t:String(t)}function hh(e,t,r){return t=fh(t),function(e,t){if(t&&("object"===ih(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ch()?Reflect.construct(t,r||[],fh(e).constructor):t.apply(e,r))}function ch(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ch=function(){return!!e})()}function dh(){return dh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fh(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},dh.apply(this,arguments)}function fh(e){return fh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fh(e)}function ph(e,t){return ph=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ph(e,t)}var yh=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=hh(this,t,[e])).inprocess=!1,r.duration=30,r.textures=[],r.inputVideo=document.createElement("video"),r.duration=1e3/r.fpsLimit,r}var r,n,i,a,s,u,l,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ph(e,t)}(t,e),r=t,n=[{key:"onTrackUpdate",value:function(){dh(fh(t.prototype),"onTrackUpdate",this).call(this),this.videoFrame&&this.videoFrame.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"setFpsLimit",value:function(e){this.fpsLimit=e,this.duration=1e3/this.fpsLimit}},{key:"setRenderer",value:function(e){this.renderer=e}},{key:"destroy",value:function(){this.stopTimers()}},{key:"clearBuffers",value:function(){this.effectProcessor.clearBuffers()}},{key:"stopTimers",value:function(){try{this.gatherFramesTimeout&&(Bl(this.gatherFramesTimeout),this.gatherFramesTimeout=0),this.handleFramesTimeout&&(Bl(this.handleFramesTimeout),this.handleFramesTimeout=0),this.gatherFramesInterval&&(e=this.gatherFramesInterval,Rl().clearInterval(e),this.gatherFramesInterval=0)}catch(e){}var e}},{key:"startTimers",value:function(){var e=this;this.gatherFramesInterval=((...e)=>Rl().setInterval(...e))((function(){e.gatherByTimers()}),this.duration),this.gatherByCallback(),this.handleFrames()}},{key:"gatherByCallback",value:(h=sh(oh().mark((function e(){return oh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"gatherByTimers",value:(l=sh(oh().mark((function e(){return oh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.hidden&&this.gatherFrames();case 1:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"gatherFrames",value:(u=sh(oh().mark((function e(){var t,r;return oh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.textures.length>3&&(null==(t=this.textures.shift())||t.destroy(!0)),this.videoTexture&&(this.videoTexture.update(),r=On.create({width:this.sdkOptions.width,height:this.sdkOptions.height}),this.renderer.renderTo(this.videoFrame.frame,r),this.textures.push(r));case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"nextTick",value:(s=sh(oh().mark((function e(){var t,r;return oh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.frameDrawFunction)||void 0===t||t.call(this),this.frame_count++,this.videoTrackWrapper.update(this.inputVideo.videoWidth,this.inputVideo.videoHeight),this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=8,this.effectProcessor.process();case 8:this.drawFps(),this.toCanvas&&(null===(r=this.toCanvas.getContext("2d"))||void 0===r||r.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height));case 10:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"handleFrames",value:(a=sh(oh().mark((function e(){var t,r,n,i=this;return oh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.textures.length){e.next=2;break}return e.abrupt("return",this.handleFramesTimeout=Dl((function(){i.handleFrames()}),10));case 2:if(r=performance.now(),this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=10;break}return this.textures=[],this.renderer.addToEffects(this.videoFrame.frame),this.renderer.render(),this.renderer.removeFromEffects(this.videoFrame.frame),this.toCanvas&&(null===(t=this.toCanvas.getContext("2d"))||void 0===t||t.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height)),e.abrupt("return",this.handleFramesTimeout=Dl((function(){i.handleFrames()}),Math.max(0,this.duration-(performance.now()-r))));case 10:if(n=this.textures.shift(),this.effectProcessor.nextFrame(new Vl(n)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=15;break}return e.next=15,this.onProcessPromise.promise;case 15:return this.onProcessPromise=new nh,this.nextTick().then((function(){i.onProcessPromise.resolve()})),e.abrupt("return",this.handleFramesTimeout=Dl((function(){i.handleFrames()}),0));case 18:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"process",value:function(){var e=this;if(this.stopTimers(),this.getInputVideoTrack()){var t=this.getInputVideoStream();t&&(this.inputVideo.srcObject=t,this.inputVideo.muted=!0,this.inputVideo.setAttribute("playsinline",!0),this.inputVideo.playsInline=!0,this.inputVideo.play().then((function(){e.videoTexture=new Vl(e.inputVideo),e.videoFrame=new Ql(e.videoTexture,{width:e.sdkOptions.width,height:e.sdkOptions.height})}))),this.startTimers()}else o.ie.notify({message:"there is no videoTrack to process",emitter:o.E7.SRTEAM_PROCESSOR})}},{key:"getInputVideoStream",value:function(){return this.stream?this.stream:null}},{key:"getStream",value:function(){var e=this;return this.outputStream||(this.outputStream=this.renderer.renderer.view.captureStream(30),this.outputStream.getVideoTracks()[0].getSettings=function(){return e.videoTrackWrapper.getSettings()},this.outputStream.getVideoTracks()[0].getConstraints=function(){return e.videoTrackWrapper.getConstraints()},this.outputStream.getVideoTracks()[0].getCapabilities=function(){return e.videoTrackWrapper.getCapabilities()},this.outputStream.getVideoTracks()[0].applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t)},this.stream&&this.stream.getAudioTracks().forEach((function(t,r){e.outputStream.addTrack(t)}))),this.outputStream}}],n&&uh(r.prototype,n),i&&uh(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(R);function gh(e){return gh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gh(e)}function mh(){mh=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==gh(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(gh(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function wh(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function bh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vh(n.key),n)}}function vh(e){var t=function(e,t){if("object"!=gh(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=gh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gh(t)?t:String(t)}function xh(e,t,r){return t=Ah(t),function(e,t){if(t&&("object"===gh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_h()?Reflect.construct(t,r||[],Ah(e).constructor):t.apply(e,r))}function _h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_h=function(){return!!e})()}function Ih(){return Ih="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ah(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ih.apply(this,arguments)}function Ah(e){return Ah=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ah(e)}function Sh(e,t){return Sh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Sh(e,t)}var Th=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=xh(this,t,[e])).timing=performance.now(),r}var r,n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sh(e,t)}(t,e),r=t,n=[{key:"gatherByCallback",value:(o=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){wh(o,n,i,a,s,"next",e)}function s(e){wh(o,n,i,a,s,"throw",e)}a(void 0)}))}}(mh().mark((function e(){var t=this;return mh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.requestAnimationFrameID=window.requestAnimationFrame((function(){return t.gatherByCallback()}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"stopTimers",value:function(){if(Ih(Ah(t.prototype),"stopTimers",this).call(this),this.requestAnimationFrameID)try{cancelAnimationFrame(this.requestAnimationFrameID),this.requestAnimationFrameID=0}catch(e){}}}],n&&bh(r.prototype,n),i&&bh(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(yh);function Ch(e){return Ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ch(e)}function Eh(){Eh=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Ch(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Ch(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Oh(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function kh(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Oh(o,n,i,a,s,"next",e)}function s(e){Oh(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Ph(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$h(n.key),n)}}function $h(e){var t=function(e,t){if("object"!=Ch(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ch(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ch(t)?t:String(t)}function Rh(e,t,r){return t=Dh(t),function(e,t){if(t&&("object"===Ch(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Bh()?Reflect.construct(t,r||[],Dh(e).constructor):t.apply(e,r))}function Bh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Bh=function(){return!!e})()}function Dh(e){return Dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dh(e)}function Mh(e,t){return Mh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mh(e,t)}var Lh=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Rh(this,t,[e])).frameTimes=[],r.aborter=new AbortController,r}var r,n,i,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mh(e,t)}(t,e),r=t,n=[{key:"clearBuffers",value:function(){this.effectProcessor.clearBuffers()}},{key:"destroy",value:function(){this.outputStream&&this.outputStream.getTracks().forEach((function(e){e.stop()})),this.aborter.abort("stream_processor is destroyed")}},{key:"nextTick",value:(s=kh(Eh().mark((function e(t,r){var n,i,a,s,u,l,h;return Eh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.frameDrawFunction)||void 0===n||n.call(this),this.videoTrackWrapper.update(t.displayWidth,t.displayHeight),this.frame_count++,this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=8,this.effectProcessor.process();case 8:this.drawFps();try{l=this.renderer.getVideoFrameSettings(),h=this.renderer.getVideoFrameData(),u=new VideoFrame(h,Object.assign({duration:this.frameTimer.getFrameDuration(),timestamp:t.timestamp},l)),t.close();try{r.enqueue(u)}catch(e){o.ie.notify({message:null!==(i=e.message)&&void 0!==i?i:e,emitter:o.E7.SRTEAM_PROCESSOR,cause:e}),u.close()}this.toCanvas&&(null===(a=this.toCanvas.getContext("2d"))||void 0===a||a.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height))}catch(e){o.ie.notify({message:null!==(s=e.message)&&void 0!==s?s:e,emitter:o.E7.SRTEAM_PROCESSOR,cause:e}),t.close()}case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"handleFrames",value:(a=kh(Eh().mark((function e(t,r){var n,i=this;return Eh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=3;break}try{r.enqueue(t),this.toCanvas&&(null===(n=this.toCanvas.getContext("2d"))||void 0===n||n.drawImage(t,0,0,this.toCanvas.width,this.toCanvas.height))}catch(e){t.close()}return e.abrupt("return");case 3:if(this.effectProcessor.nextFrame(new Vl(t)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=7;break}return e.next=7,this.onProcessPromise.promise;case 7:this.onProcessPromise=new nh,this.nextTick(t,r).then((function(){i.onProcessPromise.resolve()}));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"process",value:function(){var e=this,t=this.getInputVideoTrack();if(t){this.outputVideoTrack=new MediaStreamTrackGenerator({kind:"video"}),this.outputVideoTrack.getSettings=function(){return e.videoTrackWrapper.getSettings()},this.outputVideoTrack.getConstraints=function(){return e.videoTrackWrapper.getConstraints()},this.outputVideoTrack.getCapabilities=function(){return e.videoTrackWrapper.getCapabilities()},this.outputVideoTrack.applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t)},this.outputStream&&this.outputStream.getTracks().forEach((function(e){e.stop()})),this.outputStream=new MediaStream([this.outputVideoTrack]),this.stream&&this.stream.getAudioTracks().forEach((function(t,r){e.outputStream.addTrack(t)})),this.trackProcessor=new MediaStreamTrackProcessor({track:t,maxBufferSize:4}),this.timestamp=performance.now();var r=this,n=new TransformStream({transform:function(e,t){return kh(Eh().mark((function n(){return Eh().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.handleFrames(e,t);case 2:case"end":return n.stop()}}),n)})))()}});this.trackProcessor.readable.pipeThrough(n,{signal:this.aborter.signal}).pipeTo(this.outputVideoTrack.writable).catch((function(e){var t;o.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:o.E7.SRTEAM_PROCESSOR,cause:e})}))}else o.ie.notify({message:"there is no videoTrack to process",emitter:o.E7.SRTEAM_PROCESSOR})}},{key:"getStream",value:function(){return this.outputStream}}],n&&Ph(r.prototype,n),i&&Ph(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(R);function Fh(e){return Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(e)}function Nh(){Nh=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Fh(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Fh(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Uh(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function jh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gh(n.key),n)}}function Gh(e){var t=function(e,t){if("object"!=Fh(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fh(t)?t:String(t)}function zh(e,t,r){return t=Wh(t),function(e,t){if(t&&("object"===Fh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Vh()?Reflect.construct(t,r||[],Wh(e).constructor):t.apply(e,r))}function Vh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vh=function(){return!!e})()}function Hh(){return Hh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wh(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Hh.apply(this,arguments)}function Wh(e){return Wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wh(e)}function Yh(e,t){return Yh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yh(e,t)}var Kh=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=zh(this,t,[e])).timing=performance.now(),r}var r,n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yh(e,t)}(t,e),r=t,n=[{key:"gatherByCallback",value:(o=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Uh(o,n,i,a,s,"next",e)}function s(e){Uh(o,n,i,a,s,"throw",e)}a(void 0)}))}}(Nh().mark((function e(){var t=this;return Nh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.gatherFramesTimeout=setTimeout((function(){t.inputVideo.requestVideoFrameCallback((function(){return t.gatherByCallback()}))}),0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"stopTimers",value:function(){if(Hh(Wh(t.prototype),"stopTimers",this).call(this),this.requestVideoFrameID)try{this.inputVideo.cancelVideoFrameCallback(this.requestVideoFrameID),this.requestVideoFrameID=0}catch(e){}}}],n&&jh(r.prototype,n),i&&jh(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(yh);function Xh(e){return Xh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xh(e)}function Zh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qh(n.key),n)}}function qh(e){var t=function(e,t){if("object"!=Xh(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Xh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xh(t)?t:String(t)}var Jh,Qh,ec,tc,rc,nc,ic,oc,ac,sc,uc,lc,hc,cc,dc,fc,pc,yc,gc,mc,wc,bc,vc,xc,_c,Ic,Ac,Sc,Tc,Cc,Ec,Oc={transform:Lh,videocallback:Kh,animationcallback:Th},kc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"getStreamProcessor",value:function(e,t){return new Oc[e](t)}}],(r=null)&&Zh(t.prototype,r),n&&Zh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Pc=r(1472),$c=r(6512),Rc=r(3296).Sn,Bc=Object.defineProperty,Dc=Object.getOwnPropertyDescriptor,Mc=Object.getOwnPropertyNames,Lc=Object.prototype.hasOwnProperty,Fc=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):e)((function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')})),Nc=(e,t)=>()=>(e&&(t=e(e=0)),t),Uc=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),jc=(e,t)=>{for(var r in t)Bc(e,r,{get:t[r],enumerable:!0})},Gc=e=>((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of Mc(t))!Lc.call(e,i)&&i!==r&&Bc(e,i,{get:()=>t[i],enumerable:!(n=Dc(t,i))||n.enumerable});return e})(Bc({},"__esModule",{value:!0}),e),zc=Nc((()=>{Jh=new Map,Qh=[],ec=(e,t,r)=>{if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{let n=Jh.get(e);if(void 0===n)Jh.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let t=Qh.indexOf(e);-1!==t&&Qh.splice(t,1);for(let t=0;t<Qh.length;t++)if(Jh.get(Qh[t]).priority<=r)return void Qh.splice(t,0,e);Qh.push(e)}}},tc=async e=>{let t=0===e.length?Qh:e,r=[];for(let e of t){let t=Jh.get(e);if(t){if(t.initialized)return t.backend;if(t.aborted)continue;let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(i){n||r.push({name:e,err:i}),t.aborted=!0}finally{delete t.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map((e=>`[${e.name}] ${e.err}`)).join(", ")}`)}})),Vc=Nc((()=>{zc()})),Hc=Nc((()=>{rc="1.17.0"})),Wc=Nc((()=>{Hc(),nc="warning",ic={wasm:{},webgl:{},webgpu:{},versions:{common:rc},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error(`Unsupported logging level: ${e}`);nc=e}},get logLevel(){return nc}},Object.defineProperty(ic,"logLevel",{enumerable:!0})})),Yc=Nc((()=>{Wc(),oc=ic})),Kc=Nc((()=>{ac=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(null!=n){let i,o;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);let a,s,u=void 0!==t?.format?t.format:"RGB",l=t?.norm;void 0===l||void 0===l.mean?a=[255,255,255,255]:"number"==typeof l.mean?a=[l.mean,l.mean,l.mean,l.mean]:(a=[l.mean[0],l.mean[1],l.mean[2],0],void 0!==l.mean[3]&&(a[3]=l.mean[3])),void 0===l||void 0===l.bias?s=[0,0,0,0]:"number"==typeof l.bias?s=[l.bias,l.bias,l.bias,l.bias]:(s=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(s[3]=l.bias[3]));let h=o*i,c=0,d=h,f=2*h,p=-1;"RGBA"===u?(c=0,d=h,f=2*h,p=3*h):"RGB"===u?(c=0,d=h,f=2*h):"RBG"===u&&(c=0,f=h,d=2*h);for(let t=0;t<o;t++)for(let r=0;r<i;r++){let i=(e.data[c++]-s[0])*a[0],o=(e.data[d++]-s[1])*a[1],u=(e.data[f++]-s[2])*a[2],l=-1===p?255:(e.data[p++]-s[3])*a[3];n.fillStyle="rgba("+i+","+o+","+u+","+l+")",n.fillRect(r,t,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},sc=(e,t)=>{let r,n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==n)throw new Error("Can not access image data");{let i,o,a;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[1],a=e.dims[3]):(i=e.dims[3],o=e.dims[2],a=e.dims[1]);let s,u,l=void 0!==t&&void 0!==t.format?t.format:"RGB",h=t?.norm;void 0===h||void 0===h.mean?s=[255,255,255,255]:"number"==typeof h.mean?s=[h.mean,h.mean,h.mean,h.mean]:(s=[h.mean[0],h.mean[1],h.mean[2],255],void 0!==h.mean[3]&&(s[3]=h.mean[3])),void 0===h||void 0===h.bias?u=[0,0,0,0]:"number"==typeof h.bias?u=[h.bias,h.bias,h.bias,h.bias]:(u=[h.bias[0],h.bias[1],h.bias[2],0],void 0!==h.bias[3]&&(u[3]=h.bias[3]));let c=o*i;if(void 0!==t&&(void 0!==t.format&&4===a&&"RGBA"!==t.format||3===a&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");let d=4,f=0,p=1,y=2,g=3,m=0,w=c,b=2*c,v=-1;"RGBA"===l?(m=0,w=c,b=2*c,v=3*c):"RGB"===l?(m=0,w=c,b=2*c):"RBG"===l&&(m=0,b=c,w=2*c),r=n.createImageData(i,o);for(let t=0;t<o*i;f+=d,p+=d,y+=d,g+=d,t++)r.data[f]=(e.data[m++]-u[0])*s[0],r.data[p]=(e.data[w++]-u[1])*s[1],r.data[y]=(e.data[b++]-u[2])*s[2],r.data[g]=-1===v?255:(e.data[v++]-u[3])*s[3]}return r}})),Xc=Nc((()=>{Jc(),uc=(e,t)=>{if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");let r,n,{height:i,width:o}=t,a=t.norm??{mean:255,bias:0};r="number"==typeof a.mean?[a.mean,a.mean,a.mean,a.mean]:[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],n="number"==typeof a.bias?[a.bias,a.bias,a.bias,a.bias]:[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let s=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",l=i*o,h="RGBA"===u?new Float32Array(4*l):new Float32Array(3*l),c=4,d=0,f=1,p=2,y=3,g=0,m=l,w=2*l,b=-1;"RGB"===s&&(c=3,d=0,f=1,p=2,y=-1),"RGBA"===u?b=3*l:"RBG"===u?(g=0,w=l,m=2*l):"BGR"===u&&(w=0,m=l,g=2*l);for(let t=0;t<l;t++,d+=c,p+=c,f+=c,y+=c)h[g++]=(e[d]+n[0])/r[0],h[m++]=(e[f]+n[1])/r[1],h[w++]=(e[p]+n[2])/r[2],-1!==b&&-1!==y&&(h[b++]=(e[y]+n[3])/r[3]);return new bc("float32",h,"RGBA"===u?[1,4,i,o]:[1,3,i,o])},lc=async(e,t)=>{let r,n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,i=typeof ImageData<"u"&&e instanceof ImageData,o=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,a="string"==typeof e,s=t??{},u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=e=>e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null==i)throw new Error("Can not access image data");{let n=e.height,o=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(n=t.resizedHeight,o=t.resizedWidth),void 0!==t){if(s=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=n,s.width=o}else s.tensorFormat="RGBA",s.height=n,s.width=o;i.drawImage(e,0,0),r=i.getImageData(0,0,o,n).data}}else{if(!i){if(o){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null!=i){let t=e.height,n=e.width;return i.drawImage(e,0,0,n,t),r=i.getImageData(0,0,n,t).data,s.height=t,s.width=n,uc(r,s)}throw new Error("Can not access image data")}if(a)return new Promise(((t,r)=>{let n=u(),i=l(n);if(!e||!i)return r();let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{n.width=o.width,n.height=o.height,i.drawImage(o,0,0,n.width,n.height);let e=i.getImageData(0,0,n.width,n.height);s.height=n.height,s.width=n.width,t(uc(e.data,s))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{let n,i;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,i=t.resizedWidth):(n=e.height,i=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=n,s.width=i,void 0!==t){let t=u();t.width=i,t.height=n;let o=l(t);if(null==o)throw new Error("Can not access image data");o.putImageData(e,0,0),r=o.getImageData(0,0,i,n).data}else r=e.data}}if(void 0!==r)return uc(r,s);throw new Error("Input data provided is not supported - aborted tensor creation")},hc=(e,t)=>{let{width:r,height:n,download:i,dispose:o}=t;return new bc({location:"texture",type:"float32",texture:e,dims:[1,n,r,4],download:i,dispose:o})},cc=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:o}=t;return new bc({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:i,dispose:o})},dc=(e,t,r)=>new bc({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})})),Zc=Nc((()=>{fc=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),pc=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),yc=!1,gc=()=>{if(!yc){yc=!0;let e=typeof BigInt64Array<"u"&&"function"==typeof BigInt64Array.from,t=typeof BigUint64Array<"u"&&"function"==typeof BigUint64Array.from;e&&(fc.set("int64",BigInt64Array),pc.set(BigInt64Array,"int64")),t&&(fc.set("uint64",BigUint64Array),pc.set(BigUint64Array,"uint64"))}}})),qc=Nc((()=>{Jc(),mc=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if("number"!=typeof n||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},wc=(e,t)=>{switch(e.location){case"cpu":return new bc(e.type,e.data,t);case"cpu-pinned":return new bc({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new bc({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new bc({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}})),Jc=Nc((()=>{Kc(),Xc(),Zc(),qc(),bc=class{constructor(e,t,r){let n,i;if(gc(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{let t=fc.get(n);if(!t)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw new TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==n&&"float16"!==n&&"int32"!==n&&"int64"!==n&&"uint32"!==n&&"bool"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,a;if("string"==typeof e)if(n=e,a=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{let r=fc.get(e);if(void 0===r)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");o="uint64"===e||"int64"===e?r.from(t,BigInt):r.from(t)}else{if(!(t instanceof r))throw new TypeError(`A ${n} tensor's data must be type of ${r}`);o=t}}else if(a=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)n="string",o=e;else{if("boolean"!==t)throw new TypeError(`Invalid element type of data array: ${t}.`);n="bool",o=Uint8Array.from(e)}}else{let t=pc.get(e.constructor);if(void 0===t)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=t,o=e}if(void 0===a)a=[o.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");i=a,this.cpuData=o,this.dataLocation="cpu"}let o=mc(i);if(this.cpuData&&o!==this.cpuData.length)throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=i,this.size=o}static async fromImage(e,t){return lc(e,t)}static fromTexture(e,t){return hc(e,t)}static fromGpuBuffer(e,t){return cc(e,t)}static fromPinnedBuffer(e,t,r){return dc(e,t,r)}toDataURL(e){return ac(this,e)}toImageData(e){return sc(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return wc(this,e)}}})),Qc=Nc((()=>{Jc(),vc=bc})),ed=Nc((()=>{Wc(),xc=(e,t)=>{ic.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},_c=(e,t)=>{let r=(new Error).stack?.split(/\r\n|\r|\n/g)||[],n=!1;for(let i=0;i<r.length;i++){if(n&&!r[i].includes("TRACE_FUNC")){let n=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;return t&&(n+=`::${t}`),void xc("CPU",n)}r[i].includes("TRACE_FUNC")&&(n=!0)}},Ic=e=>{ic.wasm.trace&&_c("BEGIN",e)},Ac=e=>{ic.wasm.trace&&_c("END",e)}})),td=Nc((()=>{zc(),Qc(),ed(),Sc=class e{constructor(e){this.handler=e}async run(e,t,r){Ic();let n={},i={};if("object"!=typeof e||null===e||e instanceof vc||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if("object"==typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof vc)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let e of t){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);n[e]=null}if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,a=Object.getOwnPropertyNames(t);for(let r of this.outputNames)if(-1!==a.indexOf(r)){let i=t[r];(null===i||i instanceof vc)&&(e=!0,o=!1,n[r]=i)}if(e){if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(typeof e[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(o)for(let e of this.outputNames)n[e]=null;let a=await this.handler.run(e,n,i),s={};for(let e in a)if(Object.hasOwnProperty.call(a,e)){let t=a[e];s[e]=t instanceof vc?t:new vc(t.type,t.data,t.dims)}return Ac(),s}async release(){return this.handler.dispose()}async configure(e){return await this.handler.configure(e)}async auth(e){return await this.handler.auth(e)}static async create(t,r,n,i){Ic();let o,a={};if("string"==typeof t){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{if(!(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{let e=t,s=0,u=t.byteLength;if("object"==typeof r&&null!==r)a=r;else if("number"==typeof r){if(s=r,!Number.isSafeInteger(s))throw new RangeError("'byteOffset' must be an integer.");if(s<0||s>=e.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(u=t.byteLength-s,"number"==typeof n){if(u=n,!Number.isSafeInteger(u))throw new RangeError("'byteLength' must be an integer.");if(u<=0||s+u>e.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${e.byteLength-s}].`);if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(e,s,u)}}let s=(a.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),u=await(await tc(s)).createInferenceSessionHandler(o,a);return Ac(),new e(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}})),rd=Nc((()=>{td(),Tc=Sc})),nd=Nc((()=>{})),id=Nc((()=>{zc(),Qc(),"Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Cc=class e{constructor(e,t,r){this.handler=e,this.hasOptimizerModel=t,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(t,r){let n=t.evalModel||"",i=t.optimizerModel||"",o=r||{},a=(o.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),s=await tc(a);if(s.createTrainingSessionHandler){let r=await s.createTrainingSessionHandler(t.checkpointState,t.trainModel,n,i,o);return new e(r,!!t.optimizerModel,!!t.evalModel)}throw new Error("Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.")}typeNarrowingForRunStep(e,t,r,n,i){let o={},a={};if("object"!=typeof r||null===r||r instanceof vc||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if("object"==typeof n){if(null===n)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof vc)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(0===n.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let e of n){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);o[e]=null}if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,r=Object.getOwnPropertyNames(n);for(let i of t)if(-1!==r.indexOf(i)){let t=n[i];(null===t||t instanceof vc)&&(e=!0,s=!1,o[i]=t)}if(e){if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else a=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of e)if(typeof r[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(s)for(let e of t)o[e]=null;return[o,a]}convertHandlerReturnTypeToMapOfTensors(e){let t={};for(let r in e)if(Object.hasOwnProperty.call(e,r)){let n=e[r];t[r]=n instanceof vc?n:new vc(n.type,n.data,n.dims)}return t}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(e,t,r){let[n,i]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,t,r),o=await this.handler.runTrainStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}async runOptimizerStep(e){if(!this.hasOptimizerModel)throw new Error("This TrainingSession has no OptimizerModel loaded.");await this.handler.runOptimizerStep(e||{})}async runEvalStep(e,t,r){if(this.hasEvalModel){let[n,i]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,t,r),o=await this.handler.runEvalStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(e=!0){return this.handler.getParametersSize(e)}async loadParametersBuffer(e,t=!0){let r=await this.getParametersSize(t);if(e.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,t)}async getContiguousParameters(e=!0){return this.handler.getContiguousParameters(e)}async release(){return this.handler.dispose()}}})),od=Nc((()=>{id(),Ec=Cc})),ad={};jc(ad,{InferenceSession:()=>Tc,TRACE:()=>xc,TRACE_FUNC_BEGIN:()=>Ic,TRACE_FUNC_END:()=>Ac,Tensor:()=>vc,TrainingSession:()=>Ec,env:()=>oc,registerBackend:()=>ec});var sd=Nc((()=>{Vc(),Yc(),rd(),Qc(),ed(),nd(),od()})),ud={};jc(ud,{createReadStream:()=>cd,readFile:()=>ld,readFileSync:()=>hd});var ld,hd,cd,dd=Nc((()=>{ld=void 0,hd=void 0,cd=void 0})),fd={};jc(fd,{join:()=>pd});var pd,yd=Nc((()=>{pd=void 0})),gd=Uc(((e,t)=>{var r=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){var r,n,i=t;i.ready=new Promise(((e,t)=>{r=e,n=t})),i.mountExternalData=(e,t)=>{(i.Ka||(i.Ka=new Map)).set(e,t)},i.unmountExternalData=()=>{delete i.Ka},i.jsepInit=(e,t,r,n,o,a,s,u)=>{i.gb=e,i.Wa=t,i.Ya=r,i.Qa=n,i.Xa=o,i.Ba=a,i.Za=s,i.$a=u,t=(e,t,r)=>(...n)=>{let i=fe,o=t?.();n=e(...n);let a=t?.();return o!==a&&(e=a,r(o),t=r=null),fe!=i?new Promise(((e,t)=>{be={resolve:e,reject:t}})):n},r=t=>async(...r)=>{try{if(i.Ja)throw Error("Session already started");let n=i.Ja={ab:r[0],errors:[]},o=await t(...r);if(i.Ja!==n)throw Error("Session mismatch");e.flush();let a=n.errors;if(0<a.length){let e=await Promise.all(a);if(e=e.filter((e=>e)),0<e.length)throw Error(e.join("\n"))}return o}finally{i.Ja=null}},i._OrtRun=r(t(i._OrtRun,(()=>i._OrtRun),(e=>i._OrtRun=e))),i._OrtRunWithBinding=r(t(i._OrtRunWithBinding,(()=>i._OrtRunWithBinding),(e=>i._OrtRunWithBinding=e))),i._OrtBindInput=t(i._OrtBindInput,(()=>i._OrtBindInput),(e=>i._OrtBindInput=e)),i.jsepRegisterBuffer=(t,r,n,i)=>e.registerBuffer(t,r,n,i),i.jsepUnregisterBuffers=t=>{e.unregisterBuffers(t)},i.jsepGetBuffer=t=>e.getBuffer(t),i.jsepCreateDownloader=(t,r,n)=>e.createDownloader(t,r,n)};var o,a,s,u=Object.assign({},i),l="./this.program",h=(e,t)=>{throw t},c="object"==typeof window,d="function"==typeof importScripts,f="object"==typeof $c&&"object"==typeof $c.versions&&"string"==typeof $c.versions.node,p="";if(f){var y=(dd(),Gc(ud)),g=(yd(),Gc(fd));p=d?g.dirname(p)+"/":__dirname+"/",o=(e,t)=>(e=F(e)?new URL(e):g.normalize(e),y.readFileSync(e,t?void 0:"utf8")),s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),a=(e,t,r,n=!0)=>{e=F(e)?new URL(e):g.normalize(e),y.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!i.thisProgram&&1<$c.argv.length&&(l=$c.argv[1].replace(/\\/g,"/")),$c.argv.slice(2),h=(e,t)=>{throw $c.exitCode=e,t},i.inspect=()=>"[Emscripten Module object]"}else(c||d)&&(d?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),e&&(p=e),p=0!==p.indexOf("blob:")?p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},d&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var m=console.log.bind(console),w=console.error.bind(console);Object.assign(i,u),u=null,"object"!=typeof WebAssembly&&D("no native wasm support detected");var b,v,x,_,I,A,S,T,C=!1;function E(){var e=b.buffer;i.HEAP8=x=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=_=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=I=new Int32Array(e),i.HEAPU32=A=new Uint32Array(e),i.HEAPF32=S=new Float32Array(e),i.HEAPF64=T=new Float64Array(e)}var O=[],k=[],P=[],$=0,R=null,B=null;function D(e){throw w(e="Aborted("+e+")"),C=!0,v=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var M,L=e=>e.startsWith("data:application/octet-stream;base64,"),F=e=>e.startsWith("file://");if(!L(M="ort-wasm-simd.wasm")){var N=M;M=i.locateFile?i.locateFile(N,p):p+N}function U(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function j(e,t,r){return function(e){if(c||d){if("function"==typeof fetch&&!F(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>U(e)));if(a)return new Promise(((t,r)=>{a(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>U(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{w(`failed to asynchronously prepare wasm: ${e}`),D(e)}))}var G,z={898080:(e,t,r,n)=>{if(typeof i>"u"||!i.Ka)return 1;if((e=X(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ka.get(e)))return 2;if((t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return _.set(e.subarray(t,t+r),n>>>0>>>0),0}catch{return 4}},898581:e=>i.Wa(e),898614:e=>i.Ya(e),898646:(e,t,r)=>{i.Qa(e,t,r,!0)},898685:(e,t,r)=>{i.Qa(e,t,r)},898718:e=>{i.Ba("Abs",e,void 0)},898769:e=>{i.Ba("Neg",e,void 0)},898820:e=>{i.Ba("Floor",e,void 0)},898873:e=>{i.Ba("Ceil",e,void 0)},898925:e=>{i.Ba("Reciprocal",e,void 0)},898983:e=>{i.Ba("Sqrt",e,void 0)},899035:e=>{i.Ba("Exp",e,void 0)},899086:e=>{i.Ba("Erf",e,void 0)},899137:e=>{i.Ba("Sigmoid",e,void 0)},899192:e=>{i.Ba("Log",e,void 0)},899243:e=>{i.Ba("Sin",e,void 0)},899294:e=>{i.Ba("Cos",e,void 0)},899345:e=>{i.Ba("Tan",e,void 0)},899396:e=>{i.Ba("Asin",e,void 0)},899448:e=>{i.Ba("Acos",e,void 0)},899500:e=>{i.Ba("Atan",e,void 0)},899552:e=>{i.Ba("Sinh",e,void 0)},899604:e=>{i.Ba("Cosh",e,void 0)},899656:e=>{i.Ba("Asinh",e,void 0)},899709:e=>{i.Ba("Acosh",e,void 0)},899762:e=>{i.Ba("Atanh",e,void 0)},899815:e=>{i.Ba("Tanh",e,void 0)},899867:e=>{i.Ba("Not",e,void 0)},899918:(e,t,r)=>{i.Ba("Clip",e,{min:t,max:r})},899987:e=>{i.Ba("Clip",e,void 0)},900039:(e,t)=>{i.Ba("Elu",e,{alpha:t})},900097:e=>{i.Ba("Relu",e,void 0)},900149:(e,t)=>{i.Ba("LeakyRelu",e,{alpha:t})},900213:(e,t)=>{i.Ba("ThresholdedRelu",e,{alpha:t})},900283:(e,t)=>{i.Ba("Cast",e,{to:t})},900341:e=>{i.Ba("Add",e,void 0)},900392:e=>{i.Ba("Sub",e,void 0)},900443:e=>{i.Ba("Mul",e,void 0)},900494:e=>{i.Ba("Div",e,void 0)},900545:e=>{i.Ba("Pow",e,void 0)},900596:e=>{i.Ba("Equal",e,void 0)},900649:e=>{i.Ba("Greater",e,void 0)},900704:e=>{i.Ba("GreaterOrEqual",e,void 0)},900766:e=>{i.Ba("Less",e,void 0)},900818:e=>{i.Ba("LessOrEqual",e,void 0)},900877:(e,t,r,n,o)=>{i.Ba("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},901036:(e,t,r,n,o)=>{i.Ba("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},901194:(e,t,r,n,o)=>{i.Ba("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},901352:(e,t,r,n,o)=>{i.Ba("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},901511:(e,t,r,n,o)=>{i.Ba("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},901669:(e,t,r,n,o)=>{i.Ba("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},901826:(e,t,r,n,o)=>{i.Ba("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},901983:(e,t,r,n,o)=>{i.Ba("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},902144:(e,t,r,n,o)=>{i.Ba("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},902308:(e,t,r,n,o)=>{i.Ba("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},902472:e=>{i.Ba("Where",e,void 0)},902525:(e,t,r)=>{i.Ba("Transpose",e,{perm:t?Array.from(I.subarray(t>>>0,r>>>0)):[]})},902633:(e,t,r,n,o,a,s,u,l,h,c,d,f,p,y)=>{i.Ba("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:[r],group:n,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:()=>!!x[h>>>0],outputPadding:c?Array.from(I.subarray(c>>>0,d>>>0)):[],outputShape:f?Array.from(I.subarray(f>>>0,p>>>0)):[],activation:X(y)})},903035:(e,t,r,n,o,a,s,u,l,h,c,d,f,p)=>{i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(I.subarray(r>>>0,2+(r>>>0)>>>0)),group:n,kernelShape:Array.from(I.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(I.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(I.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:()=>!!x[l>>>0],outputPadding:h?Array.from(I.subarray(h>>>0,c>>>0)):[],outputShape:d?Array.from(I.subarray(d>>>0,f>>>0)):[],activation:X(p)})},903600:(e,t,r,n,o,a,s,u,l,h,c,d,f,p,y)=>{i.Ba("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:[r],group:n,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:()=>!!x[h>>>0],outputPadding:c?Array.from(I.subarray(c>>>0,d>>>0)):[],outputShape:f?Array.from(I.subarray(f>>>0,p>>>0)):[],activation:X(y)})},904002:(e,t,r,n,o,a,s,u,l,h,c,d,f,p)=>{i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(I.subarray(r>>>0,2+(r>>>0)>>>0)),group:n,kernelShape:Array.from(I.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(I.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(I.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:()=>!!x[l>>>0],outputPadding:h?Array.from(I.subarray(h>>>0,c>>>0)):[],outputShape:d?Array.from(I.subarray(d>>>0,f>>>0)):[],activation:X(p)})},904567:(e,t)=>{i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},904658:(e,t,r,n,o,a,s,u,l,h,c,d,f,p,y,g)=>{i.Ba("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,d,f],strides:[p,y]})},904942:(e,t)=>{i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},905033:(e,t,r,n,o,a,s,u,l,h,c,d,f,p,y,g)=>{i.Ba("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,d,f],strides:[p,y]})},905317:(e,t)=>{i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},905404:(e,t,r,n,o,a,s,u,l,h,c,d,f,p,y,g)=>{i.Ba("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,d,f],strides:[p,y]})},905684:(e,t)=>{i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},905771:(e,t,r,n,o,a,s,u,l,h,c,d,f,p,y,g)=>{i.Ba("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,d,f],strides:[p,y]})},906051:(e,t,r,n,o)=>{i.Ba("Gemm",e,{alpha:t,beta:r,transA:n,transB:o})},906155:e=>{i.Ba("MatMul",e,void 0)},906209:(e,t,r,n)=>{i.Ba("ArgMax",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},906317:(e,t,r,n)=>{i.Ba("ArgMin",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},906425:(e,t)=>{i.Ba("Softmax",e,{axis:t})},906488:(e,t)=>{i.Ba("Concat",e,{axis:t})},906548:(e,t,r,n,o)=>{i.Ba("Split",e,{axis:t,numOutputs:r,splitSizes:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},906688:e=>{i.Ba("Expand",e,void 0)},906742:(e,t)=>{i.Ba("Gather",e,{axis:Number(t)})},906813:(e,t)=>{i.Ba("GatherElements",e,{axis:Number(t)})},906892:(e,t,r,n,o,a,s,u,l,h,c)=>{i.Ba("Resize",e,{antialias:t,axes:r?Array.from(I.subarray(r>>>0,n>>>0)):[],coordinateTransformMode:X(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:X(l),mode:X(h),nearestMode:X(c)})},907238:(e,t,r,n,o,a,s)=>{i.Ba("Slice",e,{starts:t?Array.from(I.subarray(t>>>0,r>>>0)):[],ends:n?Array.from(I.subarray(n>>>0,o>>>0)):[],axes:a?Array.from(I.subarray(a>>>0,s>>>0)):[]})},907454:e=>{i.Ba("Tile",e,void 0)},907506:(e,t,r)=>{i.Ba("LayerNormalization",e,{axis:Number(t),epsilon:Number(r)})},907613:(e,t,r)=>{i.Ba("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},907727:(e,t,r)=>{i.Ba("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},907841:e=>{i.Ba("Range",e,void 0)},907894:(e,t)=>{i.Ba("Einsum",e,{equation:X(t)})},907975:(e,t,r,n,o)=>{i.Ba("Pad",e,{mode:t,value:r,pads:n?Array.from(I.subarray(n>>>0,o>>>0)):[]})},908102:(e,t,r,n,o,a)=>{i.Ba("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!o,trainingMode:!!n,format:a?"NHWC":"NCHW"})},908271:(e,t,r,n,o,a)=>{i.Ba("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!o,trainingMode:!!n,format:a?"NHWC":"NCHW"})},908440:(e,t,r)=>{i.Ba("CumSum",e,{exclusive:Number(t),reverse:Number(r)})},908537:(e,t,r,n,o,a,s,u,l)=>{i.Ba("Attention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(I.subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!l})},908809:e=>{i.Ba("Gelu",e,void 0)},908861:(e,t,r,n,o,a)=>{i.Ba("MultiHeadAttention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a})},909020:e=>{i.Ba("BiasAdd",e,void 0)},909075:e=>{i.Ba("BiasSplitGelu",e,void 0)},909136:(e,t)=>{i.Ba("SkipLayerNormalization",e,{epsilon:t})},909217:(e,t,r,n,o,a,s,u,l,h,c,d,f)=>{i.Ba("Conv",e,{format:l?"NHWC":"NCHW",auto_pad:t,dilations:[r],group:n,kernel_shape:[o],pads:a?Array.from(I.subarray(a>>>0,s>>>0)):[],strides:[u],w_is_const:()=>!!x[h>>>0],activation:X(c),activation_params:d?Array.from(S.subarray(d>>>0,f>>>0)):[]})},909587:(e,t,r,n,o,a,s,u,l,h,c,d,f,p,y,g)=>{i.Ba("Conv",e,{format:d?"NHWC":"NCHW",auto_pad:t,dilations:[r,n],group:o,kernel_shape:[a,s],pads:u?Array.from(I.subarray(u>>>0,l>>>0)):[],strides:[h,c],w_is_const:()=>!!x[f>>>0],activation:X(p),activation_params:y?Array.from(S.subarray(y>>>0,g>>>0)):[]})},909978:e=>{i.Za(e)},910012:(e,t)=>i.$a(e,t,i.Ja.ab,i.Ja.errors)};function V(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}function H(e){this.Na=e-24,this.Ua=function(e){A[this.Na+4>>>2>>>0]=e},this.Ta=function(e){A[this.Na+8>>>2>>>0]=e},this.Ra=function(e,t){this.Sa(),this.Ua(e),this.Ta(t)},this.Sa=function(){A[this.Na+16>>>2>>>0]=0}}var W,Y=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,K=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&Y)return Y.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},X=(e,t)=>(e>>>=0)?K(_,e,t):"",Z=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},q=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},J=e=>e%4==0&&(e%100!=0||e%400==0),Q=[0,31,60,91,121,152,182,213,244,274,305,335],ee=[0,31,59,90,120,151,181,212,243,273,304,334],te=e=>{var t=Z(e)+1,r=Pe(t);return r&&q(e,_,r,t),r},re=[],ne=(e,t)=>{re.length=0;for(var r;r=_[e++>>>0];){var n=105!=r;t+=(n&=112!=r)&&t%8?4:0,re.push(112==r?A[t>>>2>>>0]:105==r?I[t>>>2>>>0]:T[t>>>3>>>0]),t+=n?8:4}return re},ie={},oe=()=>{if(!W){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(e in ie)void 0===ie[e]?delete t[e]:t[e]=ie[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);W=r}return W},ae=[null,[],[]],se=e=>(se=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);if(f)try{var e=Fc("crypto");if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}D("initRandomDevice")})())(e),ue=[31,29,31,30,31,30,31,31,30,31,30,31],le=[31,28,31,30,31,30,31,31,30,31,30,31];function he(e,t,r,n){function i(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function o(e,t){return i(e,t,"0")}function a(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.Ha;for(e=new Date(new Date(e.Ia+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(J(e.getFullYear())?ue:le)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=a(t,e)?0>=a(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0;var l=A[(n>>>=0)+40>>>2>>>0];for(var h in n={eb:I[n>>>2>>>0],cb:I[n+4>>>2>>>0],La:I[n+8>>>2>>>0],Pa:I[n+12>>>2>>>0],Ma:I[n+16>>>2>>>0],Ia:I[n+20>>>2>>>0],Ga:I[n+24>>>2>>>0],Ha:I[n+28>>>2>>>0],hb:I[n+32>>>2>>>0],bb:I[n+36>>>2>>>0],fb:l?X(l):""},r=X(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(h,"g"),l[h]);var c="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d="January February March April May June July August September October November December".split(" ");for(h in l={"%a":e=>c[e.Ga].substring(0,3),"%A":e=>c[e.Ga],"%b":e=>d[e.Ma].substring(0,3),"%B":e=>d[e.Ma],"%C":e=>o((e.Ia+1900)/100|0,2),"%d":e=>o(e.Pa,2),"%e":e=>i(e.Pa,2," "),"%g":e=>u(e).toString().substring(2),"%G":e=>u(e),"%H":e=>o(e.La,2),"%I":e=>(0==(e=e.La)?e=12:12<e&&(e-=12),o(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.Ma-1;t+=(J(e.Ia+1900)?ue:le)[r++]);return o(e.Pa+t,3)},"%m":e=>o(e.Ma+1,2),"%M":e=>o(e.cb,2),"%n":()=>"\n","%p":e=>0<=e.La&&12>e.La?"AM":"PM","%S":e=>o(e.eb,2),"%t":()=>"\t","%u":e=>e.Ga||7,"%U":e=>o(Math.floor((e.Ha+7-e.Ga)/7),2),"%V":e=>{var t=Math.floor((e.Ha+7-(e.Ga+6)%7)/7);if(2>=(e.Ga+371-e.Ha-2)%7&&t++,t)53==t&&(4==(r=(e.Ga+371-e.Ha)%7)||3==r&&J(e.Ia)||(t=1));else{t=52;var r=(e.Ga+7-e.Ha-1)%7;(4==r||5==r&&J(e.Ia%400-1))&&t++}return o(t,2)},"%w":e=>e.Ga,"%W":e=>o(Math.floor((e.Ha+7-(e.Ga+6)%7)/7),2),"%y":e=>(e.Ia+1900).toString().substring(2),"%Y":e=>e.Ia+1900,"%z":e=>(0<=(e=e.bb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.fb,"%%":()=>"%"},r=r.replace(/%%/g,"\0\0"),l)r.includes(h)&&(r=r.replace(new RegExp(h,"g"),l[h](n)));return h=function(e){var t=Array(Z(e)+1);return q(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),h.length>t?0:(x.set(h,e>>>0),h.length-1)}var ce=e=>{try{e()}catch(e){D(e)}};var de=0,fe=null,pe=0,ye=[],ge={},me={},we=0,be=null,ve=[];function xe(e){if(!C){if(0===de){var t=!1,r=!1;e(((e=0)=>{if(!C&&(pe=e,t=!0,r)){de=2,ce((()=>Ne(fe))),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),e=!1;try{var n=(0,Ee[me[I[fe+8>>>2>>>0]]])()}catch(t){n=t,e=!0}var i=!1;if(!fe){var o=be;o&&(be=null,(e?o.reject:o.resolve)(n),i=!0)}if(e&&!i)throw n}})),r=!0,t||(de=1,fe=function(){var e=Pe(65548),t=e+12;A[e>>>2>>>0]=t,A[e+4>>>2>>>0]=t+65536,t=ye[0];var r=ge[t];return void 0===r&&(r=we++,ge[t]=r,me[r]=t),I[e+8>>>2>>>0]=r,e}(),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),ce((()=>Le(fe))))}else 2===de?(de=0,ce(Ue),$e(fe),fe=null,ve.forEach((e=>{if(!C)try{e();try{v=v=e=v,i.onExit?.(e),C=!0,h(e,new V(e))}catch(e){e instanceof V||"unwind"==e||h(1,e)}}catch(e){e instanceof V||"unwind"==e||h(1,e)}}))):D(`invalid state: ${de}`);return pe}}var _e,Ie,Ae=[],Se=[],Te=(e,t)=>{if(!Ie){Ie=new WeakMap;var r=_e.length;if(Ie)for(var n=0;n<0+r;n++){var i=n,o=Ae[i];o||(i>=Ae.length&&(Ae.length=i+1),Ae[i]=o=_e.get(i)),(i=o)&&Ie.set(i,n)}}if(r=Ie.get(e)||0)return r;if(Se.length)r=Se.pop();else{try{_e.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=_e.length-1}try{n=r,_e.set(n,e),Ae[n]=_e.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,_e.set(n,t),Ae[n]=_e.get(n)}return Ie.set(e,r),r},Ce={n:function(e,t,r){return function(e){return xe((t=>{e().then(t)}))}((async()=>{await i.Xa(e,t,r)}))},a:function(e,t,r){throw new H(e>>>=0).Ra(t>>>0,r>>>0),e},g:function(){return 0},M:function(){},C:function(){},E:function(){},v:function(){return 0},K:function(){},F:function(){},J:function(){},m:function(){},D:function(){},A:function(){},L:function(){},B:function(){},N:()=>1,q:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),I[r>>>2>>>0]=e.getUTCSeconds(),I[r+4>>>2>>>0]=e.getUTCMinutes(),I[r+8>>>2>>>0]=e.getUTCHours(),I[r+12>>>2>>>0]=e.getUTCDate(),I[r+16>>>2>>>0]=e.getUTCMonth(),I[r+20>>>2>>>0]=e.getUTCFullYear()-1900,I[r+24>>>2>>>0]=e.getUTCDay(),I[r+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},r:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),I[r>>>2>>>0]=e.getSeconds(),I[r+4>>>2>>>0]=e.getMinutes(),I[r+8>>>2>>>0]=e.getHours(),I[r+12>>>2>>>0]=e.getDate(),I[r+16>>>2>>>0]=e.getMonth(),I[r+20>>>2>>>0]=e.getFullYear()-1900,I[r+24>>>2>>>0]=e.getDay(),I[r+28>>>2>>>0]=(J(e.getFullYear())?Q:ee)[e.getMonth()]+e.getDate()-1|0,I[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();I[r+32>>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t))},s:function(e){e>>>=0;var t=new Date(I[e+20>>>2>>>0]+1900,I[e+16>>>2>>>0],I[e+12>>>2>>>0],I[e+8>>>2>>>0],I[e+4>>>2>>>0],I[e>>>2>>>0],0),r=I[e+32>>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>r?I[e+32>>>2>>>0]=+(i!=o&&a==n):0<r!=(a==n)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<r?a:i)-n))),I[e+24>>>2>>>0]=t.getDay(),I[e+28>>>2>>>0]=(J(t.getFullYear())?Q:ee)[t.getMonth()]+t.getDate()-1|0,I[e>>>2>>>0]=t.getSeconds(),I[e+4>>>2>>>0]=t.getMinutes(),I[e+8>>>2>>>0]=t.getHours(),I[e+12>>>2>>>0]=t.getDate(),I[e+16>>>2>>>0]=t.getMonth(),I[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(I[ke()>>>2>>>0]=61,e=-1):e/=1e3,Re((G=e,1<=+Math.abs(G)?0<G?+Math.floor(G/4294967296)>>>0:~~+Math.ceil((G-+(~~G>>>0))/4294967296)>>>0:0)),e>>>0},o:function(){return-52},p:function(){},y:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}r>>>=0;var i=(new Date).getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();A[e>>>0>>>2>>>0]=60*Math.max(i,s),I[t>>>0>>>2>>>0]=+(i!=s),e=n(o),t=n(a),e=te(e),t=te(t),s<i?(A[r>>>2>>>0]=e,A[r+4>>>2>>>0]=t):(A[r>>>2>>>0]=t,A[r+4>>>2>>>0]=e)},e:()=>{D("")},b:function(e,t,r){return e>>>=0,t=ne(t>>>0,r>>>0),z[e].apply(null,t)},j:function(e,t,r){return e>>>=0,t=ne(t>>>0,r>>>0),z[e].apply(null,t)},h:()=>Date.now(),z:function(){return 4294901760},c:()=>performance.now(),I:function(e,t,r){return t>>>=0,_.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0)},w:function(e){e>>>=0;var t=_.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var i=Math;n=Math.max(e,n);e:{i=(i.min.call(i,4294901760,n+(65536-n%65536)%65536)-b.buffer.byteLength+65535)/65536;try{b.grow(i),E();var o=1;break e}catch{}o=void 0}if(o)return!0}return!1},G:function(e,t){e>>>=0,t>>>=0;var r=0;return oe().forEach(((n,i)=>{var o=t+r;for(i=A[e+4*i>>>2>>>0]=o,o=0;o<n.length;++o)x[i++>>>0>>>0]=n.charCodeAt(o);x[i>>>0>>>0]=0,r+=n.length+1})),0},H:function(e,t){e>>>=0,t>>>=0;var r=oe();A[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),A[t>>>2>>>0]=n,0},f:()=>52,l:function(){return 52},t:function(){return 70},k:function(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var i=0,o=0;o<r;o++){var a=A[t>>>2>>>0],s=A[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var l=_[a+u>>>0],h=ae[e];0===l||10===l?((1===e?m:w)(K(h,0)),h.length=0):h.push(l)}i+=s}return A[n>>>2>>>0]=i,0},u:function(e,t){return e>>>=0,se(_.subarray(e>>>0,e+(t>>>0)>>>0)),0},x:he,d:function(e,t,r,n){return he(e>>>0,t>>>0,r>>>0,n>>>0)},i:function(e,t,r,n){let i=_e.length;e=new Uint8Array(_.slice(e+t,e+r));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:b}});for(o in s.exports)Te(s.exports[o]);return i<_e.length?i:n}catch(e){return console.log(e),n}}},Ee=function(){function e(e){return Ee=e.exports,Ee=function(){var e=Ee,t={};for(let[r,n]of Object.entries(e))t[r]="function"==typeof n?function(){ye.push(r);try{return n.apply(null,arguments)}finally{C||(ye.pop(),fe&&1===de&&0===ye.length&&(de=0,ce(Fe),typeof Fibers<"u"&&Fibers.ib()))}}:n;return t}(),Ee=function(){var e=Ee;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.ta=t(e.ta),e.ua=r(e.ua),e.ya=t(e.ya),e.Aa=r(e.Aa),e}(),b=Ee.O,E(),_e=Ee.wa,k.unshift(Ee.P),0==--$&&(null!==R&&(clearInterval(R),R=null),B&&(e=B,B=null,e())),Ee}var t={a:Ce};if($++,i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(e){w(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return function(e,t){var r=M;return"function"!=typeof WebAssembly.instantiateStreaming||L(r)||F(r)||f||"function"!=typeof fetch?j(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return w(`wasm streaming compile failed: ${n}`),w("falling back to ArrayBuffer instantiation"),j(r,e,t)}))))}(t,(function(t){e(t.instance)})).catch(n),{}}();i._OrtInit=(e,t)=>(i._OrtInit=Ee.Q)(e,t),i._OrtGetLastError=(e,t)=>(i._OrtGetLastError=Ee.R)(e,t),i._OrtCreateSessionOptions=(e,t,r,n,o,a,s,u,l,h)=>(i._OrtCreateSessionOptions=Ee.S)(e,t,r,n,o,a,s,u,l,h),i._OrtAppendExecutionProvider=(e,t)=>(i._OrtAppendExecutionProvider=Ee.T)(e,t),i._OrtAddFreeDimensionOverride=(e,t,r)=>(i._OrtAddFreeDimensionOverride=Ee.U)(e,t,r),i._OrtAddSessionConfigEntry=(e,t,r)=>(i._OrtAddSessionConfigEntry=Ee.V)(e,t,r),i._OrtReleaseSessionOptions=e=>(i._OrtReleaseSessionOptions=Ee.W)(e),i._OrtCreateSession=(e,t,r)=>(i._OrtCreateSession=Ee.X)(e,t,r),i._OrtReleaseSession=e=>(i._OrtReleaseSession=Ee.Y)(e),i._OrtGetInputOutputCount=(e,t,r)=>(i._OrtGetInputOutputCount=Ee.Z)(e,t,r),i._OrtGetInputName=(e,t)=>(i._OrtGetInputName=Ee._)(e,t),i._OrtGetOutputName=(e,t)=>(i._OrtGetOutputName=Ee.$)(e,t),i._OrtFree=e=>(i._OrtFree=Ee.aa)(e),i._OrtCreateTensor=(e,t,r,n,o,a)=>(i._OrtCreateTensor=Ee.ba)(e,t,r,n,o,a),i._OrtGetTensorData=(e,t,r,n,o)=>(i._OrtGetTensorData=Ee.ca)(e,t,r,n,o),i._OrtReleaseTensor=e=>(i._OrtReleaseTensor=Ee.da)(e),i._OrtCreateRunOptions=(e,t,r,n)=>(i._OrtCreateRunOptions=Ee.ea)(e,t,r,n),i._OrtAddRunConfigEntry=(e,t,r)=>(i._OrtAddRunConfigEntry=Ee.fa)(e,t,r),i._OrtReleaseRunOptions=e=>(i._OrtReleaseRunOptions=Ee.ga)(e),i._OrtCreateBinding=e=>(i._OrtCreateBinding=Ee.ha)(e),i._OrtBindInput=(e,t,r)=>(i._OrtBindInput=Ee.ia)(e,t,r),i._OrtBindOutput=(e,t,r,n)=>(i._OrtBindOutput=Ee.ja)(e,t,r,n),i._OrtClearBoundOutputs=e=>(i._OrtClearBoundOutputs=Ee.ka)(e),i._OrtReleaseBinding=e=>(i._OrtReleaseBinding=Ee.la)(e),i._OrtRunWithBinding=(e,t,r,n,o)=>(i._OrtRunWithBinding=Ee.ma)(e,t,r,n,o),i._OrtRun=(e,t,r,n,o,a,s,u)=>(i._OrtRun=Ee.na)(e,t,r,n,o,a,s,u),i._OrtEndProfiling=e=>(i._OrtEndProfiling=Ee.oa)(e),i._OrtConfigure=(e,t)=>(i._OrtConfigure=Ee.pa)(e,t),i._OrtAuth=(e,t)=>(i._OrtAuth=Ee.qa)(e,t),i._JsepOutput=(e,t,r)=>(i._JsepOutput=Ee.ra)(e,t,r),i._JsepGetNodeName=e=>(i._JsepGetNodeName=Ee.sa)(e);var Oe,ke=()=>(ke=Ee.ta)(),Pe=i._malloc=e=>(Pe=i._malloc=Ee.ua)(e),$e=i._free=e=>($e=i._free=Ee.va)(e),Re=e=>(Re=Ee.xa)(e),Be=()=>(Be=Ee.ya)(),De=e=>(De=Ee.za)(e),Me=e=>(Me=Ee.Aa)(e),Le=e=>(Le=Ee.Ca)(e),Fe=()=>(Fe=Ee.Da)(),Ne=e=>(Ne=Ee.Ea)(e),Ue=()=>(Ue=Ee.Fa)();function je(){if(!(0<$)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();O.unshift(e)}for(;0<O.length;)O.shift()(i);if(!(0<$||Oe||(Oe=!0,i.calledRun=!0,C))){for(;0<k.length;)k.shift()(i);for(r(i);0<P.length;)P.shift()(i)}}}return i.___start_em_js=910124,i.___stop_em_js=910897,i.stackAlloc=Me,i.stackSave=Be,i.stackRestore=De,i.addFunction=Te,i.UTF8ToString=X,i.stringToUTF8=(e,t,r)=>q(e,_,t,r),i.lengthBytesUTF8=Z,B=function e(){Oe||je(),Oe||(B=e)},je(),t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=r:"function"==typeof define&&define.amd&&define([],(()=>r))})),md=Uc((()=>{})),wd=Uc((()=>{})),bd={};jc(bd,{cpus:()=>vd});var vd,xd,_d,Id,Ad,Sd,Td,Cd,Ed,Od,kd,Pd,$d,Rd,Bd,Dd,Md,Ld,Fd,Nd,Ud,jd,Gd,zd,Vd,Hd,Wd,Yd,Kd,Xd,Zd,qd,Jd,Qd,ef,tf,rf,nf,of,af,sf,uf,lf,hf,cf,df,ff,pf,yf,gf,mf,wf,bf,vf,xf,_f,If,Af,Sf,Tf,Cf,Ef,Of,kf,Pf,$f,Rf,Bf,Df,Mf,Lf,Ff,Nf,Uf,jf,Gf,zf,Vf,Hf,Wf,Yf,Kf,Xf,Zf,qf,Jf,Qf,ep,tp,rp,np,ip,op,ap,sp,up,lp,hp,cp,dp,fp,pp,yp,gp,mp,wp,bp,vp,xp,_p,Ip,Ap,Sp,Tp,Cp,Ep,Op,kp,Pp,$p,Rp,Bp,Dp,Mp,Lp,Fp,Np,Up,jp,Gp,zp,Vp,Hp,Wp,Yp,Kp,Xp,Zp,qp,Jp,Qp,ey,ty,ry,ny,iy,oy,ay,sy,uy,ly,hy,cy,dy,fy,py,yy,gy,my,wy,by,vy,xy,_y,Iy,Ay,Sy,Ty,Cy,Ey,Oy,ky,Py,$y,Ry,By,Dy,My,Ly,Fy,Ny,Uy,jy,Gy,zy,Vy,Hy,Wy,Yy,Ky,Xy,Zy,qy,Jy,Qy,eg,tg,rg,ng,ig,og,ag,sg,ug,lg,hg,cg,dg,fg,pg,yg,gg,mg,wg,bg,vg,xg,_g,Ig,Ag,Sg,Tg,Cg,Eg,Og,kg,Pg,$g,Rg,Bg,Dg,Mg,Lg,Fg,Ng,Ug,jg,Gg,zg,Vg,Hg,Wg,Yg,Kg,Xg,Zg,qg,Jg,Qg,em,tm,rm,nm,im,om,am,sm,um,lm,hm,cm,dm,fm,pm,ym,gm,mm,wm,bm,vm,xm,_m,Im,Am,Sm,Tm,Cm,Em,Om,km,Pm,$m,Rm,Bm,Dm,Mm,Lm,Fm,Nm,Um,jm,Gm,zm,Vm,Hm,Wm,Ym,Km,Xm,Zm,qm,Jm,Qm,ew,tw,rw,nw,iw,ow,aw,sw,uw,lw,hw,cw,dw,fw,pw,yw,gw,mw,ww,bw,vw,xw,_w,Iw,Aw,Sw,Tw,Cw,Ew,Ow,kw,Pw,$w,Rw,Bw,Dw,Mw,Lw,Fw,Nw,Uw,jw,Gw,zw,Vw,Hw,Ww,Yw,Kw,Xw,Zw,qw,Jw,Qw,eb,tb,rb,nb,ib,ob,ab,sb,ub,lb,hb,cb,db=Nc((()=>{vd=void 0})),fb=Uc(((e,t)=>{var r=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){function r(){return O.buffer!=$.buffer&&N(),$}function n(){return O.buffer!=$.buffer&&N(),R}function i(){return O.buffer!=$.buffer&&N(),B}function o(){return O.buffer!=$.buffer&&N(),D}function a(){return O.buffer!=$.buffer&&N(),M}function s(){return O.buffer!=$.buffer&&N(),L}var u,l,h=t;h.ready=new Promise(((e,t)=>{u=e,l=t})),h.mountExternalData=(e,t)=>{(h.ib||(h.ib=new Map)).set(e,t)},h.unmountExternalData=()=>{delete h.ib},h.jsepInit=(e,t,r,n,i,o,a,s)=>{h.Rb=e,h.Bb=t,h.Db=r,h.pb=n,h.Cb=i,h.Ua=o,h.Eb=a,h.Fb=s,t=(e,t,r)=>(...n)=>{let i=dt,o=t?.();n=e(...n);let a=t?.();return o!==a&&(e=a,r(o),t=r=null),dt!=i?new Promise(((e,t)=>{wt={resolve:e,reject:t}})):n},r=t=>async(...r)=>{try{if(h.hb)throw Error("Session already started");let n=h.hb={Hb:r[0],errors:[]},i=await t(...r);if(h.hb!==n)throw Error("Session mismatch");e.flush();let o=n.errors;if(0<o.length){let e=await Promise.all(o);if(e=e.filter((e=>e)),0<e.length)throw Error(e.join("\n"))}return i}finally{h.hb=null}},h._OrtRun=r(t(h._OrtRun,(()=>h._OrtRun),(e=>h._OrtRun=e))),h._OrtRunWithBinding=r(t(h._OrtRunWithBinding,(()=>h._OrtRunWithBinding),(e=>h._OrtRunWithBinding=e))),h._OrtBindInput=t(h._OrtBindInput,(()=>h._OrtBindInput),(e=>h._OrtBindInput=e)),h.jsepRegisterBuffer=(t,r,n,i)=>e.registerBuffer(t,r,n,i),h.jsepUnregisterBuffers=t=>{e.unregisterBuffers(t)},h.jsepGetBuffer=t=>e.getBuffer(t),h.jsepCreateDownloader=(t,r,n)=>e.createDownloader(t,r,n)};var c,d,f,p=Object.assign({},h),y="./this.program",g=(e,t)=>{throw t},m="object"==typeof window,w="function"==typeof importScripts,b="object"==typeof $c&&"object"==typeof $c.versions&&"string"==typeof $c.versions.node,v=h.ENVIRONMENT_IS_PTHREAD||!1,x="";function _(e){return h.locateFile?h.locateFile(e,x):x+e}if(b){var I=(dd(),Gc(ud)),A=(yd(),Gc(fd));let e;x=w?A.dirname(x)+"/":__dirname+"/",c=(e,t)=>(e=q(e)?new URL(e):A.normalize(e),I.readFileSync(e,t?void 0:"utf8")),f=e=>((e=c(e,!0)).buffer||(e=new Uint8Array(e)),e),d=(e,t,r,n=!0)=>{e=q(e)?new URL(e):A.normalize(e),I.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!h.thisProgram&&1<$c.argv.length&&(y=$c.argv[1].replace(/\\/g,"/")),$c.argv.slice(2),g=(e,t)=>{throw $c.exitCode=e,t},h.inspect=()=>"[Emscripten Module object]";try{e=md()}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}global.Worker=e.Worker}else(m||w)&&(w?x=self.location.href:typeof document<"u"&&document.currentScript&&(x=document.currentScript.src),typeof e<"u"&&e&&(x=e),x=0!==x.indexOf("blob:")?x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1):"",b||(c=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},w&&(f=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),d=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}));b&&typeof performance>"u"&&(global.performance=wd().performance);var S=console.log.bind(console),T=console.error.bind(console);b&&(S=(...e)=>I.writeSync(1,e.join(" ")+"\n"),T=(...e)=>I.writeSync(2,e.join(" ")+"\n"));var C=S,E=T;Object.assign(h,p),p=null,"object"!=typeof WebAssembly&&K("no native wasm support detected");var O,k,P,$,R,B,D,M,L,F=!1;function N(){var e=O.buffer;h.HEAP8=$=new Int8Array(e),h.HEAP16=new Int16Array(e),h.HEAPU8=R=new Uint8Array(e),h.HEAPU16=new Uint16Array(e),h.HEAP32=B=new Int32Array(e),h.HEAPU32=D=new Uint32Array(e),h.HEAPF32=M=new Float32Array(e),h.HEAPF64=L=new Float64Array(e)}var U=16777216;if(v)O=h.wasmMemory;else if(h.wasmMemory)O=h.wasmMemory;else if(!((O=new WebAssembly.Memory({initial:U/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw E("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),b&&E("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");N(),U=O.buffer.byteLength;var j=[],G=[],z=[],V=0,H=null,W=null;function Y(){if(0==--V&&(null!==H&&(clearInterval(H),H=null),W)){var e=W;W=null,e()}}function K(e){throw E(e="Aborted("+e+")"),F=!0,P=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),l(e),e}var X,Z=e=>e.startsWith("data:application/octet-stream;base64,"),q=e=>e.startsWith("file://");function J(e){if(f)return f(e);throw"both async and sync fetching of the wasm failed"}function Q(e,t,r){return function(e){if(m||w){if("function"==typeof fetch&&!q(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>J(e)));if(d)return new Promise(((t,r)=>{d(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>J(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{E(`failed to asynchronously prepare wasm: ${e}`),K(e)}))}Z(X="ort-wasm-simd-threaded.wasm")||(X=_(X));var ee,te={902596:(e,t,r,i)=>{if(typeof h>"u"||!h.ib)return 1;if((e=ue(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=h.ib.get(e)))return 2;if(i>>>=0,(t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return n().set(e.subarray(t,t+r),i>>>0),0}catch{return 4}},903097:e=>h.Bb(e),903130:e=>h.Db(e),903162:(e,t,r)=>{h.pb(e,t,r,!0)},903201:(e,t,r)=>{h.pb(e,t,r)},903234:e=>{h.Ua("Abs",e,void 0)},903285:e=>{h.Ua("Neg",e,void 0)},903336:e=>{h.Ua("Floor",e,void 0)},903389:e=>{h.Ua("Ceil",e,void 0)},903441:e=>{h.Ua("Reciprocal",e,void 0)},903499:e=>{h.Ua("Sqrt",e,void 0)},903551:e=>{h.Ua("Exp",e,void 0)},903602:e=>{h.Ua("Erf",e,void 0)},903653:e=>{h.Ua("Sigmoid",e,void 0)},903708:e=>{h.Ua("Log",e,void 0)},903759:e=>{h.Ua("Sin",e,void 0)},903810:e=>{h.Ua("Cos",e,void 0)},903861:e=>{h.Ua("Tan",e,void 0)},903912:e=>{h.Ua("Asin",e,void 0)},903964:e=>{h.Ua("Acos",e,void 0)},904016:e=>{h.Ua("Atan",e,void 0)},904068:e=>{h.Ua("Sinh",e,void 0)},904120:e=>{h.Ua("Cosh",e,void 0)},904172:e=>{h.Ua("Asinh",e,void 0)},904225:e=>{h.Ua("Acosh",e,void 0)},904278:e=>{h.Ua("Atanh",e,void 0)},904331:e=>{h.Ua("Tanh",e,void 0)},904383:e=>{h.Ua("Not",e,void 0)},904434:(e,t,r)=>{h.Ua("Clip",e,{min:t,max:r})},904503:e=>{h.Ua("Clip",e,void 0)},904555:(e,t)=>{h.Ua("Elu",e,{alpha:t})},904613:e=>{h.Ua("Relu",e,void 0)},904665:(e,t)=>{h.Ua("LeakyRelu",e,{alpha:t})},904729:(e,t)=>{h.Ua("ThresholdedRelu",e,{alpha:t})},904799:(e,t)=>{h.Ua("Cast",e,{to:t})},904857:e=>{h.Ua("Add",e,void 0)},904908:e=>{h.Ua("Sub",e,void 0)},904959:e=>{h.Ua("Mul",e,void 0)},905010:e=>{h.Ua("Div",e,void 0)},905061:e=>{h.Ua("Pow",e,void 0)},905112:e=>{h.Ua("Equal",e,void 0)},905165:e=>{h.Ua("Greater",e,void 0)},905220:e=>{h.Ua("GreaterOrEqual",e,void 0)},905282:e=>{h.Ua("Less",e,void 0)},905334:e=>{h.Ua("LessOrEqual",e,void 0)},905393:(e,t,r,n,o)=>{h.Ua("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},905552:(e,t,r,n,o)=>{h.Ua("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},905710:(e,t,r,n,o)=>{h.Ua("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},905868:(e,t,r,n,o)=>{h.Ua("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906027:(e,t,r,n,o)=>{h.Ua("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906185:(e,t,r,n,o)=>{h.Ua("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906342:(e,t,r,n,o)=>{h.Ua("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906499:(e,t,r,n,o)=>{h.Ua("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906660:(e,t,r,n,o)=>{h.Ua("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906824:(e,t,r,n,o)=>{h.Ua("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906988:e=>{h.Ua("Where",e,void 0)},907041:(e,t,r)=>{h.Ua("Transpose",e,{perm:t?Array.from(i().subarray(t>>>0,r>>>0)):[]})},907149:(e,t,n,o,a,s,u,l,c,d,f,p,y,g,m)=>{h.Ua("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:o,kernel_shape:[a],pads:[s,u],strides:[l],wIsConst:()=>!!r()[d>>>0],outputPadding:f?Array.from(i().subarray(f>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,g>>>0)):[],activation:ue(m)})},907551:(e,t,n,o,a,s,u,l,c,d,f,p,y,g)=>{h.Ua("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:Array.from(i().subarray(n>>>0,2+(n>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:()=>!!r()[c>>>0],outputPadding:d?Array.from(i().subarray(d>>>0,f>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ue(g)})},908116:(e,t,n,o,a,s,u,l,c,d,f,p,y,g,m)=>{h.Ua("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:o,kernel_shape:[a],pads:[s,u],strides:[l],wIsConst:()=>!!r()[d>>>0],outputPadding:f?Array.from(i().subarray(f>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,g>>>0)):[],activation:ue(m)})},908518:(e,t,n,o,a,s,u,l,c,d,f,p,y,g)=>{h.Ua("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:Array.from(i().subarray(n>>>0,2+(n>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:()=>!!r()[c>>>0],outputPadding:d?Array.from(i().subarray(d>>>0,f>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ue(g)})},909083:(e,t)=>{h.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},909174:(e,t,r,n,i,o,a,s,u,l,c,d,f,p,y,g)=>{h.Ua("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,d,f],strides:[p,y]})},909458:(e,t)=>{h.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},909549:(e,t,r,n,i,o,a,s,u,l,c,d,f,p,y,g)=>{h.Ua("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,d,f],strides:[p,y]})},909833:(e,t)=>{h.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},909920:(e,t,r,n,i,o,a,s,u,l,c,d,f,p,y,g)=>{h.Ua("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,d,f],strides:[p,y]})},910200:(e,t)=>{h.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},910287:(e,t,r,n,i,o,a,s,u,l,c,d,f,p,y,g)=>{h.Ua("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,d,f],strides:[p,y]})},910567:(e,t,r,n,i)=>{h.Ua("Gemm",e,{alpha:t,beta:r,transA:n,transB:i})},910671:e=>{h.Ua("MatMul",e,void 0)},910725:(e,t,r,n)=>{h.Ua("ArgMax",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},910833:(e,t,r,n)=>{h.Ua("ArgMin",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},910941:(e,t)=>{h.Ua("Softmax",e,{axis:t})},911004:(e,t)=>{h.Ua("Concat",e,{axis:t})},911064:(e,t,r,n,o)=>{h.Ua("Split",e,{axis:t,numOutputs:r,splitSizes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},911204:e=>{h.Ua("Expand",e,void 0)},911258:(e,t)=>{h.Ua("Gather",e,{axis:Number(t)})},911329:(e,t)=>{h.Ua("GatherElements",e,{axis:Number(t)})},911408:(e,t,r,n,o,a,s,u,l,c,d)=>{h.Ua("Resize",e,{antialias:t,axes:r?Array.from(i().subarray(r>>>0,n>>>0)):[],coordinateTransformMode:ue(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:ue(l),mode:ue(c),nearestMode:ue(d)})},911754:(e,t,r,n,o,a,s)=>{h.Ua("Slice",e,{starts:t?Array.from(i().subarray(t>>>0,r>>>0)):[],ends:n?Array.from(i().subarray(n>>>0,o>>>0)):[],axes:a?Array.from(i().subarray(a>>>0,s>>>0)):[]})},911970:e=>{h.Ua("Tile",e,void 0)},912022:(e,t,r)=>{h.Ua("LayerNormalization",e,{axis:Number(t),epsilon:Number(r)})},912129:(e,t,r)=>{h.Ua("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},912243:(e,t,r)=>{h.Ua("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},912357:e=>{h.Ua("Range",e,void 0)},912410:(e,t)=>{h.Ua("Einsum",e,{equation:ue(t)})},912491:(e,t,r,n,o)=>{h.Ua("Pad",e,{mode:t,value:r,pads:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},912618:(e,t,r,n,i,o)=>{h.Ua("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!i,trainingMode:!!n,format:o?"NHWC":"NCHW"})},912787:(e,t,r,n,i,o)=>{h.Ua("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!i,trainingMode:!!n,format:o?"NHWC":"NCHW"})},912956:(e,t,r)=>{h.Ua("CumSum",e,{exclusive:Number(t),reverse:Number(r)})},913053:(e,t,r,n,o,a,s,u,l)=>{h.Ua("Attention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(i().subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!l})},913325:e=>{h.Ua("Gelu",e,void 0)},913377:(e,t,r,n,i,o)=>{h.Ua("MultiHeadAttention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:i,doRotary:o})},913536:e=>{h.Ua("BiasAdd",e,void 0)},913591:e=>{h.Ua("BiasSplitGelu",e,void 0)},913652:(e,t)=>{h.Ua("SkipLayerNormalization",e,{epsilon:t})},913733:(e,t,n,o,s,u,l,c,d,f,p,y,g)=>{h.Ua("Conv",e,{format:d?"NHWC":"NCHW",auto_pad:t,dilations:[n],group:o,kernel_shape:[s],pads:u?Array.from(i().subarray(u>>>0,l>>>0)):[],strides:[c],w_is_const:()=>!!r()[f>>>0],activation:ue(p),activation_params:y?Array.from(a().subarray(y>>>0,g>>>0)):[]})},914103:(e,t,n,o,s,u,l,c,d,f,p,y,g,m,w,b)=>{h.Ua("Conv",e,{format:y?"NHWC":"NCHW",auto_pad:t,dilations:[n,o],group:s,kernel_shape:[u,l],pads:c?Array.from(i().subarray(c>>>0,d>>>0)):[],strides:[f,p],w_is_const:()=>!!r()[g>>>0],activation:ue(m),activation_params:w?Array.from(a().subarray(w>>>0,b>>>0)):[]})},914494:e=>{h.Eb(e)},914528:(e,t)=>h.Fb(e,t,h.hb.Hb,h.hb.errors)};function re(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var ne=e=>{e.terminate(),e.onmessage=()=>{}},ie=e=>{0==ge.cb.length&&(ye(),ge.qb(ge.cb[0]));var t=ge.cb.pop();if(!t)return 6;ge.eb.push(t),ge.$a[e.bb]=t,t.bb=e.bb;var r={cmd:"run",start_routine:e.Ib,arg:e.xb,pthread_ptr:e.bb};return b&&t.unref(),t.postMessage(r,e.Ob),0},oe=0,ae=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,se=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&ae)return ae.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},ue=(e,t)=>(e>>>=0)?se(n(),e,t):"",le=e=>{var t=jt();return e=e(),Gt(t),e};function he(e,t){var r=arguments.length-2,n=arguments;return le((()=>{for(var i=zt(8*r),o=i>>>3,a=0;a<r;a++){var u=n[2+a];s()[o+a>>>0]=u}return Dt(e,r,i,t)}))}function ce(e){if(v)return he(0,1,e);P=e,0<oe||(ge.Jb(),h.onExit?.(e),F=!0),g(e,new re(e))}var de=e=>{if(P=e,v)throw we(e),"unwind";ce(e)},fe=e=>{e instanceof re||"unwind"==e||g(1,e)};function pe(){for(var e=h.numThreads;e--;)ye();j.unshift((()=>{V++,function(e){v?e():Promise.all(ge.cb.map(ge.qb)).then(e)}((()=>Y()))}))}function ye(){var e=_("ort-wasm-simd-threaded.worker.js");e=new Worker(e),ge.cb.push(e)}var ge={cb:[],eb:[],ub:[],$a:{},mb(){v?(ge.receiveObjectTransfer=ge.Gb,ge.threadInitTLS=ge.tb,ge.setExitStatus=ge.sb):pe()},sb:e=>P=e,Sb:["$terminateWorker"],Jb:()=>{for(var e of ge.eb)ne(e);for(e of ge.cb)ne(e);ge.cb=[],ge.eb=[],ge.$a=[]},rb:e=>{var t=e.bb;delete ge.$a[t],ge.cb.push(e),ge.eb.splice(ge.eb.indexOf(e),1),e.bb=0,Mt(t)},Gb(){},tb(){ge.ub.forEach((e=>e()))},qb:t=>new Promise((r=>{t.onmessage=e=>{var n=(e=e.data).cmd;if(e.targetThread&&e.targetThread!=kt()){var i=ge.$a[e.targetThread];i?i.postMessage(e,e.transferList):E(`Internal error! Worker sent a message "${n}" to target pthread ${e.targetThread}, but that thread no longer exists!`)}else"checkMailbox"===n?Ue():"spawnThread"===n?ie(e):"cleanupThread"===n?ge.rb(ge.$a[e.thread]):"killThread"===n?(e=e.thread,n=ge.$a[e],delete ge.$a[e],ne(n),Mt(e),ge.eb.splice(ge.eb.indexOf(n),1),n.bb=0):"cancelThread"===n?ge.$a[e.thread].postMessage({cmd:"cancel"}):"loaded"===n?(t.loaded=!0,b&&!t.bb&&t.unref(),r(t)):"alert"===n?alert(`Thread ${e.threadId}: ${e.text}`):"setimmediate"===e.target?t.postMessage(e):"callHandler"===n?h[e.handler](...e.args):n&&E(`worker sent an unknown command ${n}`)},t.onerror=e=>{throw E(`worker sent an error! ${e.filename}:${e.lineno}: ${e.message}`),e},b&&(t.on("message",(e=>t.onmessage({data:e}))),t.on("error",(e=>t.onerror(e))));var n,i=[];for(n of["onExit"])h.hasOwnProperty(n)&&i.push(n);t.postMessage({cmd:"load",handlers:i,urlOrBlob:h.mainScriptUrlOrBlob||e,wasmMemory:O,wasmModule:k})}))};h.PThread=ge;var me=e=>{for(;0<e.length;)e.shift()(h)};function we(e){if(v)return he(1,0,e);de(e)}function be(e){this.lb=e-24,this.yb=function(e){o()[this.lb+4>>>2>>>0]=e},this.wb=function(e){o()[this.lb+8>>>2>>>0]=e},this.mb=function(e,t){this.vb(),this.yb(e),this.wb(t)},this.vb=function(){o()[this.lb+16>>>2>>>0]=0}}h.establishStackSpace=()=>{var e=kt(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],Ut(t,t-e),Gt(t)},h.invokeEntryPoint=(e,t)=>{e=Vt.apply(null,[e,t]),0<oe?ge.sb(e):Lt(e)};function ve(e,t,r,n){return v?he(2,1,e,t,r,n):xe(e,t,r,n)}function xe(e,t,r,n){if(e>>>=0,t>>>=0,r>>>=0,n>>>=0,typeof SharedArrayBuffer>"u")return E("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return v&&0===i.length?ve(e,t,r,n):(e={Ib:r,bb:e,xb:n,Ob:i},v?(e.Qb="spawnThread",postMessage(e,i),0):ie(e))}function _e(e,t,r){return v?he(3,1,e,t,r):0}function Ie(e,t){if(v)return he(4,1,e,t)}var Ae=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Se=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},Te=(e,t,r)=>Se(e,n(),t,r);function Ce(e,t){if(v)return he(5,1,e,t)}function Ee(e,t,r){if(v)return he(6,1,e,t,r)}function Oe(e,t,r){return v?he(7,1,e,t,r):0}function ke(e,t){if(v)return he(8,1,e,t)}function Pe(e,t,r){if(v)return he(9,1,e,t,r)}function $e(e,t,r,n){if(v)return he(10,1,e,t,r,n)}function Re(e,t,r,n){if(v)return he(11,1,e,t,r,n)}function Be(e,t,r,n){if(v)return he(12,1,e,t,r,n)}function De(e){if(v)return he(13,1,e)}function Me(e,t){if(v)return he(14,1,e,t)}function Le(e,t,r){if(v)return he(15,1,e,t,r)}var Fe=()=>{if(!(0<oe))try{v?Lt(P):de(P)}catch(e){fe(e)}};function Ne(e){e>>>=0,"function"==typeof Atomics.Pb&&(Atomics.Pb(i(),e>>>2,e).value.then(Ue),e+=128,Atomics.store(i(),e>>>2,1))}h.__emscripten_thread_mailbox_await=Ne;var Ue=()=>{var e=kt();if(e&&(Ne(e),!F))try{Ft(),Fe()}catch(e){fe(e)}};h.checkMailbox=Ue;var je=[],Ge=e=>e%4==0&&(e%100!=0||e%400==0),ze=[0,31,60,91,121,152,182,213,244,274,305,335],Ve=[0,31,59,90,120,151,181,212,243,273,304,334];function He(e,t,r,n,i,o,a,s){return v?he(16,1,e,t,r,n,i,o,a,s):-52}function We(e,t,r,n,i,o,a){if(v)return he(17,1,e,t,r,n,i,o,a)}var Ye,Ke=e=>{var t=Ae(e)+1,r=Pt(t);return r&&Te(e,r,t),r},Xe=[],Ze=(e,t)=>{Xe.length=0;for(var r;r=n()[e++>>>0];){var a=105!=r;t+=(a&=112!=r)&&t%8?4:0,Xe.push(112==r?o()[t>>>2>>>0]:105==r?i()[t>>>2>>>0]:s()[t>>>3>>>0]),t+=a?8:4}return Xe},qe={},Je=()=>{if(!Ye){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(e in qe)void 0===qe[e]?delete t[e]:t[e]=qe[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);Ye=r}return Ye};function Qe(e,t){if(v)return he(18,1,e,t);e>>>=0,t>>>=0;var n=0;return Je().forEach(((i,a)=>{var s=t+n;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)r()[a++>>>0>>>0]=i.charCodeAt(s);r()[a>>>0>>>0]=0,n+=i.length+1})),0}function et(e,t){if(v)return he(19,1,e,t);e>>>=0,t>>>=0;var r=Je();o()[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),o()[t>>>2>>>0]=n,0}function tt(e){return v?he(20,1,e):52}function rt(e,t,r,n){return v?he(21,1,e,t,r,n):52}function nt(e,t,r,n,i){return v?he(22,1,e,t,r,n,i):70}var it=[null,[],[]];function ot(e,t,r,i){if(v)return he(23,1,e,t,r,i);t>>>=0,r>>>=0,i>>>=0;for(var a=0,s=0;s<r;s++){var u=o()[t>>>2>>>0],l=o()[t+4>>>2>>>0];t+=8;for(var h=0;h<l;h++){var c=n()[u+h>>>0],d=it[e];0===c||10===c?((1===e?C:E)(se(d,0)),d.length=0):d.push(c)}a+=l}return o()[i>>>2>>>0]=a,0}var at=e=>(at=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>(e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e);if(b)try{var e=Fc("crypto");if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}K("initRandomDevice")})())(e),st=[31,29,31,30,31,30,31,31,30,31,30,31],ut=[31,28,31,30,31,30,31,31,30,31,30,31];function lt(e,t,n,a){function s(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function u(e,t){return s(e,t,"0")}function l(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function h(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){var t=e.fb;for(e=new Date(new Date(e.gb+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Ge(e.getFullYear())?st:ut)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=h(new Date(e.getFullYear(),0,4)),r=h(r),0>=l(t,e)?0>=l(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0,a>>>=0;var d=o()[a+40>>>2>>>0];for(var f in a={Mb:i()[a>>>2>>>0],Lb:i()[a+4>>>2>>>0],jb:i()[a+8>>>2>>>0],ob:i()[a+12>>>2>>>0],kb:i()[a+16>>>2>>>0],gb:i()[a+20>>>2>>>0],ab:i()[a+24>>>2>>>0],fb:i()[a+28>>>2>>>0],Tb:i()[a+32>>>2>>>0],Kb:i()[a+36>>>2>>>0],Nb:d?ue(d):""},n=ue(n),d={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(f,"g"),d[f]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(f in d={"%a":e=>p[e.ab].substring(0,3),"%A":e=>p[e.ab],"%b":e=>y[e.kb].substring(0,3),"%B":e=>y[e.kb],"%C":e=>u((e.gb+1900)/100|0,2),"%d":e=>u(e.ob,2),"%e":e=>s(e.ob,2," "),"%g":e=>c(e).toString().substring(2),"%G":e=>c(e),"%H":e=>u(e.jb,2),"%I":e=>(0==(e=e.jb)?e=12:12<e&&(e-=12),u(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.kb-1;t+=(Ge(e.gb+1900)?st:ut)[r++]);return u(e.ob+t,3)},"%m":e=>u(e.kb+1,2),"%M":e=>u(e.Lb,2),"%n":()=>"\n","%p":e=>0<=e.jb&&12>e.jb?"AM":"PM","%S":e=>u(e.Mb,2),"%t":()=>"\t","%u":e=>e.ab||7,"%U":e=>u(Math.floor((e.fb+7-e.ab)/7),2),"%V":e=>{var t=Math.floor((e.fb+7-(e.ab+6)%7)/7);if(2>=(e.ab+371-e.fb-2)%7&&t++,t)53==t&&(4==(r=(e.ab+371-e.fb)%7)||3==r&&Ge(e.gb)||(t=1));else{t=52;var r=(e.ab+7-e.fb-1)%7;(4==r||5==r&&Ge(e.gb%400-1))&&t++}return u(t,2)},"%w":e=>e.ab,"%W":e=>u(Math.floor((e.fb+7-(e.ab+6)%7)/7),2),"%y":e=>(e.gb+1900).toString().substring(2),"%Y":e=>e.gb+1900,"%z":e=>(0<=(e=e.Kb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.Nb,"%%":()=>"%"},n=n.replace(/%%/g,"\0\0"),d)n.includes(f)&&(n=n.replace(new RegExp(f,"g"),d[f](a)));return f=function(e){var t=Array(Ae(e)+1);return Se(e,t,0,t.length),t}(n=n.replace(/\0\0/g,"%")),f.length>t?0:(((e,t)=>{r().set(e,t>>>0)})(f,e),f.length-1)}var ht=e=>{try{e()}catch(e){K(e)}};var ct=0,dt=null,ft=0,pt=[],yt={},gt={},mt=0,wt=null,bt=[];function vt(e){if(!F){if(0===ct){var t=!1,r=!1;e(((e=0)=>{if(!F&&(ft=e,t=!0,r)){ct=2,ht((()=>Yt(dt))),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.resume(),e=!1;try{var n=function(){var e=i()[dt+8>>>2>>>0];return e=Et[gt[e]],--oe,e()}()}catch(t){n=t,e=!0}var o=!1;if(!dt){var a=wt;a&&(wt=null,(e?a.reject:a.resolve)(n),o=!0)}if(e&&!o)throw n}})),r=!0,t||(ct=1,dt=function(){var e=Pt(65548),t=e+12;o()[e>>>2>>>0]=t,o()[e+4>>>2>>>0]=t+65536,t=pt[0];var r=yt[t];return void 0===r&&(r=mt++,yt[t]=r,gt[r]=t),t=r,i()[e+8>>>2>>>0]=t,e}(),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.pause(),ht((()=>Ht(dt))))}else 2===ct?(ct=0,ht(Kt),$t(dt),dt=null,bt.forEach((e=>{if(!F)try{e(),Fe()}catch(e){fe(e)}}))):K(`invalid state: ${ct}`);return ft}}var xt,_t,It=[],At=[],St=(e,t)=>{if(!_t){_t=new WeakMap;var r=xt.length;if(_t)for(var n=0;n<0+r;n++){var i=n,o=It[i];o||(i>=It.length&&(It.length=i+1),It[i]=o=xt.get(i)),(i=o)&&_t.set(i,n)}}if(r=_t.get(e)||0)return r;if(At.length)r=At.pop();else{try{xt.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=xt.length-1}try{n=r,xt.set(n,e),It[n]=xt.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,xt.set(n,t),It[n]=xt.get(n)}return _t.set(e,r),r};ge.mb();var Tt=[ce,we,ve,_e,Ie,Ce,Ee,Oe,ke,Pe,$e,Re,Be,De,Me,Le,He,We,Qe,et,tt,rt,nt,ot],Ct={r:function(e,t,r){return function(e){return vt((t=>{e().then(t)}))}((async()=>{await h.Cb(e,t,r)}))},b:function(e,t,r){throw new be(e>>>=0).mb(t>>>0,r>>>0),e},P:function(e){Rt(e>>>0,!w,1,!m,131072,!1),ge.tb()},n:function(e){e>>>=0,v?postMessage({cmd:"cleanupThread",thread:e}):ge.rb(ge.$a[e])},L:xe,i:_e,V:Ie,H:Ce,J:Ee,z:Oe,T:ke,N:Pe,S:$e,p:Re,I:Be,F:De,U:Me,G:Le,Y:()=>1,D:function(e,t){(e>>>=0)==t>>>0?setTimeout((()=>Ue())):v?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=ge.$a[e])&&e.postMessage({cmd:"checkMailbox"})},M:function(e,t,r,n){t>>>=0,je.length=r,n=n>>>0>>>3;for(var i=0;i<r;i++)je[i]=s()[n+i>>>0];return e=0>e?te[-e-1]:Tt[e],ge.zb=t,t=e.apply(null,je),ge.zb=0,t},O:Ne,X:function(e){b&&ge.$a[e>>>0].ref()},u:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getUTCSeconds(),i()[r+4>>>2>>>0]=e.getUTCMinutes(),i()[r+8>>>2>>>0]=e.getUTCHours(),i()[r+12>>>2>>>0]=e.getUTCDate(),i()[r+16>>>2>>>0]=e.getUTCMonth(),i()[r+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[r+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[r+28>>>2>>>0]=e},v:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getSeconds(),i()[r+4>>>2>>>0]=e.getMinutes(),i()[r+8>>>2>>>0]=e.getHours(),i()[r+12>>>2>>>0]=e.getDate(),i()[r+16>>>2>>>0]=e.getMonth(),i()[r+20>>>2>>>0]=e.getFullYear()-1900,i()[r+24>>>2>>>0]=e.getDay(),t=(Ge(e.getFullYear())?ze:Ve)[e.getMonth()]+e.getDate()-1|0,i()[r+28>>>2>>>0]=t,i()[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t)),i()[r+32>>>2>>>0]=e},w:function(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),r=i()[e+32>>>2>>>0],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>r?i()[e+32>>>2>>>0]=+(o!=a&&s==n):0<r!=(s==n)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<r?s:o)-n))),i()[e+24>>>2>>>0]=t.getDay(),r=(Ge(t.getFullYear())?ze:Ve)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=r,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[Ot()>>>2>>>0]=61,e=-1):e/=1e3,Nt((ee=e,1<=+Math.abs(ee)?0<ee?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)),e>>>0},s:He,t:We,C:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}e>>>=0,t>>>=0,r>>>=0;var a=(new Date).getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var l=u.getTimezoneOffset(),h=Math.max(a,l);o()[e>>>2>>>0]=60*h,i()[t>>>2>>>0]=+(a!=l),e=n(s),t=n(u),e=Ke(e),t=Ke(t),l<a?(o()[r>>>2>>>0]=e,o()[r+4>>>2>>>0]=t):(o()[r>>>2>>>0]=t,o()[r+4>>>2>>>0]=e)},d:()=>{K("")},c:function(e,t,r){return e>>>=0,t=Ze(t>>>0,r>>>0),te[e].apply(null,t)},k:function(e,t,r){return e>>>=0,t=Ze(t>>>0,r>>>0),te[e].apply(null,t)},o:()=>{},q:()=>Date.now(),W:()=>{throw oe+=1,"unwind"},E:function(){return 4294901760},f:()=>performance.timeOrigin+performance.now(),g:()=>b?(db(),Gc(bd)).cpus().length:navigator.hardwareConcurrency,A:function(e){e>>>=0;var t=n().length;if(e<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var i=t*(1+.2/r);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-O.buffer.byteLength+65535)/65536;try{O.grow(o),N();var a=1;break e}catch{}a=void 0}if(a)return!0}return!1},Q:Qe,R:et,K:de,h:tt,m:rt,x:nt,l:ot,y:function(e,t){return e>>>=0,t>>>=0,at(n().subarray(e>>>0,e+t>>>0)),0},a:O||h.wasmMemory,B:lt,e:function(e,t,r,n){return lt(e>>>0,t>>>0,r>>>0,n>>>0)},j:function(e,t,r,i){let o=xt.length;e=new Uint8Array(n().slice(e+t,e+r));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:O}});for(a in u.exports)St(u.exports[a]);return o<xt.length?o:i}catch(e){return console.log(e),i}}},Et=function(){function e(e,t){return Et=e.exports,Et=function(){var e=Et,t={};for(let[r,n]of Object.entries(e))t[r]="function"==typeof n?function(){pt.push(r);try{return n.apply(null,arguments)}finally{F||(pt.pop(),dt&&1===ct&&0===pt.length&&(ct=0,oe+=1,ht(Wt),typeof Fibers<"u"&&Fibers.Ub()))}}:n;return t}(),Et=function(){var e=Et;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.Da=t(e.Da),e.Ea=t(e.Ea),e.Fa=r(e.Fa),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Ra=t(e.Ra),e.Ta=r(e.Ta),e}(),ge.ub.push(Et.Ha),xt=Et.Ia,G.unshift(Et.Z),k=t,Y(),Et}var t={a:Ct};if(V++,h.instantiateWasm)try{return h.instantiateWasm(t,e)}catch(e){E(`Module.instantiateWasm callback failed with error: ${e}`),l(e)}return function(e,t){var r=X;return"function"!=typeof WebAssembly.instantiateStreaming||Z(r)||q(r)||b||"function"!=typeof fetch?Q(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return E(`wasm streaming compile failed: ${n}`),E("falling back to ArrayBuffer instantiation"),Q(r,e,t)}))))}(t,(function(t){e(t.instance,t.module)})).catch(l),{}}();h._OrtInit=(e,t)=>(h._OrtInit=Et._)(e,t),h._OrtGetLastError=(e,t)=>(h._OrtGetLastError=Et.$)(e,t),h._OrtCreateSessionOptions=(e,t,r,n,i,o,a,s,u,l)=>(h._OrtCreateSessionOptions=Et.aa)(e,t,r,n,i,o,a,s,u,l),h._OrtAppendExecutionProvider=(e,t)=>(h._OrtAppendExecutionProvider=Et.ba)(e,t),h._OrtAddFreeDimensionOverride=(e,t,r)=>(h._OrtAddFreeDimensionOverride=Et.ca)(e,t,r),h._OrtAddSessionConfigEntry=(e,t,r)=>(h._OrtAddSessionConfigEntry=Et.da)(e,t,r),h._OrtReleaseSessionOptions=e=>(h._OrtReleaseSessionOptions=Et.ea)(e),h._OrtCreateSession=(e,t,r)=>(h._OrtCreateSession=Et.fa)(e,t,r),h._OrtReleaseSession=e=>(h._OrtReleaseSession=Et.ga)(e),h._OrtGetInputOutputCount=(e,t,r)=>(h._OrtGetInputOutputCount=Et.ha)(e,t,r),h._OrtGetInputName=(e,t)=>(h._OrtGetInputName=Et.ia)(e,t),h._OrtGetOutputName=(e,t)=>(h._OrtGetOutputName=Et.ja)(e,t),h._OrtFree=e=>(h._OrtFree=Et.ka)(e),h._OrtCreateTensor=(e,t,r,n,i,o)=>(h._OrtCreateTensor=Et.la)(e,t,r,n,i,o),h._OrtGetTensorData=(e,t,r,n,i)=>(h._OrtGetTensorData=Et.ma)(e,t,r,n,i),h._OrtReleaseTensor=e=>(h._OrtReleaseTensor=Et.na)(e),h._OrtCreateRunOptions=(e,t,r,n)=>(h._OrtCreateRunOptions=Et.oa)(e,t,r,n),h._OrtAddRunConfigEntry=(e,t,r)=>(h._OrtAddRunConfigEntry=Et.pa)(e,t,r),h._OrtReleaseRunOptions=e=>(h._OrtReleaseRunOptions=Et.qa)(e),h._OrtCreateBinding=e=>(h._OrtCreateBinding=Et.ra)(e),h._OrtBindInput=(e,t,r)=>(h._OrtBindInput=Et.sa)(e,t,r),h._OrtBindOutput=(e,t,r,n)=>(h._OrtBindOutput=Et.ta)(e,t,r,n),h._OrtClearBoundOutputs=e=>(h._OrtClearBoundOutputs=Et.ua)(e),h._OrtReleaseBinding=e=>(h._OrtReleaseBinding=Et.va)(e),h._OrtRunWithBinding=(e,t,r,n,i)=>(h._OrtRunWithBinding=Et.wa)(e,t,r,n,i),h._OrtRun=(e,t,r,n,i,o,a,s)=>(h._OrtRun=Et.xa)(e,t,r,n,i,o,a,s),h._OrtEndProfiling=e=>(h._OrtEndProfiling=Et.ya)(e),h._OrtConfigure=(e,t)=>(h._OrtConfigure=Et.za)(e,t),h._OrtAuth=(e,t)=>(h._OrtAuth=Et.Aa)(e,t),h._JsepOutput=(e,t,r)=>(h._JsepOutput=Et.Ba)(e,t,r),h._JsepGetNodeName=e=>(h._JsepGetNodeName=Et.Ca)(e);var Ot=()=>(Ot=Et.Da)(),kt=h._pthread_self=()=>(kt=h._pthread_self=Et.Ea)(),Pt=h._malloc=e=>(Pt=h._malloc=Et.Fa)(e),$t=h._free=e=>($t=h._free=Et.Ga)(e);h.__emscripten_tls_init=()=>(h.__emscripten_tls_init=Et.Ha)();var Rt=h.__emscripten_thread_init=(e,t,r,n,i,o)=>(Rt=h.__emscripten_thread_init=Et.Ja)(e,t,r,n,i,o);h.__emscripten_thread_crashed=()=>(h.__emscripten_thread_crashed=Et.Ka)();var Bt,Dt=(e,t,r,n)=>(Dt=Et.La)(e,t,r,n),Mt=e=>(Mt=Et.Ma)(e),Lt=h.__emscripten_thread_exit=e=>(Lt=h.__emscripten_thread_exit=Et.Na)(e),Ft=()=>(Ft=Et.Oa)(),Nt=e=>(Nt=Et.Pa)(e),Ut=(e,t)=>(Ut=Et.Qa)(e,t),jt=()=>(jt=Et.Ra)(),Gt=e=>(Gt=Et.Sa)(e),zt=e=>(zt=Et.Ta)(e),Vt=h.dynCall_ii=(e,t)=>(Vt=h.dynCall_ii=Et.Va)(e,t),Ht=e=>(Ht=Et.Wa)(e),Wt=()=>(Wt=Et.Xa)(),Yt=e=>(Yt=Et.Ya)(e),Kt=()=>(Kt=Et.Za)();function Xt(){if(!(0<V))if(v)u(h),v||me(G),startWorker(h);else{if(h.preRun)for("function"==typeof h.preRun&&(h.preRun=[h.preRun]);h.preRun.length;)j.unshift(h.preRun.shift());me(j),0<V||Bt||(Bt=!0,h.calledRun=!0,F||(v||me(G),u(h),v||me(z)))}}return h.___start_em_js=914640,h.___stop_em_js=915413,h.wasmMemory=O,h.stackAlloc=zt,h.stackSave=jt,h.stackRestore=Gt,h.keepRuntimeAlive=()=>0<oe,h.addFunction=St,h.UTF8ToString=ue,h.stringToUTF8=Te,h.lengthBytesUTF8=Ae,h.ExitStatus=re,h.PThread=ge,W=function e(){Bt||Xt(),Bt||(W=e)},Xt(),t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=r:"function"==typeof define&&define.amd&&define([],(()=>r))})),pb=Uc(((e,t)=>{t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n'})),yb=Nc((()=>{xd=gd(),_d=fb(),Ad=!1,Sd=!1,Td=!1,Cd=e=>{if(1===e)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof $c<"u"&&$c.versions&&$c.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Ed=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Od=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",kd=async e=>{if(Ad)return Promise.resolve();if(Sd)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Td)throw new Error("previous call to 'initializeWebAssembly()' failed.");Sd=!0;let t=e.initTimeout,r=e.numThreads,n=e.simd,i=Cd(r),o=n&&Ed(),a=e.wasmPaths,s="string"==typeof a?a:void 0,u=Od(o,i),l="object"==typeof a?a[u]:void 0,h=!1,c=[];if(t>0&&c.push(new Promise((e=>{setTimeout((()=>{h=!0,e()}),t)}))),c.push(new Promise(((e,t)=>{let n=i?_d:xd,o={locateFile:(e,t)=>{if(i&&e.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([pb()],{type:"text/javascript"}));if(e.endsWith(".wasm")){if(l)return l;let e=s??t;return"ort-wasm-simd.wasm"===u?e+"ort-wasm-simd.jsep.wasm":"ort-wasm-simd-threaded.wasm"===u?e+"ort-wasm-simd-threaded.jsep.wasm":e+u}return t+e}};if(i)if(o.numThreads=r,typeof Blob>"u")o.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let e=`var ortWasmThreaded=${n.toString()};`;o.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}n(o).then((t=>{Sd=!1,Ad=!0,Id=t,e()}),(e=>{Sd=!1,Td=!0,t(e)}))}))),await Promise.race(c),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Pd=()=>{if(Ad&&Id)return Id;throw new Error("WebAssembly is not initialized yet.")}})),gb=Nc((()=>{yb(),$d=(e,t)=>{let r=Pd(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i},Rd=(e,t,r,n)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach((([e,i])=>{let o=t?t+e:e;if("object"==typeof i)Rd(i,o+".",r,n);else if("string"==typeof i||"number"==typeof i)n(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can't handle extra config type: "+typeof i);n(o,i?"1":"0")}}))},Bd=e=>{let t=Pd(),r=t.stackSave();try{let r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);let n=t.HEAP32[r/4],i=t.HEAPU32[r/4+1],o=i?t.UTF8ToString(i):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${o}`)}finally{t.stackRestore(r)}}})),mb=Nc((()=>{yb(),gb(),Dd=e=>{let t=Pd(),r=0,n=[],i=e||{};try{if(void 0===e?.logSeverityLevel)i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===e?.logVerbosityLevel)i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===e?.terminate&&(i.terminate=!1);let o=0;return void 0!==e?.tag&&(o=$d(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o),0===r&&Bd("Can't create run options."),void 0!==e?.extra&&Rd(e.extra,"",new WeakSet,((e,i)=>{let o=$d(e,n),a=$d(i,n);0!==t._OrtAddRunConfigEntry(r,o,a)&&Bd(`Can't set a run config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach((e=>t._free(e))),e}}})),wb=Nc((()=>{yb(),gb(),Md=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},Ld=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},Fd=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)},Nd=(e,t,r)=>{for(let n of t){let t="string"==typeof n?n:n.name;switch(t){case"webnn":if(t="WEBNN","string"!=typeof n){let t=n;if(t?.deviceType){let n=$d("deviceType",r),i=$d(t.deviceType,r);0!==Pd()._OrtAddSessionConfigEntry(e,n,i)&&Bd(`Can't set a session config entry: 'deviceType' - ${t.deviceType}.`)}if(t?.numThreads){let n=t.numThreads;("number"!=typeof n||!Number.isInteger(n)||n<0)&&(n=0);let i=$d("numThreads",r),o=$d(n.toString(),r);0!==Pd()._OrtAddSessionConfigEntry(e,i,o)&&Bd(`Can't set a session config entry: 'numThreads' - ${t.numThreads}.`)}if(t?.powerPreference){let n=$d("powerPreference",r),i=$d(t.powerPreference,r);0!==Pd()._OrtAddSessionConfigEntry(e,n,i)&&Bd(`Can't set a session config entry: 'powerPreference' - ${t.powerPreference}.`)}}break;case"webgpu":if(t="JS","string"!=typeof n){let t=n;if(t?.preferredLayout){if("NCHW"!==t.preferredLayout&&"NHWC"!==t.preferredLayout)throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${t.preferredLayout}`);let n=$d("preferredLayout",r),i=$d(t.preferredLayout,r);0!==Pd()._OrtAddSessionConfigEntry(e,n,i)&&Bd(`Can't set a session config entry: 'preferredLayout' - ${t.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${t}`)}let i=$d(t,r);0!==Pd()._OrtAppendExecutionProvider(e,i)&&Bd(`Can't append execution provider: ${t}.`)}},Ud=e=>{let t=Pd(),r=0,n=[],i=e||{};Fd(i);try{let e=Md(i.graphOptimizationLevel??"all"),o=Ld(i.executionMode??"sequential"),a="string"==typeof i.logId?$d(i.logId,n):0,s=i.logSeverityLevel??2;if(!Number.isInteger(s)||s<0||s>4)throw new Error(`log serverity level is not valid: ${s}`);let u=i.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let l="string"==typeof i.optimizedModelFilePath?$d(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(e,!!i.enableCpuMemArena,!!i.enableMemPattern,o,!!i.enableProfiling,0,a,s,u,l),0===r&&Bd("Can't create session options."),i.executionProviders&&Nd(r,i.executionProviders,n),i.freeDimensionOverrides)for(let[e,o]of Object.entries(i.freeDimensionOverrides)){if("string"!=typeof e)throw new Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof o||!Number.isInteger(o)||o<0)throw new Error(`free dimension override value must be a non-negative integer: ${o}`);let i=$d(e,n);0!==t._OrtAddFreeDimensionOverride(r,i,o)&&Bd(`Can't set a free dimension override: ${e} - ${o}.`)}return void 0!==i.extra&&Rd(i.extra,"",new WeakSet,((e,i)=>{let o=$d(e,n),a=$d(i,n);0!==t._OrtAddSessionConfigEntry(r,o,a)&&Bd(`Can't set a session config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseSessionOptions(r),n.forEach((e=>t._free(e))),e}}})),bb=Nc((()=>{jd=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},Gd=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},zd=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Vd=e=>{switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Hd=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Wd=e=>"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e,Yd=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}})),vb=Nc((()=>{Kd=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);if(!(typeof $c<"u"&&$c.versions&&$c.versions.node)){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let r,i=t.body.getReader();try{r=new ArrayBuffer(n)}catch(e){if(!(e instanceof RangeError))throw e;{let e=Math.ceil(n/65536);r=new WebAssembly.Memory({initial:e,maximum:e}).buffer}}let o=0;for(;;){let{done:e,value:t}=await i.read();if(e)break;let n=t.byteLength;new Uint8Array(r,o,n).set(t),o+=n}return new Uint8Array(r,0,n)}}try{return new Uint8Array(await(void 0)(e))}catch(t){if("ERR_FS_FILE_TOO_LARGE"===t.code){let t=(void 0)(e),r=[];for await(let e of t)r.push(e);return new Uint8Array(Rc.concat(r))}throw t}}})),xb=Nc((()=>{bb(),Xd=["V","I","W","E","F"],Zd=(e,t)=>{console.log(`[${Xd[e]},${(new Date).toISOString()}]${t}`)},Qd=(e,t)=>{qd=e,Jd=t},ef=(e,t)=>{let r=Hd(e);r>=Hd(qd)&&Zd(r,"function"==typeof t?t():t)},tf=(...e)=>{Jd&&ef(...e)}})),_b=Nc((()=>{bb(),rf=(e,t)=>new(Vd(t))(e)})),Ib=Nc((()=>{})),Ab=Nc((()=>{xb(),Ib(),nf=e=>16*Math.ceil(e/16),of=1,af=()=>of++,sf=async(e,t,r,n)=>{let i=nf(r),o=e.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let a=e.getCommandEncoder();e.endComputePass(),a.copyBufferToBuffer(t,0,o,0,i),e.flush(),await o.mapAsync(GPUMapMode.READ);let s=o.getMappedRange();if(n){let e=n();return e.set(new Uint8Array(s,0,r)),e}return new Uint8Array(s.slice(0,r))}finally{o.destroy()}},uf=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map}upload(e,t){let r=t.buffer,n=t.byteOffset,i=t.byteLength,o=nf(i),a=this.storageCache.get(e);if(!a)throw new Error("gpu data for uploading does not exist");if(a.originalSize!==i)throw new Error(`inconsistent data size. gpu data size=${a.originalSize}, data size=${i}`);let s=this.backend.device.createBuffer({mappedAtCreation:!0,size:o,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),u=s.getMappedRange();new Uint8Array(u).set(new Uint8Array(r,n,i)),s.unmap();let l=this.backend.getCommandEncoder();this.backend.endComputePass(),l.copyBufferToBuffer(s,0,a.gpuData.buffer,0,o),tf("verbose",(()=>`[WebGPU] GpuDataManager.upload(id=${e})`)),this.buffersForUploadingPending.push(s)}memcpy(e,t){let r=this.storageCache.get(e);if(!r)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(t);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(r.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let i=nf(r.originalSize),o=this.backend.getCommandEncoder();this.backend.endComputePass(),o.copyBufferToBuffer(r.gpuData.buffer,0,n.gpuData.buffer,0,i)}registerExternalBuffer(e,t,r){let n;if(r){if(n=this.externalBuffers.get(r),void 0===n)throw new Error("previous buffer is not registered");if(e===r)return tf("verbose",(()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, buffer is the same, skip.`)),n;this.externalBuffers.delete(r)}else n=af();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:e},originalSize:t}),this.externalBuffers.set(e,n),tf("verbose",(()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, registered.`)),n}unregisterExternalBuffer(e){let t=this.externalBuffers.get(e);void 0!==t&&(this.storageCache.delete(t),this.externalBuffers.delete(e),tf("verbose",(()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${t}`)))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let r,n=nf(e),i=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,o=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||o){let e=i?this.freeBuffers:this.freeUniformBuffers,o=e.get(n);o||(o=[],e.set(n,o)),r=o.length>0?o.pop():this.backend.device.createBuffer({size:n,usage:t})}else r=this.backend.device.createBuffer({size:n,usage:t});let a={id:af(),type:0,buffer:r};return this.storageCache.set(a.id,{gpuData:a,originalSize:e}),tf("verbose",(()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${a.id}`)),a}get(e){return this.storageCache.get(e)?.gpuData}release(e){let t=this.storageCache.get(e);if(!t)throw new Error("releasing data does not exist");return tf("verbose",(()=>`[WebGPU] GpuDataManager.release(id=${e}), gpuDataId=${t.gpuData.id}`)),this.storageCache.delete(e),this.buffersPending.push(t.gpuData.buffer),t.originalSize}async download(e,t){let r=this.storageCache.get(e);if(!r)throw new Error("data does not exist");await sf(this.backend,r.gpuData.buffer,r.originalSize,t)}refreshPendingBuffers(){for(let e of this.buffersForUploadingPending)e.destroy();this.buffersForUploadingPending=[];for(let e of this.buffersPending)(e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(e.size).push(e):(e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(e.size).push(e):e.destroy();this.buffersPending=[]}dispose(){this.freeBuffers.forEach((e=>{e.forEach((e=>{e.destroy()}))})),this.freeUniformBuffers.forEach((e=>{e.forEach((e=>{e.destroy()}))})),this.storageCache.forEach((e=>{e.gpuData.buffer.destroy()})),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map}},lf=(...e)=>new uf(...e)})),Sb=Nc((()=>{hf=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map((e=>`${this[e]}`)).join(";")),this.key}},cf=e=>new hf(e)})),Tb=Nc((()=>{df=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},ff=class{static calcShape(e,t,r=!1){let n=e.length,i=t.length;if(0===n)return t;if(0===i)return e;let o=Math.max(e.length,t.length),a=new Array(o);if(r){if(n<2||i<2)return;let r=df.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(void 0===r)return;[a[o-2],a[o-1]]=r}for(let s=r?3:1;s<=o;s++){let r=n-s<0?1:e[n-s],u=i-s<0?1:t[i-s];if(r!==u&&r>1&&u>1)return;a[o-s]=Math.max(r,u)}return a}static isValidBroadcast(e,t){let r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(1!==e[r-i]&&e[r-i]!==t[n-i])return!1;return!0}},pf=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(e,t,r){let n=1;for(let i=t;i<r;i++){if(e[i]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");n*=e[i]}return n}static computeStrides(e){let t=e.length;if(0===t)return[];if(1===t)return[1];let r=new Array(t);r[t-1]=1,r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map((r=>this.normalizeAxis(r,t??e.length)))}static sortBasedOnPerm(e,t){return t?t.map((t=>e[t])):e.slice().reverse()}static padShape(e,t){let r=e.length;return e.map(((e,n)=>e+t[n]+t[n+r]))}static areEqual(e,t){return e.length===t.length&&e.every(((e,r)=>e===t[r]))}},yf=class e{static adjustPoolAttributes(e,t,r,n,i,o){if(!e&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=r.length?r.push(t[e+2]):r[e]=t[e+2];for(let e=0;e<r.length;e++)if(e<n.length){if(n[e]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let e=0;e<r.length;e++)if(e<i.length){if(i[e]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let e=0;e<2*r.length;e++)if(e<o.length){if(o[e]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<r.length;e++){if(r[e]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[e]>=r[e]||o[e+r.length]>=r[e])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,n,i,o,a,s){if(s){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let u=0;u<t.length-2;u++)e.adjustPadAndReturnShape(t[u+(a?1:2)],r[u],n[u],i[u],o,u,u+t.length-2,s)}}static computePoolOutputShape(t,r,n,i,o,a,s){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let u=[r[0],r[1]];return e.computeShapeHelper(t,r,u,n,i,o,a,s),u}static computeConvOutputShape(t,r,n,i,o,a,s){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],r[0]];return e.computeShapeHelper(!1,t,u,n,i,o,a,s),u}static computeShapeHelper(t,r,n,i,o,a,s,u){if(t)for(let e=0;e<r.length-2;e++)n.push(1);else for(let t=0;t<r.length-2;t++)n.push(e.adjustPadAndReturnShape(r[t+2],i[t],o[t],a[t],s,t,t+r.length-2,u))}static adjustPadAndReturnShape(e,t,r,n,i,o,a,s){let u=r*(n-1)+1;if(!s||"NOTSET"===s)return Math.floor((e+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let r=((e+t-1)/t-1)*t+n-e;return i[o]=Math.floor("SAME_LOWER"===s?(r+1)/2:r/2),i[a]=r-i[o],Math.floor((e+r-n)/t+1)}default:throw new Error("Unsupported AutoPad type")}}},gf=class{static getShapeOfGemmResult(e,t,r,n,i){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");let o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);let u=-1;if(n?(s=r[0],u=1):(s=r[1],u=0),r[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!ff.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]}},mf=-34028234663852886e22,wf=34028234663852886e22})),Cb=Nc((()=>{bb(),Tb(),64,bf=(e,t)=>{if(3===t)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(4!==t)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},vf=(e,t=1)=>{let r=bf(e,t);return"string"==typeof r?r:r[0]},xf=(e,t=1)=>{let r=bf(e,t);return"string"==typeof r?r:r[1]},_f=e=>0===e.length?[]:[{type:"uint32",data:e},{type:"uint32",data:pf.computeStrides(e)}],If=e=>e%4==0?4:e%2==0?2:1,Af=(e="f32",t,r="0")=>t&&1!==t?`vec${t}<${e}>(${r})`:`${e}(${r})`,Sf=(e,t,r)=>"f32"===e?r:1===t?`f32(${r})`:`vec${t}f(${r})`,Tf=(e,t)=>4===t?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:2===t?`(${e}.x + ${e}.y)`:3===t?`(${e}.x + ${e}.y + ${e}.z)`:e,Cf=(e,t,r)=>e.startsWith("uniforms.")&&r>4?"string"==typeof t?`${e}[(${t}) / 4][(${t}) % 4]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Ef=(e,t,r,n,i)=>{let o="number"==typeof r,a=o?r:r.length,s=[...new Array(a).keys()],u=a<2?"u32":a<=4?`vec${a}<u32>`:`array<u32, ${a}>`,l=bf(t,i),h="string"==typeof l?l:l[1],c="string"==typeof l?l:l[0],d={indices:u,value:h,storage:c,tensor:t},f=e=>"string"==typeof e?e:`${e}u`,p={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},y=o?"uniforms.":"",g=`${y}${e}_shape`,m=`${y}${e}_strides`,w="";for(let e=0;e<a-1;e++)w+=`\n    let dim${e} = current / ${Cf(m,e,a)};\n    let rest${e} = current % ${Cf(m,e,a)};\n    indices[${e}] = dim${e};\n    current = rest${e};\n    `;w+=`indices[${a-1}] = current;`;let b=a<2?"":`\n  fn o2i_${e}(offset: u32) -> ${d.indices} {\n    var indices: ${d.indices};\n    var current = offset;\n    ${w}\n    return indices;\n  }`,v=[];if(a>=2)for(let e=a-1;e>=0;e--)v.push(`${Cf(m,e,a)} * (indices[${e}])`);let x=a<2?"":`\n  fn i2o_${e}(indices: ${d.indices}) -> u32 {\n    return ${v.join("+")};\n  }`,_=(...e)=>0===a?"0u":`${d.indices}(${e.map(f).join(",")})`,I=(e,t)=>a<2?`${e}`:`${Cf(e,t,a)}`,A={},S=(t,r)=>(()=>{if(d.storage===d.value)return`${e}[${t}]=${r};`;if("vec2<u32>"===d.storage&&"i32"===d.value)return`${e}[${t}]=vec2<u32>(u32(${r}), select(0u, 0xFFFFFFFFu, ${r} < 0));`;if("vec2<u32>"===d.storage&&"u32"===d.value)return`${e}[${t}]=vec2<u32>(u32(${r}), 0u);`;if("u32"===d.storage&&"vec4<bool>"===d.value)return`${e}[${t}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${r}));`;throw new Error(`not supported combination of storage type ${d.storage} and value type ${d.value} yet`)})(),T=t=>(()=>{if(d.storage===d.value)return`${e}[${t}]`;if("vec2<u32>"===d.storage&&"i32"===d.value)return`i32(${e}[${t}].x)`;if("vec2<u32>"===d.storage&&"u32"===d.value)return`u32(${e}[${t}].x)`;if("u32"===d.storage&&"vec4<bool>"===d.value)return`vec4<bool>(bool(${e}[${t}] & 0xFFu), bool(${e}[${t}] & 0xFF00u), bool(${e}[${t}] & 0xFF0000u), bool(${e}[${t}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${d.storage} and value type ${d.value} yet`)})(),C=a<2?"":`\n  fn get_${e}ByIndices(indices: ${d.indices}) -> ${h} {\n    return ${T(`i2o_${e}(indices)`)};\n  }`,E=a<2?"":(()=>{let t=s.map((e=>`d${e}: u32`)).join(", "),r=s.map((e=>`d${e}`)).join(", ");return`\n  fn get_${e}(${t}) -> ${h} {\n    return get_${e}ByIndices(${_(r)});\n  }`})(),O=a<2?"":`\n  fn set_${e}ByIndices(indices: ${d.indices}, value: ${h}) {\n    ${S(`i2o_${e}(indices)`,"value")}\n  }`,k=a<2?"":(()=>{let t=s.map((e=>`d${e}: u32`)).join(", "),r=s.map((e=>`d${e}`)).join(", ");return`\n  fn set_${e}(${t}, value: ${h}) {\n    set_${e}ByIndices(${_(r)}, value);\n  }`})();return{impl:()=>{let e=[],t=!1;return p.offsetToIndices&&(e.push(b),t=!0),p.indicesToOffset&&(e.push(x),t=!0),p.broadcastedIndicesToOffset&&(Object.values(A).forEach((t=>e.push(t))),t=!0),p.set&&(e.push(k),t=!0),p.setByIndices&&(e.push(O),t=!0),p.get&&(e.push(E),t=!0),p.getByIndices&&(e.push(C),t=!0),!o&&t&&e.unshift(`const ${g} = ${d.indices}(${r.join(",")});`,`const ${m} = ${d.indices}(${pf.computeStrides(r).join(",")});`),e.join("\n")},type:d,offsetToIndices:t=>(p.offsetToIndices=!0,a<2?t:`o2i_${e}(${t})`),indicesToOffset:t=>(p.indicesToOffset=!0,a<2?t:`i2o_${e}(${t})`),broadcastedIndicesToOffset:(t,r)=>{p.broadcastedIndicesToOffset=!0;let n=`${r.name}broadcastedIndicesTo${e}Offset`;if(n in A)return`${n}(${t})`;let i=[];for(let e=a-1;e>=0;e--){let t=r.indicesGet("outputIndices",e+r.rank-a);i.push(`${I(m,e)} * (${t} % ${I(g,e)})`)}return A[n]=`fn ${n}(outputIndices: ${r.type.indices}) -> u32 {\n             return ${i.length>0?i.join("+"):"0u"};\n           }`,`${n}(${t})`},indices:_,indicesGet:I,indicesSet:(e,t,r)=>a<2?`${e}=${r};`:`${Cf(e,t,a)}=${r};`,set:(...t)=>{if(t.length!==a+1)throw new Error(`indices length must be ${a}`);let r=t[a];if("string"!=typeof r)throw new Error("value must be string");let n=t.slice(0,a).map(f).join(",");return 0===a?S("0u",r):1===a?S(n[0],r):(p.set=!0,p.setByIndices=!0,p.indicesToOffset=!0,`set_${e}(${n}, ${r})`)},setByOffset:S,setByIndices:(t,r)=>a<2?S(t,r):(p.setByIndices=!0,p.indicesToOffset=!0,`set_${e}ByIndices(${t}, ${r});`),get:(...t)=>{if(t.length!==a)throw new Error(`indices length must be ${a}`);let r=t.map(f).join(",");return 0===a?T("0u"):1===a?T(r[0]):(p.get=!0,p.getByIndices=!0,p.indicesToOffset=!0,`get_${e}(${r})`)},getByOffset:T,getByIndices:t=>a<2?T(t):(p.getByIndices=!0,p.indicesToOffset=!0,`get_${e}ByIndices(${t})`),usage:n,name:e,strides:m,shape:g,rank:a}},Of=(e,t,r,n=1)=>Ef(e,t,r,"input",n),kf=(e,t,r,n=1)=>Ef(e,t,r,"output",n),Pf=(e,t,r,n=1)=>Ef(e,t,r,"internal",n),$f=class{constructor(e){this.normalizedDispatchGroup=e,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${"number"==typeof e?`${e}u`:e}) { return; }`}mainStart(e=64){let t="number"==typeof e?e:e[0],r="number"==typeof e?1:e[1],n="number"==typeof e?1:e[2],i=1===this.normalizedDispatchGroup[1]&&1===this.normalizedDispatchGroup[2];return`@compute @workgroup_size(${t}, ${r}, ${n})\n  fn main(${i?"@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>":"@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>"}) {\n    ${i?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${t*r*n}u + local_idx;`}\n  `}appendVariableUniforms(e){0!==e.rank&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if("internal"===e.usage)throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let r="input"===e.usage?"read":"read_write",n=e.type.storage;return`@group(0) @binding(${t}) var<storage, ${r}> ${e.name}: array<${n}>;`}declareVariables(...e){return e.map((e=>this.declareVariable(e,this.variableIndex++))).join("\n")}registerInternalVariable(e){if("internal"!==e.usage)throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach((e=>this.registerInternalVariable(e))),this}registerUniform(e,t,r=1){return this.uniforms.push({name:e,type:t,length:r}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(0===this.uniforms.length)return"";let e=[];for(let{name:t,type:r,length:n}of this.uniforms)if(n&&n>4)e.push(`${t}:array<vec4<${r}>, ${Math.ceil(n/4)}>`);else{let i=null==n||1===n?r:`vec${n}<${r}>`;e.push(`${t}:${i}`)}return`\n      struct Uniforms { ${e.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map((e=>e.impl())).join("\n")+this.internalVariables.map((e=>e.impl())).join("\n")}},Rf=e=>new $f(e),Bf=(e,t)=>{let r=e.length,n=[];for(let i=0;i<r;i++){let o=r-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&n.unshift(o)}return n},Df=e=>!0})),Eb=Nc((()=>{Tb(),Sb(),Cb(),Mf=e=>{if(!e||1!==e.length)throw new Error("Transpose requires 1 input.")},Lf=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,Ff=(e,t)=>pf.sortBasedOnPerm(e,Lf(e.length,t)),Nf=(e,t,r,n)=>{let i=[];i.push(`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let n=0;n<t;++n)i.push(r.indicesSet("a",e[n],`i[${n}]`));return i.push("return a;}"),i.join("\n")},Uf=(e,t)=>{let r=e.dataType,n=e.dims.length,i=Lf(n,t),o=Df(n),a=Ff(e.dims,i),s=o?a.length:a,u=o?n:e.dims,l=kf("output",r,s),h=Of("a",r,u);return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:o?["rank"]:["dims"]},getRunData:e=>{let t=pf.size(a);return{outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:o?[{type:"uint32",data:t},..._f(e[0].dims),..._f(a)]:[{type:"uint32",data:t}]}},getShaderSource:e=>`\n  ${e.registerUniform("output_size","u32").declareVariables(h,l)}\n\n  ${Nf(i,n,h,l)}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${l.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${l.setByOffset("global_idx",h.getByIndices("aIndices"))}\n  }`}},jf=(e,t)=>{Mf(e.inputs),e.compute(Uf(e.inputs[0],t.perm))},Gf=e=>cf({perm:e.perm})})),Ob=Nc((()=>{Tb(),Cb(),kb(),Eb(),zf={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Vf={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},Hf={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Wf={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Yf=(e,t)=>{let r=[];for(let n=t-e;n<t;++n)r.push(n);return r},Kf=(e,t)=>{let r=[],n=e.length;for(let i=0;i<n;i++)-1===t.indexOf(i)&&r.push(e[i]);let i=t.map((t=>e[t]));return[r,i]},Xf=(e,t)=>{let r=e.length+t.length,n=[],i=0;for(let o=0;o<r;o++)-1===t.indexOf(o)?n.push(e[i++]):n.push(1);return n},Zf=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},qf=(e,t)=>{let r=[];if(!Zf(e,t)){for(let n=0;n<t;++n)-1===e.indexOf(n)&&r.push(n);e.forEach((e=>r.push(e)))}return r},Jf=(e,t,r,n,i,o,a)=>{let s=r[0].dims,u=pf.size(o),l=pf.size(a),h=Of("_A",r[0].dataType,s),c=kf("output",i,o),d=`\n          var<workgroup> aBestValues : array<${c.type.storage}, 32>;\n       `;return{name:e,shaderCache:t,getShaderSource:e=>`\n        ${e.registerUniform("reduceSize","u32").declareVariables(h,c)}\n        ${d}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${e.mainStart(32)}\n\n          let outputIndex = global_idx / 32;\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ${c.type.storage}(${Hf[n]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + 32) {\n           let candidate = ${c.type.storage}(${h.getByOffset("offset + k")});\n           bestValue = ${zf[n]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, 32u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${Vf[n]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${c.setByOffset("outputIndex",""+("mean"===n?`bestValue / ${c.type.storage}(uniforms.reduceSize)`:`${Wf[n]}`))};\n         }\n        }`,getRunData:()=>({outputs:[{dims:o,dataType:i}],dispatchGroup:{x:u},programUniforms:[{type:"uint32",data:l}]})}},Qf=(e,t,r,n)=>{let i=1===e.inputs.length?r:fp(e.inputs,r),o=i.axes;0===o.length&&!i.noopWithEmptyAxes&&(o=e.inputs[0].dims.map(((e,t)=>t)));let a=pf.normalizeAxes(o,e.inputs[0].dims.length),s=a,u=e.inputs[0],l=qf(s,e.inputs[0].dims.length);l.length>0&&(u=e.compute(Uf(e.inputs[0],l),{inputs:[0],outputs:[-1]})[0],s=Yf(s.length,u.dims.length));let[h,c]=Kf(u.dims,s),d=h;i.keepDims&&(d=Xf(h,a)),e.compute(Jf(t,{hint:i.cacheKey,inputDependencies:["type"]},[u],n,e.inputs[0].dataType,d,c),{inputs:[u]})},ep=(e,t)=>{Qf(e,"ReduceMeanShared",t,"mean")},tp=(e,t)=>{Qf(e,"ReduceL1Shared",t,"l1")},rp=(e,t)=>{Qf(e,"ReduceL2Shared",t,"l2")},np=(e,t)=>{Qf(e,"ReduceLogSumExpShared",t,"logSumExp")},ip=(e,t)=>{Qf(e,"ReduceMaxShared",t,"max")},op=(e,t)=>{Qf(e,"ReduceMinShared",t,"min")},ap=(e,t)=>{Qf(e,"ReduceProdShared",t,"prod")},sp=(e,t)=>{Qf(e,"ReduceSumShared",t,"sum")},up=(e,t)=>{Qf(e,"ReduceSumSquareShared",t,"sumSquare")},lp=(e,t)=>{Qf(e,"ReduceLogSumShared",t,"logSum")}})),kb=Nc((()=>{Tb(),Sb(),Cb(),Ob(),hp=e=>{if(!e||0===e.length||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(2===e.length&&1!==e[1].dims.length)throw new Error("Invalid axes input dims.")},cp=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],dp=(e,t,r,n,i,o,a=!1,s=!1)=>{let u=[],l=r[0].dims,h=l.length,c=pf.normalizeAxes(i,h),d=!s&&0===c.length;l.forEach(((e,t)=>{d||c.indexOf(t)>=0?a&&u.push(1):u.push(e)}));let f=u.length,p=pf.size(u);return{name:e,shaderCache:t,getShaderSource:e=>{let t=[],i=Of("_A",r[0].dataType,h),s=kf("output",o,f),u=n(i,s,c),p=u[2];for(let e=0,r=0;e<h;e++)d||c.indexOf(e)>=0?(a&&r++,p=`for(var j${e}: u32 = 0; j${e} < ${l[e]}; j${e}++) {\n                  ${u[2].includes("last_index")?`let last_index = j${e};`:""}\n                  ${i.indicesSet("input_indices",e,`j${e}`)}\n                  ${p}\n                }`):(t.push(`${i.indicesSet("input_indices",e,s.indicesGet("output_indices",r))};`),r++);return`\n\n        ${e.registerUniform("output_size","u32").declareVariables(i,s)}\n\n        ${e.mainStart()}\n          ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${i.type.indices};\n          let output_indices = ${s.offsetToIndices("global_idx")};\n\n          ${t.join("\n")}\n          ${u[0]}       // init ops for reduce max/min\n          ${u[1]}\n          ${p}\n          ${u[3]}\n          ${4===u.length?s.setByOffset("global_idx","value"):u.slice(4).join("\n")}\n        }`},getRunData:()=>({outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:"uint32",data:p},..._f(l),..._f(u)]})}},fp=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach((e=>r.push(Number(e)))),cf({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},pp=(e,t,r,n)=>{let i=e.inputs,o=1===i.length?r:fp(i,r);e.compute(dp(t,{hint:o.cacheKey,inputDependencies:["rank"]},[i[0]],o.noopWithEmptyAxes&&0===o.axes.length?cp:n,o.axes,i[0].dataType,o.keepDims,o.noopWithEmptyAxes),{inputs:[0]})},yp=(e,t)=>{hp(e.inputs),pp(e,"ReduceLogSum",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += ${e.getByIndices("input_indices")};`,"value = log(value);"]))},gp=(e,t)=>{hp(e.inputs),pp(e,"ReduceL1",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += abs(${e.getByIndices("input_indices")});`,""]))},mp=(e,t)=>{hp(e.inputs),pp(e,"ReduceL2",t,((e,t)=>[`var t = ${t.type.value}(0); var value = ${t.type.value}(0);`,"",`t = ${e.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"]))},wp=(e,t)=>{hp(e.inputs),pp(e,"ReduceLogSumExp",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += exp(${e.getByIndices("input_indices")});`,"value = log(value);"]))},bp=(e,t)=>{hp(e.inputs),pp(e,"ReduceMax",t,((e,t,r)=>{let n=[];for(let t=0;t<e.rank;t++)(r.indexOf(t)>=0||0===r.length)&&n.push(e.indicesSet("input_indices",t,0));return[`${n.join("\n")}`,`var value = ${e.getByIndices("input_indices")};`,`value = max(value, ${e.getByIndices("input_indices")});`,""]}))},vp=(e,t)=>{hp(e.inputs),pp(e,"ReduceMean",t,((t,r,n)=>{let i=1;for(let r=0;r<t.rank;r++)(n.indexOf(r)>=0||0===n.length)&&(i*=e.inputs[0].dims[r]);return["var sum = f32(0);","",`sum += f32(${t.getByIndices("input_indices")});`,`let value = ${r.type.value}(sum / ${i});`]}))},xp=(e,t)=>{hp(e.inputs),pp(e,"ReduceMin",t,((e,t,r)=>{let n=[];for(let t=0;t<e.rank;t++)(r.indexOf(t)>=0||0===r.length)&&n.push(`input_indices[${t}] = 0;`);return[`${n.join("\n")}`,`var value = ${e.getByIndices("input_indices")};`,`value = min(value, ${e.getByIndices("input_indices")});`,""]}))},_p=(e,t)=>{hp(e.inputs),pp(e,"ReduceProd",t,((e,t)=>[`var value = ${t.type.storage}(1);`,"",`value *= ${e.getByIndices("input_indices")};`,""]))},Ip=(e,t)=>{hp(e.inputs),pp(e,"ReduceSum",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += ${e.getByIndices("input_indices")};`,""]))},Ap=(e,t)=>{hp(e.inputs),pp(e,"ReduceSumSquare",t,((e,t)=>[`var t = ${t.type.value}(0); var value = ${t.type.value}(0);`,"",`t = ${e.getByIndices("input_indices")}; value += t * t;`,""]))},Sp=(e,t,r)=>{if(0===t.length)return r;let n=1,i=1;for(let r=0;r<t.length;r++)-1===t.indexOf(r)?n*=e[r]:i*=e[r];return i<32&&n>1024},Tp=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?vp(e,t):ep(e,t)},Cp=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?gp(e,t):tp(e,t)},Ep=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?mp(e,t):rp(e,t)},Op=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?wp(e,t):np(e,t)},kp=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?bp(e,t):ip(e,t)},Pp=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?xp(e,t):op(e,t)},$p=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?_p(e,t):ap(e,t)},Rp=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ip(e,t):sp(e,t)},Bp=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ap(e,t):up(e,t)},Dp=(e,t)=>{Sp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?yp(e,t):lp(e,t)}})),Pb=Nc((()=>{bb(),Sb(),kb(),Mp=e=>{if(!e||0===e.length||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(1!==e[0].dataType)throw new Error("Invalid input type.")},Lp=(e,t)=>{Mp(e.inputs);e.compute(dp("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],((e,r,n)=>{let i=[];for(let t=0;t<e.rank;t++)(n.indexOf(t)>=0||0===n.length)&&i.push(`input_indices[${t}] = 0;`);return[`${i.join("\n")}`,`var value = ${e.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${e.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${e.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",r.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},Fp=(e,t)=>{Mp(e.inputs);e.compute(dp("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],((e,r,n)=>{let i=[];for(let t=0;t<e.rank;t++)(n.indexOf(t)>=0||0===n.length)&&i.push(`input_indices[${t}] = 0;`);return[`${i.join("\n")}`,`var value = ${e.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${e.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${e.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",r.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},Np=e=>cf(e)})),$b=Nc((()=>{bb(),Ib(),Cb(),Up=(e,t)=>{let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5];if(a&&s)throw new Error("Attention cannot have both past and relative_position_bias");if(3!==r.dims.length)throw new Error('Input "input" must have 3 dimensions');let u=r.dims[0],l=r.dims[1],h=r.dims[2];if(1!==i.dims.length)throw new Error('Input "bias" is expected to have 1 dimensions');if(2!==n.dims.length)throw new Error('Input "weights" is expected to have 2 dimensions');if(n.dims[0]!==h)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==n.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let c=i.dims[0]/3,d=c,f=d;if(t.qkvHiddenSizes.length>0){if(3!==t.qkvHiddenSizes.length)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let e of t.qkvHiddenSizes)if(e%t.numHeads!=0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");c=t.qkvHiddenSizes[0],d=t.qkvHiddenSizes[1],f=t.qkvHiddenSizes[2]}let p=l;if(c!==d)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==c+d+f)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let y=0;if(a){if(d!==f)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(5!==a.dims.length)throw new Error('Input "past" must have 5 dimensions');if(2!==a.dims[0])throw new Error('Input "past" first dimension must be 2');if(a.dims[1]!==u)throw new Error('Input "past" second dimension must be batch_size');if(a.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(a.dims[4]!==d/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(y=a.dims[3])}let g=p+y;if(o)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");if(s)throw new Error("relativePositionBias is not supported");return{batchSize:u,sequenceLength:l,pastSequenceLength:y,kvSequenceLength:p,totalSequenceLength:g,maxSequenceLength:-1,inputHiddenSize:h,hiddenSize:c,vHiddenSize:f,headSize:Math.floor(c/t.numHeads),vHeadSize:Math.floor(f/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:0,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},jp=(e,t,r,n)=>{let i=If(n),o=64,a=n/i;a<o?o=1:a/8<64&&(o=Math.ceil(a/8));let s=Math.ceil(n/i/o),u=[{type:Gd(t.dataType),data:1/n},{type:"uint32",data:a},{type:"uint32",data:s}],l=vf(t.dataType,i);e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:`${o};${l};${i}`},getShaderSource:e=>{let r=kf("x",t.dataType,t.dims,i),n="thread_max_vector";2===i?n="max(thread_max_vector.x, thread_max_vector.y)":4===i&&(n="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");let a=xf(t.dataType),s=[{name:"d_inv",type:a},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return`\n  var<workgroup> wgMax: array<f32, ${o}>;\n  var<workgroup> wgSum: array<f32, ${o}>;\n  ${e.registerUniforms(s).declareVariables(r)}\n  ${e.mainStart([o,1,1])}\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ${Af("f32",i,"-3.402823e+38f")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${Sf(a,i,"x[offset + i]")}, thread_max_vector);\n    }\n    wgMax[local_idx] = ${n};\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ${o}; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ${Af("f32",i,"0")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(${Sf(a,i,"x[offset + i]")} - maxValue);\n    }\n    wgSum[local_idx] = ${Tf("sumVector",i)};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${o}; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ${Af("f32",i,"uniforms.d_inv")};\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ${Sf(a,i,"x[offset + i]")};\n        x[offset + i] = ${r.type.value}(exp(f32input - maxValue) / sum);\n      }\n    }\n  }`},getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:u})},{inputs:[t],outputs:[]})},Gp=(e,t,r,n,i,o)=>{let a=[i.batchSize,i.numHeads,i.sequenceLength,i.kvSequenceLength+i.pastSequenceLength],s=0===o.scale?1/Math.sqrt(i.headSize):o.scale,u=If(i.headSize),l=i.headSize/u,h=12,c={x:Math.ceil(i.totalSequenceLength/h),y:Math.ceil(i.sequenceLength/h),z:i.batchSize*i.numHeads},d=Gd(t.dataType),f=[{type:"uint32",data:i.sequenceLength},{type:"uint32",data:l},{type:"uint32",data:i.totalSequenceLength},{type:"uint32",data:i.kvSequenceLength},{type:d,data:s}],p=[t,r],y=e.compute({name:"AttentionProbs",shaderCache:{hint:`${u}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:c,programUniforms:f}),getShaderSource:e=>{let n=Of("q",t.dataType,t.dims,u),i=Of("key",r.dataType,r.dims,u),o=kf("output",t.dataType,a),s=vf(t.dataType),l=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:s}];return`\n  const beta: ${s} = 1.0;\n  const TILE_SIZE = 12u;\n\n  var<workgroup> tileQ: array<${n.type.storage}, 144>;\n  var<workgroup> tileK: array<${n.type.storage}, 144>;\n  ${e.registerUniforms(l).declareVariables(n,i,o)}\n  ${e.mainStart([h,h,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${Af(s,u)};\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ${Tf("value",u)} * uniforms.alpha;\n    }\n  }`}},{inputs:p,outputs:[-1]})[0];return jp(e,y,i.batchSize*i.numHeads*i.sequenceLength,i.totalSequenceLength),y},zp=(e,t,r,n)=>{let i=[n.batchSize,n.sequenceLength,n.vHiddenSize],o=12,a={x:Math.ceil(n.vHeadSize/o),y:Math.ceil(n.sequenceLength/o),z:n.batchSize*n.numHeads},s=[{type:"uint32",data:n.sequenceLength},{type:"uint32",data:n.totalSequenceLength},{type:"uint32",data:n.vHeadSize},{type:"uint32",data:n.numHeads},{type:"uint32",data:n.vHiddenSize}];return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType,gpuDataType:0}],dispatchGroup:a,programUniforms:s}),getShaderSource:e=>{let n=Of("probs",t.dataType,t.dims),a=Of("v",r.dataType,r.dims),s=kf("output",t.dataType,i);return`\n  const TILE_SIZE = 12u;\n  var<workgroup> tileQ: array<${n.type.value}, 144>;\n  var<workgroup> tileK: array<${n.type.value}, 144>;\n  ${e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}]).declareVariables(n,a,s)}\n  ${e.mainStart([o,o,1])}\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${n.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`}},{inputs:[t,r],outputs:[0]})[0]},Vp=(e,t,r,n,i,o,a,s,u,l,h)=>{let c=Gp(e,t,r,0,l,h);zp(e,c,n,l)},Hp=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],n=t.sequenceLength,i=t.inputHiddenSize,o=t.headSize,a=12,s={x:Math.ceil(t.headSize/a),y:Math.ceil(t.sequenceLength/a),z:t.batchSize*t.numHeads},u=[e.inputs[0],e.inputs[1],e.inputs[2]],l=[{type:"uint32",data:n},{type:"uint32",data:i},{type:"uint32",data:o},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}];return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:s,programUniforms:l}),getShaderSource:e=>{let t=kf("output_q",u[0].dataType,r),n=kf("output_k",u[0].dataType,r),i=kf("output_v",u[0].dataType,r),o=Of("input",u[0].dataType,u[0].dims),s=Of("weight",u[1].dataType,u[1].dims),l=Of("bias",u[2].dataType,u[2].dims),h=o.type.storage;return`\n  const TILE_SIZE = 12u;\n  var<workgroup> tileInput: array<${h}, 144>;\n  var<workgroup> tileWeightQ: array<${h}, 144>;\n  var<workgroup> tileWeightK: array<${h}, 144>;\n  var<workgroup> tileWeightV: array<${h}, 144>;\n  ${e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}]).declareVariables(o,s,l,t,n,i)}\n  ${e.mainStart([a,a,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${h}(0);\n    var valueK = ${h}(0);\n    var valueV = ${h}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`}},{inputs:u,outputs:[-1,-1,-1]})},Wp=(e,t)=>{let r=Up(e.inputs,t),[n,i,o]=Hp(e,r);return Vp(e,n,i,o,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}})),Rb=Nc((()=>{sd(),Tb(),Sb(),Cb(),Yp=(e,t)=>{if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs");let r=(e,t,r)=>{let n=t.length;if(n!==e.length)throw new Error(`${r}: num dimensions != ${n}`);t.forEach(((t,n)=>{if(t!==e[n])throw new Error(`${r}: dim[${n}] do not match`)}))};if(e[0].dims.length>1){let n="NHWC"===t.format?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,n,"Invalid input scale"),r(e[2].dims,n,"Invalid input B"),r(e[3].dims,n,"Invalid input mean"),r(e[4].dims,n,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},Kp=(e,t)=>{let{epsilon:r,spatial:n,format:i}=t,o=e[0].dims,a=n?If(o[o.length-1]):1,s="NHWC"===i&&o.length>1?a:1,u=pf.size(o)/a,l=Df(o.length)&&n,h=l?o.length:o,c=Of("x",e[0].dataType,e[0].dims,a),d=Of("scale",e[1].dataType,e[1].dims,s),f=Of("bias",e[2].dataType,e[2].dims,s),p=Of("inputMean",e[3].dataType,e[3].dims,s),y=Of("inputVar",e[4].dataType,e[4].dims,s),g=kf("y",e[0].dataType,h,a);return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${n}_${a}`,inputDependencies:l?["rank","type","type","type","type"]:void 0},getShaderSource:e=>`\n  const epsilon = ${r};\n  ${e.registerUniform("outputSize","u32").declareVariables(c,d,f,p,y,g)}\n  ${e.mainStart()}\n  ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${g.offsetToIndices(`global_idx * ${a}`)};\n    ${(()=>{let e="";if(n)e=`let cOffset = ${1===o.length?"0u":"NHWC"===i?`outputIndices[${o.length-1}] / ${a}`:"outputIndices[1]"};`;else if("NCHW"===i)e=`\n            ${g.indicesSet("outputIndices","0","0")}\n            let cOffset = ${g.indicesToOffset("outputIndices")};`;else{e=`var cIndices = ${d.type.indices}(0);\n                       cIndices[0] = outputIndices[${o.length-1}];`;for(let t=1;t<d.rank;t++)e+=`cIndices[${t}] = outputIndices[${t}];`;e+=`let cOffset = ${d.indicesToOffset("cIndices")};`}return e})()}\n    let scale = ${d.getByOffset("cOffset")};\n    let bias = ${f.getByOffset("cOffset")};\n    let inputMean = ${p.getByOffset("cOffset")};\n    let inputVar = ${y.getByOffset("cOffset")};\n    let x = ${c.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${g.setByOffset("global_idx","value")}\n  }`,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l?[{type:"uint32",data:u},..._f(o)]:[{type:"uint32",data:u}]})}},Xp=e=>cf(e),Zp=(e,t)=>{let{inputs:r,outputCount:n}=e,i=Xp({...t,outputCount:n});if(oc.webgpu.validateInputContent&&Yp(r,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(Kp(r,i))}})),Bb=Nc((()=>{Tb(),Cb(),qp=e=>{if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Jp=e=>{let t=e[0].dims,r=e[0].dims[2],n=pf.size(t)/4,i=e[0].dataType,o=Of("input",i,t,4),a=Of("bias",i,[r],4),s=Of("residual",i,t,4),u=kf("output",i,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)}}),getShaderSource:e=>`\n  const channels = ${r}u / 4;\n  ${e.declareVariables(o,a,s,u)}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(n)}\n    let value = ${o.getByOffset("global_idx")}\n      + ${a.getByOffset("global_idx % channels")} + ${s.getByOffset("global_idx")};\n    ${u.setByOffset("global_idx","value")}\n  }`}},Qp=e=>{qp(e.inputs),e.compute(Jp(e.inputs))}})),Db=Nc((()=>{bb(),Tb(),Sb(),Cb(),ey=(e,t,r,n,i,o)=>{let a=Math.ceil(t/4),s="";s="string"==typeof i?`${i}(a)`:i("a");let u=Of("inputData",r,[a],4),l=kf("outputData",n,[a],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(u,l)}\n\n  ${o??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${u.getByOffset("global_idx")};\n    ${l.setByOffset("global_idx",s)}\n  }`},ty=(e,t,r,n,i,o=e.dataType)=>({name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:t=>ey(t,pf.size(e.dims),e.dataType,o,r,n),getRunData:t=>({outputs:[{dims:e.dims,dataType:o}],dispatchGroup:{x:Math.ceil(pf.size(t[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(pf.size(e.dims)/4)}]})}),ry=e=>{e.compute(ty(e.inputs[0],"Abs","abs"))},ny=e=>{e.compute(ty(e.inputs[0],"Acos","acos"))},iy=e=>{e.compute(ty(e.inputs[0],"Acosh","acosh"))},oy=e=>{e.compute(ty(e.inputs[0],"Asin","asin"))},ay=e=>{e.compute(ty(e.inputs[0],"Asinh","asinh"))},sy=e=>{e.compute(ty(e.inputs[0],"Atan","atan"))},uy=e=>{e.compute(ty(e.inputs[0],"Atanh","atanh"))},ly=e=>cf(e),hy=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(ty(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},cy=e=>{let t=e.length>=2&&0!==e[1].data?e[1].getFloat32Array()[0]:mf,r=e.length>=3&&0!==e[2].data?e[2].getFloat32Array()[0]:wf;return cf({min:t,max:r})},dy=(e,t)=>{let r=1===e.inputs.length?t:cy(e.inputs),n=xf(e.inputs[0].dataType);e.compute(ty(e.inputs[0],"Clip",(e=>`clamp(${e}, clip_min_, clip_max_)`),`\n    const clip_min_: vec4<${n}> = vec4(${n}(${r.min}));\n    const clip_max_: vec4<${n}> = vec4(${n}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},fy=e=>{e.compute(ty(e.inputs[0],"Ceil","ceil"))},py=e=>{e.compute(ty(e.inputs[0],"Cos","cos"))},yy=e=>{e.compute(ty(e.inputs[0],"Cosh","cosh"))},gy=e=>cf(e),my=(e,t)=>{let r=xf(e.inputs[0].dataType);e.compute(ty(e.inputs[0],"Elu",(e=>`elu_vf32(${e})`),`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},wy=(e,t="f32")=>`\nconst r0: ${t} = 0.3275911;\nconst r1: ${t} = 0.254829592;\nconst r2: ${t} = -0.284496736;\nconst r3: ${t} = 1.421413741;\nconst r4: ${t} = -1.453152027;\nconst r5: ${t} = 1.061405429;\n\nfn erf_vf32(v: ${e}) -> ${e} {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,by=e=>{let t=xf(e.inputs[0].dataType);e.compute(ty(e.inputs[0],"Erf",(e=>`erf_vf32(${e})`),wy(`vec4<${t}>`,t)))},vy=e=>{e.compute(ty(e.inputs[0],"Exp","exp"))},xy=e=>{e.compute(ty(e.inputs[0],"Floor","floor"))},_y=e=>{let t=xf(e.inputs[0].dataType);e.compute(ty(e.inputs[0],"Gelu",(e=>`0.5 * ${e} * (1.0 + erf_vf32(${e} * 0.7071067811865475))`),wy(`vec4<${t}>`,t)))},Iy=(e,t)=>{let r=xf(e.inputs[0].dataType);e.compute(ty(e.inputs[0],"LeakyRelu",(e=>`select(leaky_relu_alpha_ * ${e}, ${e}, ${e} >= vec4<${r}>(0.0))`),`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},Ay=e=>{e.compute(ty(e.inputs[0],"Not",(e=>`!${e}`)))},Sy=e=>{e.compute(ty(e.inputs[0],"Neg",(e=>`-${e}`)))},Ty=e=>{e.compute(ty(e.inputs[0],"Reciprocal",(e=>`1.0/${e}`)))},Cy=e=>{let t=xf(e.inputs[0].dataType);e.compute(ty(e.inputs[0],"Relu",(e=>`select(vec4<${t}>(0.0), ${e}, ${e} > vec4<${t}>(0.0))`)))},Ey=e=>{e.compute(ty(e.inputs[0],"Sigmoid",(e=>`(1.0 / (1.0 + exp(-${e})))`)))},Oy=e=>{e.compute(ty(e.inputs[0],"Sin","sin"))},ky=e=>{e.compute(ty(e.inputs[0],"Sinh","sinh"))},Py=e=>{e.compute(ty(e.inputs[0],"Sqrt","sqrt"))},$y=e=>{e.compute(ty(e.inputs[0],"Tan","tan"))},Ry=e=>{e.compute(ty(e.inputs[0],"Tanh","tanh"))},By=(e,t)=>{let r=xf(e.inputs[0].dataType);return e.compute(ty(e.inputs[0],"ThresholdedRelu",(e=>`select(vec4<${r}>(0.0), ${e}, ${e} > thresholded_relu_alpha_)`),`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},Dy=e=>{e.compute(ty(e.inputs[0],"Log","log"))}})),Mb=Nc((()=>{Tb(),Cb(),Db(),My=e=>{if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Ly=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=Of("input",e[0].dataType,e[0].dims,4),n=Of("bias",e[0].dataType,[e[0].dims[2]],4),i=kf("output",e[0].dataType,t,4),o=pf.size(t)/4,a=vf(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:t=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${t.declareVariables(r,n,i)}\n\n  ${wy(`vec4<${a}>`,a)}\n\n  ${t.mainStart()}\n    ${t.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${i.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},Fy=e=>{My(e.inputs),e.compute(Ly(e.inputs))}})),Lb=Nc((()=>{bb(),Tb(),Cb(),Ny=(e,t,r,n,i,o,a,s,u,l,h,c,d)=>{let f,p;"string"==typeof s?f=p=(e,t)=>`${s}((${e}),(${t}))`:"function"==typeof s?f=p=s:(f=s.scalar,p=s.vector);let y,g=c?t.length:t,m=c?r.length:r,w=c?n.length:n,b=kf("outputData",h,w,4),v=Of("aData",u,g,4),x=Of("bData",l,m,4);if(i)if(o){let e=1===pf.size(t),n=1===pf.size(r),i=t.length>0&&t[t.length-1]%4==0,o=r.length>0&&r[r.length-1]%4==0;y=e||n?b.setByOffset("global_idx",p(e?`${v.type.value}(${v.getByOffset("0")}.x)`:v.getByOffset("global_idx"),n?`${x.type.value}(${x.getByOffset("0")}.x)`:x.getByOffset("global_idx"))):`\n            let outputIndices = ${b.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${v.broadcastedIndicesToOffset("outputIndices",b)};\n            let offsetB = ${x.broadcastedIndicesToOffset("outputIndices",b)};\n            ${b.setByOffset("global_idx",p(a||i?v.getByOffset("offsetA / 4u"):`${v.type.value}(${v.getByOffset("offsetA / 4u")}[offsetA % 4u])`,a||o?x.getByOffset("offsetB / 4u"):`${x.type.value}(${x.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else y=b.setByOffset("global_idx",p(v.getByOffset("global_idx"),x.getByOffset("global_idx")));else{if(!o)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let e=(e,t,r="")=>{let n=`aData[indexA${t}][componentA${t}]`,i=`bData[indexB${t}][componentB${t}]`;return`\n            let outputIndices${t} = ${b.offsetToIndices(`global_idx * 4u + ${t}u`)};\n            let offsetA${t} = ${v.broadcastedIndicesToOffset(`outputIndices${t}`,b)};\n            let offsetB${t} = ${x.broadcastedIndicesToOffset(`outputIndices${t}`,b)};\n            let indexA${t} = offsetA${t} / 4u;\n            let indexB${t} = offsetB${t} / 4u;\n            let componentA${t} = offsetA${t} % 4u;\n            let componentB${t} = offsetB${t} % 4u;\n            ${e}[${t}] = ${r}(${f(n,i)});\n          `};y=9===h?`\n            var data = vec4<u32>(0);\n            ${e("data",0,"u32")}\n            ${e("data",1,"u32")}\n            ${e("data",2,"u32")}\n            ${e("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:`\n            ${e("outputData[global_idx]",0)}\n            ${e("outputData[global_idx]",1)}\n            ${e("outputData[global_idx]",2)}\n            ${e("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(v,x,b)}\n\n        ${d??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${y}\n      }`},Uy=(e,t,r,n,i,o,a=r.dataType)=>{let s=!pf.areEqual(r.dims,n.dims),u=r.dims,l=pf.size(r.dims),h=!1,c=!1,d=[s];if(s){let e=ff.calcShape(r.dims,n.dims,!1);if(!e)throw new Error("Can't perform binary op on the given tensors");u=e,l=pf.size(u);let t=1===pf.size(r.dims),i=1===pf.size(n.dims),o=r.dims.length>0&&r.dims[r.dims.length-1]%4==0,a=n.dims.length>0&&n.dims[n.dims.length-1]%4==0;d.push(t),d.push(i),d.push(o),d.push(a);let s=1;for(let e=1;e<u.length;e++){let t=r.dims[r.dims.length-e]??1;if(t!==(n.dims[n.dims.length-e]??1))break;s*=t}s%4==0?(c=!0,h=!0):(t||i||o||a)&&(h=!0)}else h=!0;d.push(h);let f=Df(r.dims.length)&&Df(n.dims.length)&&Df(u.length);return{name:e,shaderCache:{hint:t+d.map((e=>e.toString())).join("_"),inputDependencies:f?["rank","rank"]:["dims","dims"]},getShaderSource:e=>Ny(e,r.dims,n.dims,u,h,s,c,i,r.dataType,n.dataType,a,f,o),getRunData:()=>({outputs:[{dims:u,dataType:a}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:f?[{type:"uint32",data:Math.ceil(pf.size(u)/4)},..._f(r.dims),..._f(n.dims),..._f(u)]:[{type:"uint32",data:Math.ceil(pf.size(u)/4)}]})}},jy=(e,t,r,n,i,o)=>{e.compute(Uy(t,i??"",e.inputs[0],e.inputs[1],r,n,o))},Gy=e=>{jy(e,"Add",((e,t)=>`${e}+${t}`))},zy=e=>{jy(e,"Div",((e,t)=>`${e}/${t}`))},Vy=e=>{jy(e,"Equal",{scalar:(e,t)=>`u32(${e}==${t})`,vector:(e,t)=>`vec4<u32>(${e}==${t})`},void 0,void 0,9)},Hy=e=>{jy(e,"Mul",((e,t)=>`${e}*${t}`))},Wy=e=>{let t=Of("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;jy(e,"Pow",{scalar:(e,t)=>`pow_custom(${e},${t})`,vector:(e,t)=>`pow_vector_custom(${e},${t})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${"i32"===t?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},Yy=e=>{jy(e,"Sub",((e,t)=>`${e}-${t}`))},Ky=e=>{jy(e,"Greater",{scalar:(e,t)=>`u32(${e}>${t})`,vector:(e,t)=>`vec4<u32>(${e}>${t})`},void 0,void 0,9)},Xy=e=>{jy(e,"Less",{scalar:(e,t)=>`u32(${e}<${t})`,vector:(e,t)=>`vec4<u32>(${e}<${t})`},void 0,void 0,9)},Zy=e=>{jy(e,"GreaterOrEqual",{scalar:(e,t)=>`u32(${e}>=${t})`,vector:(e,t)=>`vec4<u32>(${e}>=${t})`},void 0,void 0,9)},qy=e=>{jy(e,"LessOrEqual",{scalar:(e,t)=>`u32(${e}<=${t})`,vector:(e,t)=>`vec4<u32>(${e}<=${t})`},void 0,void 0,9)}})),Fb=Nc((()=>{Tb(),Sb(),Cb(),Jy=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].dataType,r=e[0].dims.length;for(let n of e){if(n.dataType!==t)throw new Error("input tensors should be one type");if(n.dims.length!==r)throw new Error("input tensors should have the same shape")}},Qy=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,eg=(e,t)=>{let r=e.length,n=[];for(let i=0;i<r;++i){let o=t.setByOffset("global_idx",e[i].getByIndices("indices"));1===r?n.push(o):0===i?n.push(`if (inputIndex == ${i}u) { ${o} }`):i===r-1?n.push(`else { ${o} }`):n.push(`else if (inputIndex == ${i}) { ${o} }`)}return n.join("\n")},tg=(e,t)=>{let r=e[0].dims.slice();if(t>=r.length||t<-1*r.length)throw new Error("axis specified for concat doesn't match input dimensionality");let n=t<0?r.length+t:t,i=r.slice(0);for(let t=1;t<e.length;t++){let o=e[t].dims.slice();for(let e=0;e<r.length;e++)if(e===n)i[n]+=o[e];else if(r[e]!==o[e])throw new Error("non concat dimensions must match")}let o=pf.size(i),a=new Array(e.length),s=new Array(e.length),u=e[0].dataType,l=0,h=[],c=[],d=[],f=[{type:"uint32",data:o}];for(let t=0;t<e.length;++t)l+=e[t].dims[n],a[t]=l,d.push(Df(e[t].dims.length)),c.push(d[t]?e[t].dims.length:e[t].dims),s[t]=Of(`input${t}`,u,c[t]),h.push(d[t]?"rank":"dims"),f.push({type:"uint32",data:a[t]});for(let t=0;t<e.length;++t)d[t]&&f.push(..._f(e[t].dims));let p=Df(i.length);p&&f.push(..._f(i));let y=p?i.length:i,g=kf("output",u,y),m=g.indicesGet("indices",n),w=Array.from(Array(a.length).keys()).map((e=>`uniforms.sizeInConcatAxis${e}`)).join(",");return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:f}),getShaderSource:t=>`\n\n  ${(()=>{t.registerUniform("outputSize","u32");for(let r=0;r<e.length;r++)t.registerUniform(`sizeInConcatAxis${r}`,"u32");return t.declareVariables(...s,g)})()}\n\n  ${Qy(a.length,w)}\n\n  ${t.mainStart()}\n    ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${g.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${m});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${a.length}u>(${w});\n      ${m} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${eg(s,g)}\n  }`}},rg=(e,t)=>{Jy(e.inputs),e.compute(tg(e.inputs,t.axis))},ng=e=>cf({axis:e.axis})})),Nb=Nc((()=>{Tb(),ig=(e,t)=>{switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:`value = max(value, ${t}(0.0));`};case"Sigmoid":return{activationFunction:"",applyActivation:`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`};case"Clip":return{activationFunction:`const clip_min_=${t}(${e.clipMin});const clip_max_=${t}(${e.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},og=e=>{let t=e?.activation||"";if("Clip"===t){let[r,n]=e?.activation_params||[mf,wf];return{activation:t,clipMax:n,clipMin:r,activationCacheKey:`${t}:${r},${n}`}}return{activation:t,activationCacheKey:t}}})),Ub=Nc((()=>{ag=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},sg=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `})),jb=Nc((()=>{ug=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`})),Gb=Nc((()=>{Tb(),Cb(),Nb(),Ub(),lg=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,hg=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${3===t?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${3===t?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${3===t?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,cg=(e,t,r="f32",n,i=!1,o=32,a=!1,s=32)=>{let u=t[1]*e[1],l=t[0]*e[0],h=i?u:o,c=i?o:u,d=h/t[0],f=o/t[1];if((!i||4!==d||4!==e[1])&&(i||3!==d&&4!==d)||h%t[0]!=0||o%t[1]!=0||4!==e[0])throw new Error(`If transposeA ${i} is true, innerElementSize ${d} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${d} must be 3 or 4.\n  tileAWidth ${h} must be divisible by workgroupSize[0]${t[0]}. tileInner ${o} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${d}<${r}>, ${h/d}>, ${c}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${l/e[0]}>, ${o}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${d};\nconst tileInner = ${o};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${a?"0":"i32(globalId.z)"};\n  ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${u};\n\n  let numTiles = ${a?`${Math.ceil(s/o)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n  var kStart = ${a?`i32(globalId.z) * ${s}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${f};\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${lg(i,n)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${n?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${3===d?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${hg(i,d)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},dg=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,fg=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",pg=(e,t,r="f32",n,i=!1,o=32,a=!1,s=32,u=!1)=>{let l=e[1]*t[1],h=e[0]*t[0],c=i?l:o,d=i?o:l;if(d%t[1]!=0||c%t[0]!=0||o%t[1]!=0)throw new Error(`tileAHight ${d} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${c} must be divisible by workgroupSize[0]${t[0]}, tileInner ${o} must be divisible by workgroupSize[1]${t[1]}`);let f=d/t[1],p=c/t[0],y=o/t[1],g=u?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${l};\n    let globalColStart = i32(workgroupId.x) * ${h};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${d}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${t[0]}) {\n          ${dg(i,n)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${o}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${h}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${n?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${l};\n\nlet tileRowA = i32(localId.y) * ${f};\nlet tileColA = i32(localId.x) * ${p};\nlet tileRowB = i32(localId.y) * ${y};\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${p}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${dg(i,n)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${y}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${n?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${fg(i)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${c}>, ${d}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${h}>, ${o}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${o};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${a?"0":"i32(globalId.z)"};\n    ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}\n    let numTiles = ${a?`${Math.ceil(s/o)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n    var kStart = ${a?`i32(globalId.z) * ${s}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${g}\n  }\n`},yg=(e,t,r,n,i,o=!1)=>{let[a,s,u]=i,[l,h,c,d]=n,f=Bf(a,u),p=Bf(s,u),y=vf(n[0].type.tensor);return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${l.type.indices}) -> ${ag(e,y)} {\n      var value = ${ag(e,y)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ${(()=>{let e=h.rank,t=l.rank,r=`var aIndices: ${h.type.indices};`;for(let n=e-2-1,i=t-1;n>=0;n--,i--)r+=`\naIndices[${n}] = ${t>1?`batchIndices[${i}]`:"batchIndices"};`;return f.forEach((e=>{r+=`\naIndices[${e}] = 0;`})),r+=`\naIndices[${e-2}] = u32(row);\n                   aIndices[${e-1}] = u32(colIn);`,r})()}\n        value = ${h.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${l.type.indices}) -> ${ag(e,y)} {\n      var value = ${ag(e,y)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ${(()=>{let e=c.rank,t=l.rank,r=`var bIndices: ${c.type.indices};`;for(let n=e-2-1,i=t-1;n>=0;n--,i--)r+=`\nbIndices[${n}] = ${t>1?`batchIndices[${i}]`:"batchIndices"};`;return p.forEach((e=>{r+=`\nbIndices[${e}] = 0;`})),r+=`\nbIndices[${e-2}] = u32(row);\n                   bIndices[${e-1}] = u32(colIn);`,r})()}\n        value = ${c.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${ag(e,y)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${o?"bias[colIn]":`${ag(e,y)}(bias[row])`};`:""}\n        ${r}\n        ${d.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},gg=(e,t,r,n,i=!1)=>{let o=e[0].dims,a=e[1].dims,s=o.slice(0,-2),u=a.slice(0,-2),l=n?n.slice(0,-2):r.slice(0,-2),h=Df(l.length),c=h?l.length:l,d=Pf("batchDims",e[0].dataType,c,1),f=pf.size(l),p=o[o.length-2],y=o[o.length-1],g=a[a.length-1],m=y%4==0&&g%4==0,w=p<=8?[4,1,1]:[4,4,1],b=[8,8,1],v=[Math.ceil(g/b[0]/w[0]),Math.ceil(p/b[1]/w[1]),Math.ceil(f/b[2]/w[2])],x=vf(e[0].dataType),_=m?4:1,I=[...s,p,y/_],A=Df(I.length),S=A?I.length:I,T=[...u,y,g/_],C=Df(T.length),E=C?T.length:T,O=[f,p,g/_],k=Of("a",e[0].dataType,S,_),P=Of("b",e[1].dataType,E,_),$=kf("result",e[0].dataType,O.length,_),R=[k,P],B=[{type:"int32",data:p},{type:"int32",data:g},{type:"int32",data:y}];h&&B.push(..._f(l)),A&&B.push(..._f(I)),C&&B.push(..._f(T));let D=[];D.push(A?"rank":"dims"),D.push(C?"rank":"dims");let M=e.length>2,{activationFunction:L,applyActivation:F}=ig(t,$.type.value),N=yg(_,M,F,[d,k,P,$],[s,u,l],i);if(M){let t=i?_:1;R.push(Of("bias",e[2].dataType,e[2].dims.length,t)),B.push(..._f(e[2].dims)),D.push("rank")}B.push(..._f(O));return{name:"MatMul",shaderCache:{hint:t.activationCacheKey+`${w}${m}${i}`,inputDependencies:D},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:v[0],y:v[1],z:v[2]},programUniforms:B}),getShaderSource:e=>`\n  ${e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(d).declareVariables(...R,$)}\n  ${L}\n  ${N}\n  ${m?cg(w,b,x,d):pg(w,b,x,d)}\n                   `}}})),zb=Nc((()=>{xb(),Cb(),Nb(),Ub(),jb(),Gb(),mg=(e,t,r,n,i=!1,o,a=4,s=4,u=4,l="f32")=>{let h=e?"\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    ":"\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    ",c=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",d=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",f=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",p=e?"row":"col",y=e?"col":"row",g=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${p} / outWidth;\n    let outCol = ${p} % outWidth;\n\n    let WRow = ${y} / (filterDims[1] * inChannels);\n    let WCol = ${y} / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ${y} % inChannels;\n    var resData = ${ag(a,l)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the 'same' padding type.\n    if (xRow >= 0 && xRow < ${d} && xCol >= 0 && xCol < ${f}) {\n      ${h}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${(e=>{switch(e){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${l}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(a)}\n    }\n    return resData;`,m=e?t&&n?`\n    let col = colIn * ${a};\n    ${g}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ${g}\n    }\n    return ${ag(a,l)}(0.0);`:n&&r?`\n    let col = colIn * ${a};\n    ${g}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ${g}\n    }\n    return ${ag(a,l)}(0.0);`,w=`${(e=>{switch(e){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(s)}`,b=ag(u,l),v=ag(e?a:s,l),x=ag(e?s:a,l),{activationFunction:_,applyActivation:I}=ig(o,b);return`\n    ${_}\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${v} {\n      ${e?m:w}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${x} {\n      ${e?w:m}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${b}) {\n      let col = colIn * ${u};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${c}\n      ${sg(i)}\n      ${I}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},wg=(e,t,r,n,i,o,a,s)=>{let u="NHWC"===t.format,l=u?e[0].dims[3]:e[0].dims[1],h=r[0],c=u?r[2]:r[3],d=u?r[1]:r[2],f=u?r[3]:r[1],p=u&&(l%4==0||l%3==0)&&f%4==0,y=u?f:c*d,g=u?c*d:f,m=[8,8,1],w=n<=8?[4,1,1]:[4,4,1],b=[Math.ceil(y/m[0]/w[0]),Math.ceil(g/m[1]/w[1]),Math.ceil(h/m[2]/w[2])];tf("verbose",(()=>`[conv2d_mm_webgpu] dispatch = ${b}`));let v=p?u&&l%4!=0?3:4:1,x=m[1]*w[1],_=m[0]*w[0],I=Math.max(m[0]*v,m[1]),A=n%x==0,S=i%_==0,T=o%I==0,C=p?[v,4,4]:[1,1,1],E=vf(e[0].dataType),O=p?4:1,k=[{type:"int32",data:n},{type:"int32",data:i},{type:"int32",data:o}],P=[Of("x",e[0].dataType,e[0].dims.length,3===v?1:v),Of("w",e[1].dataType,e[1].dims.length,O)];k.push(..._f(e[0].dims)),k.push(..._f(e[1].dims));let $=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${p?`vec4<${E}>`:E}) {\n        result[flatIndex] = ${p?`vec4<${E}>`:E}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${p?`vec4<${E}>`:E}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${p?"/ 4":""}, value);\n      }`;if(a){let t=Of("bias",e[2].dataType,e[2].dims.length,O);P.push(t),k.push(..._f(e[2].dims)),$+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${p?`vec4<${E}>`:E} {\n          return bias[coords.${u?"w":"y"}${p?"/ 4":""}];\n        }`}let R=kf("result",e[0].dataType,r.length,O);return k.push(..._f(r)),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:k}),getShaderSource:e=>`\n        ${ug("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...P,R)}\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[0]}, ${t.kernelShape[1]});\n        const pad : vec2<i32> = vec2<i32>(${t.pads[0]}, ${t.pads[1]});\n        const stride : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        ${$}\n        ${mg(u,A,S,T,a,t,C[0],C[1],C[2],E)}\n            ${p?cg(w,m,E,void 0,!u,I):pg(w,m,E,void 0,!u,I,!1,void 0,s)}`}}})),Vb=Nc((()=>{Tb(),Cb(),Wb(),Nb(),bg=(e,t,r)=>{let n=e.length>2,i=n?"value += b[output_channel];":"",o=e[0].dims,a=e[1].dims,s=a[0]/t.group,u="NHWC"===t.format,l=Ig(o,a,t.dilations,t.pads,t.strides,u),h=pf.size(l),c=kf("output",e[0].dataType,l),{activationFunction:d,applyActivation:f}=ig(t,c.type.value),p=Of("x",e[0].dataType,o),y=Of("w",e[1].dataType,a),g=[p,y];n&&g.push(Of("b",e[2].dataType,e[2].dims));return{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r?r(l):l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:e=>`\n  const strides: vec2<u32> = vec2(${t.strides[0]}u, ${t.strides[1]}u);\n  const pads: vec2<u32> = vec2(${t.pads[0]}u, ${t.pads[1]}u);\n\n  ${e.declareVariables(...g,c)}\n\n  ${d}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n    let outputIndices = ${c.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${u?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${u?1:2}], outputIndices[${u?2:3}]) * strides - pads;\n    let group_id: u32 = output_channel / ${s}u;\n\n    var value: ${c.type.value} = ${c.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ${a[1]}u; wInChannel++) {\n      let input_channel = group_id * ${a[1]}u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ${a[2]}u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ${t.dilations[0]}u;\n\n        if (xHeight < 0u || xHeight >= ${o[u?1:2]}u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ${a[3]}u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ${t.dilations[1]}u;\n          if (xWidth < 0u || xWidth >= ${o[u?2:3]}u) {\n            continue;\n          }\n\n          let xVal = ${u?p.get("batch","xHeight","xWidth","input_channel"):p.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${y.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${i}\n    ${f}\n    ${c.setByOffset("global_idx","value")}\n  }`}}})),Hb=Nc((()=>{Tb(),Gb(),Cb(),Nb(),vg=(e,t,r,n,i=!1)=>{let o=e[0].dims,a=e[1].dims,s=o[o.length-2],u=a[a.length-1],l=o[o.length-1],h=If(u),c=If(l),d=If(s),f=pf.size(r)/h/d,p=e.length>2,y=n?n.slice(0,-2):r.slice(0,-2),g=[pf.size(y),s,u],m=[{type:"uint32",data:f},{type:"uint32",data:s},{type:"uint32",data:u},{type:"uint32",data:l},..._f(y),..._f(o),..._f(a)];p&&m.push(..._f(e[2].dims)),m.push(..._f(g));return{name:"MatMulNaive",shaderCache:{hint:`${t.activationCacheKey}_${h}_${c}_${d}_${i}`,inputDependencies:p?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:m}),getShaderSource:n=>{let s=Pf("batch_dims",e[0].dataType,y.length),u=Of("a",e[0].dataType,o.length,c),l=Of("b",e[1].dataType,a.length,h),f=kf("output",e[0].dataType,g.length,h),{activationFunction:m,applyActivation:w}=ig(t,f.type.value),b=[u,l],v="";if(p){let t=i?h:1;b.push(Of("bias",e[2].dataType,e[2].dims.length,t)),v=""+(i?`value += bias[col / ${t}];`:`value += ${f.type.value}(bias[row + i]);`)}let x=o.slice(0,-2),_=a.slice(0,-2),I=Bf(x,y),A=Bf(_,y),S=(e,t)=>{let r=e.rank,n=e.name;if(2===r)return`var ${n}_indices = ${e.type.indices}(0u, 0u);`;let i=s.rank,o=`var ${n}_indices: ${e.type.indices};`;for(let e=r-2-1,t=i-1;e>=0;e--,t--)o+=`\n${n}_indices[${e}] = ${i>1?`batch_indices[${t}]`:"batch_indices"};`;return t.forEach((e=>{o+=`\n${n}_indices[${e}] = 0;`})),o+=`${n}_indices[${r-2}] = 0u;\n                     ${n}_indices[${r-1}] = 0u;`,o};return`\n  ${n.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(s).declareVariables(...b,f)}\n  ${m}\n  ${n.mainStart()}\n    ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    let col = (global_idx % (uniforms.N / ${h})) * ${h};\n    var index1 = global_idx / (uniforms.N / ${h});\n    let stride1 = uniforms.M / ${d};\n    let row = (index1 % stride1) * ${d};\n    let batch = index1 / stride1;\n\n    ${2===r.length?"":`let batch_indices = ${s.offsetToIndices("batch")};`}\n    ${S(u,I)}\n    let a_offset = ${u.indicesToOffset("a_indices")};\n    ${S(l,A)}\n    let b_offset = ${l.indicesToOffset("b_indices")};\n    var values: array<${f.type.value}, ${d}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${c}) {\n      ${(()=>{let e=`var a_data: ${u.type.value};`;for(let t=0;t<c;t++)e+=`\n              let b_data${t} = b[(b_offset + (k + ${t}) * uniforms.N + col) / ${h}];`;for(let t=0;t<d;t++){e+=`a_data = a[(a_offset + (row + ${t}) * uniforms.K + k) / ${c}];`;for(let r=0;r<c;r++)e+=`\n            values[${t}] = fma(${l.type.value}(a_data${1===c?"":`[${r}]`}), b_data${r}, values[${t}]);\n`}return e})()}\n    }\n    for (var i = 0u; i < ${d}u; i++) {\n      var value = values[i];\n      ${v}\n      ${w}\n      let cur_indices = ${f.type.indices}(batch, row + i, col);\n      let offset = ${f.indicesToOffset("cur_indices")};\n      ${f.setByOffset(`offset / ${h}`,"value")};\n    }\n  }\n  `}}},xg=e=>{if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},_g=e=>{xg(e.inputs);let t=ff.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let r=t[t.length-1],n=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&n<8?e.compute(vg(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(gg(e.inputs,{activation:"",activationCacheKey:""},t))}})),Wb=Nc((()=>{Tb(),Sb(),zb(),Gb(),Vb(),Nb(),Hb(),Eb(),Ig=(e,t,r,n,i,o)=>{let a=e[0],s=e.slice(o?1:2,o?3:4),u=s.length,l=t[0],h=t.slice(2).map(((e,t)=>e+(e-1)*(r[t]-1))),c=s.map(((e,t)=>e+n[t]+n[t+u])).map(((e,t)=>Math.floor((e-h[t]+i[t])/i[t])));return c.splice(0,0,a),c.splice(o?3:1,0,l),c},Ag=[2,3,1,0],Sg=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error(`dilations should be ${r}D`);if(t.strides.length!==r)throw new Error(`strides should be ${r}D`);if(t.pads.length!==2*r)throw new Error(`pads should be ${2*r}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},Tg=(e,t)=>{let r=e.kernelShape.slice();for(let e=2;e<t[1].dims.length;++e)0===r[e-2]&&(r[e-2]=t[1].dims[e]);let n=e.pads.slice();yf.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,"NHWC"===e.format,e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n,cacheKey:e.cacheKey}),i},Cg=e=>{let t=og(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,o=e.group,a=e.kernel_shape,s=e.pads,u=e.strides,l=e.w_is_const();return cf({autoPad:n,format:r,dilations:i,group:o,kernelShape:a,pads:s,strides:u,wIsConst:l,...t})},Eg=(e,t,r)=>{let n=Tg(r,t),i="NHWC"===r.format;if(1!==r.group)return void e.compute(bg(t,n));let o=3===t.length,a=t[0].dims[i?1:2],s=t[0].dims[i?2:3],u=t[0].dims[i?3:1],l=t[1].dims[2],h=t[1].dims[3],c=Ig(t[0].dims,t[1].dims,r.dilations,n.pads,r.strides,i),d=c[i?1:2],f=c[i?2:3],p=c[i?3:1],y=i&&l===a&&h===s&&0===r.pads[0]&&0===r.pads[1];if(y||1===l&&1===h&&1===r.dilations[0]&&1===r.dilations[1]&&1===r.strides[0]&&1===r.strides[1]&&0===r.pads[0]&&0===r.pads[1]){let l,h,g,m=c[0],w=[];if(i){let n=e.kernelCustomData.wT??e.compute(Uf(t[1],Ag),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=n),y){let e=a*s*u;l=t[0].reshape([1,m,e]),h=n.reshape([1,e,p]),g=[1,m,p]}else l=t[0].reshape([m,a*s,u]),h=n.reshape([1,u,p]),g=[m,d*f,p];w.push(l),w.push(h)}else l=t[0].reshape([m,u,a*s]),h=t[1].reshape([1,p,u]),g=[m,p,d*f],w.push(h),w.push(l);o&&w.push(t[2]);let b=g[2],v=w[0].dims[w[0].dims.length-1];return void(b<8&&v<8?e.compute(vg(w,n,c,g,i),{inputs:w}):e.compute(gg(w,n,c,g,i),{inputs:w}))}let g=e.kernelCustomData.wT??e.compute(Uf(t[1],Ag),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=g);let m=[t[0],g];o&&m.push(t[2]);let w=i?d*f:p,b=i?p:d*f,v=l*h*u;e.compute(wg(m,n,c,w,b,v,o,!0),{inputs:m})},Og=(e,t)=>{let r="NHWC"===t.format,n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&n.push(e.inputs[2]);let i=[0,t.pads[0],0,t.pads[1]],o=[1].concat(t.strides),a=[1].concat(t.dilations),s=[1].concat(t.kernelShape),u=Tg({...t,pads:i,strides:o,dilations:a,kernelShape:s},n);e.compute(bg(n,u,(e=>r?[e[0],e[2],e[3]]:[])))},kg=(e,t)=>{Sg(e.inputs,t),3===e.inputs[0].dims.length?Og(e,t):Eg(e,e.inputs,t)}})),Yb=Nc((()=>{xb(),Cb(),Nb(),Ub(),jb(),Gb(),Pg=(e,t=!1,r,n=4)=>{let i=ag(n,"f32"),o=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",a=e?"row":"col",s=e?"col":"row",u=`\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${a} / outWidth;\n      let outCol = ${a} % outWidth;\n\n      let WRow = ${s} / (filterDims[1] * inChannels);\n      let WCol = ${s} / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(${e?"outBackprop[1]":"outBackprop[2]"}) || fract(xR) > 0.0) {\n        return ${i}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${e?"outBackprop[2]":"outBackprop[3]"}) || fract(xC) > 0.0) {\n        return ${i}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${s} % inChannels;\n      ${e?"\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      ":"\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      "}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${n}];`,l=e?`\n      let col = colIn * ${n};\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ${u}\n      }\n      return ${i}(0.0);`:`\n      let col = colIn * ${n};\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ${u}\n      }\n      return ${i}(0.0);`,h=`\n      let col = colIn * ${n};\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (${e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${(e=>{switch(e){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return"\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            ";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(n)}\n      }\n      return ${i}(0.0);\n      `,{activationFunction:c,applyActivation:d}=ig(r,i);return`\n      ${c}\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${i} {\n    ${e?l:h}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${i} {\n    ${e?h:l}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${i}) {\n    let col = colIn * ${n};\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${o}\n      ${sg(t)}\n      ${d}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${n}] = value;\n    }\n  }`},$g=(e,t,r,n,i,o,a,s)=>{let u="NHWC"===t.format,l=u?e[0].dims[3]:e[0].dims[1],h=r[0],c=u?r[2]:r[3],d=u?r[1]:r[2],f=u?r[3]:r[1],p=u?l%4==0&&f%4==0:c%4==0&&f%4==0,y=u?f:c*d,g=u?c*d:f,m=p?[8,8,1]:[y<=4||g<=4?4:16,y>4&&g<=4?4:16,1],w=p?[4,4,1]:[y<=4?1:4,y>4&&g<=4?1:4,1],b=[Math.ceil(y/m[0]/w[0]),Math.ceil(g/m[1]/w[1]),Math.ceil(h/m[2]/w[2])];tf("verbose",(()=>`[conv_backprop_mm_webgpu] dispatch = ${b}`));let v=p?4:1,x=Math.max(m[0]*v,m[1]),_=p?4:1,I=[{type:"int32",data:n},{type:"int32",data:i},{type:"int32",data:o}],A=Of("x",e[0].dataType,e[0].dims.length,_),S=Of("w",e[1].dataType,e[1].dims.length,1),T=kf("result",e[0].dataType,r.length,_),C=[A,S];I.push(..._f(e[0].dims)),I.push(..._f(e[1].dims));let E="";if(a){let t=Of("bias",e[2].dataType,e[2].dims.length,_);C.push(t),I.push(..._f(e[2].dims)),E+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${p?"vec4<f32>":"f32"} {\n          return bias[coords.${u?"w":"y"}${p?"/ 4":""}];\n        }`}return I.push(..._f(r)),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:I}),getShaderSource:r=>`\n        ${ug("uniforms.result_strides")}\n        ${r.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...C,T)};\n        const outBackprop : vec4<i32> = vec4<i32>(${e[0].dims.join(",")});\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[u?1:2]}, ${t.kernelShape[u?2:3]});\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ${t.dilations[0]<=1?0:(t.kernelShape[u?1:2]-1)*(t.dilations[0]-1)},\n              ${t.dilations[1]<=1?0:(t.kernelShape[u?2:3]-1)*(t.dilations[1]-1)});\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${t.pads[0]+t.pads[2]})/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (${t.pads[1]+t.pads[3]})/2);\n        const strides : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        const dimAOuter : i32 = ${n};\n        const dimBOuter : i32 = ${i};\n        const dimInner : i32 = ${o};\n        ${E}\n        ${Pg(u,a,t,v)}\n        ${p?cg(w,m,"f32",void 0,!u,x):pg(w,m,"f32",void 0,!u,x,!1,void 0,s)}`}}})),Kb=Nc((()=>{xb(),Tb(),Cb(),Rg=(e,t,r,n,i,o,a=!1,s)=>{let u="NHWC"===r.format,l=u?1:2,h=u?2:3,c=u?3:1,d=pf.size(n),f=a?2:1,p=r.group,y=t[1].dims,g=y[0]/p,m=y[1],w=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${a?`vec4<${s}>`:s}) {\n    result[flatIndex] = ${a?`vec4<${s}>`:s}(value);\n  }`;i&&(w+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${a?`vec4<${s}>`:s} {\n      return bias[coords.${u?"w":"y"}${a?"/ 4":""}];\n    }`);let b=a?4:1,v=Of("W",t[1].dataType,t[1].dims,b),x=Of("Dy",t[0].dataType,t[0].dims,b),_=[x,v];i&&_.push(Of("bias",t[2].dataType,[n[c]],b));let I=kf("result",t[0].dataType,n,b),A=`{\n        let batch: u32 = ${o?"global_id.z":"workgroup_id.z"} / outShape[1];\n        let r = ${o?"global_id.z":"workgroup_id.z"} % outShape[1];\n        let c = ${o?"global_id.y":"workgroup_id.y"} * ${f};\n        let d1: u32 = ${o?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${s}>, ${f}>;\n        for (var i = 0; i < ${f}; i++) {\n          dotProd[i] = vec4<${s}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (${s}(dyCorner.x) + ${s}(wR)) / ${s}(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${s}(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (${s}(dyCorner.y) + ${s}(wC)) / ${s}(strides.y);\n            let dyC2 = (${s}(dyCorner.y) + 1.0 + ${s}(wC)) / ${s}(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${s}(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${s}(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${x.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${s}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${x.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${s}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[${c}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${x.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${s}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${v.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${x.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${s}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${f}; i = i + 1) {\n          let value = dotProd[i] + ${i?"bias[c+i]":`vec4<${s}>(0.0)`};\n          ${I.set("batch","r","c + i","d1","value")};\n        }\n      }`,S=`\n          let outputIndices = ${I.offsetToIndices("global_idx")};\n          let batch = ${I.indicesGet("outputIndices",0)};\n          let d1 = ${I.indicesGet("outputIndices",c)};\n          let r = ${I.indicesGet("outputIndices",l)};\n          let c = ${I.indicesGet("outputIndices",h)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ${m};\n          let wOutChannel = d1 - groupId * ${m};\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${s}(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${s}(dyRCorner) + ${s}(wR)) / ${s}(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ${s}(outBackprop[${l}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${s}(dyCCorner) + ${s}(wC)) / ${s}(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ${s}(outBackprop[${h}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ${g};\n              for (var d2: u32 = 0; d2 < ${g}; d2 = d2 + 1) {\n                let xValue = ${u?x.get("batch","idyR","idyC","inputChannel"):x.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${v.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${i?"bias[d1]":`${s}(0.0)`};\n          ${I.setByOffset("global_idx","value")};\n        `;return`\n  ${e.declareVariables(..._,I)}\n  ${w}\n  const outShape : vec4<u32> = vec4<u32>(${n.join(",")});\n  const outBackprop : vec4<u32> = vec4<u32>(${t[0].dims.join(",")});\n  const strides : vec2<u32> = vec2<u32>(${r.strides[0]}, ${r.strides[1]});\n  const filterDims : vec2<u32> = vec2<u32>(${r.kernelShape[u?1:2]}, ${r.kernelShape[u?2:3]});\n  const dilations : vec2<u32> = vec2<u32>(${r.dilations[0]}, ${r.dilations[1]});\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ${r.dilations[0]<=1?0:(r.kernelShape[u?1:2]-1)*(r.dilations[0]-1)},\n          ${r.dilations[1]<=1?0:(r.kernelShape[u?2:3]-1)*(r.dilations[1]-1)});\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${r.pads[0]+r.pads[2]})/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (${r.pads[1]+r.pads[3]})/2);\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(d)};\n  ${a?A:S}}`},Bg=(e,t,r)=>{let n=e.length>2,i=t.outputShape,o=pf.size(i),a=[Math.ceil(o/64),1,1];tf("verbose",(()=>`[conv2d_backprop_webgpu] dispatch = ${a}`));let s=vf(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:()=>({dispatchGroup:{x:a[0],y:a[1],z:a[2]},outputs:[{dims:r?r(i):i,dataType:e[0].dataType}]}),getShaderSource:r=>Rg(r,e,t,i,n,1===a[1]&&1===a[2],!1,s)}}})),Xb=Nc((()=>{Sb(),Yb(),Kb(),Nb(),Eb(),Dg=(e,t,r,n,i,o)=>(e-1)*t+r+(n-1)*i+1-o,Mg=(e,t,r,n,i)=>{let o=Math.floor(e/2);"SAME_UPPER"===t?(r[n]=o,r[i]=e-o):"SAME_LOWER"===t&&(r[n]=e-o,r[i]=o)},Lg=(e,t,r,n,i,o,a,s,u,l)=>{let h=e.length-2,c=0===l.length;if(0===u.length)for(let e=0;e<h;++e)u.push(0);let d=e[0],f=t[s?3:1]*i;for(let i=0,d=e.length-h-(s?1:0);i<h;++i,++d){let s=e[d],f=c?s*a[i]:l[i],p=Dg(s,a[i],o[i],t[d],r[i],f);Mg(p,n,o,i,i+h),c&&l.push(a[i]*(s-1)+u[i]+(t[d]-1)*r[i]+1-o[i]-o[i+h])}l.splice(0,0,d),l.splice(s?3:1,0,f)},Fg=(e,t)=>{let r=e.kernelShape.slice();if(0===e.kernelShape.length||0===e.kernelShape.reduce(((e,t)=>e*t),1)){r.length=0;for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e])}let n="NHWC"===e.format;r.splice(0,0,t[1].dims[0]),r.splice(n?3:1,0,t[1].dims[1]);let i=e.pads.slice(),o=e.outputShape.slice(),a=e.outputPadding.slice(),s=t[0].dims,u=e.dilations.slice();if(0===u.reduce(((e,t)=>e+t),0)){let e=t[0].dims.length-2;u=new Array(e).fill(1)}let l=e.strides.slice();if(0===l.reduce(((e,t)=>e+t),0)){let e=t[0].dims.length-2;l=new Array(e).fill(1)}Lg(s,r,u,e.autoPad,e.group,i,l,n,a,o);let h=Object.assign({},e),c=e.cacheKey+[r.join("n,"),i.join(","),l.join(","),a.join(","),o.join(","),u.join(",")].join("_");return Object.assign(h,{kernelShape:r,pads:i,outputPadding:a,outputShape:o,dilations:u,strides:l,cacheKey:c}),h},Ng=e=>{let t=og(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],i=e.dilations,o=e.group,a=e.kernelShape,s=e.pads,u=e.strides,l=e.wIsConst(),h=e.outputPadding,c=e.outputShape;return cf({autoPad:n,format:r,dilations:i,group:o,kernelShape:a,outputPadding:h,outputShape:c,pads:s,strides:u,wIsConst:l,...t})},Ug=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let r=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==r))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.reduce(((e,t)=>e+t),0)>0&&t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.reduce(((e,t)=>e+t),0)>0&&t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.reduce(((e,t)=>e+t),0)>0&&t.pads.length!==2*n)throw new Error(`pads should be ${2*n}D`);if(t.outputPadding.length!==n&&0!==t.outputPadding.length)throw new Error(`output_padding should be ${n}D`);if(t.kernelShape.reduce(((e,t)=>e+t),0)>0&&0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},jg=[2,3,1,0],Gg=(e,t,r)=>{let n=Fg(r,t),i="NHWC"===r.format,o=n.outputShape,a=o[i?3:1],s=t[0].dims[i?3:1];if(1!==n.group||1===a&&1===s)return void e.compute(Bg(t,n));let u=o[i?1:2],l=o[i?2:3],h=i?u*l:a,c=i?a:u*l,d=t[1].dims[2]*t[1].dims[3]*s,f=e.kernelCustomData.wT??e.compute(Uf(t[1],jg),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=f);let p=[t[0],f],y=3===t.length;y&&(i||1!==t[2].dims.length?p.push(t[2]):p.push(t[2].reshape([t[2].dims[0],1,1]))),e.compute($g(p,n,o,h,c,d,y,!0),{inputs:p})},zg=(e,t)=>{let r="NHWC"===t.format,n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===n.length&&n.push(e.inputs[2]);let i=t.kernelShape;(0===i.length||0===i[0])&&(i=[e.inputs[1].dims[2]]);let o=t.dilations;(0===o.length||0===o[0])&&(o=[1]);let a=t.strides;(0===a.length||0===a[0])&&(a=[1]);let s=t.pads;0===s.length&&(s=[0,0]),s=[0,s[0],0,s[1]],a=[1].concat(a),o=[1].concat(o),i=[1].concat(i);let u=Fg({...t,pads:s,strides:a,dilations:o,kernelShape:i},n);e.compute(Bg(n,u,(e=>r?[e[0],e[2],e[3]]:[e[0],e[1],e[3]])))},Vg=(e,t)=>{Ug(e.inputs,t),3===e.inputs[0].dims.length?zg(e,t):Gg(e,e.inputs,t)}})),Zb=Nc((()=>{bb(),Tb(),Sb(),Cb(),Hg=(e,t,r,n)=>{let i=pf.size(t),o=t.length,a=Of("input",e,o),s=kf("output",e,o),u=6===r.dataType?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),l=pf.normalizeAxis(u,o);return{name:"CumSum",shaderCache:{hint:n.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i},{type:"int32",data:l},..._f(t),..._f(t)]}),getShaderSource:e=>{let t=` i32(${a.indicesGet("inputIndices","uniforms.axis")}) `,r=Cf("uniforms.input_shape","uniforms.axis",o),i=n.reverse?t+(n.exclusive?" + 1":""):"0",u=n.reverse?r:t+(n.exclusive?"":" + 1");return`\n                ${e.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,s)}\n                ${e.mainStart()}\n                  ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${s.offsetToIndices("global_idx")};\n                  var sum = ${s.type.value}(0);\n                  let first : i32 = ${i};\n                  let last : i32 = ${u};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${a.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${a.getByIndices("inputIndices")};\n                  }\n                  ${s.setByOffset("global_idx","sum")};\n                }`}}},Wg=(e,t)=>{let r=e.inputs[0].dims,n=e.inputs[0].dataType,i=e.inputs[1];e.compute(Hg(n,r,i,t),{inputs:[0]})},Yg=e=>{let t=1===e.exclusive,r=1===e.reverse;return cf({exclusive:t,reverse:r})}})),qb=Nc((()=>{Tb(),Sb(),Cb(),Zg="^"+(Xg="("+(Kg="[a-zA-Z]|\\.\\.\\.")+")+")+"$",qg="^"+("("+Xg+",)*"+Xg)+"$",Jg=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let r=this.symbolToIndices.get(e);void 0===r?r=[t]:r.push(t),this.symbolToIndices.set(e,r)}},Qg=class{constructor(e,t){this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[r,n]=t.includes("->")?t.split("->",2):[t,""];if(!r.match(RegExp(qg)))throw new Error("Invalid LHS term");if(r.split(",").forEach(((t,r)=>{let n=e[r].dims.slice();if(!t.match(RegExp(Zg)))throw new Error("Invalid LHS term");let i=this.processTerm(t,!0,n,r);this.lhs.push(i)})),""===n)n+=[...this.symbolToInfo.entries()].filter((([e,t])=>1===t.count||"..."===e)).map((([e])=>e)).join("");else if(!n.match(RegExp(Xg)))throw new Error("Invalid RHS");n.match(RegExp(Kg,"g"))?.forEach((e=>{if("..."===e)this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let t=this.symbolToInfo.get(e);if(void 0===t)throw new Error("Invalid RHS symbol");this.outputDims.push(t.dimValue)}})),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(e,t,r){let n=this.symbolToInfo.get(e);if(void 0!==n){if(n.dimValue!==t&&1!==n.count)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(r)}else n={count:1,dimValue:t,inputIndices:[r]};this.symbolToInfo.set(e,n)}processTerm(e,t,r,n=-1){let i=r.length,o=!1,a=[],s=0;if(!e.match(RegExp(Zg))&&!t&&""!==e)throw new Error("Invalid LHS term");let u=e.match(RegExp(Kg,"g")),l=new Jg(n);return u?.forEach(((e,h)=>{if("..."===e){if(o)throw new Error("Only one ellipsis is allowed per input term");o=!0;let e=i-u.length+1;if(e<0)throw new Error("Ellipsis out of bounds");if(a=r.slice(s,s+e),this.hasEllipsis){if(this.ellipsisDims.length!==a.length||this.ellipsisDims.toString()!==a.toString())throw new Error("Ellipsis dimensions mismatch")}else{if(!t)throw new Error("Ellipsis must be specified in the LHS");this.hasEllipsis=!0,this.ellipsisDims=a}for(let e=0;e<a.length;e++){let t=String.fromCharCode("0".charCodeAt(0)+e);l.addSymbol(t,h+e),this.addSymbol(t,r[s++],n)}}else l.addSymbol(e,h+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(e,r[s++],n)})),l}},em=e=>e+"_max",tm=(e,t,r,n,i)=>{let o=t.map(((t,r)=>e[r]?t.length:t)).map(((e,t)=>Of(`input${t}`,r,e))),a=pf.size(i),s=Df(i.length),u=s?i.length:i,l=kf("output",r,u),h=[...n.symbolToInfo.keys()].filter((e=>!n.rhs.symbolToIndices.has(e)));return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:e.map((e=>e?"rank":"dims"))},getRunData:()=>{let o=h.filter((e=>n.symbolToInfo.has(e))).map((e=>({type:"uint32",data:n.symbolToInfo.get(e)?.dimValue||0})));o.push({type:"uint32",data:a});let u=t.filter(((t,r)=>e[r])).map(((e,t)=>[..._f(e)])).reduce(((e,t)=>e.concat(t)),o);return s&&u.push(..._f(i)),{outputs:[{dims:i,dataType:r}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}},getShaderSource:e=>{let t=[],r=[],i=[],a=[],s=[],u=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach(((e,u)=>{if(n.rhs.symbolToIndices.has(u)){let r=n.rhs.symbolToIndices.get(u)?.[0];void 0!==r&&n.lhs.forEach(((n,i)=>{if(e.inputIndices.includes(i)){let e=n.symbolToIndices.get(u);if(void 0===e)throw new Error("Invalid symbol error");e.forEach((e=>{t.push(`${o[i].indicesSet(`input${i}Indices`,e,l.indicesGet("outputIndices",r))}`)}))}}))}else n.lhs.forEach(((t,n)=>{if(e.inputIndices.includes(n)){let e=t.symbolToIndices.get(u);if(void 0===e)throw new Error("Invalid symbol error");e.forEach((e=>{r.push(`${o[n].indicesSet(`input${n}Indices`,e,`${u}`)}`)})),s.push(`prod *= ${o[n].getByIndices(`input${n}Indices`)};`)}})),i.push(`for(var ${u}: u32 = 0; ${u} < uniforms.${em(u)}; ${u}++) {`),a.push("}")}));let c=u?[...t,`let sum = ${o.map(((e,t)=>e.getByIndices(`input${t}Indices`))).join(" * ")};`]:[...t,"var sum = 0.0;",...i,...r,"var prod = 1.0;",...s,"sum += prod;",...a];return`\n            ${e.registerUniforms(h.map((e=>({name:`${em(e)}`,type:"u32"})))).registerUniform("outputSize","u32").declareVariables(...o,l)}\n\n            ${e.mainStart()}\n            ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${l.offsetToIndices("global_idx")};\n            ${o.map(((e,t)=>`var input${t}Indices: ${o[t].type.indices};`)).join("\n")}\n            ${c.join("\n")};\n            ${l.setByOffset("global_idx","sum")};\n          }`}}},rm=(e,t)=>{let r=new Qg(e.inputs,t.equation),n=e.inputs.map(((e,t)=>Df(e.dims.length))),i=r.outputDims,o=e.inputs.map(((e,t)=>e.dims));e.compute(tm(n,o,e.inputs[0].dataType,r,i))},nm=e=>{let t=e.equation.replace(/\s+/g,"");return cf({equation:t})}})),Jb=Nc((()=>{bb(),Tb(),Cb(),im=e=>{if(!e||2!==e.length)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=r.length<t.length?0:r.length-t.length,i=t.length<r.length?0:t.length-r.length;for(;n<r.length&&i<t.length;++n,++i)if(r[n]!==t[i]&&1!==r[n]&&1!==t[i])throw new Error("Expand requires shape to be broadcastable to input")},om=(e,t)=>{let r=e.length-t.length,n=[];for(let t=0;t<r;++t)n.push(e[t]);for(let i=0;i<t.length;++i)n.push(1===t[i]?e[i+r]:t[i]);return n},am=(e,t)=>e.length>t.length?om(e,t):om(t,e),sm=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=am(t,r),i=e[0].dataType,o=9===i?4:1,a=Math.ceil(pf.size(n)/o),s=Df(t.length),u=Df(n.length),l=[{type:"uint32",data:a}];return s&&l.push(..._f(t)),u&&l.push(..._f(n)),{name:"Expand",shaderCache:{hint:`${n.length}`,inputDependencies:[s?"rank":"dims"]},getShaderSource:e=>{let r,a=s?t.length:t,l=u?n.length:n,h=Of("input",i,a,o),c=kf("output",i,l,o);if(9===i){let e=(e,t,r="")=>`\n          let outputIndices${t} = ${c.offsetToIndices(`outputOffset + ${t}u`)};\n          let offset${t} = ${h.broadcastedIndicesToOffset(`outputIndices${t}`,c)};\n          let index${t} = offset${t} / 4u;\n          let component${t} = offset${t} % 4u;\n          ${e}[${t}] = ${r}(${h.getByOffset(`index${t}`)}[component${t}]);\n        `;r=`\n        let outputOffset = global_idx * ${o};\n        var data = vec4<u32>(0);\n        ${e("data",0,"u32")}\n        ${e("data",1,"u32")}\n        ${e("data",2,"u32")}\n        ${e("data",3,"u32")}\n        ${c.setByOffset("global_idx","data")}\n      }`}else r=`\n        let outputIndices = ${c.offsetToIndices("global_idx")};\n        let inputOffset = ${h.broadcastedIndicesToOffset("outputIndices",c)};\n        ${c.setByOffset("global_idx",h.getByOffset("inputOffset"))}\n      }`;return`\n    ${e.registerUniform("vec_size","u32").declareVariables(h,c)}\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${r}`},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:l})}},um=e=>{im(e.inputs),e.compute(sm(e.inputs),{inputs:[0]})}})),Qb=Nc((()=>{bb(),Tb(),Sb(),Cb(),lm=e=>{if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.")},hm=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r.length,o=pf.normalizeAxis(t.axis,i),a=r.slice(0);a.splice(o,1,...n);let s=r[o],u=9===e[0].dataType?4:1,l=Math.ceil(pf.size(a)/u),h=Df(e[0].dims.length),c=h?e[0].dims.length:e[0].dims,d=Df(e[1].dims.length),f=d?e[1].dims.length:e[1].dims,p=Df(a.length),y=p?a.length:a,g=[{type:"uint32",data:l},{type:"int32",data:s},{type:"uint32",data:o}];h&&g.push(..._f(e[0].dims)),d&&g.push(..._f(e[1].dims)),p&&g.push(..._f(a));let m=[];m.push(h?"rank":"dims"),m.push(d?"rank":"dims");return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:m},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:g}),getShaderSource:t=>{let r,s=Of("data",e[0].dataType,c,u),l=Of("inputIndices",e[1].dataType,f),h=kf("output",e[0].dataType,y,u),d=e=>{let t=n.length,r=`var indicesIndices${e}  = ${l.type.indices}(0);`;for(let n=0;n<t;n++)r+=`${t>1?`indicesIndices${e}[${n}]`:`indicesIndices${e}`} = ${a.length>1?`outputIndices${e}[uniforms.axis + ${n}]`:`outputIndices${e}`};`;r+=`\n          var idx${e} = ${l.getByIndices(`indicesIndices${e}`)};\n          if (idx${e} < 0) {\n            idx${e} = idx${e} + uniforms.axisDimLimit;\n          }\n          var dataIndices${e} = ${s.type.indices}(0);\n        `;for(let n=0,s=0;n<i;n++)n===o?(r+=`${i>1?`dataIndices${e}[${n}]`:`dataIndices${e}`} = u32(idx${e});`,s+=t):(r+=`${i>1?`dataIndices${e}[${n}]`:`dataIndices${e}`} = ${a.length>1?`outputIndices${e}[${s}]`:`outputIndices${e}`};`,s++);return r};if(9===e[0].dataType){let e=(e,t,r="")=>`\n          let outputIndices${t} = ${h.offsetToIndices(`outputOffset + ${t}u`)};\n          ${d(t)};\n          let offset${t} = ${s.indicesToOffset(`dataIndices${t}`)};\n          let index${t} = offset${t} / 4u;\n          let component${t} = offset${t} % 4u;\n          ${e}[${t}] = ${r}(${s.getByOffset(`index${t}`)}[component${t}]);\n        `;r=`\n        let outputOffset = global_idx * ${u};\n        var value = vec4<u32>(0);\n        ${e("value",0,"u32")}\n        ${e("value",1,"u32")}\n        ${e("value",2,"u32")}\n        ${e("value",3,"u32")}\n        ${h.setByOffset("global_idx","value")}\n      `}else r=`\n      let outputIndices = ${h.offsetToIndices("global_idx")};\n      ${d("")};\n      let value = ${s.getByIndices("dataIndices")};\n      ${h.setByOffset("global_idx","value")};\n      `;return`\n      ${t.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(s,l,h)}\n      ${t.mainStart()}\n        ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${r}\n      }`}}},cm=e=>cf({axis:e.axis}),dm=(e,t)=>{let r=e.inputs;lm(r),e.compute(hm(e.inputs,t))}})),ev=Nc((()=>{Tb(),Sb(),Cb(),fm=e=>{if(!e||2!==e.length)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error("GatherElements requires that the data input and\n                     indices input tensors be of same rank.")},pm=(e,t)=>{let r=e[0].dims,n=e[0].dataType,i=r.length,o=e[1].dims,a=e[1].dataType,s=pf.normalizeAxis(t.axis,i),u=r[s],l=o.slice(0),h=pf.size(l),c=Of("input",n,i),d=Of("indicesInput",a,o.length),f=kf("output",n,l.length),p=[{type:"uint32",data:h},{type:"int32",data:u},{type:"uint32",data:s}];return p.push(..._f(r)),p.push(..._f(o)),p.push(..._f(l)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:p}),getShaderSource:e=>`\n      ${e.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(c,d,f)}\n      ${e.mainStart()}\n      ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${f.offsetToIndices("global_idx")};\n\n      var idx = ${d.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${c.type.indices}(outputIndices);\n      ${c.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${c.getByIndices("inputIndices")};\n\n      ${f.setByOffset("global_idx","value")};\n  }`}},ym=e=>cf({axis:e.axis}),gm=(e,t)=>{let r=e.inputs;fm(r),e.compute(pm(e.inputs,t))}})),tv=Nc((()=>{Tb(),Cb(),mm=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(3===e.length&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||3===e.length&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},wm=(e,t)=>{let r=e[0].dims.slice(),n=e[1].dims.slice(),[i,o,a]=gf.getShapeOfGemmResult(r,t.transA,n,t.transB,3===e.length?e[2].dims:void 0),s=[i,o];if(!s)throw new Error("Can't use gemm on the given tensors");let u=pf.size(s),l=[{type:"uint32",data:u},{type:"uint32",data:i},{type:"uint32",data:o},{type:"uint32",data:a},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],h=["type","type"];3===e.length&&(l.push(..._f(e[2].dims)),h.push("rank")),l.push(..._f(s));return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l}),getShaderSource:r=>{let n="";t.transA&&t.transB?n="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?n="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?n="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(n="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let i=1===t.alpha?"":"value *= uniforms.alpha;",o=Of("a",e[0].dataType,e[0].dims),a=Of("b",e[1].dataType,e[1].dims),u=o.type.value,l=null,h=[o,a];3===e.length&&(l=Of("c",e[2].dataType,e[2].dims.length),h.push(l));let c=kf("output",e[0].dataType,s.length);h.push(c);return`\n  ${r.registerUniforms([{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}]).declareVariables(...h)}\n\n  ${r.mainStart()}\n    ${r.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${u}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${n}\n    }\n\n    ${i}\n    ${null!=l?`let cOffset = ${l.broadcastedIndicesToOffset("vec2(m, n)",c)}; value += ${u}(uniforms.beta) * ${l.getByOffset("cOffset")};`:""}\n    output[global_idx] = value;\n  }`}}},bm=e=>({transA:e.transA,transB:e.transB,alpha:e.alpha,beta:e.beta,cacheKey:`${e.transA};${e.transB};${1===e.alpha}`}),vm=(e,t)=>{mm(e.inputs),e.compute(wm(e.inputs,t))}})),rv=Nc((()=>{bb(),Tb(),Cb(),xm=(e,t)=>{let r=e[0].dims,n=r,i=pf.sizeToDimension(r,2),o=pf.sizeFromDimension(r,2),a=If(o),s=o/a,u=[r[0],r[1],s],l=[{type:"uint32",data:o},{type:"uint32",data:s}];l.push(..._f(u),..._f(u));return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${a}`,inputDependencies:["rank","type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:i},programUniforms:l}),getShaderSource:r=>{let n=Of("x",e[0].dataType,u.length,a),i=Of("scale",e[1].dataType,e[1].dims),o=Of("bias",e[2].dataType,e[2].dims),s=kf("output",e[0].dataType,u.length,a),l=[n,i,o,s],h=n.type.value,c=1===a?"f32":`vec${a}<f32>`;return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${c}, 64>;\n  const workgroupSize = 64u;\n  ${r.registerUniforms([{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}]).declareVariables(...l)}\n  ${r.mainStart(64)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${c}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${c}(${n.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${Tf("workgroupShared[0]",a)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${c}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${c}(${n.get("batch","channel","h")}) - ${c}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${Tf("workgroupShared[0]",a)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${i.getByOffset("channel")});\n    let channelShift = f32(${o.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${n.get("batch","channel","h")} * ${h}(${c}(channelScale)) + ${h}(${c}(channelShift));\n      ${s.set("batch","channel","h","value")};\n    }\n  }`}}},_m=(e,t,r,n,i,o,a,s)=>{let u=If(a),l=64,h=1===u?"vec2f":`mat2x${u}f`,c=1===u?"f32":`vec${u}f`,d=(e,t)=>`${h}(${e}, ${t})`,f=i*a/u,p=[{type:"uint32",data:Math.ceil(o/l)},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(o*a/u)}],y=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${u}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:[i,a,l,2],dataType:1}],dispatchGroup:{x:i*a/u},programUniforms:p}),getShaderSource:e=>{let r=Of("input",t.dataType,t.dims,u);return`\n  ${e.declareVariables(r)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${e.mainStart(l)}\n    let currentImageNumber = global_idx / 64 / uniforms.C;\n    let currentChannelNumber = (global_idx / 64) % uniforms.C;\n    let wgId = global_idx % 64;\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${Af("f32",u)};\n    var squaredSum = ${Af("f32",u)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${c}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${d("sum","squaredSum")};\n  }`}},{inputs:[t],outputs:[-1]})[0],g=[{type:"uint32",data:f},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(l*a/u)}];return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${u};${s}`,inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:[i,a,2],dataType:1}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:g}),getShaderSource:e=>{let t=Of("scale",r.dataType,r.dims,u),i=Of("bias",n.dataType,n.dims,u);return`\n  @group(0) @binding(0) var<storage, read> input : array<${h}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${t.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${i.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${Af("f32",u)};\n    var squaredSum = ${Af("f32",u)};\n    for (var i: u32 = 0; i < 64; i++) {\n        let value = input[offset + i + currentChannelNumber * 64];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${s}));\n    let channelScale = invStdDev * ${c}(scale[currentChannelNumber]);\n    let channelShift = ${c}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${d("channelScale","channelShift")};\n  }`}},{inputs:[y,r,n],outputs:[-1]})[0]},Im=(e,t,r)=>{let n=t[0].dims,i=n,o=n[0],a=n[n.length-1],s=pf.sizeFromDimension(n,1)/a,u=If(a),l=pf.size(i)/u,h=[{type:"uint32",data:s},{type:"uint32",data:Math.floor(a/u)}],c=_m(e,t[0],t[1],t[2],o,s,a,r.epsilon);e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${u}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:h}),getShaderSource:e=>{let r=vf(t[0].dataType),n=1===u?"vec2f":`mat2x${u}f`,o=1===u?r:`vec${u}<${r}>`,a=Of("input",t[0].dataType,t[0].dims,u),s=kf("output",t[0].dataType,i,u);return`\n  @group(0) @binding(0) var<storage, read> input : array<${a.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${n}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${s.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${e.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${o}(scale[0]), ${o}(scale[1]));\n  }`}},{inputs:[t[0],c]})},Am=(e,t)=>{"NHWC"===t.format?Im(e,e.inputs,t):e.compute(xm(e.inputs,t))}})),nv=Nc((()=>{bb(),Tb(),Cb(),Sm=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},Tm=(e,t,r)=>{let n=e[0].dims,i=e[1],o=e[2],a=n,s=pf.normalizeAxis(t.axis,n.length),u=pf.sizeToDimension(n,s),l=pf.sizeFromDimension(n,s),h=pf.size(i.dims),c=o?pf.size(o.dims):0;if(h!==l||o&&c!==l)throw new Error(`Size of X.shape()[axis:] == ${l}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${h} and bias size of ${c}`);let d=[];for(let e=0;e<n.length;++e)e<s?d.push(n[e]):d.push(1);let f=If(l),p=["type","type"],y=[{type:"uint32",data:u},{type:"float32",data:l},{type:"uint32",data:Math.floor(l/f)},{type:"float32",data:t.epsilon}];o&&p.push("type");let g=r>1,m=r>2,w=[{dims:a,dataType:e[0].dataType}];return g&&w.push({dims:d,dataType:1}),m&&w.push({dims:d,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${f};${r}`,inputDependencies:p},getRunData:()=>({outputs:w,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:y}),getShaderSource:t=>{let r=vf(e[0].dataType),n=[Of("x",e[0].dataType,e[0].dims,f),Of("scale",i.dataType,i.dims,f)];o&&n.push(Of("bias",o.dataType,o.dims,f)),n.push(kf("output",e[0].dataType,a,f)),g&&n.push(kf("mean_data_output",1,d)),m&&n.push(kf("inv_std_output",1,d));return`\n  ${t.registerUniforms([{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}]).declareVariables(...n)}\n  ${t.mainStart()}\n    ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ${Af("f32",f)};\n    var meanSquareVector = ${Af("f32",f)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${Sf(r,f,"x[h + offset]")};\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ${Tf("meanVector",f)} / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(${Tf("meanSquareVector",f)} / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${Sf(r,f,"x[j + offset]")};\n      let f32scale = ${Sf(r,f,"scale[j]")};\n      output[j + offset] = ${n[0].type.value}((f32input - mean) * invStdDev * f32scale\n        ${o?`+ ${Sf(r,f,"bias[j]")}`:""}\n      );\n    }\n\n    ${g?"mean_data_output[global_idx] = mean":""};\n    ${m?"inv_std_output[global_idx] = invStdDev":""};\n  }`}}},Cm=(e,t)=>{Sm(e.inputs),e.compute(Tm(e.inputs,t,e.outputCount))}})),iv=Nc((()=>{Tb(),Sb(),Ib(),$b(),Cb(),Eb(),Em=(e,t)=>{let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];if(3!==r.dims.length&&5!==r.dims.length)throw new Error("Input query is expected to have 3 or 5 dimensions");let h,c=r.dims[0],d=r.dims[1],f=3===r.dims.length?r.dims[2]:t.numHeads*r.dims[4],p=d,y=0,g=0,m=Math.floor(f/t.numHeads);if(u&&l){if(4!==u.dims.length)throw new Error('Input "past_key" is expected to have 4 dimensions');if(4!==l.dims.length)throw new Error('Input "past_value" is expected to have 4 dimensions');y=u.dims[2],g=u.dims[2]}else if(u||l)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');if(n){if(3!==r.dims.length)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===n.dims.length){if(n.dims[2]!==r.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');h=2,p=n.dims[1]}else if(5===n.dims.length){if(n.dims[2]!==t.numHeads||2!==n.dims[3]||n.dims[4]!==m)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');h=5,p=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==m)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');h=0,p=n.dims[2]}}else{if(3!==r.dims.length&&5!==r.dims.length)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(5===r.dims.length&&(r.dims[2]!==t.numHeads||3!==r.dims[3]))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');h=3}if(o){if(1!==o.dims.length)throw new Error('Input "bias" is expected to have 1 dimension');if(i&&5===r.dims.length&&2===r.dims[3])throw new Error("bias is not allowed for packed kv.")}let w=0;if(a){w=8;let e=a.dims;throw 1===e.length?e[0]===c?w=1:e[0]===3*c+2&&(w=3):2===e.length&&e[0]===c&&e[1]===p&&(w=5),8===w?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)'):new Error("Mask not supported")}let b=!1,v=f;if(i){if(3!==i.dims.length&&4!==i.dims.length)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===i.dims.length){if(p!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');v=i.dims[2]}else{if(p!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');v=i.dims[1]*i.dims[3],b=!0}}let x=y+p;if(a)throw new Error("Key padding mask is not supported");if(s)throw new Error("extraAddQk is not supported");if(u)throw new Error("pastKey is not supported");if(l)throw new Error("pastValue is not supported");return{batchSize:c,sequenceLength:d,pastSequenceLength:y,kvSequenceLength:p,totalSequenceLength:x,maxSequenceLength:g,inputHiddenSize:0,hiddenSize:f,vHiddenSize:v,headSize:m,vHeadSize:Math.floor(v/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:w,scale:t.scale,broadcastResPosBias:!1,passPastInKv:b,qkvFormat:h}},Om=e=>cf({...e}),km=cf({perm:[0,2,1,3]}),Pm=(e,t,r,n,i,o,a)=>{let s=[n,i,o],u=pf.size(s),l=[{type:"uint32",data:u},{type:"uint32",data:a},{type:"uint32",data:o}];return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l}),getShaderSource:e=>{let n=kf("qkv_with_bias",t.dataType,s),i=Of("qkv",t.dataType,s),o=Of("bias",r.dataType,s);return`\n  ${e.registerUniforms([{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}]).declareVariables(i,o,n)}\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`}},{inputs:[t,r],outputs:[-1]})[0]},$m=(e,t,r,n,i,o,a,s)=>{let u=o;if(a){if(1===n)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return u=Pm(e,o,a,t,n,r*i,s),u=u.reshape([t,n,r,i]),e.compute(Uf(u,km.perm),{inputs:[u],outputs:[-1]})[0]}return 3===o.dims.length&&(u=o.reshape([t,n,r,i])),e.compute(Uf(u,km.perm),{inputs:[u],outputs:[-1]})[0]},Rm=(e,t)=>{let r=Em(e.inputs,t);if(5===e.inputs[0].dims.length)throw new Error("Packed QKV is not implemented");if(5===e.inputs[1]?.dims.length)throw new Error("Packed KV is not implemented");let n=e.inputs[1]&&e.inputs[2]&&4===e.inputs[1].dims.length&&4===e.inputs[2].dims.length,i=$m(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(n)return Vp(e,i,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);let o=$m(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),a=$m(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);Vp(e,i,o,a,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t)}})),ov=Nc((()=>{bb(),Tb(),Cb(),Bm=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(1!==e[0].dataType)throw new Error("Input type must be float.");if(e.length>=2){let t=2*e[0].dims.length===e[1].dims[0];if(4===e.length&&(t=2*e[3].dims[0]===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},Dm=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n            k = i32(${e.indicesGet("indices",i)}) - ${Cf("uniforms.pads",i,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${Cf("uniforms.x_shape",i,t)})) {\n              break;\n            }\n            offset += k * i32(${Cf("uniforms.x_strides",i,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${n}\n            value = x[offset];\n          }\n      `},Mm=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${Cf("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${Cf("uniforms.x_shape",i,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${Cf("uniforms.x_shape",i,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${Cf("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${n}\n              value = x[offset];\n          `},Lm=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${Cf("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${Cf("uniforms.x_shape",i,t)})) {\n                  k = i32(${Cf("uniforms.x_shape",i,t)}) - 1;\n                }\n                offset += k * i32(${Cf("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${n}\n              value = x[offset];\n          `},Fm=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${Cf("uniforms.pads",i,r)};\n                if (k < 0)  {\n                  k += i32(${Cf("uniforms.x_shape",i,t)}]);\n                }\n                if (k >= i32(${Cf("uniforms.x_shape",i,t)})) {\n                  k -= i32(${Cf("uniforms.x_shape",i,t)});\n                }\n                offset += k * i32(${Cf("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${n}\n              value = x[offset];\n          `},Nm=(e,t,r)=>{switch(r.mode){case 0:return Dm(e,t,r.pads.length);case 1:return Mm(e,t,r.pads.length);case 2:return Lm(e,t,r.pads.length);case 3:return Fm(e,t,r.pads.length);default:throw new Error("Invalid mode")}},Um=(e,t)=>{let r=pf.padShape(e[0].dims.slice(),t.pads),n=e[0].dims,i=[{type:"uint32",data:pf.size(r)},{type:"uint32",data:t.pads}];if(0===t.mode){let r=Gd(e[0].dataType);i.push({type:r,data:t.value})}i.push(..._f(e[0].dims),..._f(r));return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(pf.size(r)/64)},programUniforms:i}),getShaderSource:i=>{let o=kf("output",e[0].dataType,r.length),a=Of("x",e[0].dataType,n.length),s=a.type.value,u=Nm(o,n.length,t),l=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return 0===t.mode&&l.push({name:"constant_value",type:s}),`\n            ${i.registerUniforms(l).declareVariables(a,o)}\n            ${i.mainStart()}\n            ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${o.offsetToIndices("global_idx")};\n\n            var value = ${s}(0);\n            ${u}\n            output[global_idx] = value;\n        }`}}},jm=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),n=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,i=e[0].dims.length,o=new Int32Array(2*i).fill(0);if(e.length>=4){let t=e[3].getBigInt64Array();for(let e=0;e<t.length;e++)o[Number(t[e])]=Number(r[e]),o[Number(t[e])+i]=Number(r[e+t.length])}else r.forEach(((e,t)=>o[Number(t)]=Number(e)));let a=[];return o.forEach((e=>a.push(e))),{mode:t.mode,value:n,pads:a}}return t},Gm=(e,t)=>{Bm(e.inputs);let r=jm(e.inputs,t);e.compute(Um(e.inputs,r),{inputs:[0]})}})),av=Nc((()=>{sd(),Tb(),Cb(),zm=e=>{if(oc.webgpu.validateInputContent&&(!e||1!==e.length))throw new Error("Pool ops requires 1 input.")},Vm=(e,t,r)=>{let n="NHWC"===t.format,i=e.dims.slice();n&&i.splice(1,0,i.pop());let o=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),s=t.strides.slice(),u=o?t.dilations.slice():[],l=t.pads.slice();yf.adjustPoolAttributes(r,i,a,s,u,l);let h=yf.computePoolOutputShape(r,i,s,u,a,l,t.autoPad),c=Object.assign({},t);o?Object.assign(c,{kernelShape:a,strides:s,pads:l,dilations:u,cacheKey:t.cacheKey}):Object.assign(c,{kernelShape:a,strides:s,pads:l,cacheKey:t.cacheKey});let d=h.slice();return d.push(d.splice(1,1)[0]),[c,n?d:h]},Hm=(e,t)=>{let r="NHWC"===t.format,n=[{type:"uint32",data:pf.size(e)},{type:"uint32",data:pf.size(t.kernelShape)}],i=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let e=t.kernelShape[t.kernelShape.length-1],r=t.strides[t.strides.length-1],o=t.pads[t.pads.length/2-1],a=t.pads[t.pads.length-1],s=!!(o+a);n.push({type:"uint32",data:e},{type:"uint32",data:r},{type:"uint32",data:o},{type:"uint32",data:a}),i.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let u=!1;if(2===t.kernelShape.length){let e=t.kernelShape[t.kernelShape.length-2],r=t.strides[t.strides.length-2],o=t.pads[t.pads.length/2-2],a=t.pads[t.pads.length-2];u=!!(o+a),n.push({type:"uint32",data:e},{type:"uint32",data:r},{type:"uint32",data:o},{type:"uint32",data:a}),i.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[n,i,!0,s,u]}{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let e=pf.computeStrides(t.kernelShape);n.push({type:"uint32",data:e},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),i.push({name:"kernelStrides",type:"u32",length:e.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let o=t.pads.reduce(((e,t)=>e+t));return[n,i,!!o,!1,!1]}},Wm=(e,t,r,n,i,o,a,s,u,l,h,c)=>{let d="NHWC"===i.format,f=t.type.value,p=kf("output",t.type.tensor,n);if(i.kernelShape.length<=2){let n="",l="",y="",g=r-(d?2:1);if(n=h?`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${g}] = indices[${g}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${g}] < 0 || xIndices[${g}]\n                      >= uniforms.x_shape[${g}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${o}\n                }`:`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${g}] = indices[${g}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${o}\n                }`,2===i.kernelShape.length){let e=r-(d?3:2);l=c?`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${e}] = indices[${e}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${e}] < 0 || xIndices[${e}] >= uniforms.x_shape[${e}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${e}] = indices[${e}] * uniforms.sh - uniforms.phStart + j;\n                `,y="\n              }\n            "}return`\n            ${e.registerUniforms(u).declareVariables(t,p)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${p.offsetToIndices("global_idx")};\n              var xIndices = ${p.offsetToIndices("global_idx")};\n\n              var value = ${f}(${s});\n              var pad = 0;\n              ${l}\n              ${n}\n              ${y}\n              ${a}\n\n              output[global_idx] = value;\n            }`}{if(d)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let n=i.kernelShape.length,h=i.pads.length,c="";return c=l?`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${o}\n              }`:`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${o}\n            `,`\n            ${e.registerUniforms(u).declareVariables(t,p)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${p.offsetToIndices("global_idx")};\n              var xIndices = ${p.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${n}>;\n\n              var value = ${f}(${s});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${n-1}u; j++) {\n                  offsets[j] = offset / ${Cf("uniforms.kernelStrides","j",n)};\n                  offset -= offsets[j] * ${Cf("uniforms.kernelStrides","j",n)};\n                }\n                offsets[${n-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-n}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${Cf("uniforms.strides",`j - ${r-n}u`,n)}\n                    + offsets[j - ${r-n}u] - ${Cf("uniforms.pads","j - 2u",h)};\n                  ${c}\n              }\n              ${a}\n\n              output[global_idx] = value;\n            }`}},Ym=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,Km=e=>`${Ym(e)};${e.countIncludePad}`,Xm=e=>`${Ym(e)};${e.storageOrder};${e.dilations}`,Zm=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),qm=(e,t,r,n)=>{let[i,o]=Vm(t,n,r),a=Of("x",t.dataType,t.dims.length),s=a.type.value,u="";i.countIncludePad?u+=`value /= ${s}(uniforms.kernelSize);`:u+=`value /= ${s}(i32(uniforms.kernelSize) - pad);`;let[l,h,c,d,f]=Hm(o,i);l.push(..._f(t.dims),..._f(o));return{name:e,shaderCache:{hint:`${n.cacheKey};${c};${d};${f}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(pf.size(o)/64)},programUniforms:l}),getShaderSource:e=>Wm(e,a,t.dims.length,o.length,i,"value += x_val;",u,0,h,c,d,f)}},Jm=e=>{let t=0!==e.count_include_pad,r=Zm(e);if(0!==r.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let n={countIncludePad:t,...r,cacheKey:""};return{...n,cacheKey:Km(n)}},Qm=(e,t)=>{zm(e.inputs),e.compute(qm("AveragePool",e.inputs[0],!1,t))},ew={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},tw=e=>{let t=e.format;return{format:t,...ew,cacheKey:t}},rw=(e,t)=>{zm(e.inputs),e.compute(qm("GlobalAveragePool",e.inputs[0],!0,t))},nw=(e,t,r,n)=>{let[i,o]=Vm(t,n,r),a=Of("x",t.dataType,t.dims.length),[s,u,l,h,c]=Hm(o,i);return s.push(..._f(t.dims),..._f(o)),{name:e,shaderCache:{hint:`${n.cacheKey};${l};${h};${c}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(pf.size(o)/64)},programUniforms:s}),getShaderSource:e=>Wm(e,a,t.dims.length,o.length,i,"\n      value = max(x_val, value);\n    ","",-1e5,u,l,h,c)}},iw=(e,t)=>{zm(e.inputs),e.compute(nw("MaxPool",e.inputs[0],!1,t))},ow=e=>{let t=e.storage_order,r=e.dilations,n=Zm(e);if(0!==t)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==n.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:t,dilations:r,...n,cacheKey:""};return{...i,cacheKey:Xm(i)}},aw=e=>{let t=e.format;return{format:t,...ew,cacheKey:t}},sw=(e,t)=>{zm(e.inputs),e.compute(nw("GlobalMaxPool",e.inputs[0],!0,t))}})),sv=Nc((()=>{sd(),bb(),Cb(),uw=(e,t,r)=>{if(e===t||e<t&&r<0||e>t&&r>0)throw new Error("Range these inputs' contents are invalid.")},lw=(e,t,r,n)=>{let i=Math.abs(Math.ceil((t-e)/r)),o=[i],a=i,s=Gd(n),u=[{type:"uint32",data:a},{type:s,data:e},{type:s,data:r},..._f(o)];return{name:"Range",shaderCache:{hint:`${n}`},getShaderSource:e=>{let t=kf("output",n,o.length),r=t.type.value,i=[{name:"outputSize",type:"u32"},{name:"start",type:r},{name:"delta",type:r}];return`\n        ${e.registerUniforms(i).declareVariables(t)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${r}(global_idx) * uniforms.delta;\n      }`},getRunData:()=>({outputs:[{dims:o,dataType:n}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u})}},hw=e=>{let t=0,r=0,n=0;6===e.inputs[0].dataType?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],n=e.inputs[2].getInt32Array()[0]):1===e.inputs[0].dataType&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],n=e.inputs[2].getFloat32Array()[0]),oc.webgpu.validateInputContent&&uw(t,r,n),e.compute(lw(t,r,n,e.inputs[0].dataType),{inputs:[]})}})),uv=Nc((()=>{Tb(),Sb(),Cb(),cw=(e,t)=>{if(e.every((e=>e>0||(()=>{throw new Error("Resize requires scales input values to be positive")}))),e.length>0)if("linear"===t.mode){if(!(2===e.length||3===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]||5===e.length&&1===e[0]&&1===e[1]))throw new Error("For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1")}else if("cubic"===t.mode&&!(2===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")},dw=(e,t,r)=>{t.every((e=>e>=0&&e<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")})));let n=new Array(r).fill(1);return t.forEach(((t,r)=>n[t]=e[r])),n},fw=(e,t,r,n,i,o)=>{let[a,s,u]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],l=e[0].dims.length;if(a>0&&e.length>a&&e[a].dims.length>0)e[a].getFloat32Array().forEach((e=>o.push(e)));else if("tf_crop_and_resize"===t.coordinateTransformMode)throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(s>0&&e.length>s&&e[s].dims.length>0){if(e[s].getFloat32Array().forEach((e=>n.push(e))),0!==n.length&&n.length!==l&&r>=18&&n.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");cw(n,t),t.axes.length>0&&dw(n,t.axes,l).forEach(((e,t)=>n[t]=e))}if(u>0&&e.length>u&&(e[u].getBigInt64Array().forEach((e=>i.push(Number(e)))),i.length!==l||r>=18&&i.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(n.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof n<"u"&&typeof i<"u"&&n.length>0&&i.length>l)throw new Error("Resize requires only of scales or sizes to be specified")},pw=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",yw=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",gw=(e,t,r)=>{let n=new Array(r).fill(0).concat(new Array(r).fill(1)),i=0===e.length?n:e.slice();return t.length>0?(t.forEach(((e,o)=>{n[e]=i[o],n[o+r]=i[t.length+o]})),n):i},mw=(e,t,r,n)=>{let i=[];if(r.length>0)if(n.length>0){if(e.forEach((e=>i.push(e))),Math.max(...n)>e.length)throw new Error("axes is out of bound");n.forEach(((e,t)=>i[e]=r[t]))}else r.forEach((e=>i.push(e)));else{if(0===t.length)throw new Error("Resize requires either scales or sizes.");i=e.map(((e,r)=>Math.round(e*t[r])))}return i},ww=(e,t,r)=>{let n=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map((e=>t[e])),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map((e=>t[e])),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let i=e.slice();return r.axes.length>0?(r.axes.forEach((e=>t[e]=n)),r.axes.forEach((r=>i[r]=Math.round(e[r]*t[r])))):(t.fill(n,0,t.length),i.forEach(((e,r)=>i[r]=Math.round(e*t[r])))),i},bw=(e,t,r,n,i)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${Cf("uniforms.scales","i",n)};\n        var roi_low = ${Cf("uniforms.roi","i",i)};\n        var roi_hi = ${Cf("uniforms.roi",`i + ${t.length}`,i)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${Cf("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${Cf("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,vw=(e,t,r,n,i,o,a)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${n.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${Cf("uniforms.scales","i",i)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${Cf("uniforms.roi","i",o)};\n          var roi_hi = ${Cf("uniforms.roi",`i + ${r.length}`,o)};\n          var input_shape_i = ${Cf("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${Cf("uniforms.output_shape","i",n.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${a} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,xw=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${Cf("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,_w=(e,t,r,n)=>e.rank>n?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",Iw=(e,t,r,n,i)=>{let[o,a,s,u]=2===r.length?[-1,0,1,-1]:[0,2,3,1],l=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${l} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",a,`max(0, min(row, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",s,`max(0, min(col, ${r[s]} - 1))`)};\n      ${_w(e,u,o,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${l} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${l} = originalIndices[${a}];\n      var col:${l} = originalIndices[${s}];\n      ${n?`if (row < 0 || row > (${r[a]} - 1) || col < 0 || col > (${r[s]} - 1)) {\n        return ${i};\n      }`:""};\n      row = max(0, min(row, ${r[a]} - 1));\n      col = max(0, min(col, ${r[s]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${u}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${o}])`:"0"};\n      var x11: ${l} = getInputValue(batch, channel, row1, col1);\n      var x12: ${l} = getInputValue(batch, channel, row1, col2);\n      var x21: ${l} = getInputValue(batch, channel, row2, col1);\n      var x22: ${l} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${l} = abs(row - ${l}(row1));\n      var dx2: ${l} = abs(${l}(row2) - row);\n      var dy1: ${l} = abs(col - ${l}(col1));\n      var dy2: ${l} = abs(${l}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Aw=(e,t,r,n,i,o,a,s,u,l)=>{let h=2===r.length,[c,d]=h?[0,1]:[2,3],f=e.type.value,p=a=>{let h=a===c?"row":"col";return`\n      fn ${h}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${f} {\n        var output_index = ${t.indicesGet("output_indices",a)};\n        var originalIdx: ${f} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[a]},\n        ${n[a]}, ${r[a]}, ${o[a]}, ${o[a]} + ${r.length});\n        var fractOriginalIdx: ${f} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${s} && (originalIdx < 0 || originalIdx > (${r[a]} - 1))) {\n          return ${u};\n        }\n        var data: array<${f}, 4> = array<${f}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${h}: ${f} = originalIdx + ${f}(i);\n          if (${h} < 0 || ${h} >= ${r[a]}) {\n            ${l?"coefs[i + 1] = 0.0;\n                        continue;":s?`return ${u};`:`${h} = max(0, min(${h}, ${r[a]} - 1));`};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",a,`u32(${h})`)};\n          data[i + 1] = ${a===c?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${p(c)};\n    ${p(d)};\n  fn getCubicInterpolationCoefs(s: ${f}) -> array<${f}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${f}, 4> = array<${f}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${f} = 1.0 - absS;\n    var twoMinusAbsS: ${f} = 2.0 - absS;\n    var onePlusAbsS: ${f} = 1.0 + absS;\n    coeffs[0] = ((${a} * onePlusAbsS - 5 * ${a}) * onePlusAbsS + 8 * ${a}) * onePlusAbsS - 4 * ${a};\n    coeffs[1] = ((${a} + 2) * absS - (${a} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${a} + 2) * oneMinusAbsS - (${a} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${a} * twoMinusAbsS - 5 * ${a}) * twoMinusAbsS + 8 * ${a}) * twoMinusAbsS - 4 * ${a};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${f}, 4>, coefs: array<${f}, 4>) -> ${f} {\n    var coefsSum: ${f} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${f} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Sw=(e,t,r,n,i)=>{let[o,a,s,u,l]=3===r.length?[-1,0,1,2,-1]:[0,2,3,4,1],h=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${h} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",a,`max(0, min(depth, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",s,`max(0, min(height, ${r[s]} - 1))`)};\n      ${e.indicesSet("input_indices",u,`max(0, min(width, ${r[u]} - 1))`)};\n      ${_w(e,l,o,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${h} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${h} = originalIndices[${a}];\n      var height:${h} = originalIndices[${s}];\n      var width:${h} = originalIndices[${u}];\n      ${n?`if (depth < 0 || depth > (${r[a]} - 1) || height < 0 || height > (${r[s]} - 1) || width < 0 || (width > ${r[u]} - 1)) {\n      return ${i};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[a]} - 1));\n      height = max(0, min(height, ${r[s]} - 1));\n      width = max(0, min(width, ${r[u]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${l}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${o}])`:"0"};\n\n      var x111: ${h} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${h} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${h} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${h} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${h} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${h} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${h} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${h} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${h} = abs(depth - ${h}(depth1));\n      var dx2: ${h} = abs(${h}(depth2) - depth);\n      var dy1: ${h} = abs(height - ${h}(height1));\n      var dy2: ${h} = abs(${h}(height2) - height);\n      var dz1: ${h} = abs(width - ${h}(width1));\n      var dz2: ${h} = abs(${h}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},Tw=(e,t,r,n,i,o)=>{let a=e.dims,s=gw(o,t.axes,a.length),u=mw(a,n,i,t.axes),l=n.slice();0===n.length&&(l=a.map(((e,t)=>0===e?1:u[t]/e)),"stretch"!==t.keepAspectRatioPolicy&&(u=ww(a,l,t)));let h=kf("output",e.dataType,u.length),c=Of("input",e.dataType,a.length),d=pf.size(u),f=a.length===u.length&&a.every(((e,t)=>e===u[t])),p="tf_crop_and_resize"===t.coordinateTransformMode,y=t.extrapolationValue,g=c.type.value;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${l.length>0?l:""}|${i.length>0?i:""}|${s.length>0?s:""}|${f}|${a}`,inputDependencies:["rank"]},getShaderSource:e=>`\n      ${f?"":`\n      ${pw(t.coordinateTransformMode,g)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${xw(c,a)};\n              ${yw(t.nearestMode,r,g)};\n              ${vw(c,h,a,u,l.length,s.length,p)};\n              `;case"linear":return`\n              ${bw(h,a,u,l.length,s.length)};\n              ${(()=>{if(2===a.length||4===a.length)return`${Iw(c,h,a,p,y)}`;if(3===a.length||5===a.length)return`${Sw(c,h,a,p,y)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(2===a.length||4===a.length)return`${Aw(c,h,a,u,l,s,t.cubicCoeffA,p,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${e.registerUniform("output_size","u32").registerUniform("scales","f32",l.length).registerUniform("roi","f32",s.length).declareVariables(c,h)}\n      ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${f?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${h.offsetToIndices("global_idx")};\n        var input_indices: ${c.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${c.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${2===a.length||4===a.length?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`,getRunData:()=>({outputs:[{dims:u,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:[{type:"uint32",data:d},{type:"float32",data:l},{type:"float32",data:s},..._f(a),..._f(u)]})}},Cw=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},Ew=(e,t)=>{let r=[],n=[],i=[],o=Cw(e);if(0!==t.antialias)throw Error("Only default value (0) for Antialias attribute is supported");fw(e.inputs,t,o,r,n,i),e.compute(Tw(e.inputs[0],t,o,r,n,i),{inputs:[0]})},Ow=e=>{let t=e.antialias,r=e.axes,n=e.coordinateTransformMode,i=e.cubicCoeffA,o=0!==e.excludeOutside,a=e.extrapolationValue,s=e.keepAspectRatioPolicy,u=e.mode,l=""===e.nearestMode?"simple":e.nearestMode;return cf({antialias:t,axes:r,coordinateTransformMode:n,cubicCoeffA:i,excludeOutside:o,extrapolationValue:a,keepAspectRatioPolicy:s,mode:u,nearestMode:l})}})),lv=Nc((()=>{bb(),Tb(),Sb(),Cb(),kw=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],n=e[2];if(t.dataType!==r.dataType||t.dataType!==n.dataType)throw new Error("All inputs must have the same data type");if(3!==t.dims.length&&2!==t.dims.length)throw new Error("Input must be 2D or 3D");if(3!==r.dims.length&&2!==r.dims.length)throw new Error("Skip must be 2D or 3D");let i=t.dims[t.dims.length-1],o=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==o)throw new Error("Skip must have the same sequence length as input");if(1!==n.dims.length)throw new Error("Gamma must be 1D");if(n.dims[n.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let t=e[3];if(1!==t.dims.length)throw new Error("Beta must be 1D");if(t.dims[t.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let t=e[4];if(1!==t.dims.length)throw new Error("Bias must be 1D");if(t.dims[t.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},Pw=(e,t,r,n)=>{let i=e[0].dims,o=i,a=pf.size(i),s=i.slice(-1)[0],u=n?i.slice(0,-1).concat(1):[],l=e.length>3,h=e.length>4,c=n&&r>1,d=n&&r>2,f=r>3,p=If(s),y=[Of("x",e[0].dataType,e[0].dims,p),Of("skip",e[1].dataType,e[1].dims,p),Of("gamma",e[2].dataType,e[2].dims,p)];l&&y.push(Of("beta",e[3].dataType,e[3].dims,p)),h&&y.push(Of("bias",e[4].dataType,e[4].dims,p)),y.push(kf("output",e[0].dataType,o,p)),c&&y.push(kf("meanOutput",1,u)),d&&y.push(kf("invStdOutput",1,u)),f&&y.push(kf("inputSkipBiasSum",e[0].dataType,o,p));let g=vf(e[0].dataType),m=[{dims:o,dataType:e[0].dataType}];return r>1&&m.push({dims:u,dataType:1}),r>2&&m.push({dims:u,dataType:1}),r>3&&m.push({dims:i,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:e=>`\n      const hiddenSize: f32 = ${s};\n      const hiddenSizeVectorized: u32 = ${s/p};\n      const epsilon: f32 = ${t.epsilon};\n\n      ${e.declareVariables(...y)}\n\n      ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes(a/s)}\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ${Af("f32",p)};\n        var squareSum = ${Af("f32",p)};\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ${h?"bias[i]":"0.0"};\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ${f?"inputSkipBiasSum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32Value = ${Sf(g,p,"value")};\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ${Tf("sum",p)} / hiddenSize;\n        let invStdDev = inverseSqrt(${Tf("squareSum",p)} / hiddenSize - mean * mean + epsilon);\n        ${c?"meanOutput[global_idx] = mean;":""}\n        ${d?"invStdOutput[global_idx] = invStdDev;":""}\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ${g}(mean)) * ${g}(invStdDev) * gamma[i]\n           + ${l?"beta[i]":"0.0"};\n        }\n      }`,getRunData:()=>({outputs:m,dispatchGroup:{x:Math.ceil(a/s/64)}})}},$w=(e,t)=>{kw(e.inputs);let r=[0];e.outputCount>1&&r.push(-3),e.outputCount>2&&r.push(-3),e.outputCount>3&&r.push(3),e.compute(Pw(e.inputs,t,e.outputCount,!1),{outputs:r})},Rw=e=>{let t=e.epsilon;return cf({epsilon:t})}})),hv=Nc((()=>{bb(),Tb(),Sb(),Cb(),Bw=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(0!==t.axes.length){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach(((t,r)=>{if(6!==e[r+1].dataType&&7!==e[r+1].dataType)throw new Error(`Input ${r} must be an array of int32 or int64`)}))},Dw=(e,t)=>{let r=[];if(e.length>t)if(7===e[t].dataType)e[t].getBigInt64Array().forEach((e=>r.push(Number(e))));else{if(6!==e[t].dataType)throw new Error(`Input ${t} must be an array of int32 or int64`);e[t].getInt32Array().forEach((e=>r.push(Number(e))))}return r},Mw=(e,t)=>{if(e.length>1){let t=Dw(e,1),r=Dw(e,2),n=Dw(e,3);return 0===n.length&&(n=[...Array(e[0].dims.length).keys()]),cf({starts:t,ends:r,axes:n})}return t},Lw=(e,t,r,n,i)=>{let o=e;return e<0&&(o+=r[n[t]]),i[t]<0?Math.max(0,Math.min(o,r[n[t]]-1)):Math.max(0,Math.min(o,r[n[t]]))},Fw=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${Cf("uniforms.input_shape","i",r.length)};\n            let steps_i = ${Cf("uniforms.steps","i",r.length)};\n            let signs_i = ${Cf("uniforms.signs","i",r.length)};\n            let starts_i = ${Cf("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,Nw=(e,t)=>{let r=e[0].dims,n=pf.size(r),i=t.axes.length>0?pf.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],o=Dw(e,4);o.forEach((e=>0!==e||(()=>{throw new Error("step cannot be 0")}))),0===o.length&&(o=Array(i.length).fill(1));let a=t.starts.map(((e,t)=>Lw(e,t,r,i,o))),s=t.ends.map(((e,t)=>Lw(e,t,r,i,o)));if(i.length!==a.length||i.length!==s.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==r.length)for(let e=0;e<r.length;++e)i.includes(e)||(a.splice(e,0,0),s.splice(e,0,r[e]),o.splice(e,0,1));let u=o.map((e=>Math.sign(e)));o.forEach(((e,t,r)=>{if(e<0){let n=(s[t]-a[t])/e,i=a[t],u=i+n*o[t];a[t]=u,s[t]=i,r[t]=-e}}));let l=r.slice(0);i.forEach(((e,t)=>{l[e]=Math.ceil((s[e]-a[e])/o[e])}));let h={dims:l,dataType:e[0].dataType},c=kf("output",e[0].dataType,l.length),d=Of("input",e[0].dataType,e[0].dims.length),f=pf.size(l),p=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:u.length},{name:"steps",type:"u32",length:o.length}],y=[{type:"uint32",data:f},{type:"uint32",data:a},{type:"int32",data:u},{type:"uint32",data:o},..._f(e[0].dims),..._f(l)];return{name:"Slice",shaderCache:{hint:`${u.length}_${a.length}_${o.length}`,inputDependencies:["rank"]},getShaderSource:e=>`\n      ${e.registerUniforms(p).declareVariables(d,c)}\n        ${Fw(d,c,r)}\n        ${e.mainStart()}\n          ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${c.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${c.setByOffset("global_idx",d.getByIndices("input_indices"))}\n      }`,getRunData:()=>({outputs:[h],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:y})}},Uw=(e,t)=>{Bw(e.inputs,t);let r=Mw(e.inputs,t);e.compute(Nw(e.inputs,r),{inputs:[0]})},jw=e=>{let t=e.starts,r=e.ends,n=e.axes;return cf({starts:t,ends:r,axes:n})}})),cv=Nc((()=>{Tb(),Sb(),Cb(),Gw=e=>{if(!e||1!==e.length)throw new Error("Softmax op requires 1 input.")},zw=(e,t)=>{let r=e.dims,n=pf.size(r),i=t.axis;if(i<0&&(i=r.length+i),i<r.length-1)throw new Error("softmax only supports last axis for now.");let o=r[i],a=n/o,s=If(o),u=o/s,l=Of("x",e.dataType,e.dims,s),h=kf("result",e.dataType,e.dims,s),c=l.type.value,d="f32"===vf(e.dataType)?`var threadMax = ${c}(-3.402823e+38f);`:`var threadMax = ${c}(-65504.0h);`;return{name:"Softmax",shaderCache:{hint:`${s}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:u}]}),getShaderSource:e=>`\n      var<workgroup> rowMaxShared : ${c};\n      var<workgroup> rowSumShared : ${c};\n      var<workgroup> threadShared : array<${c}, 64>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${c} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${c}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${e.registerUniform("packedCols","i32").declareVariables(l,h)}\n      ${e.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = 64;\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${d}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${c}(${((e,t)=>4===t?`max(max(${e}.x, ${e}.y), max(${e}.z, ${e}.w))`:2===t?`max(${e}.x, ${e}.y)`:3===t?`max(max(${e}.x, ${e}.y), ${e}.z)`:e)("threadShared[0]",s)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${c}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${c}(${Tf("threadShared[0]",s)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`}},Vw=(e,t)=>{Gw(e.inputs),e.compute(zw(e.inputs[0],t))},Hw=e=>cf({axis:e.axis})})),dv=Nc((()=>{Tb(),Sb(),Cb(),Ww=e=>{if(!e||e.length<1)throw new Error("too few inputs")},Yw=(e,t)=>{let r=[],n=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach((e=>r.push(Number(e)))),n=r.length),cf({numOutputs:n,axis:t.axis,splitSizes:r})},Kw=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${Cf("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Xw=e=>{let t=e.length,r=[];for(let n=0;n<t;++n){let i=e[n].setByIndices("indices","input[global_idx]");1===t?r.push(i):0===n?r.push(`if (output_number == ${n}u) { ${i} }`):n===t-1?r.push(`else { ${i} }`):r.push(`else if (output_number == ${n}) { ${i} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join("\n")}\n      }`},Zw=(e,t)=>{let r=e[0].dims,n=pf.size(r),i=e[0].dataType,o=pf.normalizeAxis(t.axis,r.length),a=new Array(t.numOutputs),s=Of("input",i,r),u=new Array(t.numOutputs),l=[],h=[],c=0,d=[{type:"uint32",data:n}];for(let n=0;n<t.numOutputs;n++){c+=t.splitSizes[n],u[n]=c;let o=r.slice();o[t.axis]=t.splitSizes[n],h.push(o),a[n]=kf(`output${n}`,i,o),l.push({dims:h[n],dataType:e[0].dataType})}d.push({type:"uint32",data:u}),d.push(..._f(r)),h.forEach((e=>d.push(..._f(e))));return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:e=>`\n  ${e.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",u.length).declareVariables(s,...a)}\n  ${Kw(u.length)}\n  ${Xw(a)}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${s.offsetToIndices("global_idx")};\n    var index = ${s.indicesGet("indices",o)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${Cf("uniforms.size_in_split_axis","output_number - 1u",u.length)};\n      ${s.indicesSet("indices",o,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`,getRunData:()=>({outputs:l,dispatchGroup:{x:Math.ceil(n/64)},programUniforms:d})}},qw=(e,t)=>{Ww(e.inputs);let r=1===e.inputs.length?t:Yw(e.inputs,t);e.compute(Zw(e.inputs,r),{inputs:[0]})},Jw=e=>{let t=e.axis,r=e.splitSizes,n=e.numOutputs<0?r.length:e.numOutputs;if(n!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return cf({axis:t,numOutputs:n,splitSizes:r})}})),fv=Nc((()=>{bb(),Tb(),Cb(),Qw=e=>Array.from(e.getBigInt64Array(),Number),eb=e=>{if(!e||2!==e.length)throw new Error("Tile requires 2 inputs.");if(1!==e[0].dataType&&6!==e[0].dataType&&12!==e[0].dataType)throw new Error("Tile only support float, int32, and uint32 data types");if(7!==e[1].dataType)throw new Error("Tile `repeats` input should be of int64 data type");if(1!==e[1].dims.length)throw new Error("Tile `repeats` input should be 1-D");if(Qw(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},tb=(e,t)=>{let r=[];for(let n=0;n<e.length;++n)r.push(e[n]*t[n]);return r},rb=e=>{let t=e[0].dims,r=Qw(e[1]),n=tb(t,r),i=pf.size(n),o=e[0].dataType,a=Of("input",o,t.length),s=kf("output",o,n.length);return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i},..._f(e[0].dims),..._f(n)]}),getShaderSource:e=>`\n      const inputShape = ${a.indices(...t)};\n      ${e.registerUniform("output_size","u32").declareVariables(a,s)}\n      ${e.mainStart()}\n      ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${s.offsetToIndices("global_idx")};\n      var input_indices: ${a.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${a.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${s.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${a.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${s.setByOffset("global_idx",a.getByIndices("input_indices"))}\n    }`}},nb=e=>{eb(e.inputs),e.compute(rb(e.inputs),{inputs:[0]})}})),pv=Nc((()=>{bb(),Tb(),Cb(),ib=(e,t,r,n,i)=>{let o,a=kf("output_data",i,r.length,4),s=Of("a_data",t[1].dataType,t[1].dims.length,4),u=Of("b_data",t[2].dataType,t[2].dims.length,4),l=Of("c_data",t[0].dataType,t[0].dims.length,4),h=(e,t,r)=>`select(${t}, ${e}, ${r})`;if(n){let e=(e,t,r="")=>{let n=`a_data[index_a${t}][component_a${t}]`,i=`b_data[index_b${t}][component_b${t}]`,o=`bool(c_data[index_c${t}] & ${4278190080>>>8*(3-t)}u)`;return`\n            let output_indices${t} = ${a.offsetToIndices(`global_idx * 4u + ${t}u`)};\n            let offset_a${t} = ${s.broadcastedIndicesToOffset(`output_indices${t}`,a)};\n            let offset_b${t} = ${u.broadcastedIndicesToOffset(`output_indices${t}`,a)};\n            let offset_c${t} = ${l.broadcastedIndicesToOffset(`output_indices${t}`,a)};\n            let index_a${t} = offset_a${t} / 4u;\n            let index_b${t} = offset_b${t} / 4u;\n            let index_c${t} = offset_c${t} / 4u;\n            let component_a${t} = offset_a${t} % 4u;\n            let component_b${t} = offset_b${t} % 4u;\n            ${e}[${t}] = ${r}(${h(n,i,o)});\n          `};o=9===i?`\n            var data = vec4<u32>(0);\n            ${e("data",0,"u32")}\n            ${e("data",1,"u32")}\n            ${e("data",2,"u32")}\n            ${e("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:`\n            ${e("output_data[global_idx]",0)}\n            ${e("output_data[global_idx]",1)}\n            ${e("output_data[global_idx]",2)}\n            ${e("output_data[global_idx]",3)}\n          `}else o=a.setByOffset("global_idx",h(s.getByOffset("global_idx"),u.getByOffset("global_idx"),l.getByOffset("global_idx")));return`\n        ${e.registerUniform("vec_size","u32").declareVariables(l,s,u,a)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${o}\n      }`},ob=e=>{let t=e[1].dims,r=e[2].dims,n=e[0].dims,i=e[1].dataType,o=!(pf.areEqual(t,r)&&pf.areEqual(r,n)),a=t,s=pf.size(t);if(o){let e=ff.calcShape(ff.calcShape(t,r,!1),n,!1);if(!e)throw new Error("Can't perform where op on the given tensors");a=e,s=pf.size(a)}let u=Math.ceil(s/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:t=>ib(t,e,a,o,i),getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(s/64/4)},programUniforms:[{type:"uint32",data:u},..._f(n),..._f(t),..._f(r),..._f(a)]})}},ab=e=>{e.compute(ob(e.inputs))}})),yv=Nc((()=>{Pb(),$b(),Rb(),Bb(),Mb(),Lb(),Fb(),Wb(),Xb(),Zb(),qb(),Jb(),Qb(),ev(),tv(),rv(),nv(),Hb(),iv(),ov(),av(),sv(),kb(),uv(),lv(),hv(),cv(),dv(),fv(),Eb(),Db(),pv(),sb=new Map([["Abs",[ry]],["Acos",[ny]],["Acosh",[iy]],["Add",[Gy]],["ArgMax",[Fp,Np]],["ArgMin",[Lp,Np]],["Asin",[oy]],["Asinh",[ay]],["Atan",[sy]],["Atanh",[uy]],["Attention",[Wp]],["AveragePool",[Qm,Jm]],["BatchNormalization",[Zp]],["BiasAdd",[Qp]],["BiasSplitGelu",[Fy]],["Cast",[hy,ly]],["Ceil",[fy]],["Clip",[dy]],["Concat",[rg,ng]],["Conv",[kg,Cg]],["ConvTranspose",[Vg,Ng]],["Cos",[py]],["Cosh",[yy]],["CumSum",[Wg,Yg]],["Div",[zy]],["Einsum",[rm,nm]],["Elu",[my,gy]],["Equal",[Vy]],["Erf",[by]],["Exp",[vy]],["Expand",[um]],["Floor",[xy]],["FusedConv",[kg,Cg]],["Gather",[dm,cm]],["GatherElements",[gm,ym]],["Gelu",[_y]],["Gemm",[vm,bm]],["GlobalAveragePool",[rw,tw]],["GlobalMaxPool",[sw,aw]],["Greater",[Ky]],["GreaterOrEqual",[Zy]],["InstanceNormalization",[Am]],["LayerNormalization",[Cm]],["LeakyRelu",[Iy,gy]],["Less",[Xy]],["LessOrEqual",[qy]],["Log",[Dy]],["MatMul",[_g]],["MaxPool",[iw,ow]],["Mul",[Hy]],["MultiHeadAttention",[Rm,Om]],["Neg",[Sy]],["Not",[Ay]],["Pad",[Gm]],["Pow",[Wy]],["Range",[hw]],["Reciprocal",[Ty]],["ReduceMin",[Pp]],["ReduceMean",[Tp]],["ReduceMax",[kp]],["ReduceSum",[Rp]],["ReduceProd",[$p]],["ReduceL1",[Cp]],["ReduceL2",[Ep]],["ReduceLogSum",[Dp]],["ReduceLogSumExp",[Op]],["ReduceSumSquare",[Bp]],["Relu",[Cy]],["Resize",[Ew,Ow]],["Sigmoid",[Ey]],["Sin",[Oy]],["Sinh",[ky]],["Slice",[Uw,jw]],["SkipLayerNormalization",[$w,Rw]],["Split",[qw,Jw]],["Sqrt",[Py]],["Softmax",[Vw,Hw]],["Sub",[Yy]],["Tan",[$y]],["Tanh",[Ry]],["ThresholdedRelu",[By,gy]],["Tile",[nb]],["Transpose",[jf,Gf]],["Where",[ab]]])})),gv=Nc((()=>{sd(),xb(),Cb(),ub=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r,n,i){Ic(e.programInfo.name);let o=this.backend.device,a=this.backend.getComputePassEncoder();this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber),a.setPipeline(e.computePipeline);let s=[];for(let e of t)s.push({binding:s.length,resource:{buffer:e.buffer}});for(let e of r)s.push({binding:s.length,resource:{buffer:e.buffer}});i&&s.push({binding:s.length,resource:i});let u=o.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:s,label:e.programInfo.name});a.setBindGroup(0,u),a.dispatchWorkgroups(...n),this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||"at-passes"===this.backend.queryType)&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Ac(e.programInfo.name)}dispose(){}build(e,t){Ic(e.name);let r=this.backend.device,n=[];r.features.has("shader-f16")&&n.push("enable f16;");let i=Rf(t),o=e.getShaderSource(i),a=`${n.join("\n")}\n${i.additionalImplementations}\n${o}`,s=r.createShaderModule({code:a,label:e.name});tf("verbose",(()=>`[WebGPU] ${e.name} shader code: ${a}`));let u=r.createComputePipeline({compute:{module:s,entryPoint:"main"},layout:"auto",label:e.name});return Ac(e.name),{programInfo:e,computePipeline:u}}normalizeDispatchGroupSize(e){let t="number"==typeof e?e:e.x,r="number"==typeof e?1:e.y||1,n="number"==typeof e?1:e.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=i&&r<=i&&n<=i)return[t,r,n];let o=t*r*n,a=Math.ceil(Math.sqrt(o));if(a>i){if(a=Math.ceil(Math.cbrt(o)),a>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[a,a,a]}return[a,a,1]}}})),mv=Nc((()=>{sd(),bb(),xb(),_b(),Ab(),yv(),gv(),lb=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let n=0;n<e.length;++n){let i=e[n].dataType;switch(t[n]){case"none":r.push("");break;case"type":r.push(`${i}`);break;case"rank":{let t=e[n].dims.length;r.push(`${i};${t}`);break}case"dims":{let t=e[n].dims.join(",");r.push(`${i};${t}`);break}default:throw new Error(`unsupported input dependency: ${t[n]}`)}}return r.join("|")},hb=(e,t,r)=>{let n=e.name;return e.shaderCache?.hint&&(n+="["+e.shaderCache.hint+"]"),n+=":"+r+`:${lb(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,n},cb=class{constructor(){this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(null===this.currentKernelId)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let r=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:r};t.features.has("chromium-experimental-timestamp-query-inside-passes")?r.push("chromium-experimental-timestamp-query-inside-passes"):t.features.has("timestamp-query")&&r.push("timestamp-query"),t.features.has("shader-f16")&&r.push("shader-f16"),this.device=await t.requestDevice(n),this.gpuDataManager=lf(this),this.programManager=new ub(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Qd(e.logLevel,!!e.debug),this.device.onuncapturederror=e=>{e.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${e.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),"none"!==this.queryType&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:2*this.maxDispatchNumber}),this.queryResolveBuffer=this.device.createBuffer({size:2*this.maxDispatchNumber*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e={};"at-passes"===this.queryType&&(e.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:2*this.pendingDispatchNumber,endOfPassWriteIndex:2*this.pendingDispatchNumber+1}),this.computePassEncoder=this.getCommandEncoder().beginComputePass(e)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;let e;Ic(),this.endComputePass(),"none"!==this.queryType&&(this.commandEncoder.resolveQuerySet(this.querySet,0,2*this.pendingDispatchNumber,this.queryResolveBuffer,0),e=this.device.createBuffer({size:2*this.pendingDispatchNumber*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,2*this.pendingDispatchNumber*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,"none"!==this.queryType&&e.mapAsync(GPUMapMode.READ).then((()=>{let t=new BigUint64Array(e.getMappedRange()),r=this.pendingQueries.get(e);for(let e=0;e<t.length/2;e++){let n=r[e],i=n.kernelId,o=this.kernels.get(i),a=o.kernelType,s=o.kernelName,u=n.programName,l=n.inputTensorViews,h=n.outputTensorViews,c=t[2*e],d=t[2*e+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=c);let f=Number(c-this.queryTimeBase),p=Number(d-this.queryTimeBase);if(!Number.isSafeInteger(f)||!Number.isSafeInteger(p))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:l.map((e=>({dims:e.dims,dataType:Gd(e.dataType)}))),outputsMetadata:h.map((e=>({dims:e.dims,dataType:Gd(e.dataType)}))),kernelId:i,kernelType:a,kernelName:s,programName:u,startTime:f,endTime:p});else{let e="";l.forEach(((t,r)=>{e+=`input[${r}]: [${t.dims}] | ${Gd(t.dataType)}, `}));let t="";h.forEach(((e,r)=>{t+=`output[${r}]: [${e.dims}] | ${Gd(e.dataType)}, `})),console.log(`[profiling] kernel "${i}|${a}|${s}|${u}" ${e}${t}execution time: ${p-f} ns`)}xc("GPU",`${u}::${c}::${d}`)}e.unmap(),this.pendingQueries.delete(e)})),Ac()}run(e,t,r,n,i){Ic(e.name);let o=[];for(let e=0;e<t.length;++e){let r=this.gpuDataManager.get(t[e].data);if(!r)throw new Error(`no GPU data for input: ${t[e].data}`);o[e]=r}let{outputs:a,dispatchGroup:s,programUniforms:u}=e.getRunData(t),l=0===r.length?a.map(((e,t)=>t)):r;if(l.length!==a.length)throw new Error(`Output size ${l.length} must be equal to ${a.length}.`);let h,c=[],d=[];for(let e=0;e<a.length;++e){if(!Number.isInteger(l[e])||l[e]<-3||l[e]>=a.length)throw new Error(`Invalid output index: ${l[e]}`);if(-3===l[e])continue;let t=-1===l[e],r=-2===l[e],o=t||r?i(a[e].dataType,a[e].dims):n(l[e],a[e].dataType,a[e].dims),s=this.gpuDataManager.get(o.data);if(!s)throw new Error(`no GPU data for output: ${o.data}`);if(t&&this.temporaryData.push(s),r){let e=this.kernelPersistentData.get(this.currentKernelId);e||(e=[],this.kernelPersistentData.set(this.currentKernelId,e)),e.push(s)}c.push(o),d.push(s)}if(u){let e=0,t=[];u.forEach((r=>{let n="number"==typeof r.data?[r.data]:r.data;if(0===n.length)return;let i=n.length<=2?4*n.length:16;e=Math.ceil(e/i)*i,t.push(e),e+=n.length>4?16*Math.ceil(n.length/4):4*n.length}));let r=16;e=Math.ceil(e/r)*r;let n=new ArrayBuffer(e);u.forEach(((e,r)=>{let i=t[r],o="number"==typeof e.data?[e.data]:e.data;"int32"===e.type?new Int32Array(n,i,o.length).set(o):"uint32"===e.type?new Uint32Array(n,i,o.length).set(o):new Float32Array(n,i,o.length).set(o)}));let i=this.gpuDataManager.create(e,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(i.buffer,0,n,0,e),this.gpuDataManager.release(i.id),h={offset:0,size:e,buffer:i.buffer}}let f=this.programManager.normalizeDispatchGroupSize(s),p=1===f[1]&&1===f[2],y=hb(e,t,p),g=this.programManager.getArtifact(y);if(g||(g=this.programManager.build(e,f),this.programManager.setArtifact(y,g),tf("info",(()=>`[artifact] key: ${y}, programName: ${e.name}`))),tf("info",(()=>`[ProgramManager] run "${e.name}" (key=${y}) with ${f[0]}x${f[1]}x${f[2]}`)),"none"!==this.queryType){let e={kernelId:this.currentKernelId,programName:g.programInfo.name,inputTensorViews:t,outputTensorViews:c};this.pendingKernels.push(e)}return this.programManager.run(g,o,d,f,h),Ac(e.name),c}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,r,n){let i=sb.get(e);if(!i)throw new Error(`kernel not implemented: ${e}`);let o={kernelType:e,kernelName:n,kernelEntry:i[0],attributes:[i[1],r]};this.kernels.set(t,o)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let e of t)this.gpuDataManager.release(e.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,r){let n=this.kernels.get(e);if(!n)throw new Error(`kernel not created: ${e}`);let i=n.kernelType,o=n.kernelName,a=n.kernelEntry,s=n.attributes;if(null!==this.currentKernelId)throw new Error(`kernel "[${i}] ${o}" is not allowed to be called recursively`);this.currentKernelId=e,s[0]&&(s[1]=s[0](s[1]),s[0]=void 0),tf("info",(()=>`[WebGPU] Start to run kernel "[${i}] ${o}"...`));let u=this.env.debug;this.temporaryData=[];try{return u&&this.device.pushErrorScope("validation"),a(t,s[1]),0}catch(e){return r.push(Promise.resolve(`[WebGPU] Kernel "[${i}] ${o}" failed. ${e}`)),1}finally{u&&r.push(this.device.popErrorScope().then((e=>e?`GPU validation error for kernel "[${i}] ${o}": ${e.message}`:null)));for(let e of this.temporaryData)this.gpuDataManager.release(e.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,r,n){let i=this.sessionExternalDataMapping.get(e);i||(i=new Map,this.sessionExternalDataMapping.set(e,i));let o=i.get(t),a=this.gpuDataManager.registerExternalBuffer(r,n,o?.[1]);return i.set(t,[a,r]),a}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach((e=>this.gpuDataManager.unregisterExternalBuffer(e[1]))),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,r){return async()=>{let n=await sf(this,e,t);return rf(n.buffer,r)}}writeTimestamp(e){"inside-passes"===this.queryType&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){this.queryType="none",("default"===this.env.webgpu.profiling?.mode||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"))}}})),wv={};jc(wv,{init:()=>xv});var bv,vv,xv,_v,Iv,Av,Sv,Tv,Cv,Ev,Ov,kv,Pv,$v,Rv,Bv,Dv,Mv,Lv,Fv,Nv,Uv,jv,Gv,zv,Vv,Hv,Wv,Yv,Kv,Xv,Zv,qv,Jv,Qv,ex,tx,rx,nx,ix,ox,ax,sx=Nc((()=>{bb(),mv(),xb(),Tb(),bv=class e{constructor(e,t,r,n){this.module=e,this.dataType=t,this.data=r,this.dims=n}getFloat32Array(){if(1!==this.dataType)throw new Error("Invalid data type");let e=pf.size(this.dims);return 0===e?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}getBigInt64Array(){if(7!==this.dataType)throw new Error("Invalid data type");let e=pf.size(this.dims);return 0===e?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}getInt32Array(){if(6!==this.dataType)throw new Error("Invalid data type");let e=pf.size(this.dims);return 0===e?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}reshape(t){if(pf.size(t)!==pf.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},vv=class{constructor(e,t,r){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0;let n=e.HEAPU32,i=r>>>2;this.opKernelContext=n[i++];let o=n[i++];this.outputCount=n[i++],this.customDataOffset=n[i++],this.customDataSize=n[i++];let a=[];for(let t=0;t<o;t++){let t=n[i++],r=n[i++],o=n[i++],s=[];for(let e=0;e<o;e++)s.push(n[i++]);a.push(new bv(e,t,r,s))}this.inputs=a}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){let r=t?.inputs?.map((e=>"number"==typeof e?this.inputs[e]:e))??this.inputs,n=t?.outputs??[];return this.backend.run(e,r,n,((e,t,r)=>new bv(this.module,t,this.output(e,r),r)),((e,t)=>{let r=zd(e);if(!r)throw new Error(`Unsupported data type: ${e}`);let n=r*pf.size(t);return new bv(this.module,e,this.backend.gpuDataManager.create(n).id,t)}))}output(e,t){let r=this.module.stackSave();try{let r=this.module.stackAlloc(4*(1+t.length)),n=r>>2;this.module.HEAPU32[n++]=t.length;for(let e=0;e<t.length;e++)this.module.HEAPU32[n++]=t[e];return this.module._JsepOutput(this.opKernelContext,e,r)}catch(r){throw new Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${r}`)}finally{this.module.stackRestore(r)}}},xv=async(e,t,r)=>{let n=e.jsepInit;if(!n)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");let i=new cb;await i.initialize(t,r),n(i,(e=>i.alloc(e)),(e=>i.free(e)),((t,r,n,o=!1)=>{if(o)tf("verbose",(()=>`[WebGPU] jsepCopyGpuToGpu: src=${t}, dst=${r}, size=${n}`)),i.memcpy(t,r);else{tf("verbose",(()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${t}, gpuDataId=${r}, size=${n}`));let o=e.HEAPU8.subarray(t>>>0,(t>>>0)+n);i.upload(r,o)}}),(async(t,r,n)=>{tf("verbose",(()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${t}, dataOffset=${r}, size=${n}`)),await i.download(t,(()=>e.HEAPU8.subarray(r>>>0,(r>>>0)+n)))}),((t,r,n)=>i.createKernel(t,r,n,e.UTF8ToString(e._JsepGetNodeName(r)))),(e=>i.releaseKernel(e)),((t,r,n,o)=>{tf("verbose",(()=>`[WebGPU] jsepRun: sessionHandle=${n}, kernel=${t}, contextDataOffset=${r}`));let a=new vv(e,i,r);return i.computeKernel(t,a,o)}))}})),ux=Nc((()=>{mb(),wb(),bb(),yb(),gb(),vb(),_v=(e,t)=>{0!==Pd()._OrtInit(e,t)&&Bd("Can't initialize onnxruntime.")},Iv=async e=>{_v(e.wasm.numThreads,Hd(e.logLevel))},Av=async(e,t)=>{if("webgpu"===t){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let t=await navigator.gpu.requestAdapter();if(!t)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.');if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");let r=(sx(),Gc(wv)).init;await r(Pd(),e,t)}},Sv=new Map,Tv=e=>{let t=Pd(),r=t.stackSave();try{let r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&Bd("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(r)}},Cv=e=>{let t=Pd(),r=t._malloc(e.byteLength);if(0===r)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},Ev=async(e,t)=>{let r,n,i=Pd();Array.isArray(e)?[r,n]=e:e.buffer===i.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=Cv(e);let o=0,a=0,s=0,u=[],l=[],h=[];try{if([a,u]=Ud(t),t?.externalData&&i.mountExternalData){let e=[];for(let r of t.externalData){let t="string"==typeof r?r:r.path;e.push(Kd("string"==typeof r?r:r.data).then((e=>{i.mountExternalData(t,e)})))}await Promise.all(e)}o=i._OrtCreateSession(r,n,a),0===o&&Bd("Can't create a session.");let[e,c]=Tv(o),d=[],f=[],p=[];for(let t=0;t<e;t++){let e=i._OrtGetInputName(o,t);0===e&&Bd("Can't get an input name."),l.push(e),d.push(i.UTF8ToString(e))}for(let e=0;e<c;e++){let r=i._OrtGetOutputName(o,e);0===r&&Bd("Can't get an output name."),h.push(r);let n=i.UTF8ToString(r);f.push(n);{let e="string"==typeof t?.preferredOutputLocation?t.preferredOutputLocation:t?.preferredOutputLocation?.[n]??"cpu";if("cpu"!==e&&"cpu-pinned"!==e&&"gpu-buffer"!==e)throw new Error(`Not supported preferred output location: ${e}.`);p.push(e)}}let y=null;return p.some((e=>"gpu-buffer"===e))&&(s=i._OrtCreateBinding(o),0===s&&Bd("Can't create IO binding."),y={handle:s,outputPreferredLocations:p,outputPreferredLocationsEncoded:p.map((e=>Yd(e)))}),Sv.set(o,[o,l,h,y]),[o,d,f]}catch(e){throw l.forEach((e=>i._OrtFree(e))),h.forEach((e=>i._OrtFree(e))),0!==s&&i._OrtReleaseBinding(s),0!==o&&i._OrtReleaseSession(o),e}finally{i._free(r),0!==a&&i._OrtReleaseSessionOptions(a),u.forEach((e=>i._free(e))),i.unmountExternalData?.()}},Ov=e=>{let t=Pd(),r=Sv.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,i,o,a]=r;a&&t._OrtReleaseBinding(a.handle),t.jsepUnregisterBuffers?.(e),i.forEach((e=>t._OrtFree(e))),o.forEach((e=>t._OrtFree(e))),t._OrtReleaseSession(n),Sv.delete(e)},kv=(e,t,r,n,i)=>{if(!e)return void t.push(0);let o,a,s=Pd(),u=e[0],l=e[1],h=e[3];if("string"===u&&"gpu-buffer"===h)throw new Error("String tensor is not supported on GPU.");if("gpu-buffer"===h){let t=e[2].gpuBuffer,r=zd(jd(u));a=l.reduce(((e,t)=>e*t),1)*r,o=s.jsepRegisterBuffer(n,i,t,a)}else{let t=e[2];if(Array.isArray(t)){a=4*t.length,o=s._malloc(a),r.push(o);let e=o/4;for(let n=0;n<t.length;n++){if("string"!=typeof t[n])throw new TypeError(`tensor data at index ${n} is not a string`);s.HEAPU32[e++]=$d(t[n],r)}}else a=t.byteLength,o=s._malloc(a),r.push(o),s.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,a),o)}let c=s.stackSave(),d=s.stackAlloc(4*l.length);try{let e=d/4;l.forEach((t=>s.HEAP32[e++]=t));let r=s._OrtCreateTensor(jd(u),o,a,d,l.length,Yd(h));0===r&&Bd(`Can't create tensor for input/output. session=${n}, index=${i}.`),t.push(r)}finally{s.stackRestore(c)}},Pv=e=>{let t=(new TextEncoder).encode(e),r=Pd(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtConfigure(n,t.byteLength);if(0===i)throw new Error("Can't get an configure key");let o=r.UTF8ToString(i);return r._OrtFree(i),o},$v=e=>{let t=(new TextEncoder).encode(e),r=Pd(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtAuth(n,t.byteLength);if(0===i)throw new Error("Can't get an auth result");let o=r.UTF8ToString(i);return r._OrtFree(i),o},Rv=async(e,t,r,n,i,o)=>{let a=Pd(),s=Sv.get(e);if(!s)throw new Error(`cannot run inference. invalid session id: ${e}`);let[u,l,h,c]=s,d=t.length,f=n.length,p=0,y=[],g=[],m=[],w=[],b=a.stackSave(),v=a.stackAlloc(4*d),x=a.stackAlloc(4*d),_=a.stackAlloc(4*f),I=a.stackAlloc(4*f);try{[p,y]=Dd(o);for(let n=0;n<d;n++)kv(r[n],g,w,e,t[n]);for(let t=0;t<f;t++)kv(i[t],m,w,e,d+n[t]);let s,b=v/4,A=x/4,S=_/4,T=I/4;for(let e=0;e<d;e++)a.HEAPU32[b++]=g[e],a.HEAPU32[A++]=l[t[e]];for(let e=0;e<f;e++)a.HEAPU32[S++]=m[e],a.HEAPU32[T++]=h[n[e]];if(c){let{handle:r,outputPreferredLocations:o,outputPreferredLocationsEncoded:s}=c;if(l.length!==d)throw new Error(`input count from feeds (${d}) is expected to be always equal to model's input count (${l.length}).`);for(let n=0;n<d;n++){let i=t[n];0!==await a._OrtBindInput(r,l[i],g[n])&&Bd(`Can't bind input[${n}] for session=${e}.`)}for(let t=0;t<f;t++){let u=n[t];i[t]?.[3]?0!==a._OrtBindOutput(r,h[u],m[t],0)&&Bd(`Can't bind pre-allocated output[${t}] for session=${e}.`):0!==a._OrtBindOutput(r,h[u],0,s[u])&&Bd(`Can't bind output[${t}] to ${o[t]} for session=${e}.`)}}s=c?await a._OrtRunWithBinding(u,c.handle,f,_,p):await a._OrtRun(u,x,v,d,I,f,_,p),0!==s&&Bd("failed to call OrtRun().");let C=[];for(let e=0;e<f;e++){let t=a.HEAPU32[_/4+e];if(t===m[e]){C.push(i[e]);continue}let r,o=a.stackSave(),s=a.stackAlloc(16),u=!1,l=0;try{0!==a._OrtGetTensorData(t,s,s+4,s+8,s+12)&&Bd(`Can't access output tensor data on index ${e}.`);let i=s/4,o=a.HEAPU32[i++];l=a.HEAPU32[i++];let h=a.HEAPU32[i++],d=a.HEAPU32[i++],f=[];for(let e=0;e<d;e++)f.push(a.HEAPU32[h/4+e]);a._OrtFree(h);let p=f.reduce(((e,t)=>e*t),1);r=Gd(o);let y=c?.outputPreferredLocations[n[e]];if("string"===r){if("gpu-buffer"===y)throw new Error("String tensor is not supported on GPU.");let e=[],t=l/4;for(let r=0;r<p;r++){let n=a.HEAPU32[t++],i=r===p-1?void 0:a.HEAPU32[t]-n;e.push(a.UTF8ToString(n,i))}C.push([r,f,e,"cpu"])}else if("gpu-buffer"===y&&p>0){let e=a.jsepGetBuffer(l),n=zd(o);if(void 0===n||!Wd(r))throw new Error(`Unsupported data type: ${r}`);u=!0,C.push([r,f,{gpuBuffer:e,download:a.jsepCreateDownloader(e,p*n,r),dispose:()=>{a._OrtReleaseTensor(t)}},"gpu-buffer"])}else{let e=new(Vd(r))(p);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(a.HEAPU8.subarray(l,l+e.byteLength)),C.push([r,f,e,"cpu"])}}finally{a.stackRestore(o),"string"===r&&l&&a._free(l),u||a._OrtReleaseTensor(t)}}return c&&a._OrtClearBoundOutputs(c.handle),C}finally{a.stackRestore(b),g.forEach((e=>a._OrtReleaseTensor(e))),m.forEach((e=>a._OrtReleaseTensor(e))),w.forEach((e=>a._free(e))),0!==p&&a._OrtReleaseRunOptions(p),y.forEach((e=>a._free(e)))}},Bv=e=>{let t=Pd(),r=Sv.get(e);if(!r)throw new Error("invalid session id");let n=r[0],i=t._OrtEndProfiling(n);0===i&&Bd("Can't get an profile file name."),t._OrtFree(i)},Dv=e=>{let t=[];for(let r of e){let e=r[2];!Array.isArray(e)&&"buffer"in e&&t.push(e.buffer)}return t}})),lx=Uc(((e,t)=>{t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var Cn=Object.defineProperty;var el=Object.getOwnPropertyDescriptor;var tl=Object.getOwnPropertyNames;var rl=Object.prototype.hasOwnProperty;var ko=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error(\'Dynamic require of "\'+e+\'" is not supported\')});var q=(e,t)=>()=>(e&&(t=e(e=0)),t);var wr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Gr=(e,t)=>{for(var r in t)Cn(e,r,{get:t[r],enumerable:!0})},nl=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of tl(t))!rl.call(e,n)&&n!==r&&Cn(e,n,{get:()=>t[n],enumerable:!(o=el(t,n))||o.enumerable});return e};var Jt=e=>nl(Cn({},"__esModule",{value:!0}),e);var In={};Gr(In,{createReadStream:()=>Bo,readFile:()=>ol,readFileSync:()=>al});var ol,al,Bo,An=q(()=>{ol=void 0,al=void 0,Bo=void 0});var Tn={};Gr(Tn,{join:()=>il});var il,En=q(()=>{il=void 0});var Mo=wr((Do,On)=>{"use strict";var Ro=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){var r=t,o,n;r.ready=new Promise((l,p)=>{o=l,n=p}),r.mountExternalData=(l,p)=>{(r.Ka||(r.Ka=new Map)).set(l,p)},r.unmountExternalData=()=>{delete r.Ka},r.jsepInit=(l,p,b,x,O,W,L,te)=>{r.gb=l,r.Wa=p,r.Ya=b,r.Qa=x,r.Xa=O,r.Ba=W,r.Za=L,r.$a=te,p=(ee,ue,le)=>(...ve)=>{let Ie=Je,k=ue?.();ve=ee(...ve);let de=ue?.();return k!==de&&(ee=de,le(k),ue=le=null),Je!=Ie?kr():ve},b=ee=>async(...ue)=>{try{if(r.Ja)throw Error("Session already started");let le=r.Ja={ab:ue[0],errors:[]},ve=await ee(...ue);if(r.Ja!==le)throw Error("Session mismatch");l.flush();let Ie=le.errors;if(0<Ie.length){let k=await Promise.all(Ie);if(k=k.filter(de=>de),0<k.length)throw Error(k.join(`\n`))}return ve}finally{r.Ja=null}},r._OrtRun=b(p(r._OrtRun,()=>r._OrtRun,ee=>r._OrtRun=ee)),r._OrtRunWithBinding=b(p(r._OrtRunWithBinding,()=>r._OrtRunWithBinding,ee=>r._OrtRunWithBinding=ee)),r._OrtBindInput=p(r._OrtBindInput,()=>r._OrtBindInput,ee=>r._OrtBindInput=ee),r.jsepRegisterBuffer=(ee,ue,le,ve)=>l.registerBuffer(ee,ue,le,ve),r.jsepUnregisterBuffers=ee=>{l.unregisterBuffers(ee)},r.jsepGetBuffer=ee=>l.getBuffer(ee),r.jsepCreateDownloader=(ee,ue,le)=>l.createDownloader(ee,ue,le)};var s=Object.assign({},r),u="./this.program",d=(l,p)=>{throw p},a=typeof window=="object",m=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g="",w,v,y;if(h){var C=(An(),Jt(In)),I=(En(),Jt(Tn));g=m?I.dirname(g)+"/":__dirname+"/",w=(l,p)=>(l=We(l)?new URL(l):I.normalize(l),C.readFileSync(l,p?void 0:"utf8")),y=l=>(l=w(l,!0),l.buffer||(l=new Uint8Array(l)),l),v=(l,p,b,x=!0)=>{l=We(l)?new URL(l):I.normalize(l),C.readFile(l,x?void 0:"utf8",(O,W)=>{O?b(O):p(x?W.buffer:W)})},!r.thisProgram&&1<process.argv.length&&(u=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),d=(l,p)=>{throw process.exitCode=l,p},r.inspect=()=>"[Emscripten Module object]"}else(a||m)&&(m?g=self.location.href:typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),e&&(g=e),g.indexOf("blob:")!==0?g=g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):g="",w=l=>{var p=new XMLHttpRequest;return p.open("GET",l,!1),p.send(null),p.responseText},m&&(y=l=>{var p=new XMLHttpRequest;return p.open("GET",l,!1),p.responseType="arraybuffer",p.send(null),new Uint8Array(p.response)}),v=(l,p,b)=>{var x=new XMLHttpRequest;x.open("GET",l,!0),x.responseType="arraybuffer",x.onload=()=>{x.status==200||x.status==0&&x.response?p(x.response):b()},x.onerror=b,x.send(null)});var S=console.log.bind(console),_=console.error.bind(console);Object.assign(r,s),s=null,typeof WebAssembly!="object"&&he("no native wasm support detected");var P,A=!1,z,R,N,T,H,ie,Z;function K(){var l=P.buffer;r.HEAP8=R=new Int8Array(l),r.HEAP16=new Int16Array(l),r.HEAPU8=N=new Uint8Array(l),r.HEAPU16=new Uint16Array(l),r.HEAP32=T=new Int32Array(l),r.HEAPU32=H=new Uint32Array(l),r.HEAPF32=ie=new Float32Array(l),r.HEAPF64=Z=new Float64Array(l)}var Q=[],X=[],Ee=[],Pe=0,fe=null,Ce=null;function he(l){throw l="Aborted("+l+")",_(l),A=!0,z=1,l=new WebAssembly.RuntimeError(l+". Build with -sASSERTIONS for more info."),n(l),l}var ye=l=>l.startsWith("data:application/octet-stream;base64,"),We=l=>l.startsWith("file://"),Me;if(Me="ort-wasm-simd.wasm",!ye(Me)){var Ge=Me;Me=r.locateFile?r.locateFile(Ge,g):g+Ge}function G(l){if(y)return y(l);throw"both async and sync fetching of the wasm failed"}function re(l){if(a||m){if(typeof fetch=="function"&&!We(l))return fetch(l,{credentials:"same-origin"}).then(p=>{if(!p.ok)throw"failed to load wasm binary file at \'"+l+"\'";return p.arrayBuffer()}).catch(()=>G(l));if(v)return new Promise((p,b)=>{v(l,x=>p(new Uint8Array(x)),b)})}return Promise.resolve().then(()=>G(l))}function be(l,p,b){return re(l).then(x=>WebAssembly.instantiate(x,p)).then(x=>x).then(b,x=>{_(`failed to asynchronously prepare wasm: ${x}`),he(x)})}function rt(l,p){var b=Me;return typeof WebAssembly.instantiateStreaming!="function"||ye(b)||We(b)||h||typeof fetch!="function"?be(b,l,p):fetch(b,{credentials:"same-origin"}).then(x=>WebAssembly.instantiateStreaming(x,l).then(p,function(O){return _(`wasm streaming compile failed: ${O}`),_("falling back to ArrayBuffer instantiation"),be(b,l,p)}))}var ze,Ve={898080:(l,p,b,x)=>{if(typeof r>"u"||!r.Ka)return 1;if(l=qe(l>>>0),l.startsWith("./")&&(l=l.substring(2)),l=r.Ka.get(l),!l)return 2;if(p>>>=0,b>>>=0,p+b>l.byteLength)return 3;try{return N.set(l.subarray(p,p+b),x>>>0>>>0),0}catch{return 4}},898581:l=>r.Wa(l),898614:l=>r.Ya(l),898646:(l,p,b)=>{r.Qa(l,p,b,!0)},898685:(l,p,b)=>{r.Qa(l,p,b)},898718:l=>{r.Ba("Abs",l,void 0)},898769:l=>{r.Ba("Neg",l,void 0)},898820:l=>{r.Ba("Floor",l,void 0)},898873:l=>{r.Ba("Ceil",l,void 0)},898925:l=>{r.Ba("Reciprocal",l,void 0)},898983:l=>{r.Ba("Sqrt",l,void 0)},899035:l=>{r.Ba("Exp",l,void 0)},899086:l=>{r.Ba("Erf",l,void 0)},899137:l=>{r.Ba("Sigmoid",l,void 0)},899192:l=>{r.Ba("Log",l,void 0)},899243:l=>{r.Ba("Sin",l,void 0)},899294:l=>{r.Ba("Cos",l,void 0)},899345:l=>{r.Ba("Tan",l,void 0)},899396:l=>{r.Ba("Asin",l,void 0)},899448:l=>{r.Ba("Acos",l,void 0)},899500:l=>{r.Ba("Atan",l,void 0)},899552:l=>{r.Ba("Sinh",l,void 0)},899604:l=>{r.Ba("Cosh",l,void 0)},899656:l=>{r.Ba("Asinh",l,void 0)},899709:l=>{r.Ba("Acosh",l,void 0)},899762:l=>{r.Ba("Atanh",l,void 0)},899815:l=>{r.Ba("Tanh",l,void 0)},899867:l=>{r.Ba("Not",l,void 0)},899918:(l,p,b)=>{r.Ba("Clip",l,{min:p,max:b})},899987:l=>{r.Ba("Clip",l,void 0)},900039:(l,p)=>{r.Ba("Elu",l,{alpha:p})},900097:l=>{r.Ba("Relu",l,void 0)},900149:(l,p)=>{r.Ba("LeakyRelu",l,{alpha:p})},900213:(l,p)=>{r.Ba("ThresholdedRelu",l,{alpha:p})},900283:(l,p)=>{r.Ba("Cast",l,{to:p})},900341:l=>{r.Ba("Add",l,void 0)},900392:l=>{r.Ba("Sub",l,void 0)},900443:l=>{r.Ba("Mul",l,void 0)},900494:l=>{r.Ba("Div",l,void 0)},900545:l=>{r.Ba("Pow",l,void 0)},900596:l=>{r.Ba("Equal",l,void 0)},900649:l=>{r.Ba("Greater",l,void 0)},900704:l=>{r.Ba("GreaterOrEqual",l,void 0)},900766:l=>{r.Ba("Less",l,void 0)},900818:l=>{r.Ba("LessOrEqual",l,void 0)},900877:(l,p,b,x,O)=>{r.Ba("ReduceMean",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901036:(l,p,b,x,O)=>{r.Ba("ReduceMax",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901194:(l,p,b,x,O)=>{r.Ba("ReduceMin",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901352:(l,p,b,x,O)=>{r.Ba("ReduceProd",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901511:(l,p,b,x,O)=>{r.Ba("ReduceSum",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901669:(l,p,b,x,O)=>{r.Ba("ReduceL1",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901826:(l,p,b,x,O)=>{r.Ba("ReduceL2",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901983:(l,p,b,x,O)=>{r.Ba("ReduceLogSum",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902144:(l,p,b,x,O)=>{r.Ba("ReduceSumSquare",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902308:(l,p,b,x,O)=>{r.Ba("ReduceLogSumExp",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902472:l=>{r.Ba("Where",l,void 0)},902525:(l,p,b)=>{r.Ba("Transpose",l,{perm:p?Array.from(T.subarray(p>>>0,b>>>0)):[]})},902633:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de)=>{r.Ba("ConvTranspose",l,{format:ee?"NHWC":"NCHW",autoPad:p,dilations:[b],group:x,kernel_shape:[O],pads:[W,L],strides:[te],wIsConst:()=>!!R[ue>>>0],outputPadding:le?Array.from(T.subarray(le>>>0,ve>>>0)):[],outputShape:Ie?Array.from(T.subarray(Ie>>>0,k>>>0)):[],activation:qe(de)})},903035:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k)=>{r.Ba("ConvTranspose",l,{format:te?"NHWC":"NCHW",autoPad:p,dilations:Array.from(T.subarray(b>>>0,(b>>>0)+2>>>0)),group:x,kernelShape:Array.from(T.subarray(O>>>0,(O>>>0)+2>>>0)),pads:Array.from(T.subarray(W>>>0,(W>>>0)+4>>>0)),strides:Array.from(T.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!R[ee>>>0],outputPadding:ue?Array.from(T.subarray(ue>>>0,le>>>0)):[],outputShape:ve?Array.from(T.subarray(ve>>>0,Ie>>>0)):[],activation:qe(k)})},903600:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de)=>{r.Ba("ConvTranspose",l,{format:ee?"NHWC":"NCHW",autoPad:p,dilations:[b],group:x,kernel_shape:[O],pads:[W,L],strides:[te],wIsConst:()=>!!R[ue>>>0],outputPadding:le?Array.from(T.subarray(le>>>0,ve>>>0)):[],outputShape:Ie?Array.from(T.subarray(Ie>>>0,k>>>0)):[],activation:qe(de)})},904002:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k)=>{r.Ba("ConvTranspose",l,{format:te?"NHWC":"NCHW",autoPad:p,dilations:Array.from(T.subarray(b>>>0,(b>>>0)+2>>>0)),group:x,kernelShape:Array.from(T.subarray(O>>>0,(O>>>0)+2>>>0)),pads:Array.from(T.subarray(W>>>0,(W>>>0)+4>>>0)),strides:Array.from(T.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!R[ee>>>0],outputPadding:ue?Array.from(T.subarray(ue>>>0,le>>>0)):[],outputShape:ve?Array.from(T.subarray(ve>>>0,Ie>>>0)):[],activation:qe(k)})},904567:(l,p)=>{r.Ba("GlobalAveragePool",l,{format:p?"NHWC":"NCHW"})},904658:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("AveragePool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},904942:(l,p)=>{r.Ba("GlobalAveragePool",l,{format:p?"NHWC":"NCHW"})},905033:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("AveragePool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},905317:(l,p)=>{r.Ba("GlobalMaxPool",l,{format:p?"NHWC":"NCHW"})},905404:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("MaxPool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},905684:(l,p)=>{r.Ba("GlobalMaxPool",l,{format:p?"NHWC":"NCHW"})},905771:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("MaxPool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},906051:(l,p,b,x,O)=>{r.Ba("Gemm",l,{alpha:p,beta:b,transA:x,transB:O})},906155:l=>{r.Ba("MatMul",l,void 0)},906209:(l,p,b,x)=>{r.Ba("ArgMax",l,{keepDims:!!p,selectLastIndex:!!b,axis:x})},906317:(l,p,b,x)=>{r.Ba("ArgMin",l,{keepDims:!!p,selectLastIndex:!!b,axis:x})},906425:(l,p)=>{r.Ba("Softmax",l,{axis:p})},906488:(l,p)=>{r.Ba("Concat",l,{axis:p})},906548:(l,p,b,x,O)=>{r.Ba("Split",l,{axis:p,numOutputs:b,splitSizes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},906688:l=>{r.Ba("Expand",l,void 0)},906742:(l,p)=>{r.Ba("Gather",l,{axis:Number(p)})},906813:(l,p)=>{r.Ba("GatherElements",l,{axis:Number(p)})},906892:(l,p,b,x,O,W,L,te,ee,ue,le)=>{r.Ba("Resize",l,{antialias:p,axes:b?Array.from(T.subarray(b>>>0,x>>>0)):[],coordinateTransformMode:qe(O),cubicCoeffA:W,excludeOutside:L,extrapolationValue:te,keepAspectRatioPolicy:qe(ee),mode:qe(ue),nearestMode:qe(le)})},907238:(l,p,b,x,O,W,L)=>{r.Ba("Slice",l,{starts:p?Array.from(T.subarray(p>>>0,b>>>0)):[],ends:x?Array.from(T.subarray(x>>>0,O>>>0)):[],axes:W?Array.from(T.subarray(W>>>0,L>>>0)):[]})},907454:l=>{r.Ba("Tile",l,void 0)},907506:(l,p,b)=>{r.Ba("LayerNormalization",l,{axis:Number(p),epsilon:Number(b)})},907613:(l,p,b)=>{r.Ba("InstanceNormalization",l,{epsilon:p,format:b?"NHWC":"NCHW"})},907727:(l,p,b)=>{r.Ba("InstanceNormalization",l,{epsilon:p,format:b?"NHWC":"NCHW"})},907841:l=>{r.Ba("Range",l,void 0)},907894:(l,p)=>{r.Ba("Einsum",l,{equation:qe(p)})},907975:(l,p,b,x,O)=>{r.Ba("Pad",l,{mode:p,value:b,pads:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},908102:(l,p,b,x,O,W)=>{r.Ba("BatchNormalization",l,{epsilon:p,momentum:b,spatial:!!O,trainingMode:!!x,format:W?"NHWC":"NCHW"})},908271:(l,p,b,x,O,W)=>{r.Ba("BatchNormalization",l,{epsilon:p,momentum:b,spatial:!!O,trainingMode:!!x,format:W?"NHWC":"NCHW"})},908440:(l,p,b)=>{r.Ba("CumSum",l,{exclusive:Number(p),reverse:Number(b)})},908537:(l,p,b,x,O,W,L,te,ee)=>{r.Ba("Attention",l,{numHeads:p,isUnidirectional:b,maskFilterValue:x,scale:O,doRotary:W,qkvHiddenSizes:L?Array.from(T.subarray(Number(te)>>>0,Number(te)+L>>>0)):[],pastPresentShareBuffer:!!ee})},908809:l=>{r.Ba("Gelu",l,void 0)},908861:(l,p,b,x,O,W)=>{r.Ba("MultiHeadAttention",l,{numHeads:p,isUnidirectional:b,maskFilterValue:x,scale:O,doRotary:W})},909020:l=>{r.Ba("BiasAdd",l,void 0)},909075:l=>{r.Ba("BiasSplitGelu",l,void 0)},909136:(l,p)=>{r.Ba("SkipLayerNormalization",l,{epsilon:p})},909217:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie)=>{r.Ba("Conv",l,{format:ee?"NHWC":"NCHW",auto_pad:p,dilations:[b],group:x,kernel_shape:[O],pads:W?Array.from(T.subarray(W>>>0,L>>>0)):[],strides:[te],w_is_const:()=>!!R[ue>>>0],activation:qe(le),activation_params:ve?Array.from(ie.subarray(ve>>>0,Ie>>>0)):[]})},909587:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("Conv",l,{format:ve?"NHWC":"NCHW",auto_pad:p,dilations:[b,x],group:O,kernel_shape:[W,L],pads:te?Array.from(T.subarray(te>>>0,ee>>>0)):[],strides:[ue,le],w_is_const:()=>!!R[Ie>>>0],activation:qe(k),activation_params:de?Array.from(ie.subarray(de>>>0,Se>>>0)):[]})},909978:l=>{r.Za(l)},910012:(l,p)=>r.$a(l,p,r.Ja.ab,r.Ja.errors)};function Ue(l){this.name="ExitStatus",this.message=`Program terminated with exit(${l})`,this.status=l}function St(l){this.Na=l-24,this.Ua=function(p){H[this.Na+4>>>2>>>0]=p},this.Ta=function(p){H[this.Na+8>>>2>>>0]=p},this.Ra=function(p,b){this.Sa(),this.Ua(p),this.Ta(b)},this.Sa=function(){H[this.Na+16>>>2>>>0]=0}}var nt=0,zt=0,Tt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,xt=(l,p,b)=>{p>>>=0;var x=p+b;for(b=p;l[b]&&!(b>=x);)++b;if(16<b-p&&l.buffer&&Tt)return Tt.decode(l.subarray(p,b));for(x="";p<b;){var O=l[p++];if(O&128){var W=l[p++]&63;if((O&224)==192)x+=String.fromCharCode((O&31)<<6|W);else{var L=l[p++]&63;O=(O&240)==224?(O&15)<<12|W<<6|L:(O&7)<<18|W<<12|L<<6|l[p++]&63,65536>O?x+=String.fromCharCode(O):(O-=65536,x+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else x+=String.fromCharCode(O)}return x},qe=(l,p)=>(l>>>=0)?xt(N,l,p):"",rr=l=>{for(var p=0,b=0;b<l.length;++b){var x=l.charCodeAt(b);127>=x?p++:2047>=x?p+=2:55296<=x&&57343>=x?(p+=4,++b):p+=3}return p},Vt=(l,p,b,x)=>{if(b>>>=0,!(0<x))return 0;var O=b;x=b+x-1;for(var W=0;W<l.length;++W){var L=l.charCodeAt(W);if(55296<=L&&57343>=L){var te=l.charCodeAt(++W);L=65536+((L&1023)<<10)|te&1023}if(127>=L){if(b>=x)break;p[b++>>>0]=L}else{if(2047>=L){if(b+1>=x)break;p[b++>>>0]=192|L>>6}else{if(65535>=L){if(b+2>=x)break;p[b++>>>0]=224|L>>12}else{if(b+3>=x)break;p[b++>>>0]=240|L>>18,p[b++>>>0]=128|L>>12&63}p[b++>>>0]=128|L>>6&63}p[b++>>>0]=128|L&63}}return p[b>>>0]=0,b-O},_t=l=>l%4===0&&(l%100!==0||l%400===0),yt=[0,31,60,91,121,152,182,213,244,274,305,335],Nt=[0,31,59,90,120,151,181,212,243,273,304,334],Wt=l=>{var p=rr(l)+1,b=jt(p);return b&&Vt(l,N,b,p),b},Et=[],nr=(l,p)=>{Et.length=0;for(var b;b=N[l++>>>0];){var x=b!=105;x&=b!=112,p+=x&&p%8?4:0,Et.push(b==112?H[p>>>2>>>0]:b==105?T[p>>>2>>>0]:Z[p>>>3>>>0]),p+=x?8:4}return Et},ot={},or=()=>{if(!Ht){var l={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"},p;for(p in ot)ot[p]===void 0?delete l[p]:l[p]=ot[p];var b=[];for(p in l)b.push(`${p}=${l[p]}`);Ht=b}return Ht},Ht,Ye=[null,[],[]],yn=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return b=>crypto.getRandomValues(b);if(h)try{var l=ko("crypto");if(l.randomFillSync)return b=>l.randomFillSync(b);var p=l.randomBytes;return b=>(b.set(p(b.byteLength)),b)}catch{}he("initRandomDevice")},Oe=l=>(Oe=yn())(l),ar=[31,29,31,30,31,30,31,31,30,31,30,31],Gt=[31,28,31,30,31,30,31,31,30,31,30,31];function ir(l){var p=Array(rr(l)+1);return Vt(l,p,0,p.length),p}function Tr(l,p,b,x){function O(k,de,Se){for(k=typeof k=="number"?k.toString():k||"";k.length<de;)k=Se[0]+k;return k}function W(k,de){return O(k,de,"0")}function L(k,de){function Se(Ur){return 0>Ur?-1:0<Ur?1:0}var $t;return($t=Se(k.getFullYear()-de.getFullYear()))===0&&($t=Se(k.getMonth()-de.getMonth()))===0&&($t=Se(k.getDate()-de.getDate())),$t}function te(k){switch(k.getDay()){case 0:return new Date(k.getFullYear()-1,11,29);case 1:return k;case 2:return new Date(k.getFullYear(),0,3);case 3:return new Date(k.getFullYear(),0,2);case 4:return new Date(k.getFullYear(),0,1);case 5:return new Date(k.getFullYear()-1,11,31);case 6:return new Date(k.getFullYear()-1,11,30)}}function ee(k){var de=k.Ha;for(k=new Date(new Date(k.Ia+1900,0,1).getTime());0<de;){var Se=k.getMonth(),$t=(_t(k.getFullYear())?ar:Gt)[Se];if(de>$t-k.getDate())de-=$t-k.getDate()+1,k.setDate(1),11>Se?k.setMonth(Se+1):(k.setMonth(0),k.setFullYear(k.getFullYear()+1));else{k.setDate(k.getDate()+de);break}}return Se=new Date(k.getFullYear()+1,0,4),de=te(new Date(k.getFullYear(),0,4)),Se=te(Se),0>=L(de,k)?0>=L(Se,k)?k.getFullYear()+1:k.getFullYear():k.getFullYear()-1}l>>>=0,p>>>=0,b>>>=0,x>>>=0;var ue=H[x+40>>>2>>>0];x={eb:T[x>>>2>>>0],cb:T[x+4>>>2>>>0],La:T[x+8>>>2>>>0],Pa:T[x+12>>>2>>>0],Ma:T[x+16>>>2>>>0],Ia:T[x+20>>>2>>>0],Ga:T[x+24>>>2>>>0],Ha:T[x+28>>>2>>>0],hb:T[x+32>>>2>>>0],bb:T[x+36>>>2>>>0],fb:ue?qe(ue):""},b=qe(b),ue={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var le in ue)b=b.replace(new RegExp(le,"g"),ue[le]);var ve="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ie="January February March April May June July August September October November December".split(" ");ue={"%a":k=>ve[k.Ga].substring(0,3),"%A":k=>ve[k.Ga],"%b":k=>Ie[k.Ma].substring(0,3),"%B":k=>Ie[k.Ma],"%C":k=>W((k.Ia+1900)/100|0,2),"%d":k=>W(k.Pa,2),"%e":k=>O(k.Pa,2," "),"%g":k=>ee(k).toString().substring(2),"%G":k=>ee(k),"%H":k=>W(k.La,2),"%I":k=>(k=k.La,k==0?k=12:12<k&&(k-=12),W(k,2)),"%j":k=>{for(var de=0,Se=0;Se<=k.Ma-1;de+=(_t(k.Ia+1900)?ar:Gt)[Se++]);return W(k.Pa+de,3)},"%m":k=>W(k.Ma+1,2),"%M":k=>W(k.cb,2),"%n":()=>`\n`,"%p":k=>0<=k.La&&12>k.La?"AM":"PM","%S":k=>W(k.eb,2),"%t":()=>"\t","%u":k=>k.Ga||7,"%U":k=>W(Math.floor((k.Ha+7-k.Ga)/7),2),"%V":k=>{var de=Math.floor((k.Ha+7-(k.Ga+6)%7)/7);if(2>=(k.Ga+371-k.Ha-2)%7&&de++,de)de==53&&(Se=(k.Ga+371-k.Ha)%7,Se==4||Se==3&&_t(k.Ia)||(de=1));else{de=52;var Se=(k.Ga+7-k.Ha-1)%7;(Se==4||Se==5&&_t(k.Ia%400-1))&&de++}return W(de,2)},"%w":k=>k.Ga,"%W":k=>W(Math.floor((k.Ha+7-(k.Ga+6)%7)/7),2),"%y":k=>(k.Ia+1900).toString().substring(2),"%Y":k=>k.Ia+1900,"%z":k=>{k=k.bb;var de=0<=k;return k=Math.abs(k)/60,(de?"+":"-")+("0000"+(k/60*100+k%60)).slice(-4)},"%Z":k=>k.fb,"%%":()=>"%"},b=b.replace(/%%/g,"\\0\\0");for(le in ue)b.includes(le)&&(b=b.replace(new RegExp(le,"g"),ue[le](x)));return b=b.replace(/\\0\\0/g,"%"),le=ir(b),le.length>p?0:(R.set(le,l>>>0),le.length-1)}var Ot=l=>{try{l()}catch(p){he(p)}};function bn(){var l=oe,p={};for(let[b,x]of Object.entries(l))p[b]=typeof x=="function"?function(){Lt.push(b);try{return x.apply(null,arguments)}finally{A||(Lt.pop(),Je&&ne===1&&Lt.length===0&&(ne=0,Ot(vt),typeof Fibers<"u"&&Fibers.ib()))}}:x;return p}var ne=0,Je=null,sr=0,Lt=[],ur={},Er={},Or=0,Ft=null,Pr=[];function kr(){return new Promise((l,p)=>{Ft={resolve:l,reject:p}})}function lr(){var l=jt(65548),p=l+12;H[l>>>2>>>0]=p,H[l+4>>>2>>>0]=p+65536,p=Lt[0];var b=ur[p];return b===void 0&&(b=Or++,ur[p]=b,Er[b]=p),T[l+8>>>2>>>0]=b,l}function Br(l){if(!A){if(ne===0){var p=!1,b=!1;l((x=0)=>{if(!A&&(sr=x,p=!0,b)){ne=2,Ot(()=>gr(Je)),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),x=!1;try{var O=(0,oe[Er[T[Je+8>>>2>>>0]]])()}catch(te){O=te,x=!0}var W=!1;if(!Je){var L=Ft;L&&(Ft=null,(x?L.reject:L.resolve)(O),W=!0)}if(x&&!W)throw O}}),b=!0,p||(ne=1,Je=lr(),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),Ot(()=>Kt(Je)))}else ne===2?(ne=0,Ot(yr),mr(Je),Je=null,Pr.forEach(x=>{if(!A)try{x();try{z=z=x=z,r.onExit?.(x),A=!0,d(x,new Ue(x))}catch(O){O instanceof Ue||O=="unwind"||d(1,O)}}catch(O){O instanceof Ue||O=="unwind"||d(1,O)}})):he(`invalid state: ${ne}`);return sr}}function Rr(l){return Br(p=>{l().then(p)})}var bt=[],Xe,wt,dr=[],cr=(l,p)=>{if(!wt){wt=new WeakMap;var b=Xe.length;if(wt)for(var x=0;x<0+b;x++){var O=x,W=bt[O];W||(O>=bt.length&&(bt.length=O+1),bt[O]=W=Xe.get(O)),(O=W)&&wt.set(O,x)}}if(b=wt.get(l)||0)return b;if(dr.length)b=dr.pop();else{try{Xe.grow(1)}catch(te){throw te instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":te}b=Xe.length-1}try{x=b,Xe.set(x,l),bt[x]=Xe.get(x)}catch(te){if(!(te instanceof TypeError))throw te;if(typeof WebAssembly.Function=="function"){x=WebAssembly.Function,O={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},W={parameters:[],results:p[0]=="v"?[]:[O[p[0]]]};for(var L=1;L<p.length;++L)W.parameters.push(O[p[L]]);p=new x(W,l)}else{for(x=[1],O=p.slice(0,1),p=p.slice(1),W={i:127,p:127,j:126,f:125,d:124,e:111},x.push(96),L=p.length,128>L?x.push(L):x.push(L%128|128,L>>7),L=0;L<p.length;++L)x.push(W[p[L]]);O=="v"?x.push(0):x.push(1,W[O]),p=[0,97,115,109,1,0,0,0,1],O=x.length,128>O?p.push(O):p.push(O%128|128,O>>7),p.push.apply(p,x),p.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),p=new WebAssembly.Module(new Uint8Array(p)),p=new WebAssembly.Instance(p,{e:{f:l}}).exports.f}x=b,Xe.set(x,p),bt[x]=Xe.get(x)}return wt.set(l,b),b},Dr={n:function(l,p,b){return Rr(async()=>{await r.Xa(l,p,b)})},a:function(l,p,b){throw l>>>=0,new St(l).Ra(p>>>0,b>>>0),nt=l,zt++,nt},g:function(){return 0},M:function(){},C:function(){},E:function(){},v:function(){return 0},K:function(){},F:function(){},J:function(){},m:function(){},D:function(){},A:function(){},L:function(){},B:function(){},N:()=>1,q:function(l,p,b){l=p+2097152>>>0<4194305-!!l?(l>>>0)+4294967296*p:NaN,b>>>=0,l=new Date(1e3*l),T[b>>>2>>>0]=l.getUTCSeconds(),T[b+4>>>2>>>0]=l.getUTCMinutes(),T[b+8>>>2>>>0]=l.getUTCHours(),T[b+12>>>2>>>0]=l.getUTCDate(),T[b+16>>>2>>>0]=l.getUTCMonth(),T[b+20>>>2>>>0]=l.getUTCFullYear()-1900,T[b+24>>>2>>>0]=l.getUTCDay(),T[b+28>>>2>>>0]=(l.getTime()-Date.UTC(l.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},r:function(l,p,b){l=p+2097152>>>0<4194305-!!l?(l>>>0)+4294967296*p:NaN,b>>>=0,l=new Date(1e3*l),T[b>>>2>>>0]=l.getSeconds(),T[b+4>>>2>>>0]=l.getMinutes(),T[b+8>>>2>>>0]=l.getHours(),T[b+12>>>2>>>0]=l.getDate(),T[b+16>>>2>>>0]=l.getMonth(),T[b+20>>>2>>>0]=l.getFullYear()-1900,T[b+24>>>2>>>0]=l.getDay(),T[b+28>>>2>>>0]=(_t(l.getFullYear())?yt:Nt)[l.getMonth()]+l.getDate()-1|0,T[b+36>>>2>>>0]=-(60*l.getTimezoneOffset()),p=new Date(l.getFullYear(),6,1).getTimezoneOffset();var x=new Date(l.getFullYear(),0,1).getTimezoneOffset();T[b+32>>>2>>>0]=(p!=x&&l.getTimezoneOffset()==Math.min(x,p))|0},s:function(l){l>>>=0;var p=new Date(T[l+20>>>2>>>0]+1900,T[l+16>>>2>>>0],T[l+12>>>2>>>0],T[l+8>>>2>>>0],T[l+4>>>2>>>0],T[l>>>2>>>0],0),b=T[l+32>>>2>>>0],x=p.getTimezoneOffset(),O=new Date(p.getFullYear(),6,1).getTimezoneOffset(),W=new Date(p.getFullYear(),0,1).getTimezoneOffset(),L=Math.min(W,O);return 0>b?T[l+32>>>2>>>0]=+(O!=W&&L==x):0<b!=(L==x)&&(O=Math.max(W,O),p.setTime(p.getTime()+6e4*((0<b?L:O)-x))),T[l+24>>>2>>>0]=p.getDay(),T[l+28>>>2>>>0]=(_t(p.getFullYear())?yt:Nt)[p.getMonth()]+p.getDate()-1|0,T[l>>>2>>>0]=p.getSeconds(),T[l+4>>>2>>>0]=p.getMinutes(),T[l+8>>>2>>>0]=p.getHours(),T[l+12>>>2>>>0]=p.getDate(),T[l+16>>>2>>>0]=p.getMonth(),T[l+20>>>2>>>0]=p.getYear(),l=p.getTime(),isNaN(l)?(T[pr()>>>2>>>0]=61,l=-1):l/=1e3,fr((ze=l,1<=+Math.abs(ze)?0<ze?+Math.floor(ze/4294967296)>>>0:~~+Math.ceil((ze-+(~~ze>>>0))/4294967296)>>>0:0)),l>>>0},o:function(){return-52},p:function(){},y:function(l,p,b){function x(ee){return(ee=ee.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ee[1]:"GMT"}b>>>=0;var O=new Date().getFullYear(),W=new Date(O,0,1),L=new Date(O,6,1);O=W.getTimezoneOffset();var te=L.getTimezoneOffset();H[l>>>0>>>2>>>0]=60*Math.max(O,te),T[p>>>0>>>2>>>0]=+(O!=te),l=x(W),p=x(L),l=Wt(l),p=Wt(p),te<O?(H[b>>>2>>>0]=l,H[b+4>>>2>>>0]=p):(H[b>>>2>>>0]=p,H[b+4>>>2>>>0]=l)},e:()=>{he("")},b:function(l,p,b){return l>>>=0,p=nr(p>>>0,b>>>0),Ve[l].apply(null,p)},j:function(l,p,b){return l>>>=0,p=nr(p>>>0,b>>>0),Ve[l].apply(null,p)},h:()=>Date.now(),z:function(){return 4294901760},c:()=>performance.now(),I:function(l,p,b){return p>>>=0,N.copyWithin(l>>>0>>>0,p>>>0,p+(b>>>0)>>>0)},w:function(l){l>>>=0;var p=N.length;if(4294901760<l)return!1;for(var b=1;4>=b;b*=2){var x=p*(1+.2/b);x=Math.min(x,l+100663296);var O=Math;x=Math.max(l,x);e:{O=(O.min.call(O,4294901760,x+(65536-x%65536)%65536)-P.buffer.byteLength+65535)/65536;try{P.grow(O),K();var W=1;break e}catch{}W=void 0}if(W)return!0}return!1},G:function(l,p){l>>>=0,p>>>=0;var b=0;return or().forEach((x,O)=>{var W=p+b;for(O=H[l+4*O>>>2>>>0]=W,W=0;W<x.length;++W)R[O++>>>0>>>0]=x.charCodeAt(W);R[O>>>0>>>0]=0,b+=x.length+1}),0},H:function(l,p){l>>>=0,p>>>=0;var b=or();H[l>>>2>>>0]=b.length;var x=0;return b.forEach(O=>x+=O.length+1),H[p>>>2>>>0]=x,0},f:()=>52,l:function(){return 52},t:function(){return 70},k:function(l,p,b,x){p>>>=0,b>>>=0,x>>>=0;for(var O=0,W=0;W<b;W++){var L=H[p>>>2>>>0],te=H[p+4>>>2>>>0];p+=8;for(var ee=0;ee<te;ee++){var ue=N[L+ee>>>0],le=Ye[l];ue===0||ue===10?((l===1?S:_)(xt(le,0)),le.length=0):le.push(ue)}O+=te}return H[x>>>2>>>0]=O,0},u:function(l,p){return l>>>=0,Oe(N.subarray(l>>>0,l+(p>>>0)>>>0)),0},x:Tr,d:function(l,p,b,x){return Tr(l>>>0,p>>>0,b>>>0,x>>>0)},i:function(l,p,b,x){let O=Xe.length;l=new Uint8Array(N.slice(l+p,l+b));try{var W=new WebAssembly.Module(l),L=new WebAssembly.Instance(W,{env:{memory:P}}),te;for(te in L.exports)cr(L.exports[te]);return O<Xe.length?O:x}catch(ee){return console.log(ee),x}}},oe=function(){function l(b){return oe=b.exports,oe=bn(),oe=Mr(),P=oe.O,K(),Xe=oe.wa,X.unshift(oe.P),Pe--,Pe==0&&(fe!==null&&(clearInterval(fe),fe=null),Ce&&(b=Ce,Ce=null,b())),oe}var p={a:Dr};if(Pe++,r.instantiateWasm)try{return r.instantiateWasm(p,l)}catch(b){_(`Module.instantiateWasm callback failed with error: ${b}`),n(b)}return rt(p,function(b){l(b.instance)}).catch(n),{}}();r._OrtInit=(l,p)=>(r._OrtInit=oe.Q)(l,p),r._OrtGetLastError=(l,p)=>(r._OrtGetLastError=oe.R)(l,p),r._OrtCreateSessionOptions=(l,p,b,x,O,W,L,te,ee,ue)=>(r._OrtCreateSessionOptions=oe.S)(l,p,b,x,O,W,L,te,ee,ue),r._OrtAppendExecutionProvider=(l,p)=>(r._OrtAppendExecutionProvider=oe.T)(l,p),r._OrtAddFreeDimensionOverride=(l,p,b)=>(r._OrtAddFreeDimensionOverride=oe.U)(l,p,b),r._OrtAddSessionConfigEntry=(l,p,b)=>(r._OrtAddSessionConfigEntry=oe.V)(l,p,b),r._OrtReleaseSessionOptions=l=>(r._OrtReleaseSessionOptions=oe.W)(l),r._OrtCreateSession=(l,p,b)=>(r._OrtCreateSession=oe.X)(l,p,b),r._OrtReleaseSession=l=>(r._OrtReleaseSession=oe.Y)(l),r._OrtGetInputOutputCount=(l,p,b)=>(r._OrtGetInputOutputCount=oe.Z)(l,p,b),r._OrtGetInputName=(l,p)=>(r._OrtGetInputName=oe._)(l,p),r._OrtGetOutputName=(l,p)=>(r._OrtGetOutputName=oe.$)(l,p),r._OrtFree=l=>(r._OrtFree=oe.aa)(l),r._OrtCreateTensor=(l,p,b,x,O,W)=>(r._OrtCreateTensor=oe.ba)(l,p,b,x,O,W),r._OrtGetTensorData=(l,p,b,x,O)=>(r._OrtGetTensorData=oe.ca)(l,p,b,x,O),r._OrtReleaseTensor=l=>(r._OrtReleaseTensor=oe.da)(l),r._OrtCreateRunOptions=(l,p,b,x)=>(r._OrtCreateRunOptions=oe.ea)(l,p,b,x),r._OrtAddRunConfigEntry=(l,p,b)=>(r._OrtAddRunConfigEntry=oe.fa)(l,p,b),r._OrtReleaseRunOptions=l=>(r._OrtReleaseRunOptions=oe.ga)(l),r._OrtCreateBinding=l=>(r._OrtCreateBinding=oe.ha)(l),r._OrtBindInput=(l,p,b)=>(r._OrtBindInput=oe.ia)(l,p,b),r._OrtBindOutput=(l,p,b,x)=>(r._OrtBindOutput=oe.ja)(l,p,b,x),r._OrtClearBoundOutputs=l=>(r._OrtClearBoundOutputs=oe.ka)(l),r._OrtReleaseBinding=l=>(r._OrtReleaseBinding=oe.la)(l),r._OrtRunWithBinding=(l,p,b,x,O)=>(r._OrtRunWithBinding=oe.ma)(l,p,b,x,O),r._OrtRun=(l,p,b,x,O,W,L,te)=>(r._OrtRun=oe.na)(l,p,b,x,O,W,L,te),r._OrtEndProfiling=l=>(r._OrtEndProfiling=oe.oa)(l),r._OrtConfigure=(l,p)=>(r._OrtConfigure=oe.pa)(l,p),r._OrtAuth=(l,p)=>(r._OrtAuth=oe.qa)(l,p),r._JsepOutput=(l,p,b)=>(r._JsepOutput=oe.ra)(l,p,b),r._JsepGetNodeName=l=>(r._JsepGetNodeName=oe.sa)(l);var pr=()=>(pr=oe.ta)(),jt=r._malloc=l=>(jt=r._malloc=oe.ua)(l),mr=r._free=l=>(mr=r._free=oe.va)(l),fr=l=>(fr=oe.xa)(l),hr=()=>(hr=oe.ya)(),qt=l=>(qt=oe.za)(l),Pt=l=>(Pt=oe.Aa)(l),Kt=l=>(Kt=oe.Ca)(l),vt=()=>(vt=oe.Da)(),gr=l=>(gr=oe.Ea)(l),yr=()=>(yr=oe.Fa)();r.___start_em_js=910124,r.___stop_em_js=910897;function Mr(){var l=oe;l=Object.assign({},l);var p=x=>()=>x()>>>0,b=x=>O=>x(O)>>>0;return l.ta=p(l.ta),l.ua=b(l.ua),l.ya=p(l.ya),l.Aa=b(l.Aa),l}r.stackAlloc=Pt,r.stackSave=hr,r.stackRestore=qt,r.addFunction=cr,r.UTF8ToString=qe,r.stringToUTF8=(l,p,b)=>Vt(l,N,p,b),r.lengthBytesUTF8=rr;var kt;Ce=function l(){kt||br(),kt||(Ce=l)};function br(){if(!(0<Pe)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;){var l=r.preRun.shift();Q.unshift(l)}for(;0<Q.length;)Q.shift()(r);if(!(0<Pe||kt||(kt=!0,r.calledRun=!0,A))){for(;0<X.length;)X.shift()(r);for(o(r);0<Ee.length;)Ee.shift()(r)}}}return br(),t.ready}})();typeof Do=="object"&&typeof On=="object"?On.exports=Ro:typeof define=="function"&&define.amd&&define([],()=>Ro)});var Uo=wr(()=>{});var zo=wr(()=>{});var Vo={};Gr(Vo,{cpus:()=>sl});var sl,No=q(()=>{sl=void 0});var Go=wr((Ho,Pn)=>{"use strict";var Wo=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){function r(){return Q.buffer!=fe.buffer&&Ge(),fe}function o(){return Q.buffer!=fe.buffer&&Ge(),Ce}function n(){return Q.buffer!=fe.buffer&&Ge(),he}function s(){return Q.buffer!=fe.buffer&&Ge(),ye}function u(){return Q.buffer!=fe.buffer&&Ge(),We}function d(){return Q.buffer!=fe.buffer&&Ge(),Me}var a=t,m,h;a.ready=new Promise((i,c)=>{m=i,h=c}),a.mountExternalData=(i,c)=>{(a.ib||(a.ib=new Map)).set(i,c)},a.unmountExternalData=()=>{delete a.ib},a.jsepInit=(i,c,f,$,E,D,U,J)=>{a.Rb=i,a.Bb=c,a.Db=f,a.pb=$,a.Cb=E,a.Ua=D,a.Eb=U,a.Fb=J,c=(ae,se,pe)=>(...xe)=>{let Te=ut,B=se?.();xe=ae(...xe);let me=se?.();return B!==me&&(ae=me,pe(B),se=pe=null),ut!=Te?ju():xe},f=ae=>async(...se)=>{try{if(a.hb)throw Error("Session already started");let pe=a.hb={Hb:se[0],errors:[]},xe=await ae(...se);if(a.hb!==pe)throw Error("Session mismatch");i.flush();let Te=pe.errors;if(0<Te.length){let B=await Promise.all(Te);if(B=B.filter(me=>me),0<B.length)throw Error(B.join(`\n`))}return xe}finally{a.hb=null}},a._OrtRun=f(c(a._OrtRun,()=>a._OrtRun,ae=>a._OrtRun=ae)),a._OrtRunWithBinding=f(c(a._OrtRunWithBinding,()=>a._OrtRunWithBinding,ae=>a._OrtRunWithBinding=ae)),a._OrtBindInput=c(a._OrtBindInput,()=>a._OrtBindInput,ae=>a._OrtBindInput=ae),a.jsepRegisterBuffer=(ae,se,pe,xe)=>i.registerBuffer(ae,se,pe,xe),a.jsepUnregisterBuffers=ae=>{i.unregisterBuffers(ae)},a.jsepGetBuffer=ae=>i.getBuffer(ae),a.jsepCreateDownloader=(ae,se,pe)=>i.createDownloader(ae,se,pe)};var g=Object.assign({},a),w="./this.program",v=(i,c)=>{throw c},y=typeof window=="object",C=typeof importScripts=="function",I=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",S=a.ENVIRONMENT_IS_PTHREAD||!1,_="";function P(i){return a.locateFile?a.locateFile(i,_):_+i}var A,z,R;if(I){var N=(An(),Jt(In)),T=(En(),Jt(Tn));_=C?T.dirname(_)+"/":__dirname+"/",A=(c,f)=>(c=Tt(c)?new URL(c):T.normalize(c),N.readFileSync(c,f?void 0:"utf8")),R=c=>(c=A(c,!0),c.buffer||(c=new Uint8Array(c)),c),z=(c,f,$,E=!0)=>{c=Tt(c)?new URL(c):T.normalize(c),N.readFile(c,E?void 0:"utf8",(D,U)=>{D?$(D):f(E?U.buffer:U)})},!a.thisProgram&&1<process.argv.length&&(w=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),v=(c,f)=>{throw process.exitCode=c,f},a.inspect=()=>"[Emscripten Module object]";let i;try{i=Uo()}catch(c){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),c}global.Worker=i.Worker}else(y||C)&&(C?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),typeof e<"u"&&e&&(_=e),_.indexOf("blob:")!==0?_=_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1):_="",I||(A=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.send(null),c.responseText},C&&(R=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.responseType="arraybuffer",c.send(null),new Uint8Array(c.response)}),z=(i,c,f)=>{var $=new XMLHttpRequest;$.open("GET",i,!0),$.responseType="arraybuffer",$.onload=()=>{$.status==200||$.status==0&&$.response?c($.response):f()},$.onerror=f,$.send(null)}));I&&typeof performance>"u"&&(global.performance=zo().performance);var H=console.log.bind(console),ie=console.error.bind(console);I&&(H=(...i)=>N.writeSync(1,i.join(" ")+`\n`),ie=(...i)=>N.writeSync(2,i.join(" ")+`\n`));var Z=H,K=ie;Object.assign(a,g),g=null,typeof WebAssembly!="object"&&nt("no native wasm support detected");var Q,X,Ee=!1,Pe,fe,Ce,he,ye,We,Me;function Ge(){var i=Q.buffer;a.HEAP8=fe=new Int8Array(i),a.HEAP16=new Int16Array(i),a.HEAPU8=Ce=new Uint8Array(i),a.HEAPU16=new Uint16Array(i),a.HEAP32=he=new Int32Array(i),a.HEAPU32=ye=new Uint32Array(i),a.HEAPF32=We=new Float32Array(i),a.HEAPF64=Me=new Float64Array(i)}var G=16777216;if(S)Q=a.wasmMemory;else if(a.wasmMemory)Q=a.wasmMemory;else if(Q=new WebAssembly.Memory({initial:G/65536,maximum:65536,shared:!0}),!(Q.buffer instanceof SharedArrayBuffer))throw K("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),I&&K("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ge(),G=Q.buffer.byteLength;var re=[],be=[],rt=[],ze=0,Ve=null,Ue=null;function St(){if(ze--,ze==0&&(Ve!==null&&(clearInterval(Ve),Ve=null),Ue)){var i=Ue;Ue=null,i()}}function nt(i){throw i="Aborted("+i+")",K(i),Ee=!0,Pe=1,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),h(i),i}var zt=i=>i.startsWith("data:application/octet-stream;base64,"),Tt=i=>i.startsWith("file://"),xt;xt="ort-wasm-simd-threaded.wasm",zt(xt)||(xt=P(xt));function qe(i){if(R)return R(i);throw"both async and sync fetching of the wasm failed"}function rr(i){if(y||C){if(typeof fetch=="function"&&!Tt(i))return fetch(i,{credentials:"same-origin"}).then(c=>{if(!c.ok)throw"failed to load wasm binary file at \'"+i+"\'";return c.arrayBuffer()}).catch(()=>qe(i));if(z)return new Promise((c,f)=>{z(i,$=>c(new Uint8Array($)),f)})}return Promise.resolve().then(()=>qe(i))}function Vt(i,c,f){return rr(i).then($=>WebAssembly.instantiate($,c)).then($=>$).then(f,$=>{K(`failed to asynchronously prepare wasm: ${$}`),nt($)})}function _t(i,c){var f=xt;return typeof WebAssembly.instantiateStreaming!="function"||zt(f)||Tt(f)||I||typeof fetch!="function"?Vt(f,i,c):fetch(f,{credentials:"same-origin"}).then($=>WebAssembly.instantiateStreaming($,i).then(c,function(E){return K(`wasm streaming compile failed: ${E}`),K("falling back to ArrayBuffer instantiation"),Vt(f,i,c)}))}var yt,Nt={902596:(i,c,f,$)=>{if(typeof a>"u"||!a.ib)return 1;if(i=Ye(i>>>0),i.startsWith("./")&&(i=i.substring(2)),i=a.ib.get(i),!i)return 2;if(c>>>=0,f>>>=0,$>>>=0,c+f>i.byteLength)return 3;try{return o().set(i.subarray(c,c+f),$>>>0),0}catch{return 4}},903097:i=>a.Bb(i),903130:i=>a.Db(i),903162:(i,c,f)=>{a.pb(i,c,f,!0)},903201:(i,c,f)=>{a.pb(i,c,f)},903234:i=>{a.Ua("Abs",i,void 0)},903285:i=>{a.Ua("Neg",i,void 0)},903336:i=>{a.Ua("Floor",i,void 0)},903389:i=>{a.Ua("Ceil",i,void 0)},903441:i=>{a.Ua("Reciprocal",i,void 0)},903499:i=>{a.Ua("Sqrt",i,void 0)},903551:i=>{a.Ua("Exp",i,void 0)},903602:i=>{a.Ua("Erf",i,void 0)},903653:i=>{a.Ua("Sigmoid",i,void 0)},903708:i=>{a.Ua("Log",i,void 0)},903759:i=>{a.Ua("Sin",i,void 0)},903810:i=>{a.Ua("Cos",i,void 0)},903861:i=>{a.Ua("Tan",i,void 0)},903912:i=>{a.Ua("Asin",i,void 0)},903964:i=>{a.Ua("Acos",i,void 0)},904016:i=>{a.Ua("Atan",i,void 0)},904068:i=>{a.Ua("Sinh",i,void 0)},904120:i=>{a.Ua("Cosh",i,void 0)},904172:i=>{a.Ua("Asinh",i,void 0)},904225:i=>{a.Ua("Acosh",i,void 0)},904278:i=>{a.Ua("Atanh",i,void 0)},904331:i=>{a.Ua("Tanh",i,void 0)},904383:i=>{a.Ua("Not",i,void 0)},904434:(i,c,f)=>{a.Ua("Clip",i,{min:c,max:f})},904503:i=>{a.Ua("Clip",i,void 0)},904555:(i,c)=>{a.Ua("Elu",i,{alpha:c})},904613:i=>{a.Ua("Relu",i,void 0)},904665:(i,c)=>{a.Ua("LeakyRelu",i,{alpha:c})},904729:(i,c)=>{a.Ua("ThresholdedRelu",i,{alpha:c})},904799:(i,c)=>{a.Ua("Cast",i,{to:c})},904857:i=>{a.Ua("Add",i,void 0)},904908:i=>{a.Ua("Sub",i,void 0)},904959:i=>{a.Ua("Mul",i,void 0)},905010:i=>{a.Ua("Div",i,void 0)},905061:i=>{a.Ua("Pow",i,void 0)},905112:i=>{a.Ua("Equal",i,void 0)},905165:i=>{a.Ua("Greater",i,void 0)},905220:i=>{a.Ua("GreaterOrEqual",i,void 0)},905282:i=>{a.Ua("Less",i,void 0)},905334:i=>{a.Ua("LessOrEqual",i,void 0)},905393:(i,c,f,$,E)=>{a.Ua("ReduceMean",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905552:(i,c,f,$,E)=>{a.Ua("ReduceMax",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905710:(i,c,f,$,E)=>{a.Ua("ReduceMin",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905868:(i,c,f,$,E)=>{a.Ua("ReduceProd",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906027:(i,c,f,$,E)=>{a.Ua("ReduceSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906185:(i,c,f,$,E)=>{a.Ua("ReduceL1",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906342:(i,c,f,$,E)=>{a.Ua("ReduceL2",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906499:(i,c,f,$,E)=>{a.Ua("ReduceLogSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906660:(i,c,f,$,E)=>{a.Ua("ReduceSumSquare",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906824:(i,c,f,$,E)=>{a.Ua("ReduceLogSumExp",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906988:i=>{a.Ua("Where",i,void 0)},907041:(i,c,f)=>{a.Ua("Transpose",i,{perm:c?Array.from(n().subarray(c>>>0,f>>>0)):[]})},907149:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me)=>{a.Ua("ConvTranspose",i,{format:ae?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[E],pads:[D,U],strides:[J],wIsConst:()=>!!r()[se>>>0],outputPadding:pe?Array.from(n().subarray(pe>>>0,xe>>>0)):[],outputShape:Te?Array.from(n().subarray(Te>>>0,B>>>0)):[],activation:Ye(me)})},907551:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B)=>{a.Ua("ConvTranspose",i,{format:J?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(E>>>0,(E>>>0)+2>>>0)),pads:Array.from(n().subarray(D>>>0,(D>>>0)+4>>>0)),strides:Array.from(n().subarray(U>>>0,(U>>>0)+2>>>0)),wIsConst:()=>!!r()[ae>>>0],outputPadding:se?Array.from(n().subarray(se>>>0,pe>>>0)):[],outputShape:xe?Array.from(n().subarray(xe>>>0,Te>>>0)):[],activation:Ye(B)})},908116:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me)=>{a.Ua("ConvTranspose",i,{format:ae?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[E],pads:[D,U],strides:[J],wIsConst:()=>!!r()[se>>>0],outputPadding:pe?Array.from(n().subarray(pe>>>0,xe>>>0)):[],outputShape:Te?Array.from(n().subarray(Te>>>0,B>>>0)):[],activation:Ye(me)})},908518:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B)=>{a.Ua("ConvTranspose",i,{format:J?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(E>>>0,(E>>>0)+2>>>0)),pads:Array.from(n().subarray(D>>>0,(D>>>0)+4>>>0)),strides:Array.from(n().subarray(U>>>0,(U>>>0)+2>>>0)),wIsConst:()=>!!r()[ae>>>0],outputPadding:se?Array.from(n().subarray(se>>>0,pe>>>0)):[],outputShape:xe?Array.from(n().subarray(xe>>>0,Te>>>0)):[],activation:Ye(B)})},909083:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909174:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("AveragePool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},909458:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909549:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("AveragePool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},909833:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},909920:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("MaxPool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},910200:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},910287:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("MaxPool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},910567:(i,c,f,$,E)=>{a.Ua("Gemm",i,{alpha:c,beta:f,transA:$,transB:E})},910671:i=>{a.Ua("MatMul",i,void 0)},910725:(i,c,f,$)=>{a.Ua("ArgMax",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},910833:(i,c,f,$)=>{a.Ua("ArgMin",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},910941:(i,c)=>{a.Ua("Softmax",i,{axis:c})},911004:(i,c)=>{a.Ua("Concat",i,{axis:c})},911064:(i,c,f,$,E)=>{a.Ua("Split",i,{axis:c,numOutputs:f,splitSizes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},911204:i=>{a.Ua("Expand",i,void 0)},911258:(i,c)=>{a.Ua("Gather",i,{axis:Number(c)})},911329:(i,c)=>{a.Ua("GatherElements",i,{axis:Number(c)})},911408:(i,c,f,$,E,D,U,J,ae,se,pe)=>{a.Ua("Resize",i,{antialias:c,axes:f?Array.from(n().subarray(f>>>0,$>>>0)):[],coordinateTransformMode:Ye(E),cubicCoeffA:D,excludeOutside:U,extrapolationValue:J,keepAspectRatioPolicy:Ye(ae),mode:Ye(se),nearestMode:Ye(pe)})},911754:(i,c,f,$,E,D,U)=>{a.Ua("Slice",i,{starts:c?Array.from(n().subarray(c>>>0,f>>>0)):[],ends:$?Array.from(n().subarray($>>>0,E>>>0)):[],axes:D?Array.from(n().subarray(D>>>0,U>>>0)):[]})},911970:i=>{a.Ua("Tile",i,void 0)},912022:(i,c,f)=>{a.Ua("LayerNormalization",i,{axis:Number(c),epsilon:Number(f)})},912129:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912243:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912357:i=>{a.Ua("Range",i,void 0)},912410:(i,c)=>{a.Ua("Einsum",i,{equation:Ye(c)})},912491:(i,c,f,$,E)=>{a.Ua("Pad",i,{mode:c,value:f,pads:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},912618:(i,c,f,$,E,D)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!E,trainingMode:!!$,format:D?"NHWC":"NCHW"})},912787:(i,c,f,$,E,D)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!E,trainingMode:!!$,format:D?"NHWC":"NCHW"})},912956:(i,c,f)=>{a.Ua("CumSum",i,{exclusive:Number(c),reverse:Number(f)})},913053:(i,c,f,$,E,D,U,J,ae)=>{a.Ua("Attention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:E,doRotary:D,qkvHiddenSizes:U?Array.from(n().subarray(Number(J)>>>0,Number(J)+U>>>0)):[],pastPresentShareBuffer:!!ae})},913325:i=>{a.Ua("Gelu",i,void 0)},913377:(i,c,f,$,E,D)=>{a.Ua("MultiHeadAttention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:E,doRotary:D})},913536:i=>{a.Ua("BiasAdd",i,void 0)},913591:i=>{a.Ua("BiasSplitGelu",i,void 0)},913652:(i,c)=>{a.Ua("SkipLayerNormalization",i,{epsilon:c})},913733:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te)=>{a.Ua("Conv",i,{format:ae?"NHWC":"NCHW",auto_pad:c,dilations:[f],group:$,kernel_shape:[E],pads:D?Array.from(n().subarray(D>>>0,U>>>0)):[],strides:[J],w_is_const:()=>!!r()[se>>>0],activation:Ye(pe),activation_params:xe?Array.from(u().subarray(xe>>>0,Te>>>0)):[]})},914103:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("Conv",i,{format:xe?"NHWC":"NCHW",auto_pad:c,dilations:[f,$],group:E,kernel_shape:[D,U],pads:J?Array.from(n().subarray(J>>>0,ae>>>0)):[],strides:[se,pe],w_is_const:()=>!!r()[Te>>>0],activation:Ye(B),activation_params:me?Array.from(u().subarray(me>>>0,_e>>>0)):[]})},914494:i=>{a.Eb(i)},914528:(i,c)=>a.Fb(i,c,a.hb.Hb,a.hb.errors)};function Wt(i){this.name="ExitStatus",this.message=`Program terminated with exit(${i})`,this.status=i}var Et=i=>{i.terminate(),i.onmessage=()=>{}},nr=i=>{ne.cb.length==0&&(Ot(),ne.qb(ne.cb[0]));var c=ne.cb.pop();if(!c)return 6;ne.eb.push(c),ne.$a[i.bb]=c,c.bb=i.bb;var f={cmd:"run",start_routine:i.Ib,arg:i.xb,pthread_ptr:i.bb};return I&&c.unref(),c.postMessage(f,i.Ob),0},ot=0,or=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ht=(i,c,f)=>{c>>>=0;var $=c+f;for(f=c;i[f]&&!(f>=$);)++f;if(16<f-c&&i.buffer&&or)return or.decode(i.buffer instanceof SharedArrayBuffer?i.slice(c,f):i.subarray(c,f));for($="";c<f;){var E=i[c++];if(E&128){var D=i[c++]&63;if((E&224)==192)$+=String.fromCharCode((E&31)<<6|D);else{var U=i[c++]&63;E=(E&240)==224?(E&15)<<12|D<<6|U:(E&7)<<18|D<<12|U<<6|i[c++]&63,65536>E?$+=String.fromCharCode(E):(E-=65536,$+=String.fromCharCode(55296|E>>10,56320|E&1023))}}else $+=String.fromCharCode(E)}return $},Ye=(i,c)=>(i>>>=0)?Ht(o(),i,c):"",yn=i=>{var c=xn();return i=i(),Wr(c),i};function Oe(i,c){var f=arguments.length-2,$=arguments;return yn(()=>{for(var E=_n(8*f),D=E>>>3,U=0;U<f;U++){var J=$[2+U];d()[D+U>>>0]=J}return $o(i,f,E,c)})}function ar(i){if(S)return Oe(0,1,i);Pe=i,0<ot||(ne.Jb(),a.onExit?.(i),Ee=!0),v(i,new Wt(i))}var Gt=i=>{if(Pe=i,S)throw sr(i),"unwind";ar(i)},ir=i=>{i instanceof Wt||i=="unwind"||v(1,i)};function Tr(){for(var i=a.numThreads;i--;)Ot();re.unshift(()=>{ze++,bn(()=>St())})}function Ot(){var i=P("ort-wasm-simd-threaded.worker.js");i=new Worker(i),ne.cb.push(i)}function bn(i){S?i():Promise.all(ne.cb.map(ne.qb)).then(i)}var ne={cb:[],eb:[],ub:[],$a:{},mb(){S?(ne.receiveObjectTransfer=ne.Gb,ne.threadInitTLS=ne.tb,ne.setExitStatus=ne.sb):Tr()},sb:i=>Pe=i,Sb:["$terminateWorker"],Jb:()=>{for(var i of ne.eb)Et(i);for(i of ne.cb)Et(i);ne.cb=[],ne.eb=[],ne.$a=[]},rb:i=>{var c=i.bb;delete ne.$a[c],ne.cb.push(i),ne.eb.splice(ne.eb.indexOf(i),1),i.bb=0,$n(c)},Gb(){},tb(){ne.ub.forEach(i=>i())},qb:i=>new Promise(c=>{i.onmessage=D=>{D=D.data;var U=D.cmd;if(D.targetThread&&D.targetThread!=Nr()){var J=ne.$a[D.targetThread];J?J.postMessage(D,D.transferList):K(`Internal error! Worker sent a message "${U}" to target pthread ${D.targetThread}, but that thread no longer exists!`)}else U==="checkMailbox"?Pt():U==="spawnThread"?nr(D):U==="cleanupThread"?ne.rb(ne.$a[D.thread]):U==="killThread"?(D=D.thread,U=ne.$a[D],delete ne.$a[D],Et(U),$n(D),ne.eb.splice(ne.eb.indexOf(U),1),U.bb=0):U==="cancelThread"?ne.$a[D.thread].postMessage({cmd:"cancel"}):U==="loaded"?(i.loaded=!0,I&&!i.bb&&i.unref(),c(i)):U==="alert"?alert(`Thread ${D.threadId}: ${D.text}`):D.target==="setimmediate"?i.postMessage(D):U==="callHandler"?a[D.handler](...D.args):U&&K(`worker sent an unknown command ${U}`)},i.onerror=D=>{throw K(`worker sent an error! ${D.filename}:${D.lineno}: ${D.message}`),D},I&&(i.on("message",D=>i.onmessage({data:D})),i.on("error",D=>i.onerror(D)));var f=[],$=["onExit"],E;for(E of $)a.hasOwnProperty(E)&&f.push(E);i.postMessage({cmd:"load",handlers:f,urlOrBlob:a.mainScriptUrlOrBlob||e,wasmMemory:Q,wasmModule:X})})};a.PThread=ne;var Je=i=>{for(;0<i.length;)i.shift()(a)};a.establishStackSpace=()=>{var i=Nr(),c=s()[i+52>>>2>>>0];i=s()[i+56>>>2>>>0],_o(c,c-i),Wr(c)};function sr(i){if(S)return Oe(1,0,i);Gt(i)}a.invokeEntryPoint=(i,c)=>{i=Co.apply(null,[i,c]),0<ot?ne.sb(i):Sn(i)};function Lt(i){this.lb=i-24,this.yb=function(c){s()[this.lb+4>>>2>>>0]=c},this.wb=function(c){s()[this.lb+8>>>2>>>0]=c},this.mb=function(c,f){this.vb(),this.yb(c),this.wb(f)},this.vb=function(){s()[this.lb+16>>>2>>>0]=0}}var ur=0,Er=0;function Or(i,c,f,$){return S?Oe(2,1,i,c,f,$):Ft(i,c,f,$)}function Ft(i,c,f,$){if(i>>>=0,c>>>=0,f>>>=0,$>>>=0,typeof SharedArrayBuffer>"u")return K("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var E=[];return S&&E.length===0?Or(i,c,f,$):(i={Ib:f,bb:i,xb:$,Ob:E},S?(i.Qb="spawnThread",postMessage(i,E),0):nr(i))}function Pr(i,c,f){return S?Oe(3,1,i,c,f):0}function kr(i,c){if(S)return Oe(4,1,i,c)}var lr=i=>{for(var c=0,f=0;f<i.length;++f){var $=i.charCodeAt(f);127>=$?c++:2047>=$?c+=2:55296<=$&&57343>=$?(c+=4,++f):c+=3}return c},Br=(i,c,f,$)=>{if(f>>>=0,!(0<$))return 0;var E=f;$=f+$-1;for(var D=0;D<i.length;++D){var U=i.charCodeAt(D);if(55296<=U&&57343>=U){var J=i.charCodeAt(++D);U=65536+((U&1023)<<10)|J&1023}if(127>=U){if(f>=$)break;c[f++>>>0]=U}else{if(2047>=U){if(f+1>=$)break;c[f++>>>0]=192|U>>6}else{if(65535>=U){if(f+2>=$)break;c[f++>>>0]=224|U>>12}else{if(f+3>=$)break;c[f++>>>0]=240|U>>18,c[f++>>>0]=128|U>>12&63}c[f++>>>0]=128|U>>6&63}c[f++>>>0]=128|U&63}}return c[f>>>0]=0,f-E},Rr=(i,c,f)=>Br(i,o(),c,f);function bt(i,c){if(S)return Oe(5,1,i,c)}function Xe(i,c,f){if(S)return Oe(6,1,i,c,f)}function wt(i,c,f){return S?Oe(7,1,i,c,f):0}function dr(i,c){if(S)return Oe(8,1,i,c)}function cr(i,c,f){if(S)return Oe(9,1,i,c,f)}function Dr(i,c,f,$){if(S)return Oe(10,1,i,c,f,$)}function oe(i,c,f,$){if(S)return Oe(11,1,i,c,f,$)}function pr(i,c,f,$){if(S)return Oe(12,1,i,c,f,$)}function jt(i){if(S)return Oe(13,1,i)}function mr(i,c){if(S)return Oe(14,1,i,c)}function fr(i,c,f){if(S)return Oe(15,1,i,c,f)}var hr=()=>{if(!(0<ot))try{S?Sn(Pe):Gt(Pe)}catch(i){ir(i)}};function qt(i){i>>>=0,typeof Atomics.Pb=="function"&&(Atomics.Pb(n(),i>>>2,i).value.then(Pt),i+=128,Atomics.store(n(),i>>>2,1))}a.__emscripten_thread_mailbox_await=qt;var Pt=()=>{var i=Nr();if(i&&(qt(i),!Ee))try{So(),hr()}catch(c){ir(c)}};a.checkMailbox=Pt;var Kt=[],vt=i=>i%4===0&&(i%100!==0||i%400===0),gr=[0,31,60,91,121,152,182,213,244,274,305,335],yr=[0,31,59,90,120,151,181,212,243,273,304,334];function Mr(i,c,f,$,E,D,U,J){return S?Oe(16,1,i,c,f,$,E,D,U,J):-52}function kt(i,c,f,$,E,D,U){if(S)return Oe(17,1,i,c,f,$,E,D,U)}var br=i=>{var c=lr(i)+1,f=vn(c);return f&&Rr(i,f,c),f},l=[],p=(i,c)=>{l.length=0;for(var f;f=o()[i++>>>0];){var $=f!=105;$&=f!=112,c+=$&&c%8?4:0,l.push(f==112?s()[c>>>2>>>0]:f==105?n()[c>>>2>>>0]:d()[c>>>3>>>0]),c+=$?8:4}return l},b={},x=()=>{if(!O){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:w||"./this.program"},c;for(c in b)b[c]===void 0?delete i[c]:i[c]=b[c];var f=[];for(c in i)f.push(`${c}=${i[c]}`);O=f}return O},O;function W(i,c){if(S)return Oe(18,1,i,c);i>>>=0,c>>>=0;var f=0;return x().forEach(($,E)=>{var D=c+f;for(E=s()[i+4*E>>>2>>>0]=D,D=0;D<$.length;++D)r()[E++>>>0>>>0]=$.charCodeAt(D);r()[E>>>0>>>0]=0,f+=$.length+1}),0}function L(i,c){if(S)return Oe(19,1,i,c);i>>>=0,c>>>=0;var f=x();s()[i>>>2>>>0]=f.length;var $=0;return f.forEach(E=>$+=E.length+1),s()[c>>>2>>>0]=$,0}function te(i){return S?Oe(20,1,i):52}function ee(i,c,f,$){return S?Oe(21,1,i,c,f,$):52}function ue(i,c,f,$,E){return S?Oe(22,1,i,c,f,$,E):70}var le=[null,[],[]];function ve(i,c,f,$){if(S)return Oe(23,1,i,c,f,$);c>>>=0,f>>>=0,$>>>=0;for(var E=0,D=0;D<f;D++){var U=s()[c>>>2>>>0],J=s()[c+4>>>2>>>0];c+=8;for(var ae=0;ae<J;ae++){var se=o()[U+ae>>>0],pe=le[i];se===0||se===10?((i===1?Z:K)(Ht(pe,0)),pe.length=0):pe.push(se)}E+=J}return s()[$>>>2>>>0]=E,0}var Ie=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return f=>(f.set(crypto.getRandomValues(new Uint8Array(f.byteLength))),f);if(I)try{var i=ko("crypto");if(i.randomFillSync)return f=>i.randomFillSync(f);var c=i.randomBytes;return f=>(f.set(c(f.byteLength)),f)}catch{}nt("initRandomDevice")},k=i=>(k=Ie())(i),de=[31,29,31,30,31,30,31,31,30,31,30,31],Se=[31,28,31,30,31,30,31,31,30,31,30,31];function $t(i){var c=Array(lr(i)+1);return Br(i,c,0,c.length),c}var Ur=(i,c)=>{r().set(i,c>>>0)};function po(i,c,f,$){function E(B,me,_e){for(B=typeof B=="number"?B.toString():B||"";B.length<me;)B=_e[0]+B;return B}function D(B,me){return E(B,me,"0")}function U(B,me){function _e(Po){return 0>Po?-1:0<Po?1:0}var Bt;return(Bt=_e(B.getFullYear()-me.getFullYear()))===0&&(Bt=_e(B.getMonth()-me.getMonth()))===0&&(Bt=_e(B.getDate()-me.getDate())),Bt}function J(B){switch(B.getDay()){case 0:return new Date(B.getFullYear()-1,11,29);case 1:return B;case 2:return new Date(B.getFullYear(),0,3);case 3:return new Date(B.getFullYear(),0,2);case 4:return new Date(B.getFullYear(),0,1);case 5:return new Date(B.getFullYear()-1,11,31);case 6:return new Date(B.getFullYear()-1,11,30)}}function ae(B){var me=B.fb;for(B=new Date(new Date(B.gb+1900,0,1).getTime());0<me;){var _e=B.getMonth(),Bt=(vt(B.getFullYear())?de:Se)[_e];if(me>Bt-B.getDate())me-=Bt-B.getDate()+1,B.setDate(1),11>_e?B.setMonth(_e+1):(B.setMonth(0),B.setFullYear(B.getFullYear()+1));else{B.setDate(B.getDate()+me);break}}return _e=new Date(B.getFullYear()+1,0,4),me=J(new Date(B.getFullYear(),0,4)),_e=J(_e),0>=U(me,B)?0>=U(_e,B)?B.getFullYear()+1:B.getFullYear():B.getFullYear()-1}i>>>=0,c>>>=0,f>>>=0,$>>>=0;var se=s()[$+40>>>2>>>0];$={Mb:n()[$>>>2>>>0],Lb:n()[$+4>>>2>>>0],jb:n()[$+8>>>2>>>0],ob:n()[$+12>>>2>>>0],kb:n()[$+16>>>2>>>0],gb:n()[$+20>>>2>>>0],ab:n()[$+24>>>2>>>0],fb:n()[$+28>>>2>>>0],Tb:n()[$+32>>>2>>>0],Kb:n()[$+36>>>2>>>0],Nb:se?Ye(se):""},f=Ye(f),se={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var pe in se)f=f.replace(new RegExp(pe,"g"),se[pe]);var xe="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Te="January February March April May June July August September October November December".split(" ");se={"%a":B=>xe[B.ab].substring(0,3),"%A":B=>xe[B.ab],"%b":B=>Te[B.kb].substring(0,3),"%B":B=>Te[B.kb],"%C":B=>D((B.gb+1900)/100|0,2),"%d":B=>D(B.ob,2),"%e":B=>E(B.ob,2," "),"%g":B=>ae(B).toString().substring(2),"%G":B=>ae(B),"%H":B=>D(B.jb,2),"%I":B=>(B=B.jb,B==0?B=12:12<B&&(B-=12),D(B,2)),"%j":B=>{for(var me=0,_e=0;_e<=B.kb-1;me+=(vt(B.gb+1900)?de:Se)[_e++]);return D(B.ob+me,3)},"%m":B=>D(B.kb+1,2),"%M":B=>D(B.Lb,2),"%n":()=>`\n`,"%p":B=>0<=B.jb&&12>B.jb?"AM":"PM","%S":B=>D(B.Mb,2),"%t":()=>"\t","%u":B=>B.ab||7,"%U":B=>D(Math.floor((B.fb+7-B.ab)/7),2),"%V":B=>{var me=Math.floor((B.fb+7-(B.ab+6)%7)/7);if(2>=(B.ab+371-B.fb-2)%7&&me++,me)me==53&&(_e=(B.ab+371-B.fb)%7,_e==4||_e==3&&vt(B.gb)||(me=1));else{me=52;var _e=(B.ab+7-B.fb-1)%7;(_e==4||_e==5&&vt(B.gb%400-1))&&me++}return D(me,2)},"%w":B=>B.ab,"%W":B=>D(Math.floor((B.fb+7-(B.ab+6)%7)/7),2),"%y":B=>(B.gb+1900).toString().substring(2),"%Y":B=>B.gb+1900,"%z":B=>{B=B.Kb;var me=0<=B;return B=Math.abs(B)/60,(me?"+":"-")+("0000"+(B/60*100+B%60)).slice(-4)},"%Z":B=>B.Nb,"%%":()=>"%"},f=f.replace(/%%/g,"\\0\\0");for(pe in se)f.includes(pe)&&(f=f.replace(new RegExp(pe,"g"),se[pe]($)));return f=f.replace(/\\0\\0/g,"%"),pe=$t(f),pe.length>c?0:(Ur(pe,i),pe.length-1)}var zr=i=>{try{i()}catch(c){nt(c)}};function Gu(){var i=Y,c={};for(let[f,$]of Object.entries(i))c[f]=typeof $=="function"?function(){Vr.push(f);try{return $.apply(null,arguments)}finally{Ee||(Vr.pop(),ut&&Ct===1&&Vr.length===0&&(Ct=0,ot+=1,zr(Ao),typeof Fibers<"u"&&Fibers.Ub()))}}:$;return c}var Ct=0,ut=null,mo=0,Vr=[],fo={},ho={},Lu=0,wn=null,Fu=[];function ju(){return new Promise((i,c)=>{wn={resolve:i,reject:c}})}function qu(){var i=vn(65548),c=i+12;s()[i>>>2>>>0]=c,s()[i+4>>>2>>>0]=c+65536,c=Vr[0];var f=fo[c];return f===void 0&&(f=Lu++,fo[c]=f,ho[f]=c),c=f,n()[i+8>>>2>>>0]=c,i}function Ku(){var i=n()[ut+8>>>2>>>0];return i=Y[ho[i]],--ot,i()}function Yu(i){if(!Ee){if(Ct===0){var c=!1,f=!1;i(($=0)=>{if(!Ee&&(mo=$,c=!0,f)){Ct=2,zr(()=>To(ut)),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.resume(),$=!1;try{var E=Ku()}catch(J){E=J,$=!0}var D=!1;if(!ut){var U=wn;U&&(wn=null,($?U.reject:U.resolve)(E),D=!0)}if($&&!D)throw E}}),f=!0,c||(Ct=1,ut=qu(),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.pause(),zr(()=>Io(ut)))}else Ct===2?(Ct=0,zr(Eo),wo(ut),ut=null,Fu.forEach($=>{if(!Ee)try{$(),hr()}catch(E){ir(E)}})):nt(`invalid state: ${Ct}`);return mo}}function Zu(i){return Yu(c=>{i().then(c)})}var Yt=[],at,Zt,go=[],yo=(i,c)=>{if(!Zt){Zt=new WeakMap;var f=at.length;if(Zt)for(var $=0;$<0+f;$++){var E=$,D=Yt[E];D||(E>=Yt.length&&(Yt.length=E+1),Yt[E]=D=at.get(E)),(E=D)&&Zt.set(E,$)}}if(f=Zt.get(i)||0)return f;if(go.length)f=go.pop();else{try{at.grow(1)}catch(J){throw J instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":J}f=at.length-1}try{$=f,at.set($,i),Yt[$]=at.get($)}catch(J){if(!(J instanceof TypeError))throw J;if(typeof WebAssembly.Function=="function"){$=WebAssembly.Function,E={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},D={parameters:[],results:c[0]=="v"?[]:[E[c[0]]]};for(var U=1;U<c.length;++U)D.parameters.push(E[c[U]]);c=new $(D,i)}else{for($=[1],E=c.slice(0,1),c=c.slice(1),D={i:127,p:127,j:126,f:125,d:124,e:111},$.push(96),U=c.length,128>U?$.push(U):$.push(U%128|128,U>>7),U=0;U<c.length;++U)$.push(D[c[U]]);E=="v"?$.push(0):$.push(1,D[E]),c=[0,97,115,109,1,0,0,0,1],E=$.length,128>E?c.push(E):c.push(E%128|128,E>>7),c.push.apply(c,$),c.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),c=new WebAssembly.Module(new Uint8Array(c)),c=new WebAssembly.Instance(c,{e:{f:i}}).exports.f}$=f,at.set($,c),Yt[$]=at.get($)}return Zt.set(i,f),f};ne.mb();var Ju=[ar,sr,Or,Pr,kr,bt,Xe,wt,dr,cr,Dr,oe,pr,jt,mr,fr,Mr,kt,W,L,te,ee,ue,ve],Qu={r:function(i,c,f){return Zu(async()=>{await a.Cb(i,c,f)})},b:function(i,c,f){throw i>>>=0,new Lt(i).mb(c>>>0,f>>>0),ur=i,Er++,ur},P:function(i){vo(i>>>0,!C,1,!y,131072,!1),ne.tb()},n:function(i){i>>>=0,S?postMessage({cmd:"cleanupThread",thread:i}):ne.rb(ne.$a[i])},L:Ft,i:Pr,V:kr,H:bt,J:Xe,z:wt,T:dr,N:cr,S:Dr,p:oe,I:pr,F:jt,U:mr,G:fr,Y:()=>1,D:function(i,c){i>>>=0,i==c>>>0?setTimeout(()=>Pt()):S?postMessage({targetThread:i,cmd:"checkMailbox"}):(i=ne.$a[i])&&i.postMessage({cmd:"checkMailbox"})},M:function(i,c,f,$){c>>>=0,Kt.length=f,$=$>>>0>>>3;for(var E=0;E<f;E++)Kt[E]=d()[$+E>>>0];return i=0>i?Nt[-i-1]:Ju[i],ne.zb=c,c=i.apply(null,Kt),ne.zb=0,c},O:qt,X:function(i){I&&ne.$a[i>>>0].ref()},u:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getUTCSeconds(),n()[f+4>>>2>>>0]=i.getUTCMinutes(),n()[f+8>>>2>>>0]=i.getUTCHours(),n()[f+12>>>2>>>0]=i.getUTCDate(),n()[f+16>>>2>>>0]=i.getUTCMonth(),n()[f+20>>>2>>>0]=i.getUTCFullYear()-1900,n()[f+24>>>2>>>0]=i.getUTCDay(),i=(i.getTime()-Date.UTC(i.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,n()[f+28>>>2>>>0]=i},v:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getSeconds(),n()[f+4>>>2>>>0]=i.getMinutes(),n()[f+8>>>2>>>0]=i.getHours(),n()[f+12>>>2>>>0]=i.getDate(),n()[f+16>>>2>>>0]=i.getMonth(),n()[f+20>>>2>>>0]=i.getFullYear()-1900,n()[f+24>>>2>>>0]=i.getDay(),c=(vt(i.getFullYear())?gr:yr)[i.getMonth()]+i.getDate()-1|0,n()[f+28>>>2>>>0]=c,n()[f+36>>>2>>>0]=-(60*i.getTimezoneOffset()),c=new Date(i.getFullYear(),6,1).getTimezoneOffset();var $=new Date(i.getFullYear(),0,1).getTimezoneOffset();i=(c!=$&&i.getTimezoneOffset()==Math.min($,c))|0,n()[f+32>>>2>>>0]=i},w:function(i){i>>>=0;var c=new Date(n()[i+20>>>2>>>0]+1900,n()[i+16>>>2>>>0],n()[i+12>>>2>>>0],n()[i+8>>>2>>>0],n()[i+4>>>2>>>0],n()[i>>>2>>>0],0),f=n()[i+32>>>2>>>0],$=c.getTimezoneOffset(),E=new Date(c.getFullYear(),6,1).getTimezoneOffset(),D=new Date(c.getFullYear(),0,1).getTimezoneOffset(),U=Math.min(D,E);return 0>f?n()[i+32>>>2>>>0]=+(E!=D&&U==$):0<f!=(U==$)&&(E=Math.max(D,E),c.setTime(c.getTime()+6e4*((0<f?U:E)-$))),n()[i+24>>>2>>>0]=c.getDay(),f=(vt(c.getFullYear())?gr:yr)[c.getMonth()]+c.getDate()-1|0,n()[i+28>>>2>>>0]=f,n()[i>>>2>>>0]=c.getSeconds(),n()[i+4>>>2>>>0]=c.getMinutes(),n()[i+8>>>2>>>0]=c.getHours(),n()[i+12>>>2>>>0]=c.getDate(),n()[i+16>>>2>>>0]=c.getMonth(),n()[i+20>>>2>>>0]=c.getYear(),i=c.getTime(),isNaN(i)?(n()[bo()>>>2>>>0]=61,i=-1):i/=1e3,xo((yt=i,1<=+Math.abs(yt)?0<yt?+Math.floor(yt/4294967296)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)),i>>>0},s:Mr,t:kt,C:function(i,c,f){function $(se){return(se=se.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?se[1]:"GMT"}i>>>=0,c>>>=0,f>>>=0;var E=new Date().getFullYear(),D=new Date(E,0,1),U=new Date(E,6,1);E=D.getTimezoneOffset();var J=U.getTimezoneOffset(),ae=Math.max(E,J);s()[i>>>2>>>0]=60*ae,n()[c>>>2>>>0]=+(E!=J),i=$(D),c=$(U),i=br(i),c=br(c),J<E?(s()[f>>>2>>>0]=i,s()[f+4>>>2>>>0]=c):(s()[f>>>2>>>0]=c,s()[f+4>>>2>>>0]=i)},d:()=>{nt("")},c:function(i,c,f){return i>>>=0,c=p(c>>>0,f>>>0),Nt[i].apply(null,c)},k:function(i,c,f){return i>>>=0,c=p(c>>>0,f>>>0),Nt[i].apply(null,c)},o:()=>{},q:()=>Date.now(),W:()=>{throw ot+=1,"unwind"},E:function(){return 4294901760},f:()=>performance.timeOrigin+performance.now(),g:()=>I?(No(),Jt(Vo)).cpus().length:navigator.hardwareConcurrency,A:function(i){i>>>=0;var c=o().length;if(i<=c||4294901760<i)return!1;for(var f=1;4>=f;f*=2){var $=c*(1+.2/f);$=Math.min($,i+100663296);var E=Math;$=Math.max(i,$);e:{E=(E.min.call(E,4294901760,$+(65536-$%65536)%65536)-Q.buffer.byteLength+65535)/65536;try{Q.grow(E),Ge();var D=1;break e}catch{}D=void 0}if(D)return!0}return!1},Q:W,R:L,K:Gt,h:te,m:ee,x:ue,l:ve,y:function(i,c){return i>>>=0,c>>>=0,k(o().subarray(i>>>0,i+c>>>0)),0},a:Q||a.wasmMemory,B:po,e:function(i,c,f,$){return po(i>>>0,c>>>0,f>>>0,$>>>0)},j:function(i,c,f,$){let E=at.length;i=new Uint8Array(o().slice(i+c,i+f));try{var D=new WebAssembly.Module(i),U=new WebAssembly.Instance(D,{env:{memory:Q}}),J;for(J in U.exports)yo(U.exports[J]);return E<at.length?E:$}catch(ae){return console.log(ae),$}}},Y=function(){function i(f,$){return Y=f.exports,Y=Gu(),Y=Xu(),ne.ub.push(Y.Ha),at=Y.Ia,be.unshift(Y.Z),X=$,St(),Y}var c={a:Qu};if(ze++,a.instantiateWasm)try{return a.instantiateWasm(c,i)}catch(f){K(`Module.instantiateWasm callback failed with error: ${f}`),h(f)}return _t(c,function(f){i(f.instance,f.module)}).catch(h),{}}();a._OrtInit=(i,c)=>(a._OrtInit=Y._)(i,c),a._OrtGetLastError=(i,c)=>(a._OrtGetLastError=Y.$)(i,c),a._OrtCreateSessionOptions=(i,c,f,$,E,D,U,J,ae,se)=>(a._OrtCreateSessionOptions=Y.aa)(i,c,f,$,E,D,U,J,ae,se),a._OrtAppendExecutionProvider=(i,c)=>(a._OrtAppendExecutionProvider=Y.ba)(i,c),a._OrtAddFreeDimensionOverride=(i,c,f)=>(a._OrtAddFreeDimensionOverride=Y.ca)(i,c,f),a._OrtAddSessionConfigEntry=(i,c,f)=>(a._OrtAddSessionConfigEntry=Y.da)(i,c,f),a._OrtReleaseSessionOptions=i=>(a._OrtReleaseSessionOptions=Y.ea)(i),a._OrtCreateSession=(i,c,f)=>(a._OrtCreateSession=Y.fa)(i,c,f),a._OrtReleaseSession=i=>(a._OrtReleaseSession=Y.ga)(i),a._OrtGetInputOutputCount=(i,c,f)=>(a._OrtGetInputOutputCount=Y.ha)(i,c,f),a._OrtGetInputName=(i,c)=>(a._OrtGetInputName=Y.ia)(i,c),a._OrtGetOutputName=(i,c)=>(a._OrtGetOutputName=Y.ja)(i,c),a._OrtFree=i=>(a._OrtFree=Y.ka)(i),a._OrtCreateTensor=(i,c,f,$,E,D)=>(a._OrtCreateTensor=Y.la)(i,c,f,$,E,D),a._OrtGetTensorData=(i,c,f,$,E)=>(a._OrtGetTensorData=Y.ma)(i,c,f,$,E),a._OrtReleaseTensor=i=>(a._OrtReleaseTensor=Y.na)(i),a._OrtCreateRunOptions=(i,c,f,$)=>(a._OrtCreateRunOptions=Y.oa)(i,c,f,$),a._OrtAddRunConfigEntry=(i,c,f)=>(a._OrtAddRunConfigEntry=Y.pa)(i,c,f),a._OrtReleaseRunOptions=i=>(a._OrtReleaseRunOptions=Y.qa)(i),a._OrtCreateBinding=i=>(a._OrtCreateBinding=Y.ra)(i),a._OrtBindInput=(i,c,f)=>(a._OrtBindInput=Y.sa)(i,c,f),a._OrtBindOutput=(i,c,f,$)=>(a._OrtBindOutput=Y.ta)(i,c,f,$),a._OrtClearBoundOutputs=i=>(a._OrtClearBoundOutputs=Y.ua)(i),a._OrtReleaseBinding=i=>(a._OrtReleaseBinding=Y.va)(i),a._OrtRunWithBinding=(i,c,f,$,E)=>(a._OrtRunWithBinding=Y.wa)(i,c,f,$,E),a._OrtRun=(i,c,f,$,E,D,U,J)=>(a._OrtRun=Y.xa)(i,c,f,$,E,D,U,J),a._OrtEndProfiling=i=>(a._OrtEndProfiling=Y.ya)(i),a._OrtConfigure=(i,c)=>(a._OrtConfigure=Y.za)(i,c),a._OrtAuth=(i,c)=>(a._OrtAuth=Y.Aa)(i,c),a._JsepOutput=(i,c,f)=>(a._JsepOutput=Y.Ba)(i,c,f),a._JsepGetNodeName=i=>(a._JsepGetNodeName=Y.Ca)(i);var bo=()=>(bo=Y.Da)(),Nr=a._pthread_self=()=>(Nr=a._pthread_self=Y.Ea)(),vn=a._malloc=i=>(vn=a._malloc=Y.Fa)(i),wo=a._free=i=>(wo=a._free=Y.Ga)(i);a.__emscripten_tls_init=()=>(a.__emscripten_tls_init=Y.Ha)();var vo=a.__emscripten_thread_init=(i,c,f,$,E,D)=>(vo=a.__emscripten_thread_init=Y.Ja)(i,c,f,$,E,D);a.__emscripten_thread_crashed=()=>(a.__emscripten_thread_crashed=Y.Ka)();var $o=(i,c,f,$)=>($o=Y.La)(i,c,f,$),$n=i=>($n=Y.Ma)(i),Sn=a.__emscripten_thread_exit=i=>(Sn=a.__emscripten_thread_exit=Y.Na)(i),So=()=>(So=Y.Oa)(),xo=i=>(xo=Y.Pa)(i),_o=(i,c)=>(_o=Y.Qa)(i,c),xn=()=>(xn=Y.Ra)(),Wr=i=>(Wr=Y.Sa)(i),_n=i=>(_n=Y.Ta)(i),Co=a.dynCall_ii=(i,c)=>(Co=a.dynCall_ii=Y.Va)(i,c),Io=i=>(Io=Y.Wa)(i),Ao=()=>(Ao=Y.Xa)(),To=i=>(To=Y.Ya)(i),Eo=()=>(Eo=Y.Za)();a.___start_em_js=914640,a.___stop_em_js=915413;function Xu(){var i=Y;i=Object.assign({},i);var c=$=>()=>$()>>>0,f=$=>E=>$(E)>>>0;return i.Da=c(i.Da),i.Ea=c(i.Ea),i.Fa=f(i.Fa),i.emscripten_main_runtime_thread_id=c(i.emscripten_main_runtime_thread_id),i.Ra=c(i.Ra),i.Ta=f(i.Ta),i}a.wasmMemory=Q,a.stackAlloc=_n,a.stackSave=xn,a.stackRestore=Wr,a.keepRuntimeAlive=()=>0<ot,a.addFunction=yo,a.UTF8ToString=Ye,a.stringToUTF8=Rr,a.lengthBytesUTF8=lr,a.ExitStatus=Wt,a.PThread=ne;var Hr;Ue=function i(){Hr||Oo(),Hr||(Ue=i)};function Oo(){if(!(0<ze))if(S)m(a),S||Je(be),startWorker(a);else{if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)re.unshift(a.preRun.shift());Je(re),0<ze||Hr||(Hr=!0,a.calledRun=!0,Ee||(S||Je(be),m(a),S||Je(rt)))}}return Oo(),t.ready}})();typeof Ho=="object"&&typeof Pn=="object"?Pn.exports=Wo:typeof define=="function"&&define.amd&&define([],()=>Wo)});var Lo=wr((np,ul)=>{ul.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Rn,et,$r,Fr,Sr,Zo,Dn,Ne=q(()=>{"use strict";Rn=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},et=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},$r=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Fr=e=>{switch(e){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Sr=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Zo=e=>e==="float32"||e==="int32"||e==="int64"||e==="bool"||e==="float16"||e==="uint32",Dn=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}});var jr=q(()=>{"use strict"});var Qo=q(()=>{"use strict";jr()});var Xo,ea=q(()=>{"use strict";Xo="1.17.0"});var ta,Rt,Mn=q(()=>{"use strict";ea();ta="warning",Rt={wasm:{},webgl:{},webgpu:{},versions:{common:Xo},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);ta=e}},get logLevel(){return ta}};Object.defineProperty(Rt,"logLevel",{enumerable:!0})});var Qt,ra=q(()=>{"use strict";Mn();Qt=Rt});var na=q(()=>{"use strict"});var oa=q(()=>{"use strict";qr()});var ia=q(()=>{"use strict"});var sa=q(()=>{"use strict";qr()});var qr=q(()=>{"use strict";na();oa();ia();sa()});var Kr=q(()=>{"use strict";qr()});var Un,ua,Dt,Mt,zn=q(()=>{"use strict";Mn();Un=(e,t)=>{Rt.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},ua=(e,t)=>{let r=new Error().stack?.split(/\\r\\n|\\r|\\n/g)||[],o=!1;for(let n=0;n<r.length;n++){if(o&&!r[n].includes("TRACE_FUNC")){let s=`FUNC_${e}::${r[n].trim().split(" ")[1]}`;t&&(s+=`::${t}`),Un("CPU",s);return}r[n].includes("TRACE_FUNC")&&(o=!0)}},Dt=e=>{Rt.wasm.trace&&ua("BEGIN",e)},Mt=e=>{Rt.wasm.trace&&ua("END",e)}});var la=q(()=>{"use strict";jr();Kr();zn()});var da=q(()=>{"use strict";la()});var ca=q(()=>{"use strict"});var pa=q(()=>{"use strict";jr();Kr()});var ma=q(()=>{"use strict";pa()});var Xt=q(()=>{"use strict";Qo();ra();da();Kr();zn();ca();ma()});var wl,vl,fa,ha,ga,$l,De,It=q(()=>{"use strict";Ne();wl=["V","I","W","E","F"],vl=(e,t)=>{console.log(`[${wl[e]},${new Date().toISOString()}]${t}`)},ga=(e,t)=>{fa=e,ha=t},$l=(e,t)=>{let r=Sr(e),o=Sr(fa);r>=o&&vl(r,typeof t=="function"?t():t)},De=(...e)=>{ha&&$l(...e)}});var ya,ba=q(()=>{"use strict";Ne();ya=(e,t)=>new(Fr(t))(e)});var Yr=q(()=>{"use strict"});var Zr,Sl,wa,Nn,Vn,$a,Sa=q(()=>{"use strict";It();Yr();Zr=e=>Math.ceil(e/16)*16,Sl=1,wa=()=>Sl++,Nn=async(e,t,r,o)=>{let n=Zr(r),s=e.device.createBuffer({size:n,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let u=e.getCommandEncoder();e.endComputePass(),u.copyBufferToBuffer(t,0,s,0,n),e.flush(),await s.mapAsync(GPUMapMode.READ);let d=s.getMappedRange();if(o){let a=o();return a.set(new Uint8Array(d,0,r)),a}else return new Uint8Array(d.slice(0,r))}finally{s.destroy()}},Vn=class{constructor(t){this.backend=t;this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map}upload(t,r){let o=r.buffer,n=r.byteOffset,s=r.byteLength,u=Zr(s),d=this.storageCache.get(t);if(!d)throw new Error("gpu data for uploading does not exist");if(d.originalSize!==s)throw new Error(`inconsistent data size. gpu data size=${d.originalSize}, data size=${s}`);let a=this.backend.device.createBuffer({mappedAtCreation:!0,size:u,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),m=a.getMappedRange();new Uint8Array(m).set(new Uint8Array(o,n,s)),a.unmap();let h=this.backend.getCommandEncoder();this.backend.endComputePass(),h.copyBufferToBuffer(a,0,d.gpuData.buffer,0,u),De("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${t})`),this.buffersForUploadingPending.push(a)}memcpy(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(r);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(o.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let s=Zr(o.originalSize),u=this.backend.getCommandEncoder();this.backend.endComputePass(),u.copyBufferToBuffer(o.gpuData.buffer,0,n.gpuData.buffer,0,s)}registerExternalBuffer(t,r,o){let n;if(o){if(n=this.externalBuffers.get(o),n===void 0)throw new Error("previous buffer is not registered");if(t===o)return De("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, buffer is the same, skip.`),n;this.externalBuffers.delete(o)}else n=wa();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:t},originalSize:r}),this.externalBuffers.set(t,n),De("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, registered.`),n}unregisterExternalBuffer(t){let r=this.externalBuffers.get(t);r!==void 0&&(this.storageCache.delete(r),this.externalBuffers.delete(t),De("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${r}`))}create(t,r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let o=Zr(t),n,s=(r&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,u=(r&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(s||u){let a=s?this.freeBuffers:this.freeUniformBuffers,m=a.get(o);m||(m=[],a.set(o,m)),m.length>0?n=m.pop():n=this.backend.device.createBuffer({size:o,usage:r})}else n=this.backend.device.createBuffer({size:o,usage:r});let d={id:wa(),type:0,buffer:n};return this.storageCache.set(d.id,{gpuData:d,originalSize:t}),De("verbose",()=>`[WebGPU] GpuDataManager.create(size=${t}) => id=${d.id}`),d}get(t){return this.storageCache.get(t)?.gpuData}release(t){let r=this.storageCache.get(t);if(!r)throw new Error("releasing data does not exist");return De("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(r.gpuData.buffer),r.originalSize}async download(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("data does not exist");await Nn(this.backend,o.gpuData.buffer,o.originalSize,r)}refreshPendingBuffers(){for(let t of this.buffersForUploadingPending)t.destroy();this.buffersForUploadingPending=[];for(let t of this.buffersPending)(t.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(t.size).push(t):(t.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(t.size).push(t):t.destroy();this.buffersPending=[]}dispose(){this.freeBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.freeUniformBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map}},$a=(...e)=>new Vn(...e)});var Wn,ge,je=q(()=>{"use strict";Wn=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},ge=e=>new Wn(e)});var Hn,lt,V,Ut,Jr,Qr,Xr,$e=q(()=>{"use strict";Hn=class{static calcMatMulShape(t,r){return t[1]!==r[0]?void 0:[t[0],r[1]]}},lt=class{static calcShape(t,r,o=!1){let n=t.length,s=r.length;if(n===0)return r;if(s===0)return t;let u=Math.max(t.length,r.length),d=new Array(u);if(o){if(n<2||s<2)return;let a=Hn.calcMatMulShape([t[n-2],t[n-1]],[r[s-2],r[s-1]]);if(a===void 0)return;[d[u-2],d[u-1]]=a}for(let a=o?3:1;a<=u;a++){let m=n-a<0?1:t[n-a],h=s-a<0?1:r[s-a];if(m!==h&&m>1&&h>1)return;d[u-a]=Math.max(m,h)}return d}static isValidBroadcast(t,r){let o=t.length,n=r.length;if(o>n)return!1;for(let s=1;s<=o;s++)if(t[o-s]!==1&&t[o-s]!==r[n-s])return!1;return!0}},V=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,o){let n=1;for(let s=r;s<o;s++){if(t[s]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");n*=t[s]}return n}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let o=new Array(r);o[r-1]=1,o[r-2]=t[r-1];for(let n=r-3;n>=0;--n)o[n]=o[n+1]*t[n+1];return o}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(o=>this.normalizeAxis(o,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(o=>t[o]):t.slice().reverse()}static padShape(t,r){let o=t.length;return t.map((n,s)=>n+r[s]+r[s+o])}static areEqual(t,r){return t.length!==r.length?!1:t.every((o,n)=>o===r[n])}},Ut=class e{static adjustPoolAttributes(t,r,o,n,s,u){if(!t&&o.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let d=0;d<r.length-2;d++)d>=o.length?o.push(r[d+2]):o[d]=r[d+2];for(let d=0;d<o.length;d++)if(d<n.length){if(n[d]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let d=0;d<o.length;d++)if(d<s.length){if(s[d]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let d=0;d<o.length*2;d++)if(d<u.length){if(u[d]<0)throw new Error("pad should be greater than or equal to 1")}else u.push(0);for(let d=0;d<o.length;d++){if(o[d]<=0)throw new Error("kernel shapes need to be greater than 0");if(u[d]>=o[d]||u[d+o.length]>=o[d])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,o,n,s,u,d){if(d){if(s.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let a=0;a<t.length-2;a++)e.adjustPadAndReturnShape(t[a+(u?1:2)],r[a],o[a],n[a],s,a,a+t.length-2,d)}}static computePoolOutputShape(t,r,o,n,s,u,d){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let a=[r[0],r[1]];return e.computeShapeHelper(t,r,a,o,n,s,u,d),a}static computeConvOutputShape(t,r,o,n,s,u,d){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let a=[t[0],r[0]];return e.computeShapeHelper(!1,t,a,o,n,s,u,d),a}static computeShapeHelper(t,r,o,n,s,u,d,a){if(t)for(let m=0;m<r.length-2;m++)o.push(1);else for(let m=0;m<r.length-2;m++)o.push(e.adjustPadAndReturnShape(r[m+2],n[m],s[m],u[m],d,m,m+r.length-2,a))}static adjustPadAndReturnShape(t,r,o,n,s,u,d,a){let m=o*(n-1)+1;if(a&&a!=="NOTSET")switch(a){case"VALID":return s[u]=0,s[d]=0,Math.floor((t-m)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let g=((t+r-1)/r-1)*r+n-t;return s[u]=Math.floor(a==="SAME_LOWER"?(g+1)/2:g/2),s[d]=g-s[u],Math.floor((t+g-n)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+s[u]+s[d]-m)/r+1)}},Jr=class{static getShapeOfGemmResult(t,r,o,n,s){if(t.length!==2||o.length!==2)throw new Error("shape need to be of size 2");let u,d,a;r?(u=t[1],d=t[0]):(u=t[0],d=t[1]);let m=-1;if(n?(a=o[0],m=1):(a=o[1],m=0),o[m]!==d)throw new Error("dimension mismatch");if(u<=0||a<=0||d<=0)throw new Error("invalid shape specified");if(s&&!lt.isValidBroadcast(s,[u,a]))throw new Error("gemm: invalid bias shape for broadcast");return[u,a,d]}},Qr=-34028234663852886e22,Xr=34028234663852886e22});var xl,Ln,Le,dt,F,Fe,Ze,it,tt,ce,Fn,M,j,en,Gn,xa,er,Be,we=q(()=>{"use strict";Ne();$e();xl=64,Ln=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},Le=(e,t=1)=>{let r=Ln(e,t);return typeof r=="string"?r:r[0]},dt=(e,t=1)=>{let r=Ln(e,t);return typeof r=="string"?r:r[1]},F=e=>e.length===0?[]:[{type:"uint32",data:e},{type:"uint32",data:V.computeStrides(e)}],Fe=e=>e%4===0?4:e%2===0?2:1,Ze=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,it=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}f(${r})`,tt=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,ce=(e,t,r)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?`${e}[(${t}) / 4][(${t}) % 4]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Fn=(e,t,r,o,n)=>{let s=typeof r=="number",u=s?r:r.length,d=[...new Array(u).keys()],a=u<2?"u32":u<=4?`vec${u}<u32>`:`array<u32, ${u}>`,m=Ln(t,n),h=typeof m=="string"?m:m[1],g=typeof m=="string"?m:m[0],w={indices:a,value:h,storage:g,tensor:t},v=G=>typeof G=="string"?G:`${G}u`,y={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},C=s?"uniforms.":"",I=`${C}${e}_shape`,S=`${C}${e}_strides`,_="";for(let G=0;G<u-1;G++)_+=`\n    let dim${G} = current / ${ce(S,G,u)};\n    let rest${G} = current % ${ce(S,G,u)};\n    indices[${G}] = dim${G};\n    current = rest${G};\n    `;_+=`indices[${u-1}] = current;`;let P=u<2?"":`\n  fn o2i_${e}(offset: u32) -> ${w.indices} {\n    var indices: ${w.indices};\n    var current = offset;\n    ${_}\n    return indices;\n  }`,A=G=>(y.offsetToIndices=!0,u<2?G:`o2i_${e}(${G})`),z=[];if(u>=2)for(let G=u-1;G>=0;G--)z.push(`${ce(S,G,u)} * (indices[${G}])`);let R=u<2?"":`\n  fn i2o_${e}(indices: ${w.indices}) -> u32 {\n    return ${z.join("+")};\n  }`,N=G=>(y.indicesToOffset=!0,u<2?G:`i2o_${e}(${G})`),T=(...G)=>u===0?"0u":`${w.indices}(${G.map(v).join(",")})`,H=(G,re)=>u<2?`${G}`:`${ce(G,re,u)}`,ie=(G,re,be)=>u<2?`${G}=${be};`:`${ce(G,re,u)}=${be};`,Z={},K=(G,re)=>{y.broadcastedIndicesToOffset=!0;let be=`${re.name}broadcastedIndicesTo${e}Offset`;if(be in Z)return`${be}(${G})`;let rt=[];for(let ze=u-1;ze>=0;ze--){let Ve=re.indicesGet("outputIndices",ze+re.rank-u);rt.push(`${H(S,ze)} * (${Ve} % ${H(I,ze)})`)}return Z[be]=`fn ${be}(outputIndices: ${re.type.indices}) -> u32 {\n             return ${rt.length>0?rt.join("+"):"0u"};\n           }`,`${be}(${G})`},Q=(G,re)=>(()=>{if(w.storage===w.value)return`${e}[${G}]=${re};`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`${e}[${G}]=vec2<u32>(u32(${re}), select(0u, 0xFFFFFFFFu, ${re} < 0));`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`${e}[${G}]=vec2<u32>(u32(${re}), 0u);`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`${e}[${G}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${re}));`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),X=G=>(()=>{if(w.storage===w.value)return`${e}[${G}]`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`i32(${e}[${G}].x)`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`u32(${e}[${G}].x)`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${G}] & 0xFFu), bool(${e}[${G}] & 0xFF00u), bool(${e}[${G}] & 0xFF0000u), bool(${e}[${G}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),Ee=u<2?"":`\n  fn get_${e}ByIndices(indices: ${w.indices}) -> ${h} {\n    return ${X(`i2o_${e}(indices)`)};\n  }`,Pe=u<2?"":(()=>{let G=d.map(be=>`d${be}: u32`).join(", "),re=d.map(be=>`d${be}`).join(", ");return`\n  fn get_${e}(${G}) -> ${h} {\n    return get_${e}ByIndices(${T(re)});\n  }`})(),fe=(...G)=>{if(G.length!==u)throw new Error(`indices length must be ${u}`);let re=G.map(v).join(",");return u===0?X("0u"):u===1?X(re[0]):(y.get=!0,y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}(${re})`)},Ce=G=>u<2?X(G):(y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}ByIndices(${G})`),he=u<2?"":`\n  fn set_${e}ByIndices(indices: ${w.indices}, value: ${h}) {\n    ${Q(`i2o_${e}(indices)`,"value")}\n  }`,ye=u<2?"":(()=>{let G=d.map(be=>`d${be}: u32`).join(", "),re=d.map(be=>`d${be}`).join(", ");return`\n  fn set_${e}(${G}, value: ${h}) {\n    set_${e}ByIndices(${T(re)}, value);\n  }`})();return{impl:()=>{let G=[],re=!1;return y.offsetToIndices&&(G.push(P),re=!0),y.indicesToOffset&&(G.push(R),re=!0),y.broadcastedIndicesToOffset&&(Object.values(Z).forEach(be=>G.push(be)),re=!0),y.set&&(G.push(ye),re=!0),y.setByIndices&&(G.push(he),re=!0),y.get&&(G.push(Pe),re=!0),y.getByIndices&&(G.push(Ee),re=!0),!s&&re&&G.unshift(`const ${I} = ${w.indices}(${r.join(",")});`,`const ${S} = ${w.indices}(${V.computeStrides(r).join(",")});`),G.join(`\n`)},type:w,offsetToIndices:A,indicesToOffset:N,broadcastedIndicesToOffset:K,indices:T,indicesGet:H,indicesSet:ie,set:(...G)=>{if(G.length!==u+1)throw new Error(`indices length must be ${u}`);let re=G[u];if(typeof re!="string")throw new Error("value must be string");let be=G.slice(0,u).map(v).join(",");return u===0?Q("0u",re):u===1?Q(be[0],re):(y.set=!0,y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}(${be}, ${re})`)},setByOffset:Q,setByIndices:(G,re)=>u<2?Q(G,re):(y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}ByIndices(${G}, ${re});`),get:fe,getByOffset:X,getByIndices:Ce,usage:o,name:e,strides:S,shape:I,rank:u}},M=(e,t,r,o=1)=>Fn(e,t,r,"input",o),j=(e,t,r,o=1)=>Fn(e,t,r,"output",o),en=(e,t,r,o=1)=>Fn(e,t,r,"internal",o),Gn=class{constructor(t){this.normalizedDispatchGroup=t;this.internalVariables=[];this.variables=[];this.uniforms=[];this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(t){return`if (global_idx >= ${typeof t=="number"?`${t}u`:t}) { return; }`}mainStart(t=xl){let r=typeof t=="number"?t:t[0],o=typeof t=="number"?1:t[1],n=typeof t=="number"?1:t[2],s=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,u=s?`@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>`,d=s?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${r*o*n}u + local_idx;`;return`@compute @workgroup_size(${r}, ${o}, ${n})\n  fn main(${u}) {\n    ${d}\n  `}appendVariableUniforms(t){t.rank!==0&&(t.shape.startsWith("uniforms.")&&this.uniforms.push({name:t.shape.replace("uniforms.",""),type:"u32",length:t.rank}),t.strides.startsWith("uniforms.")&&this.uniforms.push({name:t.strides.replace("uniforms.",""),type:"u32",length:t.rank}))}declareVariable(t,r){if(t.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(t),this.appendVariableUniforms(t);let o=t.usage==="input"?"read":"read_write",n=t.type.storage;return`@group(0) @binding(${r}) var<storage, ${o}> ${t.name}: array<${n}>;`}declareVariables(...t){return t.map(r=>this.declareVariable(r,this.variableIndex++)).join(`\n`)}registerInternalVariable(t){if(t.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(t),this.appendVariableUniforms(t)}registerInternalVariables(...t){return t.forEach(r=>this.registerInternalVariable(r)),this}registerUniform(t,r,o=1){return this.uniforms.push({name:t,type:r,length:o}),this}registerUniforms(t){return this.uniforms=this.uniforms.concat(t),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let t=[];for(let{name:r,type:o,length:n}of this.uniforms)if(n&&n>4)t.push(`${r}:array<vec4<${o}>, ${Math.ceil(n/4)}>`);else{let s=n==null||n===1?o:`vec${n}<${o}>`;t.push(`${r}:${s}`)}return`\n      struct Uniforms { ${t.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(t=>t.impl()).join(`\n`)+this.internalVariables.map(t=>t.impl()).join(`\n`)}},xa=e=>new Gn(e),er=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;n++){let s=r-1-n,u=e[s]||1;(t[t.length-1-n]||1)>1&&u===1&&o.unshift(s)}return o},Be=e=>!0});var _l,_a,Cl,Il,st,Ca,Ia,tr=q(()=>{"use strict";$e();je();we();_l=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.")},_a=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,Cl=(e,t)=>V.sortBasedOnPerm(e,_a(e.length,t)),Il=(e,t,r,o)=>{let n=[];n.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let s=0;s<t;++s)n.push(r.indicesSet("a",e[s],`i[${s}]`));return n.push("return a;}"),n.join(`\n`)},st=(e,t)=>{let r=e.dataType,o=e.dims.length,n=_a(o,t),s=Be(o),u=Cl(e.dims,n),d=s?u.length:u,a=s?o:e.dims,m=j("output",r,d),h=M("a",r,a),g=w=>`\n  ${w.registerUniform("output_size","u32").declareVariables(h,m)}\n\n  ${Il(n,o,h,m)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${m.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${m.setByOffset("global_idx",h.getByIndices("aIndices"))}\n  }`;return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:s?["rank"]:["dims"]},getRunData:w=>{let v=V.size(u);return{outputs:[{dims:u,dataType:w[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:s?[{type:"uint32",data:v},...F(w[0].dims),...F(u)]:[{type:"uint32",data:v}]}},getShaderSource:g}},Ca=(e,t)=>{_l(e.inputs),e.compute(st(e.inputs[0],t.perm))},Ia=e=>ge({perm:e.perm})});var Al,Tl,El,Ol,Pl,kl,Bl,Rl,Dl,Ml,ct,Aa,Ta,Ea,Oa,Pa,ka,Ba,Ra,Da,Ma,Ua=q(()=>{"use strict";$e();we();tn();tr();Al={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Tl={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},El={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Ol={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Pl=(e,t)=>{let r=[];for(let o=t-e;o<t;++o)r.push(o);return r},kl=(e,t)=>{let r=[],o=e.length;for(let s=0;s<o;s++)t.indexOf(s)===-1&&r.push(e[s]);let n=t.map(s=>e[s]);return[r,n]},Bl=(e,t)=>{let r=e.length+t.length,o=[],n=0;for(let s=0;s<r;s++)t.indexOf(s)===-1?o.push(e[n++]):o.push(1);return o},Rl=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},Dl=(e,t)=>{let r=[];if(!Rl(e,t)){for(let o=0;o<t;++o)e.indexOf(o)===-1&&r.push(o);e.forEach(o=>r.push(o))}return r},Ml=(e,t,r,o,n,s,u)=>{let d=r[0].dims,a=V.size(s),m=V.size(u),h=M("_A",r[0].dataType,d),g=j("output",n,s),w=32,v=`\n          var<workgroup> aBestValues : array<${g.type.storage}, ${w}>;\n       `;return{name:e,shaderCache:t,getShaderSource:C=>`\n        ${C.registerUniform("reduceSize","u32").declareVariables(h,g)}\n        ${v}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${C.mainStart(w)}\n\n          let outputIndex = global_idx / ${w};\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ${g.type.storage}(${El[o]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + ${w}) {\n           let candidate = ${g.type.storage}(${h.getByOffset("offset + k")});\n           bestValue = ${Al[o]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, ${w}u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${Tl[o]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${g.setByOffset("outputIndex",`${o==="mean"?`bestValue / ${g.type.storage}(uniforms.reduceSize)`:`${Ol[o]}`}`)};\n         }\n        }`,getRunData:()=>({outputs:[{dims:s,dataType:n}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:m}]})}},ct=(e,t,r,o)=>{let n=e.inputs.length===1?r:jn(e.inputs,r),s=n.axes;s.length===0&&!n.noopWithEmptyAxes&&(s=e.inputs[0].dims.map((v,y)=>y));let u=V.normalizeAxes(s,e.inputs[0].dims.length),d=u,a=e.inputs[0],m=Dl(d,e.inputs[0].dims.length);m.length>0&&(a=e.compute(st(e.inputs[0],m),{inputs:[0],outputs:[-1]})[0],d=Pl(d.length,a.dims.length));let[h,g]=kl(a.dims,d),w=h;n.keepDims&&(w=Bl(h,u)),e.compute(Ml(t,{hint:n.cacheKey,inputDependencies:["type"]},[a],o,e.inputs[0].dataType,w,g),{inputs:[a]})},Aa=(e,t)=>{ct(e,"ReduceMeanShared",t,"mean")},Ta=(e,t)=>{ct(e,"ReduceL1Shared",t,"l1")},Ea=(e,t)=>{ct(e,"ReduceL2Shared",t,"l2")},Oa=(e,t)=>{ct(e,"ReduceLogSumExpShared",t,"logSumExp")},Pa=(e,t)=>{ct(e,"ReduceMaxShared",t,"max")},ka=(e,t)=>{ct(e,"ReduceMinShared",t,"min")},Ba=(e,t)=>{ct(e,"ReduceProdShared",t,"prod")},Ra=(e,t)=>{ct(e,"ReduceSumShared",t,"sum")},Da=(e,t)=>{ct(e,"ReduceSumSquareShared",t,"sumSquare")},Ma=(e,t)=>{ct(e,"ReduceLogSumShared",t,"logSum")}});var pt,Ul,rn,jn,mt,zl,Vl,Nl,Wl,Hl,Gl,Ll,Fl,jl,ql,ft,za,Va,Na,Wa,Ha,Ga,La,Fa,ja,qa,tn=q(()=>{"use strict";$e();je();we();Ua();pt=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Ul=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],rn=(e,t,r,o,n,s,u=!1,d=!1)=>{let a=[],m=r[0].dims,h=m.length,g=V.normalizeAxes(n,h),w=!d&&g.length===0;m.forEach((I,S)=>{w||g.indexOf(S)>=0?u&&a.push(1):a.push(I)});let v=a.length,y=V.size(a);return{name:e,shaderCache:t,getShaderSource:I=>{let S=[],_=M("_A",r[0].dataType,h),P=j("output",s,v),A=o(_,P,g),z=A[2];for(let R=0,N=0;R<h;R++)w||g.indexOf(R)>=0?(u&&N++,z=`for(var j${R}: u32 = 0; j${R} < ${m[R]}; j${R}++) {\n                  ${A[2].includes("last_index")?`let last_index = j${R};`:""}\n                  ${_.indicesSet("input_indices",R,`j${R}`)}\n                  ${z}\n                }`):(S.push(`${_.indicesSet("input_indices",R,P.indicesGet("output_indices",N))};`),N++);return`\n\n        ${I.registerUniform("output_size","u32").declareVariables(_,P)}\n\n        ${I.mainStart()}\n          ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${_.type.indices};\n          let output_indices = ${P.offsetToIndices("global_idx")};\n\n          ${S.join(`\n`)}\n          ${A[0]}       // init ops for reduce max/min\n          ${A[1]}\n          ${z}\n          ${A[3]}\n          ${A.length===4?P.setByOffset("global_idx","value"):A.slice(4).join(`\n`)}\n        }`},getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:[{type:"uint32",data:y},...F(m),...F(a)]})}},jn=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>r.push(Number(o))),ge({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},mt=(e,t,r,o)=>{let n=e.inputs,s=n.length===1?r:jn(n,r);e.compute(rn(t,{hint:s.cacheKey,inputDependencies:["rank"]},[n[0]],s.noopWithEmptyAxes&&s.axes.length===0?Ul:o,s.axes,n[0].dataType,s.keepDims,s.noopWithEmptyAxes),{inputs:[0]})},zl=(e,t)=>{pt(e.inputs),mt(e,"ReduceLogSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,"value = log(value);"])},Vl=(e,t)=>{pt(e.inputs),mt(e,"ReduceL1",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += abs(${o.getByIndices("input_indices")});`,""])},Nl=(e,t)=>{pt(e.inputs),mt(e,"ReduceL2",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Wl=(e,t)=>{pt(e.inputs),mt(e,"ReduceLogSumExp",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += exp(${o.getByIndices("input_indices")});`,"value = log(value);"])},Hl=(e,t)=>{pt(e.inputs),mt(e,"ReduceMax",t,(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(o.indicesSet("input_indices",d,0));return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = max(value, ${o.getByIndices("input_indices")});`,""]})},Gl=(e,t)=>{pt(e.inputs),mt(e,"ReduceMean",t,(o,n,s)=>{let u=1;for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&(u*=e.inputs[0].dims[d]);return["var sum = f32(0);","",`sum += f32(${o.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${u});`]})},Ll=(e,t)=>{pt(e.inputs),mt(e,"ReduceMin",t,(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(`input_indices[${d}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = min(value, ${o.getByIndices("input_indices")});`,""]})},Fl=(e,t)=>{pt(e.inputs),mt(e,"ReduceProd",t,(o,n)=>[`var value = ${n.type.storage}(1);`,"",`value *= ${o.getByIndices("input_indices")};`,""])},jl=(e,t)=>{pt(e.inputs),mt(e,"ReduceSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,""])},ql=(e,t)=>{pt(e.inputs),mt(e,"ReduceSumSquare",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += t * t;`,""])},ft=(e,t,r)=>{if(t.length===0)return r;let o=1,n=1;for(let s=0;s<t.length;s++)t.indexOf(s)===-1?o*=e[s]:n*=e[s];return n<32&&o>1024},za=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Gl(e,t):Aa(e,t)},Va=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Vl(e,t):Ta(e,t)},Na=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Nl(e,t):Ea(e,t)},Wa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Wl(e,t):Oa(e,t)},Ha=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Hl(e,t):Pa(e,t)},Ga=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ll(e,t):ka(e,t)},La=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Fl(e,t):Ba(e,t)},Fa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jl(e,t):Ra(e,t)},ja=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?ql(e,t):Da(e,t)},qa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?zl(e,t):Ma(e,t)}});var Ka,Ya,Za,qn,Ja=q(()=>{"use strict";Ne();je();tn();Ka=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Ya=(e,t)=>{Ka(e.inputs);let r=(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(`input_indices[${d}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(rn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Za=(e,t)=>{Ka(e.inputs);let r=(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(`input_indices[${d}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(rn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},qn=e=>ge(e)});var Kl,Yl,Zl,Jl,nn,Ql,Qa,Kn=q(()=>{"use strict";Ne();Yr();we();Kl=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],d=e[5];if(u&&d)throw new Error("Attention cannot have both past and relative_position_bias");if(r.dims.length!==3)throw new Error(\'Input "input" must have 3 dimensions\');let a=r.dims[0],m=r.dims[1],h=r.dims[2];if(n.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimensions\');if(o.dims.length!==2)throw new Error(\'Input "weights" is expected to have 2 dimensions\');if(o.dims[0]!==h)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(n.dims[0]!==o.dims[1])throw new Error(\'Input "bias" dimension 0 should have same length as dimension 1 of input "weights"\');let g=n.dims[0]/3,w=g,v=w;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let P of t.qkvHiddenSizes)if(P%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");g=t.qkvHiddenSizes[0],w=t.qkvHiddenSizes[1],v=t.qkvHiddenSizes[2]}let y=m;if(g!==w)throw new Error("qkv_hidden_sizes first element should be same as the second");if(n.dims[0]!==g+w+v)throw new Error(\'Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes\');let C=0;if(u){if(w!==v)throw new Error(\'Input "past" expect k_hidden_size == v_hidden_size\');if(u.dims.length!==5)throw new Error(\'Input "past" must have 5 dimensions\');if(u.dims[0]!==2)throw new Error(\'Input "past" first dimension must be 2\');if(u.dims[1]!==a)throw new Error(\'Input "past" second dimension must be batch_size\');if(u.dims[2]!==t.numHeads)throw new Error(\'Input "past" third dimension must be num_heads\');if(u.dims[4]!==w/t.numHeads)throw new Error(\'Input "past" fifth dimension must be k_hidden_size / num_heads\');t.pastPresentShareBuffer||(C=u.dims[3])}let I=y+C,S=-1,_=0;if(s)throw new Error("Mask not supported");if(u)throw new Error("past is not supported");if(d)throw new Error("relativePositionBias is not supported");return{batchSize:a,sequenceLength:m,pastSequenceLength:C,kvSequenceLength:y,totalSequenceLength:I,maxSequenceLength:S,inputHiddenSize:h,hiddenSize:g,vHiddenSize:v,headSize:Math.floor(g/t.numHeads),vHeadSize:Math.floor(v/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:_,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Yl=(e,t,r,o)=>{let n=Fe(o),s=64,u=o/n;u<s?s=1:u/8<64&&(s=Math.ceil(u/8));let d=Math.ceil(o/n/s),m=[{type:et(t.dataType),data:1/o},{type:"uint32",data:u},{type:"uint32",data:d}],h=Le(t.dataType,n),g=w=>{let v=j("x",t.dataType,t.dims,n),y="thread_max_vector";n===2?y="max(thread_max_vector.x, thread_max_vector.y)":n===4&&(y="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");let C=dt(t.dataType),I=[{name:"d_inv",type:C},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return`\n  var<workgroup> wgMax: array<f32, ${s}>;\n  var<workgroup> wgSum: array<f32, ${s}>;\n  ${w.registerUniforms(I).declareVariables(v)}\n  ${w.mainStart([s,1,1])}\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ${Ze("f32",n,"-3.402823e+38f")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${it(C,n,"x[offset + i]")}, thread_max_vector);\n    }\n    wgMax[local_idx] = ${y};\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ${s}; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ${Ze("f32",n,"0")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(${it(C,n,"x[offset + i]")} - maxValue);\n    }\n    wgSum[local_idx] = ${tt("sumVector",n)};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${s}; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ${Ze("f32",n,"uniforms.d_inv")};\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ${it(C,n,"x[offset + i]")};\n        x[offset + i] = ${v.type.value}(exp(f32input - maxValue) / sum);\n      }\n    }\n  }`};e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:`${s};${h};${n}`},getShaderSource:g,getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:m})},{inputs:[t],outputs:[]})},Zl=(e,t,r,o,n,s)=>{let u=[n.batchSize,n.numHeads,n.sequenceLength,n.kvSequenceLength+n.pastSequenceLength],d=s.scale===0?1/Math.sqrt(n.headSize):s.scale,a=Fe(n.headSize),m=n.headSize/a,h=12,g={x:Math.ceil(n.totalSequenceLength/h),y:Math.ceil(n.sequenceLength/h),z:n.batchSize*n.numHeads},w=et(t.dataType),v=[{type:"uint32",data:n.sequenceLength},{type:"uint32",data:m},{type:"uint32",data:n.totalSequenceLength},{type:"uint32",data:n.kvSequenceLength},{type:w,data:d}],y=[t,r],C=S=>{let _=M("q",t.dataType,t.dims,a),P=M("key",r.dataType,r.dims,a),A=j("output",t.dataType,u),z=Le(t.dataType),R=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:z}];return`\n  const beta: ${z} = 1.0;\n  const TILE_SIZE = ${h}u;\n\n  var<workgroup> tileQ: array<${_.type.storage}, ${h*h}>;\n  var<workgroup> tileK: array<${_.type.storage}, ${h*h}>;\n  ${S.registerUniforms(R).declareVariables(_,P,A)}\n  ${S.mainStart([h,h,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${Ze(z,a)};\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ${tt("value",a)} * uniforms.alpha;\n    }\n  }`},I=e.compute({name:"AttentionProbs",shaderCache:{hint:`${a}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType,gpuDataType:0}],dispatchGroup:g,programUniforms:v}),getShaderSource:C},{inputs:y,outputs:[-1]})[0];return Yl(e,I,n.batchSize*n.numHeads*n.sequenceLength,n.totalSequenceLength),I},Jl=(e,t,r,o)=>{let n=[o.batchSize,o.sequenceLength,o.vHiddenSize],s=12,u={x:Math.ceil(o.vHeadSize/s),y:Math.ceil(o.sequenceLength/s),z:o.batchSize*o.numHeads},d=[{type:"uint32",data:o.sequenceLength},{type:"uint32",data:o.totalSequenceLength},{type:"uint32",data:o.vHeadSize},{type:"uint32",data:o.numHeads},{type:"uint32",data:o.vHiddenSize}],a=m=>{let h=M("probs",t.dataType,t.dims),g=M("v",r.dataType,r.dims),w=j("output",t.dataType,n),v=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`\n  const TILE_SIZE = ${s}u;\n  var<workgroup> tileQ: array<${h.type.value}, ${s*s}>;\n  var<workgroup> tileK: array<${h.type.value}, ${s*s}>;\n  ${m.registerUniforms(v).declareVariables(h,g,w)}\n  ${m.mainStart([s,s,1])}\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${h.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`};return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:t.dataType,gpuDataType:0}],dispatchGroup:u,programUniforms:d}),getShaderSource:a},{inputs:[t,r],outputs:[0]})[0]},nn=(e,t,r,o,n,s,u,d,a,m,h)=>{let g=Zl(e,t,r,a,m,h);Jl(e,g,o,m)},Ql=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],o=t.sequenceLength,n=t.inputHiddenSize,s=t.headSize,u=12,d={x:Math.ceil(t.headSize/u),y:Math.ceil(t.sequenceLength/u),z:t.batchSize*t.numHeads},a=[e.inputs[0],e.inputs[1],e.inputs[2]],m=[{type:"uint32",data:o},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],h=g=>{let w=j("output_q",a[0].dataType,r),v=j("output_k",a[0].dataType,r),y=j("output_v",a[0].dataType,r),C=M("input",a[0].dataType,a[0].dims),I=M("weight",a[1].dataType,a[1].dims),S=M("bias",a[2].dataType,a[2].dims),_=C.type.storage,P=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`\n  const TILE_SIZE = ${u}u;\n  var<workgroup> tileInput: array<${_}, ${u*u}>;\n  var<workgroup> tileWeightQ: array<${_}, ${u*u}>;\n  var<workgroup> tileWeightK: array<${_}, ${u*u}>;\n  var<workgroup> tileWeightV: array<${_}, ${u*u}>;\n  ${g.registerUniforms(P).declareVariables(C,I,S,w,v,y)}\n  ${g.mainStart([u,u,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${_}(0);\n    var valueK = ${_}(0);\n    var valueV = ${_}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:d,programUniforms:m}),getShaderSource:h},{inputs:a,outputs:[-1,-1,-1]})},Qa=(e,t)=>{let r=Kl(e.inputs,t),[o,n,s]=Ql(e,r);return nn(e,o,n,s,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}});var Xl,ed,td,Xa,ei=q(()=>{"use strict";Xt();$e();je();we();Xl=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(o,n,s)=>{let u=n.length;if(u!==o.length)throw new Error(`${s}: num dimensions != ${u}`);n.forEach((d,a)=>{if(d!==o[a])throw new Error(`${s}: dim[${a}] do not match`)})};if(e[0].dims.length>1){let o=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,o,"Invalid input scale"),r(e[2].dims,o,"Invalid input B"),r(e[3].dims,o,"Invalid input mean"),r(e[4].dims,o,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},ed=(e,t)=>{let{epsilon:r,spatial:o,format:n}=t,s=e[0].dims,u=o?Fe(s[s.length-1]):1,d=n==="NHWC"&&s.length>1?u:1,a=V.size(s)/u,m=Be(s.length)&&o,h=m?s.length:s,g=M("x",e[0].dataType,e[0].dims,u),w=M("scale",e[1].dataType,e[1].dims,d),v=M("bias",e[2].dataType,e[2].dims,d),y=M("inputMean",e[3].dataType,e[3].dims,d),C=M("inputVar",e[4].dataType,e[4].dims,d),I=j("y",e[0].dataType,h,u),S=()=>{let P="";if(o)P=`let cOffset = ${s.length===1?"0u":n==="NHWC"?`outputIndices[${s.length-1}] / ${u}`:"outputIndices[1]"};`;else if(n==="NCHW")P=`\n            ${I.indicesSet("outputIndices","0","0")}\n            let cOffset = ${I.indicesToOffset("outputIndices")};`;else{P=`var cIndices = ${w.type.indices}(0);\n                       cIndices[0] = outputIndices[${s.length-1}];`;for(let A=1;A<w.rank;A++)P+=`cIndices[${A}] = outputIndices[${A}];`;P+=`let cOffset = ${w.indicesToOffset("cIndices")};`}return P},_=P=>`\n  const epsilon = ${r};\n  ${P.registerUniform("outputSize","u32").declareVariables(g,w,v,y,C,I)}\n  ${P.mainStart()}\n  ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${I.offsetToIndices(`global_idx * ${u}`)};\n    ${S()}\n    let scale = ${w.getByOffset("cOffset")};\n    let bias = ${v.getByOffset("cOffset")};\n    let inputMean = ${y.getByOffset("cOffset")};\n    let inputVar = ${C.getByOffset("cOffset")};\n    let x = ${g.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${I.setByOffset("global_idx","value")}\n  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${o}_${u}`,inputDependencies:m?["rank","type","type","type","type"]:void 0},getShaderSource:_,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:m?[{type:"uint32",data:a},...F(s)]:[{type:"uint32",data:a}]})}},td=e=>ge(e),Xa=(e,t)=>{let{inputs:r,outputCount:o}=e,n=td({...t,outputCount:o});if(Qt.webgpu.validateInputContent&&Xl(r,n),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(ed(r,n))}});var rd,nd,ti,ri=q(()=>{"use strict";$e();we();rd=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},nd=e=>{let t=e[0].dims,r=e[0].dims[2],o=V.size(t)/4,n=e[0].dataType,s=M("input",n,t,4),u=M("bias",n,[r],4),d=M("residual",n,t,4),a=j("output",n,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:h=>`\n  const channels = ${r}u / 4;\n  ${h.declareVariables(s,u,d,a)}\n\n  ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let value = ${s.getByOffset("global_idx")}\n      + ${u.getByOffset("global_idx % channels")} + ${d.getByOffset("global_idx")};\n    ${a.setByOffset("global_idx","value")}\n  }`}},ti=e=>{rd(e.inputs),e.compute(nd(e.inputs))}});var od,Ae,ni,oi,ai,ii,si,ui,li,di,ci,ad,pi,mi,fi,hi,on,gi,an,yi,bi,wi,vi,$i,Si,xi,_i,Ci,Ii,Ai,Ti,Ei,Oi,Pi,ki,Bi,Yn=q(()=>{"use strict";Ne();$e();je();we();od=(e,t,r,o,n,s)=>{let u=Math.ceil(t/4),d="";typeof n=="string"?d=`${n}(a)`:d=n("a");let a=M("inputData",r,[u],4),m=j("outputData",o,[u],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(a,m)}\n\n  ${s??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${a.getByOffset("global_idx")};\n    ${m.setByOffset("global_idx",d)}\n  }`},Ae=(e,t,r,o,n,s=e.dataType)=>({name:t,shaderCache:{hint:n,inputDependencies:["type"]},getShaderSource:u=>od(u,V.size(e.dims),e.dataType,s,r,o),getRunData:u=>({outputs:[{dims:e.dims,dataType:s}],dispatchGroup:{x:Math.ceil(V.size(u[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(V.size(e.dims)/4)}]})}),ni=e=>{e.compute(Ae(e.inputs[0],"Abs","abs"))},oi=e=>{e.compute(Ae(e.inputs[0],"Acos","acos"))},ai=e=>{e.compute(Ae(e.inputs[0],"Acosh","acosh"))},ii=e=>{e.compute(Ae(e.inputs[0],"Asin","asin"))},si=e=>{e.compute(Ae(e.inputs[0],"Asinh","asinh"))},ui=e=>{e.compute(Ae(e.inputs[0],"Atan","atan"))},li=e=>{e.compute(Ae(e.inputs[0],"Atanh","atanh"))},di=e=>ge(e),ci=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute \'to\' from \'Cast\' operator): ${t.to}`)}e.compute(Ae(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},ad=e=>{let t=e.length>=2&&e[1].data!==0?e[1].getFloat32Array()[0]:Qr,r=e.length>=3&&e[2].data!==0?e[2].getFloat32Array()[0]:Xr;return ge({min:t,max:r})},pi=(e,t)=>{let r=e.inputs.length===1?t:ad(e.inputs),o=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Clip",n=>`clamp(${n}, clip_min_, clip_max_)`,`\n    const clip_min_: vec4<${o}> = vec4(${o}(${r.min}));\n    const clip_max_: vec4<${o}> = vec4(${o}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},mi=e=>{e.compute(Ae(e.inputs[0],"Ceil","ceil"))},fi=e=>{e.compute(Ae(e.inputs[0],"Cos","cos"))},hi=e=>{e.compute(Ae(e.inputs[0],"Cosh","cosh"))},on=e=>ge(e),gi=(e,t)=>{let r=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},an=(e,t="f32")=>`\nconst r0: ${t} = 0.3275911;\nconst r1: ${t} = 0.254829592;\nconst r2: ${t} = -0.284496736;\nconst r3: ${t} = 1.421413741;\nconst r4: ${t} = -1.453152027;\nconst r5: ${t} = 1.061405429;\n\nfn erf_vf32(v: ${e}) -> ${e} {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,yi=e=>{let t=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,an(`vec4<${t}>`,t)))},bi=e=>{e.compute(Ae(e.inputs[0],"Exp","exp"))},wi=e=>{e.compute(Ae(e.inputs[0],"Floor","floor"))},vi=e=>{let t=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,an(`vec4<${t}>`,t)))},$i=(e,t)=>{let r=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},Si=e=>{e.compute(Ae(e.inputs[0],"Not",t=>`!${t}`))},xi=e=>{e.compute(Ae(e.inputs[0],"Neg",t=>`-${t}`))},_i=e=>{e.compute(Ae(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},Ci=e=>{let t=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},Ii=e=>{e.compute(Ae(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},Ai=e=>{e.compute(Ae(e.inputs[0],"Sin","sin"))},Ti=e=>{e.compute(Ae(e.inputs[0],"Sinh","sinh"))},Ei=e=>{e.compute(Ae(e.inputs[0],"Sqrt","sqrt"))},Oi=e=>{e.compute(Ae(e.inputs[0],"Tan","tan"))},Pi=e=>{e.compute(Ae(e.inputs[0],"Tanh","tanh"))},ki=(e,t)=>{let r=dt(e.inputs[0].dataType);return e.compute(Ae(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${r}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},Bi=e=>{e.compute(Ae(e.inputs[0],"Log","log"))}});var sd,ud,Ri,Di=q(()=>{"use strict";$e();we();Yn();sd=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},ud=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=M("input",e[0].dataType,e[0].dims,4),o=M("bias",e[0].dataType,[e[0].dims[2]],4),n=j("output",e[0].dataType,t,4),s=V.size(t)/4,u=Le(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:a=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${a.declareVariables(r,o,n)}\n\n  ${an(`vec4<${u}>`,u)}\n\n  ${a.mainStart()}\n    ${a.guardAgainstOutOfBoundsWorkgroupSizes(s)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${n.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},Ri=e=>{sd(e.inputs),e.compute(ud(e.inputs))}});var ld,dd,ht,Mi,Ui,zi,Vi,Ni,Wi,Hi,Gi,Li,Fi,ji=q(()=>{"use strict";Ne();$e();we();ld=(e,t,r,o,n,s,u,d,a,m,h,g,w)=>{let v,y;typeof d=="string"?v=y=(R,N)=>`${d}((${R}),(${N}))`:typeof d=="function"?v=y=d:(v=d.scalar,y=d.vector);let C=g?t.length:t,I=g?r.length:r,S=g?o.length:o,_=j("outputData",h,S,4),P=M("aData",a,C,4),A=M("bData",m,I,4),z;if(n)if(s){let R=V.size(t)===1,N=V.size(r)===1,T=t.length>0&&t[t.length-1]%4===0,H=r.length>0&&r[r.length-1]%4===0;R||N?z=_.setByOffset("global_idx",y(R?`${P.type.value}(${P.getByOffset("0")}.x)`:P.getByOffset("global_idx"),N?`${A.type.value}(${A.getByOffset("0")}.x)`:A.getByOffset("global_idx"))):z=`\n            let outputIndices = ${_.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${P.broadcastedIndicesToOffset("outputIndices",_)};\n            let offsetB = ${A.broadcastedIndicesToOffset("outputIndices",_)};\n            ${_.setByOffset("global_idx",y(u||T?P.getByOffset("offsetA / 4u"):`${P.type.value}(${P.getByOffset("offsetA / 4u")}[offsetA % 4u])`,u||H?A.getByOffset("offsetB / 4u"):`${A.type.value}(${A.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else z=_.setByOffset("global_idx",y(P.getByOffset("global_idx"),A.getByOffset("global_idx")));else{if(!s)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let R=(N,T,H="")=>{let ie=`aData[indexA${T}][componentA${T}]`,Z=`bData[indexB${T}][componentB${T}]`;return`\n            let outputIndices${T} = ${_.offsetToIndices(`global_idx * 4u + ${T}u`)};\n            let offsetA${T} = ${P.broadcastedIndicesToOffset(`outputIndices${T}`,_)};\n            let offsetB${T} = ${A.broadcastedIndicesToOffset(`outputIndices${T}`,_)};\n            let indexA${T} = offsetA${T} / 4u;\n            let indexB${T} = offsetB${T} / 4u;\n            let componentA${T} = offsetA${T} % 4u;\n            let componentB${T} = offsetB${T} % 4u;\n            ${N}[${T}] = ${H}(${v(ie,Z)});\n          `};h===9?z=`\n            var data = vec4<u32>(0);\n            ${R("data",0,"u32")}\n            ${R("data",1,"u32")}\n            ${R("data",2,"u32")}\n            ${R("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:z=`\n            ${R("outputData[global_idx]",0)}\n            ${R("outputData[global_idx]",1)}\n            ${R("outputData[global_idx]",2)}\n            ${R("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(P,A,_)}\n\n        ${w??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${z}\n      }`},dd=(e,t,r,o,n,s,u=r.dataType)=>{let d=!V.areEqual(r.dims,o.dims),a=r.dims,m=V.size(r.dims),h=!1,g=!1,w=[d];if(d){let y=lt.calcShape(r.dims,o.dims,!1);if(!y)throw new Error("Can\'t perform binary op on the given tensors");a=y,m=V.size(a);let C=V.size(r.dims)===1,I=V.size(o.dims)===1,S=r.dims.length>0&&r.dims[r.dims.length-1]%4===0,_=o.dims.length>0&&o.dims[o.dims.length-1]%4===0;w.push(C),w.push(I),w.push(S),w.push(_);let P=1;for(let A=1;A<a.length;A++){let z=r.dims[r.dims.length-A]??1,R=o.dims[o.dims.length-A]??1;if(z===R)P*=z;else break}P%4===0?(g=!0,h=!0):(C||I||S||_)&&(h=!0)}else h=!0;w.push(h);let v=Be(r.dims.length)&&Be(o.dims.length)&&Be(a.length);return{name:e,shaderCache:{hint:t+w.map(y=>y.toString()).join("_"),inputDependencies:v?["rank","rank"]:["dims","dims"]},getShaderSource:y=>ld(y,r.dims,o.dims,a,h,d,g,n,r.dataType,o.dataType,u,v,s),getRunData:()=>({outputs:[{dims:a,dataType:u}],dispatchGroup:{x:Math.ceil(m/64/4)},programUniforms:v?[{type:"uint32",data:Math.ceil(V.size(a)/4)},...F(r.dims),...F(o.dims),...F(a)]:[{type:"uint32",data:Math.ceil(V.size(a)/4)}]})}},ht=(e,t,r,o,n,s)=>{e.compute(dd(t,n??"",e.inputs[0],e.inputs[1],r,o,s))},Mi=e=>{ht(e,"Add",(t,r)=>`${t}+${r}`)},Ui=e=>{ht(e,"Div",(t,r)=>`${t}/${r}`)},zi=e=>{ht(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},Vi=e=>{ht(e,"Mul",(t,r)=>`${t}*${r}`)},Ni=e=>{let t=M("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;ht(e,"Pow",{scalar:(o,n)=>`pow_custom(${o},${n})`,vector:(o,n)=>`pow_vector_custom(${o},${n})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},Wi=e=>{ht(e,"Sub",(t,r)=>`${t}-${r}`)},Hi=e=>{ht(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},Gi=e=>{ht(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},Li=e=>{ht(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},Fi=e=>{ht(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}});var pd,md,fd,hd,qi,Ki,Yi=q(()=>{"use strict";$e();je();we();pd=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].dataType,r=e[0].dims.length;for(let o of e){if(o.dataType!==t)throw new Error("input tensors should be one type");if(o.dims.length!==r)throw new Error("input tensors should have the same shape")}},md=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,fd=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;++n){let s=t.setByOffset("global_idx",e[n].getByIndices("indices"));r===1?o.push(s):n===0?o.push(`if (inputIndex == ${n}u) { ${s} }`):n===r-1?o.push(`else { ${s} }`):o.push(`else if (inputIndex == ${n}) { ${s} }`)}return o.join(`\n`)},hd=(e,t)=>{let r=e[0].dims.slice();if(t>=r.length||t<-1*r.length)throw new Error("axis specified for concat doesn\'t match input dimensionality");let o=t<0?r.length+t:t,n=r.slice(0);for(let A=1;A<e.length;A++){let z=e[A].dims.slice();for(let R=0;R<r.length;R++)if(R===o)n[o]+=z[R];else if(r[R]!==z[R])throw new Error("non concat dimensions must match")}let s=V.size(n),u=new Array(e.length),d=new Array(e.length),a=e[0].dataType,m=0,h=[],g=[],w=[],v=[{type:"uint32",data:s}];for(let A=0;A<e.length;++A)m+=e[A].dims[o],u[A]=m,w.push(Be(e[A].dims.length)),g.push(w[A]?e[A].dims.length:e[A].dims),d[A]=M(`input${A}`,a,g[A]),h.push(w[A]?"rank":"dims"),v.push({type:"uint32",data:u[A]});for(let A=0;A<e.length;++A)w[A]&&v.push(...F(e[A].dims));let y=Be(n.length);y&&v.push(...F(n));let C=y?n.length:n,I=j("output",a,C),S=I.indicesGet("indices",o),_=Array.from(Array(u.length).keys()).map(A=>`uniforms.sizeInConcatAxis${A}`).join(","),P=A=>`\n\n  ${(()=>{A.registerUniform("outputSize","u32");for(let z=0;z<e.length;z++)A.registerUniform(`sizeInConcatAxis${z}`,"u32");return A.declareVariables(...d,I)})()}\n\n  ${md(u.length,_)}\n\n  ${A.mainStart()}\n    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${I.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${S});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${u.length}u>(${_});\n      ${S} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${fd(d,I)}\n  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:v}),getShaderSource:P}},qi=(e,t)=>{pd(e.inputs),e.compute(hd(e.inputs,t.axis))},Ki=e=>ge({axis:e.axis})});var gt,sn,At=q(()=>{"use strict";$e();gt=(e,t)=>{switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:`value = max(value, ${t}(0.0));`};case"Sigmoid":return{activationFunction:"",applyActivation:`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`};case"Clip":return{activationFunction:`const clip_min_=${t}(${e.clipMin});const clip_max_=${t}(${e.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},sn=e=>{let t=e?.activation||"";if(t==="Clip"){let[r,o]=e?.activation_params||[Qr,Xr];return{activation:t,clipMax:o,clipMin:r,activationCacheKey:`${t}:${r},${o}`}}return{activation:t,activationCacheKey:t}}});var Ke,un,ln=q(()=>{"use strict";Ke=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},un=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `});var dn,Zn=q(()=>{"use strict";dn=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`});var gd,yd,xr,Zi,bd,_r,wd,cn,Cr=q(()=>{"use strict";$e();we();At();ln();gd=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,yd=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,xr=(e,t,r="f32",o,n=!1,s=32,u=!1,d=32)=>{let a=t[1]*e[1],m=t[0]*e[0],h=n?a:s,g=n?s:a,w=h/t[0],v=s/t[1];if(!((n&&w===4&&e[1]===4||!n&&(w===3||w===4))&&h%t[0]===0&&s%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${n} is true, innerElementSize ${w} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${w} must be 3 or 4.\n  tileAWidth ${h} must be divisible by workgroupSize[0]${t[0]}. tileInner ${s} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${w}<${r}>, ${h/w}>, ${g}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${m/e[0]}>, ${s}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${w};\nconst tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${u?"0":"i32(globalId.z)"};\n  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${a};\n\n  let numTiles = ${u?`${Math.ceil(d/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n  var kStart = ${u?`i32(globalId.z) * ${d}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${v};\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${gd(n,o)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${w===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${yd(n,w)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},Zi=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,bd=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",_r=(e,t,r="f32",o,n=!1,s=32,u=!1,d=32,a=!1)=>{let m=e[1]*t[1],h=e[0]*t[0],g=n?m:s,w=n?s:m;if(!(w%t[1]===0&&g%t[0]===0&&s%t[1]===0))throw new Error(`tileAHight ${w} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${g} must be divisible by workgroupSize[0]${t[0]}, tileInner ${s} must be divisible by workgroupSize[1]${t[1]}`);let v=w/t[1],y=g/t[0],C=s/t[1],I=a?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${m};\n    let globalColStart = i32(workgroupId.x) * ${h};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${w}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${g}; inputCol = inputCol + ${t[0]}) {\n          ${Zi(n,o)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${s}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${h}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${o?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${m};\n\nlet tileRowA = i32(localId.y) * ${v};\nlet tileColA = i32(localId.x) * ${y};\nlet tileRowB = i32(localId.y) * ${C};\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${y}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${Zi(n,o)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${C}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${o?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${bd(n)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${g}>, ${w}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${h}>, ${s}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${u?"0":"i32(globalId.z)"};\n    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n    let numTiles = ${u?`${Math.ceil(d/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n    var kStart = ${u?`i32(globalId.z) * ${d}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${I}\n  }\n`},wd=(e,t,r,o,n,s=!1)=>{let[u,d,a]=n,[m,h,g,w]=o,v=er(u,a),y=er(d,a),C=Le(o[0].type.tensor),I=()=>{let P=h.rank,A=m.rank,z=`var aIndices: ${h.type.indices};`;for(let R=P-2-1,N=A-1;R>=0;R--,N--)z+=`\naIndices[${R}] = ${A>1?`batchIndices[${N}]`:"batchIndices"};`;return v.forEach(R=>{z+=`\naIndices[${R}] = 0;`}),z+=`\naIndices[${P-2}] = u32(row);\n                   aIndices[${P-1}] = u32(colIn);`,z},S=()=>{let P=g.rank,A=m.rank,z=`var bIndices: ${g.type.indices};`;for(let R=P-2-1,N=A-1;R>=0;R--,N--)z+=`\nbIndices[${R}] = ${A>1?`batchIndices[${N}]`:"batchIndices"};`;return y.forEach(R=>{z+=`\nbIndices[${R}] = 0;`}),z+=`\nbIndices[${P-2}] = u32(row);\n                   bIndices[${P-1}] = u32(colIn);`,z};return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${m.type.indices}) -> ${Ke(e,C)} {\n      var value = ${Ke(e,C)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ${I()}\n        value = ${h.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${m.type.indices}) -> ${Ke(e,C)} {\n      var value = ${Ke(e,C)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ${S()}\n        value = ${g.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Ke(e,C)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${s?"bias[colIn]":`${Ke(e,C)}(bias[row])`};`:""}\n        ${r}\n        ${w.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},cn=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,d=s.slice(0,-2),a=u.slice(0,-2),m=o?o.slice(0,-2):r.slice(0,-2),h=Be(m.length),g=h?m.length:m,w=en("batchDims",e[0].dataType,g,1),v=V.size(m),y=s[s.length-2],C=s[s.length-1],I=u[u.length-1],S=C%4===0&&I%4===0,_=y<=8?[4,1,1]:[4,4,1],P=[8,8,1],A=[Math.ceil(I/P[0]/_[0]),Math.ceil(y/P[1]/_[1]),Math.ceil(v/P[2]/_[2])],z=Le(e[0].dataType),R=S?4:1,N=[...d,y,C/R],T=Be(N.length),H=T?N.length:N,ie=[...a,C,I/R],Z=Be(ie.length),K=Z?ie.length:ie,Q=[v,y,I/R],X=M("a",e[0].dataType,H,R),Ee=M("b",e[1].dataType,K,R),Pe=j("result",e[0].dataType,Q.length,R),fe=[X,Ee],Ce=[{type:"int32",data:y},{type:"int32",data:I},{type:"int32",data:C}];h&&Ce.push(...F(m)),T&&Ce.push(...F(N)),Z&&Ce.push(...F(ie));let he=[];he.push(T?"rank":"dims"),he.push(Z?"rank":"dims");let ye=e.length>2,{activationFunction:We,applyActivation:Me}=gt(t,Pe.type.value),Ge=wd(R,ye,Me,[w,X,Ee,Pe],[d,a,m],n);if(ye){let re=n?R:1;fe.push(M("bias",e[2].dataType,e[2].dims.length,re)),Ce.push(...F(e[2].dims)),he.push("rank")}Ce.push(...F(Q));let G=re=>`\n  ${re.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(w).declareVariables(...fe,Pe)}\n  ${We}\n  ${Ge}\n  ${S?xr(_,P,z,w):_r(_,P,z,w)}\n                   `;return{name:"MatMul",shaderCache:{hint:t.activationCacheKey+`${_}${S}${n}`,inputDependencies:he},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:A[0],y:A[1],z:A[2]},programUniforms:Ce}),getShaderSource:G}}});var vd,Ji,Qi=q(()=>{"use strict";It();we();At();ln();Zn();Cr();vd=(e,t,r,o,n=!1,s,u=4,d=4,a=4,m="f32")=>{let h=Z=>{switch(Z){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${m}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${Z} is not supported.`)}},g=Z=>{switch(Z){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${Z} is not supported.`)}},w=e?`\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    `:`\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    `,v=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,y=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",C=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",I=e?"row":"col",S=e?"col":"row",_=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${I} / outWidth;\n    let outCol = ${I} % outWidth;\n\n    let WRow = ${S} / (filterDims[1] * inChannels);\n    let WCol = ${S} / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ${S} % inChannels;\n    var resData = ${Ke(u,m)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the \'same\' padding type.\n    if (xRow >= 0 && xRow < ${y} && xCol >= 0 && xCol < ${C}) {\n      ${w}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${h(u)}\n    }\n    return resData;`,P=e?t&&o?`\n    let col = colIn * ${u};\n    ${_}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ${_}\n    }\n    return ${Ke(u,m)}(0.0);`:o&&r?`\n    let col = colIn * ${u};\n    ${_}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ${_}\n    }\n    return ${Ke(u,m)}(0.0);`,A=`${g(d)}`,z=Ke(a,m),R=e?Ke(u,m):Ke(d,m),N=e?Ke(d,m):Ke(u,m),{activationFunction:T,applyActivation:H}=gt(s,z);return`\n    ${T}\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${R} {\n      ${e?P:A}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${N} {\n      ${e?A:P}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${z}) {\n      let col = colIn * ${a};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${v}\n      ${un(n)}\n      ${H}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},Ji=(e,t,r,o,n,s,u,d)=>{let a=t.format==="NHWC",m=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a&&(m%4===0||m%3===0)&&v%4===0,C=a?v:g*w,I=a?g*w:v,S=[8,8,1],_=o<=8?[4,1,1]:[4,4,1],P=[Math.ceil(C/S[0]/_[0]),Math.ceil(I/S[1]/_[1]),Math.ceil(h/S[2]/_[2])];De("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${P}`);let A=y?a&&m%4!==0?3:4:1,z=S[1]*_[1],R=S[0]*_[0],N=Math.max(S[0]*A,S[1]),T=o%z===0,H=n%R===0,ie=s%N===0,Z=y?[A,4,4]:[1,1,1],K=Le(e[0].dataType),Q=y?4:1,X=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],Ee=M("x",e[0].dataType,e[0].dims.length,A===3?1:A),Pe=M("w",e[1].dataType,e[1].dims.length,Q),fe=[Ee,Pe];X.push(...F(e[0].dims)),X.push(...F(e[1].dims));let Ce=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${y?`vec4<${K}>`:K}) {\n        result[flatIndex] = ${y?`vec4<${K}>`:K}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${y?`vec4<${K}>`:K}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${y?"/ 4":""}, value);\n      }`;if(u){let ye=M("bias",e[2].dataType,e[2].dims.length,Q);fe.push(ye),X.push(...F(e[2].dims)),Ce+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?`vec4<${K}>`:K} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}let he=j("result",e[0].dataType,r.length,Q);return X.push(...F(r)),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:P[0],y:P[1],z:P[2]},programUniforms:X}),getShaderSource:ye=>`\n        ${dn("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${ye.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...fe,he)}\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[0]}, ${t.kernelShape[1]});\n        const pad : vec2<i32> = vec2<i32>(${t.pads[0]}, ${t.pads[1]});\n        const stride : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        ${Ce}\n        ${vd(a,T,H,ie,u,t,Z[0],Z[1],Z[2],K)}\n            ${y?xr(_,S,K,void 0,!a,N):_r(_,S,K,void 0,!a,N,!1,void 0,d)}`}}});var Jn,Xi=q(()=>{"use strict";$e();we();Xn();At();Jn=(e,t,r)=>{let o=e.length>2,n=o?"value += b[output_channel];":"",s=e[0].dims,u=e[1].dims,d=u[0]/t.group,a=t.format==="NHWC",m=Qn(s,u,t.dilations,t.pads,t.strides,a),h=V.size(m),g=j("output",e[0].dataType,m),{activationFunction:w,applyActivation:v}=gt(t,g.type.value),y=M("x",e[0].dataType,s),C=M("w",e[1].dataType,u),I=[y,C];o&&I.push(M("b",e[2].dataType,e[2].dims));let S=_=>`\n  const strides: vec2<u32> = vec2(${t.strides[0]}u, ${t.strides[1]}u);\n  const pads: vec2<u32> = vec2(${t.pads[0]}u, ${t.pads[1]}u);\n\n  ${_.declareVariables(...I,g)}\n\n  ${w}\n\n  ${_.mainStart()}\n    ${_.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n    let outputIndices = ${g.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${a?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${a?1:2}], outputIndices[${a?2:3}]) * strides - pads;\n    let group_id: u32 = output_channel / ${d}u;\n\n    var value: ${g.type.value} = ${g.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ${u[1]}u; wInChannel++) {\n      let input_channel = group_id * ${u[1]}u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ${u[2]}u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ${t.dilations[0]}u;\n\n        if (xHeight < 0u || xHeight >= ${s[a?1:2]}u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ${u[3]}u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ${t.dilations[1]}u;\n          if (xWidth < 0u || xWidth >= ${s[a?2:3]}u) {\n            continue;\n          }\n\n          let xVal = ${a?y.get("batch","xHeight","xWidth","input_channel"):y.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${C.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${n}\n    ${v}\n    ${g.setByOffset("global_idx","value")}\n  }`;return{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r?r(m):m,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:S}}});var eo,$d,es,to=q(()=>{"use strict";$e();Cr();we();At();eo=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,d=s[s.length-2],a=u[u.length-1],m=s[s.length-1],h=Fe(a),g=Fe(m),w=Fe(d),v=V.size(r)/h/w,y=e.length>2,C=o?o.slice(0,-2):r.slice(0,-2),S=[V.size(C),d,a],_=[{type:"uint32",data:v},{type:"uint32",data:d},{type:"uint32",data:a},{type:"uint32",data:m},...F(C),...F(s),...F(u)];y&&_.push(...F(e[2].dims)),_.push(...F(S));let P=A=>{let z=en("batch_dims",e[0].dataType,C.length),R=M("a",e[0].dataType,s.length,g),N=M("b",e[1].dataType,u.length,h),T=j("output",e[0].dataType,S.length,h),{activationFunction:H,applyActivation:ie}=gt(t,T.type.value),Z=[R,N],K="";if(y){let he=n?h:1;Z.push(M("bias",e[2].dataType,e[2].dims.length,he)),K=`${n?`value += bias[col / ${he}];`:`value += ${T.type.value}(bias[row + i]);`}`}let Q=s.slice(0,-2),X=u.slice(0,-2),Ee=er(Q,C),Pe=er(X,C),fe=(he,ye)=>{let We=he.rank,Me=he.name;if(We===2)return`var ${Me}_indices = ${he.type.indices}(0u, 0u);`;let Ge=z.rank,G=`var ${Me}_indices: ${he.type.indices};`;for(let re=We-2-1,be=Ge-1;re>=0;re--,be--)G+=`\n${Me}_indices[${re}] = ${Ge>1?`batch_indices[${be}]`:"batch_indices"};`;return ye.forEach(re=>{G+=`\n${Me}_indices[${re}] = 0;`}),G+=`${Me}_indices[${We-2}] = 0u;\n                     ${Me}_indices[${We-1}] = 0u;`,G},Ce=()=>{let he=`var a_data: ${R.type.value};`;for(let ye=0;ye<g;ye++)he+=`\n              let b_data${ye} = b[(b_offset + (k + ${ye}) * uniforms.N + col) / ${h}];`;for(let ye=0;ye<w;ye++){he+=`a_data = a[(a_offset + (row + ${ye}) * uniforms.K + k) / ${g}];`;for(let We=0;We<g;We++)he+=`\n            values[${ye}] = fma(${N.type.value}(a_data${g===1?"":`[${We}]`}), b_data${We}, values[${ye}]);\n`}return he};return`\n  ${A.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(z).declareVariables(...Z,T)}\n  ${H}\n  ${A.mainStart()}\n    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    let col = (global_idx % (uniforms.N / ${h})) * ${h};\n    var index1 = global_idx / (uniforms.N / ${h});\n    let stride1 = uniforms.M / ${w};\n    let row = (index1 % stride1) * ${w};\n    let batch = index1 / stride1;\n\n    ${r.length===2?"":`let batch_indices = ${z.offsetToIndices("batch")};`}\n    ${fe(R,Ee)}\n    let a_offset = ${R.indicesToOffset("a_indices")};\n    ${fe(N,Pe)}\n    let b_offset = ${N.indicesToOffset("b_indices")};\n    var values: array<${T.type.value}, ${w}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${g}) {\n      ${Ce()}\n    }\n    for (var i = 0u; i < ${w}u; i++) {\n      var value = values[i];\n      ${K}\n      ${ie}\n      let cur_indices = ${T.type.indices}(batch, row + i, col);\n      let offset = ${T.indicesToOffset("cur_indices")};\n      ${T.setByOffset(`offset / ${h}`,"value")};\n    }\n  }\n  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activationCacheKey}_${h}_${g}_${w}_${n}`,inputDependencies:y?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:_}),getShaderSource:P}},$d=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},es=e=>{$d(e.inputs);let t=lt.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can\'t use matmul on the given tensors");let r=t[t.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&o<8?e.compute(eo(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(cn(e.inputs,{activation:"",activationCacheKey:""},t))}});var Qn,ts,Sd,rs,ro,xd,_d,no,Xn=q(()=>{"use strict";$e();je();Qi();Cr();Xi();At();to();tr();Qn=(e,t,r,o,n,s)=>{let u=e[0],d=e.slice(s?1:2,s?3:4),a=d.length,m=t[0],g=t.slice(2).map((y,C)=>y+(y-1)*(r[C]-1)),v=d.map((y,C)=>y+o[C]+o[C+a]).map((y,C)=>Math.floor((y-g[C]+n[C])/n[C]));return v.splice(0,0,u),v.splice(s?3:1,0,m),v},ts=[2,3,1,0],Sd=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*t.group;if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==n*2)throw new Error(`pads should be ${n*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},rs=(e,t)=>{let r=e.kernelShape.slice();for(let s=2;s<t[1].dims.length;++s)r[s-2]===0&&(r[s-2]=t[1].dims[s]);let o=e.pads.slice();Ut.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,o,e.format==="NHWC",e.autoPad);let n=Object.assign({},e);return Object.assign(n,{kernelShape:r,pads:o,cacheKey:e.cacheKey}),n},ro=e=>{let t=sn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],n=e.dilations,s=e.group,u=e.kernel_shape,d=e.pads,a=e.strides,m=e.w_is_const();return ge({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,pads:d,strides:a,wIsConst:m,...t})},xd=(e,t,r)=>{let o=rs(r,t),n=r.format==="NHWC";if(r.group!==1){e.compute(Jn(t,o));return}let s=t.length===3,u=t[0].dims[n?1:2],d=t[0].dims[n?2:3],a=t[0].dims[n?3:1],m=t[1].dims[2],h=t[1].dims[3],g=Qn(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,n),w=g[n?1:2],v=g[n?2:3],y=g[n?3:1],C=n&&m===u&&h===d&&r.pads[0]===0&&r.pads[1]===0;if(C||m===1&&h===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let R=g[0],N,T,H,ie=[];if(n){let Q=e.kernelCustomData.wT??e.compute(st(t[1],ts),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=Q),C){let X=u*d*a;N=t[0].reshape([1,R,X]),T=Q.reshape([1,X,y]),H=[1,R,y]}else N=t[0].reshape([R,u*d,a]),T=Q.reshape([1,a,y]),H=[R,w*v,y];ie.push(N),ie.push(T)}else N=t[0].reshape([R,a,u*d]),T=t[1].reshape([1,y,a]),H=[R,y,w*v],ie.push(T),ie.push(N);s&&ie.push(t[2]);let Z=H[2],K=ie[0].dims[ie[0].dims.length-1];Z<8&&K<8?e.compute(eo(ie,o,g,H,n),{inputs:ie}):e.compute(cn(ie,o,g,H,n),{inputs:ie});return}let I=!0,S=e.kernelCustomData.wT??e.compute(st(t[1],ts),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=S);let _=[t[0],S];s&&_.push(t[2]);let P=n?w*v:y,A=n?y:w*v,z=m*h*a;e.compute(Ji(_,o,g,P,A,z,s,I),{inputs:_})},_d=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let n=[0,t.pads[0],0,t.pads[1]],s=[1].concat(t.strides),u=[1].concat(t.dilations),d=[1].concat(t.kernelShape),a=rs({...t,pads:n,strides:s,dilations:u,kernelShape:d},o);e.compute(Jn(o,a,m=>r?[m[0],m[2],m[3]]:[]))},no=(e,t)=>{Sd(e.inputs,t),e.inputs[0].dims.length===3?_d(e,t):xd(e,e.inputs,t)}});var Cd,ns,os=q(()=>{"use strict";It();we();At();ln();Zn();Cr();Cd=(e,t=!1,r,o=4)=>{let n=Ke(o,"f32"),s=_=>{switch(_){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            `;default:throw new Error(`innerElementSize ${_} is not supported.`)}},u=e?`\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      `:`\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      `,d=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,a=e?"outBackprop[1]":"outBackprop[2]",m=e?"outBackprop[2]":"outBackprop[3]",h=e?"row":"col",g=e?"col":"row",w=`\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${h} / outWidth;\n      let outCol = ${h} % outWidth;\n\n      let WRow = ${g} / (filterDims[1] * inChannels);\n      let WCol = ${g} / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(${a}) || fract(xR) > 0.0) {\n        return ${n}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${m}) || fract(xC) > 0.0) {\n        return ${n}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${g} % inChannels;\n      ${u}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${o}];`,v=e?`\n      let col = colIn * ${o};\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ${w}\n      }\n      return ${n}(0.0);`:`\n      let col = colIn * ${o};\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ${w}\n      }\n      return ${n}(0.0);`,y=`\n      let col = colIn * ${o};\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (${e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${s(o)}\n      }\n      return ${n}(0.0);\n      `,{activationFunction:C,applyActivation:I}=gt(r,n);return`\n      ${C}\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?v:y}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?y:v}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${n}) {\n    let col = colIn * ${o};\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${d}\n      ${un(t)}\n      ${I}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${o}] = value;\n    }\n  }`},ns=(e,t,r,o,n,s,u,d)=>{let a=t.format==="NHWC",m=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a?m%4===0&&v%4===0:g%4===0&&v%4===0,C=a?v:g*w,I=a?g*w:v,S=y?[8,8,1]:[C<=4||I<=4?4:16,C>4&&I<=4?4:16,1],_=y?[4,4,1]:[C<=4?1:4,C>4&&I<=4?1:4,1],P=[Math.ceil(C/S[0]/_[0]),Math.ceil(I/S[1]/_[1]),Math.ceil(h/S[2]/_[2])];De("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${P}`);let A=y?4:1,z=Math.max(S[0]*A,S[1]),R=y?4:1,N=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],T=M("x",e[0].dataType,e[0].dims.length,R),H=M("w",e[1].dataType,e[1].dims.length,1),ie=j("result",e[0].dataType,r.length,R),Z=[T,H];N.push(...F(e[0].dims)),N.push(...F(e[1].dims));let K="";if(u){let Q=M("bias",e[2].dataType,e[2].dims.length,R);Z.push(Q),N.push(...F(e[2].dims)),K+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?"vec4<f32>":"f32"} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}return N.push(...F(r)),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:P[0],y:P[1],z:P[2]},programUniforms:N}),getShaderSource:Q=>`\n        ${dn("uniforms.result_strides")}\n        ${Q.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...Z,ie)};\n        const outBackprop : vec4<i32> = vec4<i32>(${e[0].dims.join(",")});\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[a?1:2]}, ${t.kernelShape[a?2:3]});\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ${t.dilations[0]<=1?0:(t.kernelShape[a?1:2]-1)*(t.dilations[0]-1)},\n              ${t.dilations[1]<=1?0:(t.kernelShape[a?2:3]-1)*(t.dilations[1]-1)});\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${t.pads[0]+t.pads[2]})/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (${t.pads[1]+t.pads[3]})/2);\n        const strides : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        const dimAOuter : i32 = ${o};\n        const dimBOuter : i32 = ${n};\n        const dimInner : i32 = ${s};\n        ${K}\n        ${Cd(a,u,t,A)}\n        ${y?xr(_,S,"f32",void 0,!a,z):_r(_,S,"f32",void 0,!a,z,!1,void 0,d)}`}}});var Id,oo,as=q(()=>{"use strict";It();$e();we();Id=(e,t,r,o,n,s,u=!1,d)=>{let a=r.format==="NHWC",m=a?1:2,h=a?2:3,g=a?3:1,w=V.size(o),v=u?2:1,y=r.group,C=t[1].dims,I=C[0]/y,S=C[1],_=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${u?`vec4<${d}>`:d}) {\n    result[flatIndex] = ${u?`vec4<${d}>`:d}(value);\n  }`;n&&(_+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${u?`vec4<${d}>`:d} {\n      return bias[coords.${a?"w":"y"}${u?"/ 4":""}];\n    }`);let P=u?4:1,A=M("W",t[1].dataType,t[1].dims,P),z=M("Dy",t[0].dataType,t[0].dims,P),R=[z,A];n&&R.push(M("bias",t[2].dataType,[o[g]],P));let N=j("result",t[0].dataType,o,P),T=`{\n        let batch: u32 = ${s?"global_id.z":"workgroup_id.z"} / outShape[1];\n        let r = ${s?"global_id.z":"workgroup_id.z"} % outShape[1];\n        let c = ${s?"global_id.y":"workgroup_id.y"} * ${v};\n        let d1: u32 = ${s?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${d}>, ${v}>;\n        for (var i = 0; i < ${v}; i++) {\n          dotProd[i] = vec4<${d}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (${d}(dyCorner.x) + ${d}(wR)) / ${d}(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${d}(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (${d}(dyCorner.y) + ${d}(wC)) / ${d}(strides.y);\n            let dyC2 = (${d}(dyCorner.y) + 1.0 + ${d}(wC)) / ${d}(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${d}(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${d}(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${z.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${d}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${z.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${d}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[${g}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${z.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${d}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${z.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${d}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${v}; i = i + 1) {\n          let value = dotProd[i] + ${n?"bias[c+i]":`vec4<${d}>(0.0)`};\n          ${N.set("batch","r","c + i","d1","value")};\n        }\n      }`,H=`\n          let outputIndices = ${N.offsetToIndices("global_idx")};\n          let batch = ${N.indicesGet("outputIndices",0)};\n          let d1 = ${N.indicesGet("outputIndices",g)};\n          let r = ${N.indicesGet("outputIndices",m)};\n          let c = ${N.indicesGet("outputIndices",h)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ${S};\n          let wOutChannel = d1 - groupId * ${S};\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${d}(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${d}(dyRCorner) + ${d}(wR)) / ${d}(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ${d}(outBackprop[${m}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${d}(dyCCorner) + ${d}(wC)) / ${d}(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ${d}(outBackprop[${h}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ${I};\n              for (var d2: u32 = 0; d2 < ${I}; d2 = d2 + 1) {\n                let xValue = ${a?z.get("batch","idyR","idyC","inputChannel"):z.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${A.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${n?"bias[d1]":`${d}(0.0)`};\n          ${N.setByOffset("global_idx","value")};\n        `;return`\n  ${e.declareVariables(...R,N)}\n  ${_}\n  const outShape : vec4<u32> = vec4<u32>(${o.join(",")});\n  const outBackprop : vec4<u32> = vec4<u32>(${t[0].dims.join(",")});\n  const strides : vec2<u32> = vec2<u32>(${r.strides[0]}, ${r.strides[1]});\n  const filterDims : vec2<u32> = vec2<u32>(${r.kernelShape[a?1:2]}, ${r.kernelShape[a?2:3]});\n  const dilations : vec2<u32> = vec2<u32>(${r.dilations[0]}, ${r.dilations[1]});\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ${r.dilations[0]<=1?0:(r.kernelShape[a?1:2]-1)*(r.dilations[0]-1)},\n          ${r.dilations[1]<=1?0:(r.kernelShape[a?2:3]-1)*(r.dilations[1]-1)});\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${r.pads[0]+r.pads[2]})/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (${r.pads[1]+r.pads[3]})/2);\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(w)};\n  ${u?T:H}}`},oo=(e,t,r)=>{let o=e.length>2,n=t.outputShape,s=V.size(n),u=[Math.ceil(s/64),1,1];De("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${u}`);let d=Le(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:()=>({dispatchGroup:{x:u[0],y:u[1],z:u[2]},outputs:[{dims:r?r(n):n,dataType:e[0].dataType}]}),getShaderSource:a=>Id(a,e,t,n,o,u[1]===1&&u[2]===1,!1,d)}}});var Ad,Td,Ed,is,ss,Od,Pd,kd,Bd,us,ls=q(()=>{"use strict";je();os();as();At();tr();Ad=(e,t,r,o,n,s)=>(e-1)*t+r+(o-1)*n+1-s,Td=(e,t,r,o,n)=>{let s=Math.floor(e/2);t==="SAME_UPPER"?(r[o]=s,r[n]=e-s):t==="SAME_LOWER"&&(r[o]=e-s,r[n]=s)},Ed=(e,t,r,o,n,s,u,d,a,m)=>{let h=e.length-2,g=m.length===0;if(a.length===0)for(let y=0;y<h;++y)a.push(0);let w=e[0],v=t[d?3:1]*n;for(let y=0,C=e.length-h-(d?1:0);y<h;++y,++C){let I=e[C],S=g?I*u[y]:m[y],_=Ad(I,u[y],s[y],t[C],r[y],S);Td(_,o,s,y,y+h),g&&m.push(u[y]*(I-1)+a[y]+(t[C]-1)*r[y]+1-s[y]-s[y+h])}m.splice(0,0,w),m.splice(d?3:1,0,v)},is=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((w,v)=>w*v,1)===0){r.length=0;for(let w=2;w<t[1].dims.length;++w)r.push(t[1].dims[w])}let o=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(o?3:1,0,t[1].dims[1]);let n=e.pads.slice(),s=e.outputShape.slice(),u=e.outputPadding.slice(),d=t[0].dims,a=e.dilations.slice();if(a.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;a=new Array(w).fill(1)}let m=e.strides.slice();if(m.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;m=new Array(w).fill(1)}Ed(d,r,a,e.autoPad,e.group,n,m,o,u,s);let h=Object.assign({},e),g=e.cacheKey+[r.join("n,"),n.join(","),m.join(","),u.join(","),s.join(","),a.join(",")].join("_");return Object.assign(h,{kernelShape:r,pads:n,outputPadding:u,outputShape:s,dilations:a,strides:m,cacheKey:g}),h},ss=e=>{let t=sn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],n=e.dilations,s=e.group,u=e.kernelShape,d=e.pads,a=e.strides,m=e.wIsConst(),h=e.outputPadding,g=e.outputShape;return ge({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,outputPadding:h,outputShape:g,pads:d,strides:a,wIsConst:m,...t})},Od=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==n))throw new Error("invalid bias");let s=e[0].dims.length-2;if(t.dilations.reduce((h,g)=>h+g,0)>0&&t.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(t.strides.reduce((h,g)=>h+g,0)>0&&t.strides.length!==s)throw new Error(`strides should be ${s}D`);if(t.pads.reduce((h,g)=>h+g,0)>0&&t.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(t.outputPadding.length!==s&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${s}D`);if(t.kernelShape.reduce((h,g)=>h+g,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Pd=[2,3,1,0],kd=(e,t,r)=>{let o=is(r,t),n=r.format==="NHWC",s=o.outputShape,u=s[n?3:1],d=t[0].dims[n?3:1];if(o.group!==1||u===1&&d===1){e.compute(oo(t,o));return}let a=s[n?1:2],m=s[n?2:3],h=t[1].dims[2],g=t[1].dims[3],w=n?a*m:u,v=n?u:a*m,y=h*g*d,C=!0,I=e.kernelCustomData.wT??e.compute(st(t[1],Pd),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=I);let S=[t[0],I],_=t.length===3;_&&(!n&&t[2].dims.length===1?S.push(t[2].reshape([t[2].dims[0],1,1])):S.push(t[2])),e.compute(ns(S,o,s,w,v,y,_,C),{inputs:S})},Bd=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];o.length===3&&o.push(e.inputs[2]);let n=t.kernelShape;(n.length===0||n[0]===0)&&(n=[e.inputs[1].dims[2]]);let s=t.dilations;(s.length===0||s[0]===0)&&(s=[1]);let u=t.strides;(u.length===0||u[0]===0)&&(u=[1]);let d=t.pads;d.length===0&&(d=[0,0]),d=[0,d[0],0,d[1]],u=[1].concat(u),s=[1].concat(s),n=[1].concat(n);let a=is({...t,pads:d,strides:u,dilations:s,kernelShape:n},o);e.compute(oo(o,a,m=>r?[m[0],m[2],m[3]]:[m[0],m[1],m[3]]))},us=(e,t)=>{Od(e.inputs,t),e.inputs[0].dims.length===3?Bd(e,t):kd(e,e.inputs,t)}});var Rd,ds,cs,ps=q(()=>{"use strict";Ne();$e();je();we();Rd=(e,t,r,o)=>{let n=V.size(t),s=t.length,u=M("input",e,s),d=j("output",e,s),a=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),m=V.normalizeAxis(a,s),h=g=>{let w=` i32(${u.indicesGet("inputIndices","uniforms.axis")}) `,v=ce("uniforms.input_shape","uniforms.axis",s),y=o.reverse?w+(o.exclusive?" + 1":""):"0",C=o.reverse?v:w+(o.exclusive?"":" + 1");return`\n                ${g.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(u,d)}\n                ${g.mainStart()}\n                  ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${d.offsetToIndices("global_idx")};\n                  var sum = ${d.type.value}(0);\n                  let first : i32 = ${y};\n                  let last : i32 = ${C};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${u.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${u.getByIndices("inputIndices")};\n                  }\n                  ${d.setByOffset("global_idx","sum")};\n                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},{type:"int32",data:m},...F(t),...F(t)]}),getShaderSource:h}},ds=(e,t)=>{let r=e.inputs[0].dims,o=e.inputs[0].dataType,n=e.inputs[1];e.compute(Rd(o,r,n,t),{inputs:[0]})},cs=e=>{let t=e.exclusive===1,r=e.reverse===1;return ge({exclusive:t,reverse:r})}});var ao,pn,ms,Dd,Md,io,so,fs,Ud,hs,gs,ys=q(()=>{"use strict";$e();je();we();ao="[a-zA-Z]|\\\\.\\\\.\\\\.",pn="("+ao+")+",ms="^"+pn+"$",Dd="("+pn+",)*"+pn,Md="^"+Dd+"$",io=class{constructor(t=-1){this.symbolToIndices=new Map,this.inputIndex=t}addSymbol(t,r){let o=this.symbolToIndices.get(t);o===void 0?o=[r]:o.push(r),this.symbolToIndices.set(t,o)}},so=class{constructor(t,r){this.equation=r;this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[o,n]=r.includes("->")?r.split("->",2):[r,""];if(!o.match(RegExp(Md)))throw new Error("Invalid LHS term");if(o.split(",").forEach((d,a)=>{let m=t[a].dims.slice();if(!d.match(RegExp(ms)))throw new Error("Invalid LHS term");let h=this.processTerm(d,!0,m,a);this.lhs.push(h)}),n==="")n+=[...this.symbolToInfo.entries()].filter(([d,a])=>a.count===1||d==="...").map(([d])=>d).join("");else if(!n.match(RegExp(pn)))throw new Error("Invalid RHS");n.match(RegExp(ao,"g"))?.forEach(d=>{if(d==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let a=this.symbolToInfo.get(d);if(a===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(a.dimValue)}}),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(t,r,o){let n=this.symbolToInfo.get(t);if(n!==void 0){if(n.dimValue!==r&&n.count!==1)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(o)}else n={count:1,dimValue:r,inputIndices:[o]};this.symbolToInfo.set(t,n)}processTerm(t,r,o,n=-1){let s=o.length,u=!1,d=[],a=0;if(!t.match(RegExp(ms))&&!r&&t!=="")throw new Error("Invalid LHS term");let m=t.match(RegExp(ao,"g")),h=new io(n);return m?.forEach((g,w)=>{if(g==="..."){if(u)throw new Error("Only one ellipsis is allowed per input term");u=!0;let v=s-m.length+1;if(v<0)throw new Error("Ellipsis out of bounds");if(d=o.slice(a,a+v),this.hasEllipsis){if(this.ellipsisDims.length!==d.length||this.ellipsisDims.toString()!==d.toString())throw new Error("Ellipsis dimensions mismatch")}else if(r)this.hasEllipsis=!0,this.ellipsisDims=d;else throw new Error("Ellipsis must be specified in the LHS");for(let y=0;y<d.length;y++){let C=String.fromCharCode("0".charCodeAt(0)+y);h.addSymbol(C,w+y),this.addSymbol(C,o[a++],n)}}else h.addSymbol(g,w+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(g,o[a++],n)}),h}},fs=e=>e+"_max",Ud=(e,t,r,o,n)=>{let u=t.map((v,y)=>e[y]?v.length:v).map((v,y)=>M(`input${y}`,r,v)),d=V.size(n),a=Be(n.length),m=a?n.length:n,h=j("output",r,m),g=[...o.symbolToInfo.keys()].filter(v=>!o.rhs.symbolToIndices.has(v)),w=v=>{let y=[],C="var prod = 1.0;",I="var sum = 0.0;",S="sum += prod;",_=[],P=[],A=[],z=[],R=o.symbolToInfo.size===o.rhs.symbolToIndices.size;o.symbolToInfo.forEach((T,H)=>{if(o.rhs.symbolToIndices.has(H)){let ie=o.rhs.symbolToIndices.get(H)?.[0];ie!==void 0&&o.lhs.forEach((Z,K)=>{if(T.inputIndices.includes(K)){let Q=Z.symbolToIndices.get(H);if(Q===void 0)throw new Error("Invalid symbol error");Q.forEach(X=>{y.push(`${u[K].indicesSet(`input${K}Indices`,X,h.indicesGet("outputIndices",ie))}`)})}})}else o.lhs.forEach((ie,Z)=>{if(T.inputIndices.includes(Z)){let K=ie.symbolToIndices.get(H);if(K===void 0)throw new Error("Invalid symbol error");K.forEach(Q=>{_.push(`${u[Z].indicesSet(`input${Z}Indices`,Q,`${H}`)}`)}),z.push(`prod *= ${u[Z].getByIndices(`input${Z}Indices`)};`)}}),P.push(`for(var ${H}: u32 = 0; ${H} < uniforms.${fs(H)}; ${H}++) {`),A.push("}")});let N=R?[...y,`let sum = ${u.map((T,H)=>T.getByIndices(`input${H}Indices`)).join(" * ")};`]:[...y,I,...P,..._,C,...z,S,...A];return`\n            ${v.registerUniforms(g.map(T=>({name:`${fs(T)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...u,h)}\n\n            ${v.mainStart()}\n            ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${h.offsetToIndices("global_idx")};\n            ${u.map((T,H)=>`var input${H}Indices: ${u[H].type.indices};`).join(`\n`)}\n            ${N.join(`\n`)};\n            ${h.setByOffset("global_idx","sum")};\n          }`};return{name:"Einsum",shaderCache:{hint:o.equation,inputDependencies:e.map(v=>v?"rank":"dims")},getRunData:()=>{let v=g.filter(C=>o.symbolToInfo.has(C)).map(C=>({type:"uint32",data:o.symbolToInfo.get(C)?.dimValue||0}));v.push({type:"uint32",data:d});let y=t.filter((C,I)=>e[I]).map((C,I)=>[...F(C)]).reduce((C,I)=>C.concat(I),v);return a&&y.push(...F(n)),{outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:y}},getShaderSource:w}},hs=(e,t)=>{let r=new so(e.inputs,t.equation),o=e.inputs.map((u,d)=>Be(u.dims.length)),n=r.outputDims,s=e.inputs.map((u,d)=>u.dims);e.compute(Ud(o,s,e.inputs[0].dataType,r,n))},gs=e=>{let t=e.equation.replace(/\\s+/g,"");return ge({equation:t})}});var zd,bs,Vd,Nd,ws,vs=q(()=>{"use strict";Ne();$e();we();zd=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=r.length<t.length?0:r.length-t.length,n=t.length<r.length?0:t.length-r.length;for(;o<r.length&&n<t.length;++o,++n)if(r[o]!==t[n]&&r[o]!==1&&t[n]!==1)throw new Error("Expand requires shape to be broadcastable to input")},bs=(e,t)=>{let r=e.length-t.length,o=[];for(let n=0;n<r;++n)o.push(e[n]);for(let n=0;n<t.length;++n)o.push(t[n]===1?e[n+r]:t[n]);return o},Vd=(e,t)=>e.length>t.length?bs(e,t):bs(t,e),Nd=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=Vd(t,r),n=e[0].dataType,s=n===9?4:1,u=Math.ceil(V.size(o)/s),d=Be(t.length),a=Be(o.length),m=g=>{let w=d?t.length:t,v=a?o.length:o,y=M("input",n,w,s),C=j("output",n,v,s),I;if(n===9){let S=(_,P,A="")=>`\n          let outputIndices${P} = ${C.offsetToIndices(`outputOffset + ${P}u`)};\n          let offset${P} = ${y.broadcastedIndicesToOffset(`outputIndices${P}`,C)};\n          let index${P} = offset${P} / 4u;\n          let component${P} = offset${P} % 4u;\n          ${_}[${P}] = ${A}(${y.getByOffset(`index${P}`)}[component${P}]);\n        `;I=`\n        let outputOffset = global_idx * ${s};\n        var data = vec4<u32>(0);\n        ${S("data",0,"u32")}\n        ${S("data",1,"u32")}\n        ${S("data",2,"u32")}\n        ${S("data",3,"u32")}\n        ${C.setByOffset("global_idx","data")}\n      }`}else I=`\n        let outputIndices = ${C.offsetToIndices("global_idx")};\n        let inputOffset = ${y.broadcastedIndicesToOffset("outputIndices",C)};\n        ${C.setByOffset("global_idx",y.getByOffset("inputOffset"))}\n      }`;return`\n    ${g.registerUniform("vec_size","u32").declareVariables(y,C)}\n    ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${I}`},h=[{type:"uint32",data:u}];return d&&h.push(...F(t)),a&&h.push(...F(o)),{name:"Expand",shaderCache:{hint:`${o.length}`,inputDependencies:[d?"rank":"dims"]},getShaderSource:m,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:h})}},ws=e=>{zd(e.inputs),e.compute(Nd(e.inputs),{inputs:[0]})}});var Wd,Hd,$s,Ss,xs=q(()=>{"use strict";Ne();$e();je();we();Wd=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},Hd=(e,t)=>{let r=e[0].dims,o=e[1].dims,n=r.length,s=V.normalizeAxis(t.axis,n),u=r.slice(0);u.splice(s,1,...o);let d=r[s],a=e[0].dataType===9?4:1,m=Math.ceil(V.size(u)/a),h=Be(e[0].dims.length),g=h?e[0].dims.length:e[0].dims,w=Be(e[1].dims.length),v=w?e[1].dims.length:e[1].dims,y=Be(u.length),C=y?u.length:u,I=[{type:"uint32",data:m},{type:"int32",data:d},{type:"uint32",data:s}];h&&I.push(...F(e[0].dims)),w&&I.push(...F(e[1].dims)),y&&I.push(...F(u));let S=[];S.push(h?"rank":"dims"),S.push(w?"rank":"dims");let _=P=>{let A=M("data",e[0].dataType,g,a),z=M("inputIndices",e[1].dataType,v),R=j("output",e[0].dataType,C,a),N=H=>{let ie=o.length,Z=`var indicesIndices${H}  = ${z.type.indices}(0);`;for(let K=0;K<ie;K++)Z+=`${ie>1?`indicesIndices${H}[${K}]`:`indicesIndices${H}`} = ${u.length>1?`outputIndices${H}[uniforms.axis + ${K}]`:`outputIndices${H}`};`;Z+=`\n          var idx${H} = ${z.getByIndices(`indicesIndices${H}`)};\n          if (idx${H} < 0) {\n            idx${H} = idx${H} + uniforms.axisDimLimit;\n          }\n          var dataIndices${H} = ${A.type.indices}(0);\n        `;for(let K=0,Q=0;K<n;K++)K===s?(Z+=`${n>1?`dataIndices${H}[${K}]`:`dataIndices${H}`} = u32(idx${H});`,Q+=ie):(Z+=`${n>1?`dataIndices${H}[${K}]`:`dataIndices${H}`} = ${u.length>1?`outputIndices${H}[${Q}]`:`outputIndices${H}`};`,Q++);return Z},T;if(e[0].dataType===9){let H=(ie,Z,K="")=>`\n          let outputIndices${Z} = ${R.offsetToIndices(`outputOffset + ${Z}u`)};\n          ${N(Z)};\n          let offset${Z} = ${A.indicesToOffset(`dataIndices${Z}`)};\n          let index${Z} = offset${Z} / 4u;\n          let component${Z} = offset${Z} % 4u;\n          ${ie}[${Z}] = ${K}(${A.getByOffset(`index${Z}`)}[component${Z}]);\n        `;T=`\n        let outputOffset = global_idx * ${a};\n        var value = vec4<u32>(0);\n        ${H("value",0,"u32")}\n        ${H("value",1,"u32")}\n        ${H("value",2,"u32")}\n        ${H("value",3,"u32")}\n        ${R.setByOffset("global_idx","value")}\n      `}else T=`\n      let outputIndices = ${R.offsetToIndices("global_idx")};\n      ${N("")};\n      let value = ${A.getByIndices("dataIndices")};\n      ${R.setByOffset("global_idx","value")};\n      `;return`\n      ${P.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(A,z,R)}\n      ${P.mainStart()}\n        ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${T}\n      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:S},getRunData:()=>({outputs:[{dims:u,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:I}),getShaderSource:_}},$s=e=>ge({axis:e.axis}),Ss=(e,t)=>{let r=e.inputs;Wd(r),e.compute(Hd(e.inputs,t))}});var Gd,Ld,_s,Cs,Is=q(()=>{"use strict";$e();je();we();Gd=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and\n                     indices input tensors be of same rank.`)},Ld=(e,t)=>{let r=e[0].dims,o=e[0].dataType,n=r.length,s=e[1].dims,u=e[1].dataType,d=V.normalizeAxis(t.axis,n),a=r[d],m=s.slice(0),h=V.size(m),g=M("input",o,n),w=M("indicesInput",u,s.length),v=j("output",o,m.length),y=[{type:"uint32",data:h},{type:"int32",data:a},{type:"uint32",data:d}];return y.push(...F(r)),y.push(...F(s)),y.push(...F(m)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:m,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:y}),getShaderSource:S=>`\n      ${S.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(g,w,v)}\n      ${S.mainStart()}\n      ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${v.offsetToIndices("global_idx")};\n\n      var idx = ${w.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${g.type.indices}(outputIndices);\n      ${g.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${g.getByIndices("inputIndices")};\n\n      ${v.setByOffset("global_idx","value")};\n  }`}},_s=e=>ge({axis:e.axis}),Cs=(e,t)=>{let r=e.inputs;Gd(r),e.compute(Ld(e.inputs,t))}});var Fd,jd,As,Ts,Es=q(()=>{"use strict";$e();we();Fd=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},jd=(e,t)=>{let r=e[0].dims.slice(),o=e[1].dims.slice(),[n,s,u]=Jr.getShapeOfGemmResult(r,t.transA,o,t.transB,e.length===3?e[2].dims:void 0),d=[n,s];if(!d)throw new Error("Can\'t use gemm on the given tensors");let a=V.size(d),m=[{type:"uint32",data:a},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:u},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],h=["type","type"];e.length===3&&(m.push(...F(e[2].dims)),h.push("rank")),m.push(...F(d));let g=w=>{let v="";t.transA&&t.transB?v="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?v="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?v="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(v="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let y=t.alpha===1?"":"value *= uniforms.alpha;",C=M("a",e[0].dataType,e[0].dims),I=M("b",e[1].dataType,e[1].dims),S=C.type.value,_=null,P=[C,I];e.length===3&&(_=M("c",e[2].dataType,e[2].dims.length),P.push(_));let A=j("output",e[0].dataType,d.length);P.push(A);let z=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`\n  ${w.registerUniforms(z).declareVariables(...P)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${S}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${v}\n    }\n\n    ${y}\n    ${(()=>_!=null?`let cOffset = ${_.broadcastedIndicesToOffset("vec2(m, n)",A)}; value += ${S}(uniforms.beta) * ${_.getByOffset("cOffset")};`:"")()}\n    output[global_idx] = value;\n  }`};return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:d,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:m}),getShaderSource:g}},As=e=>{let t=e.transA,r=e.transB,o=e.alpha,n=e.beta;return{transA:t,transB:r,alpha:o,beta:n,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Ts=(e,t)=>{Fd(e.inputs),e.compute(jd(e.inputs,t))}});var qd,Kd,Yd,Os,Ps=q(()=>{"use strict";Ne();$e();we();qd=(e,t)=>{let r=e[0].dims,o=r,n=2,s=V.sizeToDimension(r,n),u=V.sizeFromDimension(r,n),d=Fe(u),a=u/d,m=[r[0],r[1],a],h=["rank","type","type"],g=[{type:"uint32",data:u},{type:"uint32",data:a}];g.push(...F(m),...F(m));let w=v=>{let y=M("x",e[0].dataType,m.length,d),C=M("scale",e[1].dataType,e[1].dims),I=M("bias",e[2].dataType,e[2].dims),S=j("output",e[0].dataType,m.length,d),_=[y,C,I,S],P=y.type.value,A=d===1?"f32":`vec${d}<f32>`,z=64,R=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${A}, ${z}>;\n  const workgroupSize = ${z}u;\n  ${v.registerUniforms(R).declareVariables(..._)}\n  ${v.mainStart(z)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${A}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${A}(${y.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${tt("workgroupShared[0]",d)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${A}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${A}(${y.get("batch","channel","h")}) - ${A}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${tt("workgroupShared[0]",d)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${C.getByOffset("channel")});\n    let channelShift = f32(${I.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${y.get("batch","channel","h")} * ${P}(${A}(channelScale)) + ${P}(${A}(channelShift));\n      ${S.set("batch","channel","h","value")};\n    }\n  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${d}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:s},programUniforms:g}),getShaderSource:w}},Kd=(e,t,r,o,n,s,u,d)=>{let a=Fe(u),m=64,h=a===1?"vec2f":`mat2x${a}f`,g=a===1?"f32":`vec${a}f`,w=(R,N)=>`${h}(${R}, ${N})`,v=n*u/a,y=Math.ceil(s/m),C=["type"],I=[{type:"uint32",data:y},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(s*u/a)}],S=R=>{let N=M("input",t.dataType,t.dims,a);return`\n  ${R.declareVariables(N)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart(m)}\n    let currentImageNumber = global_idx / ${m} / uniforms.C;\n    let currentChannelNumber = (global_idx / ${m}) % uniforms.C;\n    let wgId = global_idx % ${m};\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${Ze("f32",a)};\n    var squaredSum = ${Ze("f32",a)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${g}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${w("sum","squaredSum")};\n  }`},_=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${a}`,inputDependencies:C},getRunData:()=>({outputs:[{dims:[n,u,m,2],dataType:1}],dispatchGroup:{x:n*u/a},programUniforms:I}),getShaderSource:S},{inputs:[t],outputs:[-1]})[0],P=[{type:"uint32",data:v},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(m*u/a)}],A=["type","type","type"],z=R=>{let N=M("scale",r.dataType,r.dims,a),T=M("bias",o.dataType,o.dims,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${h}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${N.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${T.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart()}\n    ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${Ze("f32",a)};\n    var squaredSum = ${Ze("f32",a)};\n    for (var i: u32 = 0; i < ${m}; i++) {\n        let value = input[offset + i + currentChannelNumber * ${m}];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${d}));\n    let channelScale = invStdDev * ${g}(scale[currentChannelNumber]);\n    let channelShift = ${g}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${w("channelScale","channelShift")};\n  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${a};${d}`,inputDependencies:A},getRunData:()=>({outputs:[{dims:[n,u,2],dataType:1}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:P}),getShaderSource:z},{inputs:[_,r,o],outputs:[-1]})[0]},Yd=(e,t,r)=>{let o=t[0].dims,n=o,s=o[0],u=o[o.length-1],d=V.sizeFromDimension(o,1)/u,a=Fe(u),m=V.size(n)/a,h=[{type:"uint32",data:d},{type:"uint32",data:Math.floor(u/a)}],g=["type","type"],w=Kd(e,t[0],t[1],t[2],s,d,u,r.epsilon),v=y=>{let C=Le(t[0].dataType),I=a===1?"vec2f":`mat2x${a}f`,S=a===1?C:`vec${a}<${C}>`,_=M("input",t[0].dataType,t[0].dims,a),P=j("output",t[0].dataType,n,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${_.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${I}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${P.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${y.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${S}(scale[0]), ${S}(scale[1]));\n  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${a}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:h}),getShaderSource:v},{inputs:[t[0],w]})},Os=(e,t)=>{t.format==="NHWC"?Yd(e,e.inputs,t):e.compute(qd(e.inputs,t))}});var Zd,Jd,ks,Bs=q(()=>{"use strict";Ne();$e();we();Zd=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},Jd=(e,t,r)=>{let o=e[0].dims,n=e[1],s=e[2],u=o,d=V.normalizeAxis(t.axis,o.length),a=V.sizeToDimension(o,d),m=V.sizeFromDimension(o,d),h=V.size(n.dims),g=s?V.size(s.dims):0;if(h!==m||s&&g!==m)throw new Error(`Size of X.shape()[axis:] == ${m}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${h} and bias size of ${g}`);let w=[];for(let A=0;A<o.length;++A)A<d?w.push(o[A]):w.push(1);let v=Fe(m),y=["type","type"],C=[{type:"uint32",data:a},{type:"float32",data:m},{type:"uint32",data:Math.floor(m/v)},{type:"float32",data:t.epsilon}];s&&y.push("type");let I=r>1,S=r>2,_=A=>{let z=Le(e[0].dataType),R=[M("x",e[0].dataType,e[0].dims,v),M("scale",n.dataType,n.dims,v)];s&&R.push(M("bias",s.dataType,s.dims,v)),R.push(j("output",e[0].dataType,u,v)),I&&R.push(j("mean_data_output",1,w)),S&&R.push(j("inv_std_output",1,w));let N=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`\n  ${A.registerUniforms(N).declareVariables(...R)}\n  ${A.mainStart()}\n    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ${Ze("f32",v)};\n    var meanSquareVector = ${Ze("f32",v)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${it(z,v,"x[h + offset]")};\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ${tt("meanVector",v)} / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(${tt("meanSquareVector",v)} / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${it(z,v,"x[j + offset]")};\n      let f32scale = ${it(z,v,"scale[j]")};\n      output[j + offset] = ${R[0].type.value}((f32input - mean) * invStdDev * f32scale\n        ${s?`+ ${it(z,v,"bias[j]")}`:""}\n      );\n    }\n\n    ${I?"mean_data_output[global_idx] = mean":""};\n    ${S?"inv_std_output[global_idx] = invStdDev":""};\n  }`},P=[{dims:u,dataType:e[0].dataType}];return I&&P.push({dims:w,dataType:1}),S&&P.push({dims:w,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${v};${r}`,inputDependencies:y},getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(a/64)},programUniforms:C}),getShaderSource:_}},ks=(e,t)=>{Zd(e.inputs),e.compute(Jd(e.inputs,t,e.outputCount))}});var Qd,Ds,Rs,Xd,uo,Ms,Us=q(()=>{"use strict";$e();je();Yr();Kn();we();tr();Qd=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],d=e[5],a=e[6],m=e[7];if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let h=!1,g=r.dims[0],w=r.dims[1],v=r.dims.length===3?h?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],y=w,C=0,I=0,S=Math.floor(v/t.numHeads);if(a&&m){if(a.dims.length!==4)throw new Error(\'Input "past_key" is expected to have 4 dimensions\');if(m.dims.length!==4)throw new Error(\'Input "past_value" is expected to have 4 dimensions\');C=a.dims[2],I=a.dims[2]}else if(a||m)throw new Error(\'Input "past_key" and "past_value" shall be both present or both absent\');let _;if(o){if(r.dims.length!==3)throw new Error(\'Input "query" is expected to have 3 dimensions when key is given\');if(o.dims.length<3||o.dims.length>5)throw new Error(\'Input "key" is expected to have 3, 4, or 5 dimensions\');if(r.dims[0]!==o.dims[0])throw new Error(\'Input "query" and "key" shall have same dim 0 (batch size)\');if(o.dims.length===3){if(o.dims[2]!==r.dims[2])throw new Error(\'Input "query" and "key" shall have same dim 2 (hidden_size)\');_=2,y=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==t.numHeads||o.dims[3]!==2||o.dims[4]!==S)throw new Error(\'Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv\');if(n)throw new Error(\'Expect "value" be none when "key" has packed kv format.\');_=5,y=o.dims[1]}else{if(o.dims[1]!==t.numHeads||o.dims[3]!==S)throw new Error(\'Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key\');_=0,y=o.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error(\'Input "query" is expected to have 3 or 5 dimensions when key is empty\');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error(\'Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv\');_=3}if(s){if(s.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimension\');if(n&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let P=0;if(u){P=8;let T=u.dims;throw T.length===1?T[0]===g?P=1:T[0]===3*g+2&&(P=3):T.length===2&&T[0]===g&&T[1]===y&&(P=5),P===8?new Error(\'Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)\'):new Error("Mask not supported")}let A=!1,z=v;if(n){if(n.dims.length!==3&&n.dims.length!==4)throw new Error(\'Input "value" is expected to have 3 or 4 dimensions\');if(r.dims[0]!==n.dims[0])throw new Error(\'Input "query" and "value" shall have same dim 0 (batch_size)\');if(n.dims.length===3){if(y!==n.dims[1])throw new Error(\'Input "key" and "value" shall have the same dim 1 (kv_sequence_length)\');z=n.dims[2]}else{if(y!==n.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)\');z=n.dims[1]*n.dims[3],A=!0}}let R=C+y,N=!1;if(u)throw new Error("Key padding mask is not supported");if(d)throw new Error("extraAddQk is not supported");if(a)throw new Error("pastKey is not supported");if(m)throw new Error("pastValue is not supported");return{batchSize:g,sequenceLength:w,pastSequenceLength:C,kvSequenceLength:y,totalSequenceLength:R,maxSequenceLength:I,inputHiddenSize:0,hiddenSize:v,vHiddenSize:z,headSize:S,vHeadSize:Math.floor(z/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:P,scale:t.scale,broadcastResPosBias:N,passPastInKv:A,qkvFormat:_}},Ds=e=>ge({...e}),Rs=ge({perm:[0,2,1,3]}),Xd=(e,t,r,o,n,s,u)=>{let d=[o,n,s],a=V.size(d),m=[{type:"uint32",data:a},{type:"uint32",data:u},{type:"uint32",data:s}],h=g=>{let w=j("qkv_with_bias",t.dataType,d),v=M("qkv",t.dataType,d),y=M("bias",r.dataType,d),C=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`\n  ${g.registerUniforms(C).declareVariables(v,y,w)}\n  ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:d,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:m}),getShaderSource:h},{inputs:[t,r],outputs:[-1]})[0]},uo=(e,t,r,o,n,s,u,d)=>{let a=s;if(u){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return a=Xd(e,s,u,t,o,r*n,d),a=a.reshape([t,o,r,n]),e.compute(st(a,Rs.perm),{inputs:[a],outputs:[-1]})[0]}else return s.dims.length===3&&(a=s.reshape([t,o,r,n])),e.compute(st(a,Rs.perm),{inputs:[a],outputs:[-1]})[0]},Ms=(e,t)=>{let r=Qd(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let o=e.inputs[1]&&e.inputs[2]&&e.inputs[1].dims.length===4&&e.inputs[2].dims.length===4,n=uo(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(o)return nn(e,n,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);let s=uo(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),u=uo(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);nn(e,n,s,u,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t)}});var ec,tc,rc,nc,oc,ac,ic,sc,zs,Vs=q(()=>{"use strict";Ne();$e();we();ec=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1)throw new Error("Input type must be float.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},tc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n            k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${ce("uniforms.x_shape",n,t)})) {\n              break;\n            }\n            offset += k * i32(${ce("uniforms.x_strides",n,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${o}\n            value = x[offset];\n          }\n      `},rc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${ce("uniforms.x_shape",n,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${ce("uniforms.x_shape",n,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${ce("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},nc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${ce("uniforms.x_shape",n,t)})) {\n                  k = i32(${ce("uniforms.x_shape",n,t)}) - 1;\n                }\n                offset += k * i32(${ce("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},oc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n                if (k < 0)  {\n                  k += i32(${ce("uniforms.x_shape",n,t)}]);\n                }\n                if (k >= i32(${ce("uniforms.x_shape",n,t)})) {\n                  k -= i32(${ce("uniforms.x_shape",n,t)});\n                }\n                offset += k * i32(${ce("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},ac=(e,t,r)=>{switch(r.mode){case 0:return tc(e,t,r.pads.length);case 1:return rc(e,t,r.pads.length);case 2:return nc(e,t,r.pads.length);case 3:return oc(e,t,r.pads.length);default:throw new Error("Invalid mode")}},ic=(e,t)=>{let r=V.padShape(e[0].dims.slice(),t.pads),o=e[0].dims,s=[{type:"uint32",data:V.size(r)},{type:"uint32",data:t.pads}];if(t.mode===0){let a=et(e[0].dataType);s.push({type:a,data:t.value})}s.push(...F(e[0].dims),...F(r));let u=["rank"],d=a=>{let m=j("output",e[0].dataType,r.length),h=M("x",e[0].dataType,o.length),g=h.type.value,w=ac(m,o.length,t),v=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&v.push({name:"constant_value",type:g}),`\n            ${a.registerUniforms(v).declareVariables(h,m)}\n            ${a.mainStart()}\n            ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${m.offsetToIndices("global_idx")};\n\n            var value = ${g}(0);\n            ${w}\n            output[global_idx] = value;\n        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(V.size(r)/64)},programUniforms:s}),getShaderSource:d}},sc=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,n=e[0].dims.length,s=new Int32Array(2*n).fill(0);if(e.length>=4){let d=e[3].getBigInt64Array();for(let a=0;a<d.length;a++)s[Number(d[a])]=Number(r[a]),s[Number(d[a])+n]=Number(r[a+d.length])}else r.forEach((d,a)=>s[Number(a)]=Number(d));let u=[];return s.forEach(d=>u.push(d)),{mode:t.mode,value:o,pads:u}}else return t},zs=(e,t)=>{ec(e.inputs);let r=sc(e.inputs,t);e.compute(ic(e.inputs,r),{inputs:[0]})}});var mn,Ns,Ws,Hs,Gs,uc,lc,Ls,Fs,js,qs,Ks,Ys,Zs,Js,Qs,Xs,eu,tu,ru=q(()=>{"use strict";Xt();$e();we();mn=e=>{if(Qt.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Ns=(e,t,r)=>{let o=t.format==="NHWC",n=e.dims.slice();o&&n.splice(1,0,n.pop());let s=Object.hasOwnProperty.call(t,"dilations"),u=t.kernelShape.slice(),d=t.strides.slice(),a=s?t.dilations.slice():[],m=t.pads.slice();Ut.adjustPoolAttributes(r,n,u,d,a,m);let h=Ut.computePoolOutputShape(r,n,d,a,u,m,t.autoPad),g=Object.assign({},t);s?Object.assign(g,{kernelShape:u,strides:d,pads:m,dilations:a,cacheKey:t.cacheKey}):Object.assign(g,{kernelShape:u,strides:d,pads:m,cacheKey:t.cacheKey});let w=h.slice();return w.push(w.splice(1,1)[0]),[g,o?w:h]},Ws=(e,t)=>{let r=t.format==="NHWC",o=V.size(e),n=V.size(t.kernelShape),s=[{type:"uint32",data:o},{type:"uint32",data:n}],u=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let d=t.kernelShape[t.kernelShape.length-1],a=t.strides[t.strides.length-1],m=t.pads[t.pads.length/2-1],h=t.pads[t.pads.length-1],g=!!(m+h);s.push({type:"uint32",data:d},{type:"uint32",data:a},{type:"uint32",data:m},{type:"uint32",data:h}),u.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let w=!1;if(t.kernelShape.length===2){let v=t.kernelShape[t.kernelShape.length-2],y=t.strides[t.strides.length-2],C=t.pads[t.pads.length/2-2],I=t.pads[t.pads.length-2];w=!!(C+I),s.push({type:"uint32",data:v},{type:"uint32",data:y},{type:"uint32",data:C},{type:"uint32",data:I}),u.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[s,u,!0,g,w]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let d=V.computeStrides(t.kernelShape);s.push({type:"uint32",data:d},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),u.push({name:"kernelStrides",type:"u32",length:d.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let a=t.pads.reduce((m,h)=>m+h);return[s,u,!!a,!1,!1]}},Hs=(e,t,r,o,n,s,u,d,a,m,h,g)=>{let w=n.format==="NHWC",v=t.type.value,y=j("output",t.type.tensor,o);if(n.kernelShape.length<=2){let C="",I="",S="",_=r-(w?2:1);if(h?C=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${_}] = indices[${_}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${_}] < 0 || xIndices[${_}]\n                      >= uniforms.x_shape[${_}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`:C=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${_}] = indices[${_}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`,n.kernelShape.length===2){let A=r-(w?3:2);g?I=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${A}] = indices[${A}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${A}] < 0 || xIndices[${A}] >= uniforms.x_shape[${A}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:I=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${A}] = indices[${A}] * uniforms.sh - uniforms.phStart + j;\n                `,S=`\n              }\n            `}return`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var value = ${v}(${d});\n              var pad = 0;\n              ${I}\n              ${C}\n              ${S}\n              ${u}\n\n              output[global_idx] = value;\n            }`}else{if(w)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let C=n.kernelShape.length,I=n.pads.length,S="";return m?S=`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${s}\n              }`:S=`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${s}\n            `,`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${C}>;\n\n              var value = ${v}(${d});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${C-1}u; j++) {\n                  offsets[j] = offset / ${ce("uniforms.kernelStrides","j",C)};\n                  offset -= offsets[j] * ${ce("uniforms.kernelStrides","j",C)};\n                }\n                offsets[${C-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-C}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${ce("uniforms.strides",`j - ${r-C}u`,C)}\n                    + offsets[j - ${r-C}u] - ${ce("uniforms.pads","j - 2u",I)};\n                  ${S}\n              }\n              ${u}\n\n              output[global_idx] = value;\n            }`}},Gs=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,uc=e=>`${Gs(e)};${e.countIncludePad}`,lc=e=>`${Gs(e)};${e.storageOrder};${e.dilations}`,Ls=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),Fs=(e,t,r,o)=>{let[n,s]=Ns(t,o,r),u=M("x",t.dataType,t.dims.length),d=u.type.value,a="value += x_val;",m="";n.countIncludePad?m+=`value /= ${d}(uniforms.kernelSize);`:m+=`value /= ${d}(i32(uniforms.kernelSize) - pad);`;let[h,g,w,v,y]=Ws(s,n);h.push(...F(t.dims),...F(s));let C=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:C},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(V.size(s)/64)},programUniforms:h}),getShaderSource:I=>Hs(I,u,t.dims.length,s.length,n,a,m,0,g,w,v,y)}},js=e=>{let t=e.count_include_pad!==0,r=Ls(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:t,...r,cacheKey:""};return{...o,cacheKey:uc(o)}},qs=(e,t)=>{mn(e.inputs),e.compute(Fs("AveragePool",e.inputs[0],!1,t))},Ks={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Ys=e=>{let t=e.format;return{format:t,...Ks,cacheKey:t}},Zs=(e,t)=>{mn(e.inputs),e.compute(Fs("GlobalAveragePool",e.inputs[0],!0,t))},Js=(e,t,r,o)=>{let[n,s]=Ns(t,o,r),u=`\n      value = max(x_val, value);\n    `,d="",a=M("x",t.dataType,t.dims.length),m=["rank"],[h,g,w,v,y]=Ws(s,n);return h.push(...F(t.dims),...F(s)),{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:m},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(V.size(s)/64)},programUniforms:h}),getShaderSource:C=>Hs(C,a,t.dims.length,s.length,n,u,d,-1e5,g,w,v,y)}},Qs=(e,t)=>{mn(e.inputs),e.compute(Js("MaxPool",e.inputs[0],!1,t))},Xs=e=>{let t=e.storage_order,r=e.dilations,o=Ls(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let n={storageOrder:t,dilations:r,...o,cacheKey:""};return{...n,cacheKey:lc(n)}},eu=e=>{let t=e.format;return{format:t,...Ks,cacheKey:t}},tu=(e,t)=>{mn(e.inputs),e.compute(Js("GlobalMaxPool",e.inputs[0],!0,t))}});var cc,pc,nu,ou=q(()=>{"use strict";Xt();Ne();we();cc=(e,t,r)=>{let o=e===t,n=e<t&&r<0,s=e>t&&r>0;if(o||n||s)throw new Error("Range these inputs\' contents are invalid.")},pc=(e,t,r,o)=>{let n=Math.abs(Math.ceil((t-e)/r)),s=[n],u=n,d=et(o),a=[{type:"uint32",data:u},{type:d,data:e},{type:d,data:r},...F(s)],m=h=>{let g=j("output",o,s.length),w=g.type.value,v=[{name:"outputSize",type:"u32"},{name:"start",type:w},{name:"delta",type:w}];return`\n        ${h.registerUniforms(v).declareVariables(g)}\n        ${h.mainStart()}\n        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${w}(global_idx) * uniforms.delta;\n      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:m,getRunData:()=>({outputs:[{dims:s,dataType:o}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:a})}},nu=e=>{let t=0,r=0,o=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),Qt.webgpu.validateInputContent&&cc(t,r,o),e.compute(pc(t,r,o,e.inputs[0].dataType),{inputs:[]})}});var mc,fc,hc,gc,yc,bc,wc,vc,$c,Sc,xc,au,_c,Cc,Ic,Ac,Tc,iu,su,uu=q(()=>{"use strict";$e();je();we();mc=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},fc=(e,t,r)=>{t.every(n=>n>=0&&n<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(r).fill(1);return t.forEach((n,s)=>o[n]=e[s]),o},hc=(e,t,r,o,n,s)=>{let[u,d,a]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],m=e[0].dims.length;if(u>0&&e.length>u&&e[u].dims.length>0)e[u].getFloat32Array().forEach(h=>s.push(h));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(d>0&&e.length>d&&e[d].dims.length>0){if(e[d].getFloat32Array().forEach(h=>o.push(h)),o.length!==0&&o.length!==m&&r>=18&&o.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");mc(o,t),t.axes.length>0&&fc(o,t.axes,m).forEach((h,g)=>o[g]=h)}if(a>0&&e.length>a&&(e[a].getBigInt64Array().forEach(h=>n.push(Number(h))),n.length!==m||r>=18&&n.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(o.length!==t.axes.length)throw new Error(\'Resize requires "scales" input size to be of axes rank when axes attributes is specified\');if(n.length!==t.axes.length)throw new Error(\'Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified\')}if(typeof o<"u"&&typeof n<"u"&&o.length>0&&n.length>m)throw new Error("Resize requires only of scales or sizes to be specified")},gc=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",yc=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",bc=(e,t,r)=>{let o=new Array(r).fill(0).concat(new Array(r).fill(1)),n=e.length===0?o:e.slice();return t.length>0?(t.forEach((s,u)=>{o[s]=n[u],o[u+r]=n[t.length+u]}),o):n},wc=(e,t,r,o)=>{let n=[];if(r.length>0)if(o.length>0){if(e.forEach(s=>n.push(s)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((s,u)=>n[s]=r[u])}else r.forEach(s=>n.push(s));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");n=e.map((s,u)=>Math.round(s*t[u]))}return n},vc=(e,t,r)=>{let o=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(s=>t[s]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(s=>t[s]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let n=e.slice();return r.axes.length>0?(r.axes.forEach(s=>t[s]=o),r.axes.forEach(s=>n[s]=Math.round(e[s]*t[s]))):(t.fill(o,0,t.length),n.forEach((s,u)=>n[u]=Math.round(s*t[u]))),n},$c=(e,t,r,o,n)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${ce("uniforms.scales","i",o)};\n        var roi_low = ${ce("uniforms.roi","i",n)};\n        var roi_hi = ${ce("uniforms.roi",`i + ${t.length}`,n)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${ce("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${ce("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,Sc=(e,t,r,o,n,s,u)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${o.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${ce("uniforms.scales","i",n)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${ce("uniforms.roi","i",s)};\n          var roi_hi = ${ce("uniforms.roi",`i + ${r.length}`,s)};\n          var input_shape_i = ${ce("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${ce("uniforms.output_shape","i",o.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${u} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,xc=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${ce("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,au=(e,t,r,o)=>e.rank>o?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",_c=(e,t,r,o,n)=>{let[u,d,a,m]=r.length===2?[-1,0,1,-1]:[0,2,3,1],h=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${h} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",d,`max(0, min(row, ${r[d]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(col, ${r[a]} - 1))`)};\n      ${au(e,m,u,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${h} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${h} = originalIndices[${d}];\n      var col:${h} = originalIndices[${a}];\n      ${o?`if (row < 0 || row > (${r[d]} - 1) || col < 0 || col > (${r[a]} - 1)) {\n        return ${n};\n      }`:""};\n      row = max(0, min(row, ${r[d]} - 1));\n      col = max(0, min(col, ${r[a]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${m}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${u}])`:"0"};\n      var x11: ${h} = getInputValue(batch, channel, row1, col1);\n      var x12: ${h} = getInputValue(batch, channel, row1, col2);\n      var x21: ${h} = getInputValue(batch, channel, row2, col1);\n      var x22: ${h} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${h} = abs(row - ${h}(row1));\n      var dx2: ${h} = abs(${h}(row2) - row);\n      var dy1: ${h} = abs(col - ${h}(col1));\n      var dy2: ${h} = abs(${h}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Cc=(e,t,r,o,n,s,u,d,a,m)=>{let h=r.length===2,g=!0,[w,v]=h?[0,1]:g?[2,3]:[1,2],y=e.type.value,C=I=>{let S=I===w?"row":"col";return`\n      fn ${S}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${y} {\n        var output_index = ${t.indicesGet("output_indices",I)};\n        var originalIdx: ${y} = getOriginalCoordinateFromResizedCoordinate(output_index, ${n[I]},\n        ${o[I]}, ${r[I]}, ${s[I]}, ${s[I]} + ${r.length});\n        var fractOriginalIdx: ${y} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${d} && (originalIdx < 0 || originalIdx > (${r[I]} - 1))) {\n          return ${a};\n        }\n        var data: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${S}: ${y} = originalIdx + ${y}(i);\n          if (${S} < 0 || ${S} >= ${r[I]}) {\n            ${(()=>m?`coefs[i + 1] = 0.0;\n                        continue;`:d?`return ${a};`:`${S} = max(0, min(${S}, ${r[I]} - 1));`)()};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",I,`u32(${S})`)};\n          data[i + 1] = ${I===w?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${C(w)};\n    ${C(v)};\n  fn getCubicInterpolationCoefs(s: ${y}) -> array<${y}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${y} = 1.0 - absS;\n    var twoMinusAbsS: ${y} = 2.0 - absS;\n    var onePlusAbsS: ${y} = 1.0 + absS;\n    coeffs[0] = ((${u} * onePlusAbsS - 5 * ${u}) * onePlusAbsS + 8 * ${u}) * onePlusAbsS - 4 * ${u};\n    coeffs[1] = ((${u} + 2) * absS - (${u} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${u} + 2) * oneMinusAbsS - (${u} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${u} * twoMinusAbsS - 5 * ${u}) * twoMinusAbsS + 8 * ${u}) * twoMinusAbsS - 4 * ${u};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${y}, 4>, coefs: array<${y}, 4>) -> ${y} {\n    var coefsSum: ${y} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${y} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Ic=(e,t,r,o,n)=>{let[u,d,a,m,h]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],g=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${g} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",d,`max(0, min(depth, ${r[d]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(height, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",m,`max(0, min(width, ${r[m]} - 1))`)};\n      ${au(e,h,u,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${g} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${g} = originalIndices[${d}];\n      var height:${g} = originalIndices[${a}];\n      var width:${g} = originalIndices[${m}];\n      ${o?`if (depth < 0 || depth > (${r[d]} - 1) || height < 0 || height > (${r[a]} - 1) || width < 0 || (width > ${r[m]} - 1)) {\n      return ${n};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[d]} - 1));\n      height = max(0, min(height, ${r[a]} - 1));\n      width = max(0, min(width, ${r[m]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${h}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${u}])`:"0"};\n\n      var x111: ${g} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${g} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${g} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${g} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${g} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${g} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${g} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${g} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${g} = abs(depth - ${g}(depth1));\n      var dx2: ${g} = abs(${g}(depth2) - depth);\n      var dy1: ${g} = abs(height - ${g}(height1));\n      var dy2: ${g} = abs(${g}(height2) - height);\n      var dz1: ${g} = abs(width - ${g}(width1));\n      var dz2: ${g} = abs(${g}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},Ac=(e,t,r,o,n,s)=>{let u=e.dims,d=bc(s,t.axes,u.length),a=wc(u,o,n,t.axes),m=o.slice();o.length===0&&(m=u.map((_,P)=>_===0?1:a[P]/_),t.keepAspectRatioPolicy!=="stretch"&&(a=vc(u,m,t)));let h=j("output",e.dataType,a.length),g=M("input",e.dataType,u.length),w=V.size(a),v=u.length===a.length&&u.every((_,P)=>_===a[P]),y=t.coordinateTransformMode==="tf_crop_and_resize",C=t.extrapolationValue,I=g.type.value,S=_=>`\n      ${v?"":`\n      ${gc(t.coordinateTransformMode,I)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${xc(g,u)};\n              ${yc(t.nearestMode,r,I)};\n              ${Sc(g,h,u,a,m.length,d.length,y)};\n              `;case"linear":return`\n              ${$c(h,u,a,m.length,d.length)};\n              ${(()=>{if(u.length===2||u.length===4)return`${_c(g,h,u,y,C)}`;if(u.length===3||u.length===5)return`${Ic(g,h,u,y,C)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(u.length===2||u.length===4)return`${Cc(g,h,u,a,m,d,t.cubicCoeffA,y,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${_.registerUniform("output_size","u32").registerUniform("scales","f32",m.length).registerUniform("roi","f32",d.length).declareVariables(g,h)}\n      ${_.mainStart()}\n        ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${v?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${h.offsetToIndices("global_idx")};\n        var input_indices: ${g.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${g.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${u.length===2||u.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${m.length>0?m:""}|${n.length>0?n:""}|${d.length>0?d:""}|${v}|${u}`,inputDependencies:["rank"]},getShaderSource:S,getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:"uint32",data:w},{type:"float32",data:m},{type:"float32",data:d},...F(u),...F(a)]})}},Tc=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},iu=(e,t)=>{let r=[],o=[],n=[],s=Tc(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");hc(e.inputs,t,s,r,o,n),e.compute(Ac(e.inputs[0],t,s,r,o,n),{inputs:[0]})},su=e=>{let t=e.antialias,r=e.axes,o=e.coordinateTransformMode,n=e.cubicCoeffA,s=e.excludeOutside!==0,u=e.extrapolationValue,d=e.keepAspectRatioPolicy,a=e.mode,m=e.nearestMode===""?"simple":e.nearestMode;return ge({antialias:t,axes:r,coordinateTransformMode:o,cubicCoeffA:n,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:d,mode:a,nearestMode:m})}});var Ec,Oc,lu,du,cu=q(()=>{"use strict";Ne();$e();je();we();Ec=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],o=e[2];if(t.dataType!==r.dataType||t.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let n=t.dims[t.dims.length-1],s=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==n)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==s)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==n)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let u=e[3];if(u.dims.length!==1)throw new Error("Beta must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let u=e[4];if(u.dims.length!==1)throw new Error("Bias must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Bias must have the same hidden size as input")}},Oc=(e,t,r,o)=>{let n=e[0].dims,s=V.size(n),u=n,d=s,a=n.slice(-1)[0],m=o?n.slice(0,-1).concat(1):[],h=e.length>3,g=e.length>4,w=o&&r>1,v=o&&r>2,y=r>3,C=Fe(a),I=[M("x",e[0].dataType,e[0].dims,C),M("skip",e[1].dataType,e[1].dims,C),M("gamma",e[2].dataType,e[2].dims,C)];h&&I.push(M("beta",e[3].dataType,e[3].dims,C)),g&&I.push(M("bias",e[4].dataType,e[4].dims,C)),I.push(j("output",e[0].dataType,u,C)),w&&I.push(j("meanOutput",1,m)),v&&I.push(j("invStdOutput",1,m)),y&&I.push(j("inputSkipBiasSum",e[0].dataType,u,C));let S=Le(e[0].dataType),_=A=>`\n      const hiddenSize: f32 = ${a};\n      const hiddenSizeVectorized: u32 = ${a/C};\n      const epsilon: f32 = ${t.epsilon};\n\n      ${A.declareVariables(...I)}\n\n      ${A.mainStart()}\n        ${A.guardAgainstOutOfBoundsWorkgroupSizes(d/a)}\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ${Ze("f32",C)};\n        var squareSum = ${Ze("f32",C)};\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ${g?"bias[i]":"0.0"};\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ${y?"inputSkipBiasSum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32Value = ${it(S,C,"value")};\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ${tt("sum",C)} / hiddenSize;\n        let invStdDev = inverseSqrt(${tt("squareSum",C)} / hiddenSize - mean * mean + epsilon);\n        ${w?"meanOutput[global_idx] = mean;":""}\n        ${v?"invStdOutput[global_idx] = invStdDev;":""}\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ${S}(mean)) * ${S}(invStdDev) * gamma[i]\n           + ${h?"beta[i]":"0.0"};\n        }\n      }`,P=[{dims:u,dataType:e[0].dataType}];return r>1&&P.push({dims:m,dataType:1}),r>2&&P.push({dims:m,dataType:1}),r>3&&P.push({dims:n,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:_,getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(d/a/64)}})}},lu=(e,t)=>{Ec(e.inputs);let o=[0];e.outputCount>1&&o.push(-3),e.outputCount>2&&o.push(-3),e.outputCount>3&&o.push(3),e.compute(Oc(e.inputs,t,e.outputCount,!1),{outputs:o})},du=e=>{let t=e.epsilon;return ge({epsilon:t})}});var Pc,fn,kc,pu,Bc,Rc,mu,fu,hu=q(()=>{"use strict";Ne();$e();je();we();Pc=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},fn=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(o=>r.push(Number(o)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(o=>r.push(Number(o)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},kc=(e,t)=>{if(e.length>1){let r=fn(e,1),o=fn(e,2),n=fn(e,3);return n.length===0&&(n=[...Array(e[0].dims.length).keys()]),ge({starts:r,ends:o,axes:n})}else return t},pu=(e,t,r,o,n)=>{let s=e;return e<0&&(s+=r[o[t]]),n[t]<0?Math.max(0,Math.min(s,r[o[t]]-1)):Math.max(0,Math.min(s,r[o[t]]))},Bc=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${ce("uniforms.input_shape","i",r.length)};\n            let steps_i = ${ce("uniforms.steps","i",r.length)};\n            let signs_i = ${ce("uniforms.signs","i",r.length)};\n            let starts_i = ${ce("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,Rc=(e,t)=>{let r=e[0].dims,o=V.size(r),n=t.axes.length>0?V.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],s=fn(e,4);s.forEach(S=>S!==0||(()=>{throw new Error("step cannot be 0")})),s.length===0&&(s=Array(n.length).fill(1));let u=t.starts.map((S,_)=>pu(S,_,r,n,s)),d=t.ends.map((S,_)=>pu(S,_,r,n,s));if(n.length!==u.length||n.length!==d.length)throw new Error("start, ends and axes should have the same number of elements");if(n.length!==r.length)for(let S=0;S<r.length;++S)n.includes(S)||(u.splice(S,0,0),d.splice(S,0,r[S]),s.splice(S,0,1));let a=s.map(S=>Math.sign(S));s.forEach((S,_,P)=>{if(S<0){let A=(d[_]-u[_])/S,z=u[_],R=z+A*s[_];u[_]=R,d[_]=z,P[_]=-S}});let m=r.slice(0);n.forEach((S,_)=>{m[S]=Math.ceil((d[S]-u[S])/s[S])});let h={dims:m,dataType:e[0].dataType},g=j("output",e[0].dataType,m.length),w=M("input",e[0].dataType,e[0].dims.length),v=V.size(m),y=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:u.length},{name:"signs",type:"i32",length:a.length},{name:"steps",type:"u32",length:s.length}],C=[{type:"uint32",data:v},{type:"uint32",data:u},{type:"int32",data:a},{type:"uint32",data:s},...F(e[0].dims),...F(m)],I=S=>`\n      ${S.registerUniforms(y).declareVariables(w,g)}\n        ${Bc(w,g,r)}\n        ${S.mainStart()}\n          ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${g.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${g.setByOffset("global_idx",w.getByIndices("input_indices"))}\n      }`;return{name:"Slice",shaderCache:{hint:`${a.length}_${u.length}_${s.length}`,inputDependencies:["rank"]},getShaderSource:I,getRunData:()=>({outputs:[h],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:C})}},mu=(e,t)=>{Pc(e.inputs,t);let r=kc(e.inputs,t);e.compute(Rc(e.inputs,r),{inputs:[0]})},fu=e=>{let t=e.starts,r=e.ends,o=e.axes;return ge({starts:t,ends:r,axes:o})}});var Dc,Mc,gu,yu,bu=q(()=>{"use strict";$e();je();we();Dc=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Mc=(e,t)=>{let r=e.dims,o=V.size(r),n=64,s=t.axis;if(s<0&&(s=r.length+s),s<r.length-1)throw new Error("softmax only supports last axis for now.");let u=r[s],d=o/u,a=Fe(u),m=u/a,h=(I,S)=>S===4?`max(max(${I}.x, ${I}.y), max(${I}.z, ${I}.w))`:S===2?`max(${I}.x, ${I}.y)`:S===3?`max(max(${I}.x, ${I}.y), ${I}.z)`:I,g=M("x",e.dataType,e.dims,a),w=j("result",e.dataType,e.dims,a),v=g.type.value,y=Le(e.dataType)==="f32"?`var threadMax = ${v}(-3.402823e+38f);`:`var threadMax = ${v}(-65504.0h);`,C=I=>`\n      var<workgroup> rowMaxShared : ${v};\n      var<workgroup> rowSumShared : ${v};\n      var<workgroup> threadShared : array<${v}, ${n}>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${v} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${v}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${I.registerUniform("packedCols","i32").declareVariables(g,w)}\n      ${I.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = ${n};\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${y}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${v}(${h("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${v}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${v}(${tt("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`;return{name:"Softmax",shaderCache:{hint:`${a}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:d},programUniforms:[{type:"uint32",data:m}]}),getShaderSource:C}},gu=(e,t)=>{Dc(e.inputs),e.compute(Mc(e.inputs[0],t))},yu=e=>ge({axis:e.axis})});var Uc,zc,Vc,Nc,Wc,wu,vu,$u=q(()=>{"use strict";$e();je();we();Uc=e=>{if(!e||e.length<1)throw new Error("too few inputs")},zc=(e,t)=>{let r=[],o=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(n=>r.push(Number(n))),o=r.length),ge({numOutputs:o,axis:t.axis,splitSizes:r})},Vc=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${ce("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Nc=e=>{let t=e.length,r=[];for(let o=0;o<t;++o){let n=e[o].setByIndices("indices","input[global_idx]");t===1?r.push(n):o===0?r.push(`if (output_number == ${o}u) { ${n} }`):o===t-1?r.push(`else { ${n} }`):r.push(`else if (output_number == ${o}) { ${n} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join(`\n`)}\n      }`},Wc=(e,t)=>{let r=e[0].dims,o=V.size(r),n=e[0].dataType,s=V.normalizeAxis(t.axis,r.length),u=new Array(t.numOutputs),d=M("input",n,r),a=new Array(t.numOutputs),m=[],h=[],g=0,w=[{type:"uint32",data:o}];for(let y=0;y<t.numOutputs;y++){g+=t.splitSizes[y],a[y]=g;let C=r.slice();C[t.axis]=t.splitSizes[y],h.push(C),u[y]=j(`output${y}`,n,C),m.push({dims:h[y],dataType:e[0].dataType})}w.push({type:"uint32",data:a}),w.push(...F(r)),h.forEach(y=>w.push(...F(y)));let v=y=>`\n  ${y.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",a.length).declareVariables(d,...u)}\n  ${Vc(a.length)}\n  ${Nc(u)}\n\n  ${y.mainStart()}\n    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${d.offsetToIndices("global_idx")};\n    var index = ${d.indicesGet("indices",s)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${ce("uniforms.size_in_split_axis","output_number - 1u",a.length)};\n      ${d.indicesSet("indices",s,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:v,getRunData:()=>({outputs:m,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:w})}},wu=(e,t)=>{Uc(e.inputs);let r=e.inputs.length===1?t:zc(e.inputs,t);e.compute(Wc(e.inputs,r),{inputs:[0]})},vu=e=>{let t=e.axis,r=e.splitSizes,o=e.numOutputs<0?r.length:e.numOutputs;if(o!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return ge({axis:t,numOutputs:o,splitSizes:r})}});var Su,Hc,Gc,Lc,xu,_u=q(()=>{"use strict";Ne();$e();we();Su=e=>Array.from(e.getBigInt64Array(),Number),Hc=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Su(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Gc=(e,t)=>{let r=[];for(let o=0;o<e.length;++o)r.push(e[o]*t[o]);return r},Lc=e=>{let t=e[0].dims,r=Su(e[1]),o=Gc(t,r),n=V.size(o),s=e[0].dataType,u=M("input",s,t.length),d=j("output",s,o.length),a=m=>`\n      const inputShape = ${u.indices(...t)};\n      ${m.registerUniform("output_size","u32").declareVariables(u,d)}\n      ${m.mainStart()}\n      ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${d.offsetToIndices("global_idx")};\n      var input_indices: ${u.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${u.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${d.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${u.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${d.setByOffset("global_idx",u.getByIndices("input_indices"))}\n    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},...F(e[0].dims),...F(o)]}),getShaderSource:a}},xu=e=>{Hc(e.inputs),e.compute(Lc(e.inputs),{inputs:[0]})}});var Fc,jc,Cu,Iu=q(()=>{"use strict";Ne();$e();we();Fc=(e,t,r,o,n)=>{let s=j("output_data",n,r.length,4),u=M("a_data",t[1].dataType,t[1].dims.length,4),d=M("b_data",t[2].dataType,t[2].dims.length,4),a=M("c_data",t[0].dataType,t[0].dims.length,4),m,h=(g,w,v)=>`select(${w}, ${g}, ${v})`;if(!o)m=s.setByOffset("global_idx",h(u.getByOffset("global_idx"),d.getByOffset("global_idx"),a.getByOffset("global_idx")));else{let g=(w,v,y="")=>{let C=`a_data[index_a${v}][component_a${v}]`,I=`b_data[index_b${v}][component_b${v}]`,S=`bool(c_data[index_c${v}] & ${4278190080>>>(3-v)*8}u)`;return`\n            let output_indices${v} = ${s.offsetToIndices(`global_idx * 4u + ${v}u`)};\n            let offset_a${v} = ${u.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_b${v} = ${d.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_c${v} = ${a.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let index_a${v} = offset_a${v} / 4u;\n            let index_b${v} = offset_b${v} / 4u;\n            let index_c${v} = offset_c${v} / 4u;\n            let component_a${v} = offset_a${v} % 4u;\n            let component_b${v} = offset_b${v} % 4u;\n            ${w}[${v}] = ${y}(${h(C,I,S)});\n          `};n===9?m=`\n            var data = vec4<u32>(0);\n            ${g("data",0,"u32")}\n            ${g("data",1,"u32")}\n            ${g("data",2,"u32")}\n            ${g("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:m=`\n            ${g("output_data[global_idx]",0)}\n            ${g("output_data[global_idx]",1)}\n            ${g("output_data[global_idx]",2)}\n            ${g("output_data[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(a,u,d,s)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${m}\n      }`},jc=e=>{let t=e[1].dims,r=e[2].dims,o=e[0].dims,n=e[1].dataType,s=!(V.areEqual(t,r)&&V.areEqual(r,o)),u=t,d=V.size(t);if(s){let m=lt.calcShape(lt.calcShape(t,r,!1),o,!1);if(!m)throw new Error("Can\'t perform where op on the given tensors");u=m,d=V.size(u)}let a=Math.ceil(d/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:m=>Fc(m,e,u,s,n),getRunData:()=>({outputs:[{dims:u,dataType:n}],dispatchGroup:{x:Math.ceil(d/64/4)},programUniforms:[{type:"uint32",data:a},...F(o),...F(t),...F(r),...F(u)]})}},Cu=e=>{e.compute(jc(e.inputs))}});var Au,Tu=q(()=>{"use strict";Ja();Kn();ei();ri();Di();ji();Yi();Xn();ls();ps();ys();vs();xs();Is();Es();Ps();Bs();to();Us();Vs();ru();ou();tn();uu();cu();hu();bu();$u();_u();tr();Yn();Iu();Au=new Map([["Abs",[ni]],["Acos",[oi]],["Acosh",[ai]],["Add",[Mi]],["ArgMax",[Za,qn]],["ArgMin",[Ya,qn]],["Asin",[ii]],["Asinh",[si]],["Atan",[ui]],["Atanh",[li]],["Attention",[Qa]],["AveragePool",[qs,js]],["BatchNormalization",[Xa]],["BiasAdd",[ti]],["BiasSplitGelu",[Ri]],["Cast",[ci,di]],["Ceil",[mi]],["Clip",[pi]],["Concat",[qi,Ki]],["Conv",[no,ro]],["ConvTranspose",[us,ss]],["Cos",[fi]],["Cosh",[hi]],["CumSum",[ds,cs]],["Div",[Ui]],["Einsum",[hs,gs]],["Elu",[gi,on]],["Equal",[zi]],["Erf",[yi]],["Exp",[bi]],["Expand",[ws]],["Floor",[wi]],["FusedConv",[no,ro]],["Gather",[Ss,$s]],["GatherElements",[Cs,_s]],["Gelu",[vi]],["Gemm",[Ts,As]],["GlobalAveragePool",[Zs,Ys]],["GlobalMaxPool",[tu,eu]],["Greater",[Hi]],["GreaterOrEqual",[Li]],["InstanceNormalization",[Os]],["LayerNormalization",[ks]],["LeakyRelu",[$i,on]],["Less",[Gi]],["LessOrEqual",[Fi]],["Log",[Bi]],["MatMul",[es]],["MaxPool",[Qs,Xs]],["Mul",[Vi]],["MultiHeadAttention",[Ms,Ds]],["Neg",[xi]],["Not",[Si]],["Pad",[zs]],["Pow",[Ni]],["Range",[nu]],["Reciprocal",[_i]],["ReduceMin",[Ga]],["ReduceMean",[za]],["ReduceMax",[Ha]],["ReduceSum",[Fa]],["ReduceProd",[La]],["ReduceL1",[Va]],["ReduceL2",[Na]],["ReduceLogSum",[qa]],["ReduceLogSumExp",[Wa]],["ReduceSumSquare",[ja]],["Relu",[Ci]],["Resize",[iu,su]],["Sigmoid",[Ii]],["Sin",[Ai]],["Sinh",[Ti]],["Slice",[mu,fu]],["SkipLayerNormalization",[lu,du]],["Split",[wu,vu]],["Sqrt",[Ei]],["Softmax",[gu,yu]],["Sub",[Wi]],["Tan",[Oi]],["Tanh",[Pi]],["ThresholdedRelu",[ki,on]],["Tile",[xu]],["Transpose",[Ca,Ia]],["Where",[Cu]]])});var hn,Eu=q(()=>{"use strict";Xt();It();we();hn=class{constructor(t){this.backend=t;this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,r){this.repo.set(t,r)}run(t,r,o,n,s){Dt(t.programInfo.name);let u=this.backend.device,d=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2),d.setPipeline(t.computePipeline);let a=[];for(let h of r)a.push({binding:a.length,resource:{buffer:h.buffer}});for(let h of o)a.push({binding:a.length,resource:{buffer:h.buffer}});s&&a.push({binding:a.length,resource:s});let m=u.createBindGroup({layout:t.computePipeline.getBindGroupLayout(0),entries:a,label:t.programInfo.name});d.setBindGroup(0,m),d.dispatchWorkgroups(...n),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Mt(t.programInfo.name)}dispose(){}build(t,r){Dt(t.name);let o=this.backend.device,n=[];o.features.has("shader-f16")&&n.push("enable f16;");let s=xa(r),u=t.getShaderSource(s),d=`${n.join(`\n`)}\n${s.additionalImplementations}\n${u}`,a=o.createShaderModule({code:d,label:t.name});De("verbose",()=>`[WebGPU] ${t.name} shader code: ${d}`);let m=o.createComputePipeline({compute:{module:a,entryPoint:"main"},layout:"auto",label:t.name});return Mt(t.name),{programInfo:t,computePipeline:m}}normalizeDispatchGroupSize(t){let r=typeof t=="number"?t:t.x,o=typeof t=="number"?1:t.y||1,n=typeof t=="number"?1:t.z||1,s=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(r<=s&&o<=s&&n<=s)return[r,o,n];let u=r*o*n,d=Math.ceil(Math.sqrt(u));if(d>s){if(d=Math.ceil(Math.cbrt(u)),d>s)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[d,d,d]}else return[d,d,1]}}});var qc,Kc,gn,Ou=q(()=>{"use strict";Xt();Ne();It();ba();Sa();Tu();Eu();qc=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let o=0;o<e.length;++o){let n=e[o].dataType;switch(t[o]){case"none":{r.push("");break}case"type":{r.push(`${n}`);break}case"rank":{let s=e[o].dims.length;r.push(`${n};${s}`);break}case"dims":{let s=e[o].dims.join(",");r.push(`${n};${s}`);break}default:throw new Error(`unsupported input dependency: ${t[o]}`)}}return r.join("|")},Kc=(e,t,r)=>{let o=e.name;return e.shaderCache?.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+r+`:${qc(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,o},gn=class{constructor(){this.currentKernelId=null;this.commandEncoder=null;this.computePassEncoder=null;this.maxDispatchNumber=16;this.pendingDispatchNumber=0;this.pendingKernels=[];this.pendingQueries=new Map;this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let t=this.kernelCustomData.get(this.currentKernelId);return t||(t={},this.kernelCustomData.set(this.currentKernelId,t)),t}async initialize(t,r){this.env=t;let o=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:r.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:r.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:r.limits.maxStorageBufferBindingSize,maxBufferSize:r.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:r.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:r.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:r.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:r.limits.maxComputeWorkgroupSizeZ},requiredFeatures:o};r.features.has("chromium-experimental-timestamp-query-inside-passes")?o.push("chromium-experimental-timestamp-query-inside-passes"):r.features.has("timestamp-query")&&o.push("timestamp-query"),r.features.has("shader-f16")&&o.push("shader-f16"),this.device=await r.requestDevice(n),this.gpuDataManager=$a(this),this.programManager=new hn(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,ga(t.logLevel,!!t.debug),this.device.onuncapturederror=s=>{s.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${s.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=this.getCommandEncoder().beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Dt(),this.endComputePass();let t;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),t=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(t,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&t.mapAsync(GPUMapMode.READ).then(()=>{let r=new BigUint64Array(t.getMappedRange()),o=this.pendingQueries.get(t);for(let n=0;n<r.length/2;n++){let s=o[n],u=s.kernelId,d=this.kernels.get(u),a=d.kernelType,m=d.kernelName,h=s.programName,g=s.inputTensorViews,w=s.outputTensorViews,v=r[n*2],y=r[n*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=v);let C=Number(v-this.queryTimeBase),I=Number(y-this.queryTimeBase);if(!Number.isSafeInteger(C)||!Number.isSafeInteger(I))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:g.map(S=>({dims:S.dims,dataType:et(S.dataType)})),outputsMetadata:w.map(S=>({dims:S.dims,dataType:et(S.dataType)})),kernelId:u,kernelType:a,kernelName:m,programName:h,startTime:C,endTime:I});else{let S="";g.forEach((P,A)=>{S+=`input[${A}]: [${P.dims}] | ${et(P.dataType)}, `});let _="";w.forEach((P,A)=>{_+=`output[${A}]: [${P.dims}] | ${et(P.dataType)}, `}),console.log(`[profiling] kernel "${u}|${a}|${m}|${h}" ${S}${_}execution time: ${I-C} ns`)}Un("GPU",`${h}::${v}::${y}`)}t.unmap(),this.pendingQueries.delete(t)}),Mt()}run(t,r,o,n,s){Dt(t.name);let u=[];for(let _=0;_<r.length;++_){let P=this.gpuDataManager.get(r[_].data);if(!P)throw new Error(`no GPU data for input: ${r[_].data}`);u[_]=P}let{outputs:d,dispatchGroup:a,programUniforms:m}=t.getRunData(r),h=o.length===0?d.map((_,P)=>P):o;if(h.length!==d.length)throw new Error(`Output size ${h.length} must be equal to ${d.length}.`);let g=[],w=[];for(let _=0;_<d.length;++_){if(!Number.isInteger(h[_])||h[_]<-3||h[_]>=d.length)throw new Error(`Invalid output index: ${h[_]}`);if(h[_]===-3)continue;let P=h[_]===-1,A=h[_]===-2,z=P||A?s(d[_].dataType,d[_].dims):n(h[_],d[_].dataType,d[_].dims),R=this.gpuDataManager.get(z.data);if(!R)throw new Error(`no GPU data for output: ${z.data}`);if(P&&this.temporaryData.push(R),A){let N=this.kernelPersistentData.get(this.currentKernelId);N||(N=[],this.kernelPersistentData.set(this.currentKernelId,N)),N.push(R)}g.push(z),w.push(R)}let v;if(m){let _=0,P=[];m.forEach(N=>{let T=typeof N.data=="number"?[N.data]:N.data;if(T.length===0)return;let H=T.length<=2?T.length*4:16;_=Math.ceil(_/H)*H,P.push(_),_+=T.length>4?Math.ceil(T.length/4)*16:T.length*4});let A=16;_=Math.ceil(_/A)*A;let z=new ArrayBuffer(_);m.forEach((N,T)=>{let H=P[T],ie=typeof N.data=="number"?[N.data]:N.data;N.type==="int32"?new Int32Array(z,H,ie.length).set(ie):N.type==="uint32"?new Uint32Array(z,H,ie.length).set(ie):new Float32Array(z,H,ie.length).set(ie)});let R=this.gpuDataManager.create(_,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(R.buffer,0,z,0,_),this.gpuDataManager.release(R.id),v={offset:0,size:_,buffer:R.buffer}}let y=this.programManager.normalizeDispatchGroupSize(a),C=y[1]===1&&y[2]===1,I=Kc(t,r,C),S=this.programManager.getArtifact(I);if(S||(S=this.programManager.build(t,y),this.programManager.setArtifact(I,S),De("info",()=>`[artifact] key: ${I}, programName: ${t.name}`)),De("info",()=>`[ProgramManager] run "${t.name}" (key=${I}) with ${y[0]}x${y[1]}x${y[2]}`),this.queryType!=="none"){let _={kernelId:this.currentKernelId,programName:S.programInfo.name,inputTensorViews:r,outputTensorViews:g};this.pendingKernels.push(_)}return this.programManager.run(S,u,w,y,v),Mt(t.name),g}upload(t,r){this.gpuDataManager.upload(t,r)}memcpy(t,r){this.gpuDataManager.memcpy(t,r)}async download(t,r){await this.gpuDataManager.download(t,r)}alloc(t){return this.gpuDataManager.create(t).id}free(t){return this.gpuDataManager.release(t)}createKernel(t,r,o,n){let s=Au.get(t);if(!s)throw new Error(`kernel not implemented: ${t}`);let u={kernelType:t,kernelName:n,kernelEntry:s[0],attributes:[s[1],o]};this.kernels.set(r,u)}releaseKernel(t){let r=this.kernelPersistentData.get(t);if(r){for(let o of r)this.gpuDataManager.release(o.id);this.kernelPersistentData.delete(t)}this.kernelCustomData.delete(t),this.kernels.delete(t)}computeKernel(t,r,o){let n=this.kernels.get(t);if(!n)throw new Error(`kernel not created: ${t}`);let s=n.kernelType,u=n.kernelName,d=n.kernelEntry,a=n.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${s}] ${u}" is not allowed to be called recursively`);this.currentKernelId=t,a[0]&&(a[1]=a[0](a[1]),a[0]=void 0),De("info",()=>`[WebGPU] Start to run kernel "[${s}] ${u}"...`);let m=this.env.debug;this.temporaryData=[];try{return m&&this.device.pushErrorScope("validation"),d(r,a[1]),0}catch(h){return o.push(Promise.resolve(`[WebGPU] Kernel "[${s}] ${u}" failed. ${h}`)),1}finally{m&&o.push(this.device.popErrorScope().then(h=>h?`GPU validation error for kernel "[${s}] ${u}": ${h.message}`:null));for(let h of this.temporaryData)this.gpuDataManager.release(h.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(t,r,o,n){let s=this.sessionExternalDataMapping.get(t);s||(s=new Map,this.sessionExternalDataMapping.set(t,s));let u=s.get(r),d=this.gpuDataManager.registerExternalBuffer(o,n,u?.[1]);return s.set(r,[d,o]),d}unregisterBuffers(t){let r=this.sessionExternalDataMapping.get(t);r&&(r.forEach(o=>this.gpuDataManager.unregisterExternalBuffer(o[1])),this.sessionExternalDataMapping.delete(t))}getBuffer(t){let r=this.gpuDataManager.get(t);if(!r)throw new Error(`no GPU data for buffer: ${t}`);return r.buffer}createDownloader(t,r,o){return async()=>{let n=await Nn(this,t,r);return ya(n.buffer,o)}}writeTimestamp(t){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,t)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"))}}});var Pu={};Gr(Pu,{init:()=>Yc});var Ir,lo,Yc,ku=q(()=>{"use strict";Ne();Ou();It();$e();Ir=class e{constructor(t,r,o,n){this.module=t;this.dataType=r;this.data=o;this.dims=n}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(V.size(t)!==V.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},lo=class{constructor(t,r,o){this.module=t;this.backend=r;this.customDataOffset=0;this.customDataSize=0;let n=t.HEAPU32,s=o>>>2;this.opKernelContext=n[s++];let u=n[s++];this.outputCount=n[s++],this.customDataOffset=n[s++],this.customDataSize=n[s++];let d=[];for(let a=0;a<u;a++){let m=n[s++],h=n[s++],g=n[s++],w=[];for(let v=0;v<g;v++)w.push(n[s++]);d.push(new Ir(t,m,h,w))}this.inputs=d}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(t,r){let o=r?.inputs?.map(d=>typeof d=="number"?this.inputs[d]:d)??this.inputs,n=r?.outputs??[],s=(d,a,m)=>new Ir(this.module,a,this.output(d,m),m),u=(d,a)=>{let m=$r(d);if(!m)throw new Error(`Unsupported data type: ${d}`);let h=m*V.size(a);return new Ir(this.module,d,this.backend.gpuDataManager.create(h).id,a)};return this.backend.run(t,o,n,s,u)}output(t,r){let o=this.module.stackSave();try{let n=this.module.stackAlloc((1+r.length)*4),s=n>>2;this.module.HEAPU32[s++]=r.length;for(let u=0;u<r.length;u++)this.module.HEAPU32[s++]=r[u];return this.module._JsepOutput(this.opKernelContext,t,n)}catch(n){throw new Error(`Failed to generate kernel\'s output[${t}] with dims [${r}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(o)}}},Yc=async(e,t,r)=>{let o=e.jsepInit;if(!o)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");let n=new gn;await n.initialize(t,r),o(n,s=>n.alloc(s),s=>n.free(s),(s,u,d,a=!1)=>{if(a)De("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${s}, dst=${u}, size=${d}`),n.memcpy(s,u);else{De("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${s}, gpuDataId=${u}, size=${d}`);let m=e.HEAPU8.subarray(s>>>0,(s>>>0)+d);n.upload(u,m)}},async(s,u,d)=>{De("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${s}, dataOffset=${u}, size=${d}`),await n.download(s,()=>e.HEAPU8.subarray(u>>>0,(u>>>0)+d))},(s,u,d)=>n.createKernel(s,u,d,e.UTF8ToString(e._JsepGetNodeName(u))),s=>n.releaseKernel(s),(s,u,d,a)=>{De("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${d}, kernel=${s}, contextDataOffset=${u}`);let m=new lo(e,n,u);return n.computeKernel(s,m,a)})}});var jo;jo=Mo();var ll=Go(),kn,Bn=!1,Lr=!1,Fo=!1,dl=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},cl=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},pl=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",qo=async e=>{if(Bn)return Promise.resolve();if(Lr)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Fo)throw new Error("previous call to \'initializeWebAssembly()\' failed.");Lr=!0;let t=e.initTimeout,r=e.numThreads,o=e.simd,n=dl(r),s=o&&cl(),u=e.wasmPaths,d=typeof u=="string"?u:void 0,a=pl(s,n),m=typeof u=="object"?u[a]:void 0,h=!1,g=[];if(t>0&&g.push(new Promise(w=>{setTimeout(()=>{h=!0,w()},t)})),g.push(new Promise((w,v)=>{let y=n?ll:jo,C={locateFile:(I,S)=>{if(n&&I.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([Lo()],{type:"text/javascript"}));if(I.endsWith(".wasm")){if(m)return m;let _=d??S;return a==="ort-wasm-simd.wasm"?_+"ort-wasm-simd.jsep.wasm":a==="ort-wasm-simd-threaded.wasm"?_+"ort-wasm-simd-threaded.jsep.wasm":_+a}return S+I}};if(n)if(C.numThreads=r,typeof Blob>"u")C.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let I=`var ortWasmThreaded=${y.toString()};`;C.mainScriptUrlOrBlob=new Blob([I],{type:"text/javascript"})}y(C).then(I=>{Lr=!1,Bn=!0,kn=I,w()},I=>{Lr=!1,Fo=!0,v(I)})})),await Promise.race(g),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Re=()=>{if(Bn&&kn)return kn;throw new Error("WebAssembly is not initialized yet.")};var He=(e,t)=>{let r=Re(),o=r.lengthBytesUTF8(e)+1,n=r._malloc(o);return r.stringToUTF8(e,n,o),t.push(n),n},vr=(e,t,r,o)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([n,s])=>{let u=t?t+n:n;if(typeof s=="object")vr(s,u+".",r,o);else if(typeof s=="string"||typeof s=="number")o(u,s.toString());else if(typeof s=="boolean")o(u,s?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof s}`)})},ke=e=>{let t=Re(),r=t.stackSave();try{let o=t.stackAlloc(8);t._OrtGetLastError(o,o+4);let n=t.HEAP32[o/4],s=t.HEAPU32[o/4+1],u=s?t.UTF8ToString(s):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${u}`)}finally{t.stackRestore(r)}};var Ko=e=>{let t=Re(),r=0,o=[],n=e||{};try{if(e?.logSeverityLevel===void 0)n.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)n.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(n.terminate=!1);let s=0;return e?.tag!==void 0&&(s=He(e.tag,o)),r=t._OrtCreateRunOptions(n.logSeverityLevel,n.logVerbosityLevel,!!n.terminate,s),r===0&&ke("Can\'t create run options."),e?.extra!==void 0&&vr(e.extra,"",new WeakSet,(u,d)=>{let a=He(u,o),m=He(d,o);t._OrtAddRunConfigEntry(r,a,m)!==0&&ke(`Can\'t set a run config entry: ${u} - ${d}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseRunOptions(r),o.forEach(u=>t._free(u)),s}};var ml=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},fl=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},hl=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},gl=(e,t,r)=>{for(let o of t){let n=typeof o=="string"?o:o.name;switch(n){case"webnn":if(n="WEBNN",typeof o!="string"){let u=o;if(u?.deviceType){let d=He("deviceType",r),a=He(u.deviceType,r);Re()._OrtAddSessionConfigEntry(e,d,a)!==0&&ke(`Can\'t set a session config entry: \'deviceType\' - ${u.deviceType}.`)}if(u?.numThreads){let d=u.numThreads;(typeof d!="number"||!Number.isInteger(d)||d<0)&&(d=0);let a=He("numThreads",r),m=He(d.toString(),r);Re()._OrtAddSessionConfigEntry(e,a,m)!==0&&ke(`Can\'t set a session config entry: \'numThreads\' - ${u.numThreads}.`)}if(u?.powerPreference){let d=He("powerPreference",r),a=He(u.powerPreference,r);Re()._OrtAddSessionConfigEntry(e,d,a)!==0&&ke(`Can\'t set a session config entry: \'powerPreference\' - ${u.powerPreference}.`)}}break;case"webgpu":if(n="JS",typeof o!="string"){let u=o;if(u?.preferredLayout){if(u.preferredLayout!=="NCHW"&&u.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${u.preferredLayout}`);let d=He("preferredLayout",r),a=He(u.preferredLayout,r);Re()._OrtAddSessionConfigEntry(e,d,a)!==0&&ke(`Can\'t set a session config entry: \'preferredLayout\' - ${u.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${n}`)}let s=He(n,r);Re()._OrtAppendExecutionProvider(e,s)!==0&&ke(`Can\'t append execution provider: ${n}.`)}},Yo=e=>{let t=Re(),r=0,o=[],n=e||{};hl(n);try{let s=ml(n.graphOptimizationLevel??"all"),u=fl(n.executionMode??"sequential"),d=typeof n.logId=="string"?He(n.logId,o):0,a=n.logSeverityLevel??2;if(!Number.isInteger(a)||a<0||a>4)throw new Error(`log serverity level is not valid: ${a}`);let m=n.logVerbosityLevel??0;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log verbosity level is not valid: ${m}`);let h=typeof n.optimizedModelFilePath=="string"?He(n.optimizedModelFilePath,o):0;if(r=t._OrtCreateSessionOptions(s,!!n.enableCpuMemArena,!!n.enableMemPattern,u,!!n.enableProfiling,0,d,a,m,h),r===0&&ke("Can\'t create session options."),n.executionProviders&&gl(r,n.executionProviders,o),n.freeDimensionOverrides)for(let[g,w]of Object.entries(n.freeDimensionOverrides)){if(typeof g!="string")throw new Error(`free dimension override name must be a string: ${g}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let v=He(g,o);t._OrtAddFreeDimensionOverride(r,v,w)!==0&&ke(`Can\'t set a free dimension override: ${g} - ${w}.`)}return n.extra!==void 0&&vr(n.extra,"",new WeakSet,(g,w)=>{let v=He(g,o),y=He(w,o);t._OrtAddSessionConfigEntry(r,v,y)!==0&&ke(`Can\'t set a session config entry: ${g} - ${w}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseSessionOptions(r),o.forEach(u=>t._free(u)),s}};Ne();var Jo=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(t){if(t.code==="ERR_FS_FILE_TOO_LARGE"){let r=(void 0)(e),o=[];for await(let n of r)o.push(n);return new Uint8Array(Buffer.concat(o))}throw t}else{let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),o=r?parseInt(r,10):0;if(o<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let n=t.body.getReader(),s;try{s=new ArrayBuffer(o)}catch(d){if(d instanceof RangeError){let a=Math.ceil(o/65536);s=new WebAssembly.Memory({initial:a,maximum:a}).buffer}else throw d}let u=0;for(;;){let{done:d,value:a}=await n.read();if(d)break;let m=a.byteLength;new Uint8Array(s,u,m).set(a),u+=m}return new Uint8Array(s,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)};var Zc=(e,t)=>{Re()._OrtInit(e,t)!==0&&ke("Can\'t initialize onnxruntime.")},Ru=async e=>{Zc(e.wasm.numThreads,Sr(e.logLevel))},Du=async(e,t)=>{if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=await navigator.gpu.requestAdapter();if(!r)throw new Error(\'Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.\');if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");let o=(ku(),Jt(Pu)).init;await o(Re(),e,r)}},Ar=new Map,Jc=e=>{let t=Re(),r=t.stackSave();try{let o=t.stackAlloc(8);return t._OrtGetInputOutputCount(e,o,o+4)!==0&&ke("Can\'t get session input/output count."),[t.HEAP32[o/4],t.HEAP32[o/4+1]]}finally{t.stackRestore(r)}},co=e=>{let t=Re(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},Mu=async(e,t)=>{let r,o,n=Re();Array.isArray(e)?[r,o]=e:e.buffer===n.HEAPU8.buffer?[r,o]=[e.byteOffset,e.byteLength]:[r,o]=co(e);let s=0,u=0,d=0,a=[],m=[],h=[];try{if([u,a]=Yo(t),t?.externalData&&n.mountExternalData){let S=[];for(let _ of t.externalData){let P=typeof _=="string"?_:_.path;S.push(Jo(typeof _=="string"?_:_.data).then(A=>{n.mountExternalData(P,A)}))}await Promise.all(S)}s=n._OrtCreateSession(r,o,u),s===0&&ke("Can\'t create a session.");let[g,w]=Jc(s),v=[],y=[],C=[];for(let S=0;S<g;S++){let _=n._OrtGetInputName(s,S);_===0&&ke("Can\'t get an input name."),m.push(_),v.push(n.UTF8ToString(_))}for(let S=0;S<w;S++){let _=n._OrtGetOutputName(s,S);_===0&&ke("Can\'t get an output name."),h.push(_);let P=n.UTF8ToString(_);y.push(P);{let A=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[P]??"cpu";if(A!=="cpu"&&A!=="cpu-pinned"&&A!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${A}.`);C.push(A)}}let I=null;return C.some(S=>S==="gpu-buffer")&&(d=n._OrtCreateBinding(s),d===0&&ke("Can\'t create IO binding."),I={handle:d,outputPreferredLocations:C,outputPreferredLocationsEncoded:C.map(S=>Dn(S))}),Ar.set(s,[s,m,h,I]),[s,v,y]}catch(g){throw m.forEach(w=>n._OrtFree(w)),h.forEach(w=>n._OrtFree(w)),d!==0&&n._OrtReleaseBinding(d),s!==0&&n._OrtReleaseSession(s),g}finally{n._free(r),u!==0&&n._OrtReleaseSessionOptions(u),a.forEach(g=>n._free(g)),n.unmountExternalData?.()}},Uu=e=>{let t=Re(),r=Ar.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,n,s,u]=r;u&&t._OrtReleaseBinding(u.handle),t.jsepUnregisterBuffers?.(e),n.forEach(d=>t._OrtFree(d)),s.forEach(d=>t._OrtFree(d)),t._OrtReleaseSession(o),Ar.delete(e)},Bu=(e,t,r,o,n)=>{if(!e){t.push(0);return}let s=Re(),u=e[0],d=e[1],a=e[3],m,h;if(u==="string"&&a==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(a==="gpu-buffer"){let v=e[2].gpuBuffer,y=$r(Rn(u));h=d.reduce((C,I)=>C*I,1)*y,m=s.jsepRegisterBuffer(o,n,v,h)}else{let v=e[2];if(Array.isArray(v)){h=4*v.length,m=s._malloc(h),r.push(m);let y=m/4;for(let C=0;C<v.length;C++){if(typeof v[C]!="string")throw new TypeError(`tensor data at index ${C} is not a string`);s.HEAPU32[y++]=He(v[C],r)}}else h=v.byteLength,m=s._malloc(h),r.push(m),s.HEAPU8.set(new Uint8Array(v.buffer,v.byteOffset,h),m)}let g=s.stackSave(),w=s.stackAlloc(4*d.length);try{let v=w/4;d.forEach(C=>s.HEAP32[v++]=C);let y=s._OrtCreateTensor(Rn(u),m,h,w,d.length,Dn(a));y===0&&ke(`Can\'t create tensor for input/output. session=${o}, index=${n}.`),t.push(y)}finally{s.stackRestore(g)}},zu=e=>{let r=new TextEncoder().encode(e),o=Re(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtConfigure(n,r.byteLength);if(s===0)throw new Error("Can\'t get an configure key");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Vu=e=>{let r=new TextEncoder().encode(e),o=Re(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtAuth(n,r.byteLength);if(s===0)throw new Error("Can\'t get an auth result");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Nu=async(e,t,r,o,n,s)=>{let u=Re(),d=Ar.get(e);if(!d)throw new Error(`cannot run inference. invalid session id: ${e}`);let[a,m,h,g]=d,w=t.length,v=o.length,y=0,C=[],I=[],S=[],_=[],P=u.stackSave(),A=u.stackAlloc(w*4),z=u.stackAlloc(w*4),R=u.stackAlloc(v*4),N=u.stackAlloc(v*4);try{[y,C]=Ko(s);for(let X=0;X<w;X++)Bu(r[X],I,_,e,t[X]);for(let X=0;X<v;X++)Bu(n[X],S,_,e,w+o[X]);let T=A/4,H=z/4,ie=R/4,Z=N/4;for(let X=0;X<w;X++)u.HEAPU32[T++]=I[X],u.HEAPU32[H++]=m[t[X]];for(let X=0;X<v;X++)u.HEAPU32[ie++]=S[X],u.HEAPU32[Z++]=h[o[X]];if(g){let{handle:X,outputPreferredLocations:Ee,outputPreferredLocationsEncoded:Pe}=g;if(m.length!==w)throw new Error(`input count from feeds (${w}) is expected to be always equal to model\'s input count (${m.length}).`);for(let fe=0;fe<w;fe++){let Ce=t[fe];await u._OrtBindInput(X,m[Ce],I[fe])!==0&&ke(`Can\'t bind input[${fe}] for session=${e}.`)}for(let fe=0;fe<v;fe++){let Ce=o[fe];n[fe]?.[3]?u._OrtBindOutput(X,h[Ce],S[fe],0)!==0&&ke(`Can\'t bind pre-allocated output[${fe}] for session=${e}.`):u._OrtBindOutput(X,h[Ce],0,Pe[Ce])!==0&&ke(`Can\'t bind output[${fe}] to ${Ee[fe]} for session=${e}.`)}}let K;g?K=await u._OrtRunWithBinding(a,g.handle,v,R,y):K=await u._OrtRun(a,z,A,w,N,v,R,y),K!==0&&ke("failed to call OrtRun().");let Q=[];for(let X=0;X<v;X++){let Ee=u.HEAPU32[R/4+X];if(Ee===S[X]){Q.push(n[X]);continue}let Pe=u.stackSave(),fe=u.stackAlloc(4*4),Ce=!1,he,ye=0;try{u._OrtGetTensorData(Ee,fe,fe+4,fe+8,fe+12)!==0&&ke(`Can\'t access output tensor data on index ${X}.`);let Me=fe/4,Ge=u.HEAPU32[Me++];ye=u.HEAPU32[Me++];let G=u.HEAPU32[Me++],re=u.HEAPU32[Me++],be=[];for(let Ve=0;Ve<re;Ve++)be.push(u.HEAPU32[G/4+Ve]);u._OrtFree(G);let rt=be.reduce((Ve,Ue)=>Ve*Ue,1);he=et(Ge);let ze=g?.outputPreferredLocations[o[X]];if(he==="string"){if(ze==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let Ve=[],Ue=ye/4;for(let St=0;St<rt;St++){let nt=u.HEAPU32[Ue++],zt=St===rt-1?void 0:u.HEAPU32[Ue]-nt;Ve.push(u.UTF8ToString(nt,zt))}Q.push([he,be,Ve,"cpu"])}else if(ze==="gpu-buffer"&&rt>0){let Ve=u.jsepGetBuffer(ye),Ue=$r(Ge);if(Ue===void 0||!Zo(he))throw new Error(`Unsupported data type: ${he}`);Ce=!0,Q.push([he,be,{gpuBuffer:Ve,download:u.jsepCreateDownloader(Ve,rt*Ue,he),dispose:()=>{u._OrtReleaseTensor(Ee)}},"gpu-buffer"])}else{let Ve=Fr(he),Ue=new Ve(rt);new Uint8Array(Ue.buffer,Ue.byteOffset,Ue.byteLength).set(u.HEAPU8.subarray(ye,ye+Ue.byteLength)),Q.push([he,be,Ue,"cpu"])}}finally{u.stackRestore(Pe),he==="string"&&ye&&u._free(ye),Ce||u._OrtReleaseTensor(Ee)}}return g&&u._OrtClearBoundOutputs(g.handle),Q}finally{u.stackRestore(P),I.forEach(T=>u._OrtReleaseTensor(T)),S.forEach(T=>u._OrtReleaseTensor(T)),_.forEach(T=>u._free(T)),y!==0&&u._OrtReleaseRunOptions(y),C.forEach(T=>u._free(T))}},Wu=e=>{let t=Re(),r=Ar.get(e);if(!r)throw new Error("invalid session id");let o=r[0],n=t._OrtEndProfiling(o);n===0&&ke("Can\'t get an profile file name."),t._OrtFree(n)},Hu=e=>{let t=[];for(let r of e){let o=r[2];!Array.isArray(o)&&"buffer"in o&&t.push(o.buffer)}return t};self.onmessage=e=>{let{type:t,in:r}=e.data;try{switch(t){case"init-wasm":qo(r.wasm).then(()=>{Ru(r).then(()=>{postMessage({type:t})},o=>{postMessage({type:t,err:o})})},o=>{postMessage({type:t,err:o})});break;case"init-ep":{let{epName:o,env:n}=r;Du(n,o).then(()=>{postMessage({type:t})},s=>{postMessage({type:t,err:s})});break}case"copy-from":{let{buffer:o}=r,n=co(o);postMessage({type:t,out:n});break}case"create":{let{model:o,options:n}=r;Mu(o,n).then(s=>{postMessage({type:t,out:s})},s=>{postMessage({type:t,err:s})});break}case"release":Uu(r),postMessage({type:t});break;case"run":{let{sessionId:o,inputIndices:n,inputs:s,outputIndices:u,options:d}=r;Nu(o,n,s,u,new Array(u.length).fill(null),d).then(a=>{a.some(m=>m[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:a},Hu(a))},a=>{postMessage({type:t,err:a})});break}case"configure":try{let o=zu(e.data.in);postMessage({type:"configure",out:o})}catch(o){postMessage({type:"configure",err:o})}break;case"auth":try{let o=Vu(e.data.in);postMessage({type:"auth",out:o})}catch(o){postMessage({type:"auth",err:o})}break;case"end-profiling":Wu(r),postMessage({type:t});break;default:}}catch(o){postMessage({type:t,err:o})}};})();\n/**\n * @license\n * Copyright 2021 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n'})),hx=Nc((()=>{sd(),ux(),yb(),Mv=()=>!!oc.wasm.proxy&&typeof document<"u",Fv=!1,Nv=!1,Uv=!1,Gv=new Map,zv=(e,t)=>{let r=Gv.get(e);r?r.push(t):Gv.set(e,[t])},Vv=()=>{if(Fv||!Nv||Uv||!Lv)throw new Error("worker not ready")},Hv=e=>{switch(e.data.type){case"init-wasm":Fv=!1,e.data.err?(Uv=!0,jv[1](e.data.err)):(Nv=!0,jv[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"run":case"end-profiling":{let t=Gv.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},Wv=typeof document<"u"?document?.currentScript?.src:void 0,Yv=async()=>{if(!Nv){if(Fv)throw new Error("multiple calls to 'initWasm()' detected.");if(Uv)throw new Error("previous call to 'initWasm()' failed.");if(Fv=!0,Mv())return void 0===oc.wasm.wasmPaths&&Wv&&0!==Wv.indexOf("blob:")&&(oc.wasm.wasmPaths=Wv.substr(0,+Wv.lastIndexOf("/")+1)),new Promise(((e,t)=>{Lv?.terminate();let r=URL.createObjectURL(new Blob([lx()],{type:"text/javascript"}));(Lv=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=e=>t(e),Lv.onmessage=Hv,URL.revokeObjectURL(r),jv=[e,t];let n={type:"init-wasm",in:oc};Lv.postMessage(n)}));try{await kd(oc.wasm),await Iv(oc),Nv=!0}catch(e){throw Uv=!0,e}finally{Fv=!1}}},Kv=async e=>{if(Mv())return Vv(),new Promise(((t,r)=>{zv("init-ep",[t,r]);let n={type:"init-ep",in:{epName:e,env:oc}};Lv.postMessage(n)}));await Av(oc,e)},Xv=async e=>Mv()?(Vv(),new Promise(((t,r)=>{zv("copy-from",[t,r]);let n={type:"copy-from",in:{buffer:e}};Lv.postMessage(n,[e.buffer])}))):Cv(e),Zv=async(e,t)=>{if(Mv()){if(t?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Vv(),new Promise(((r,n)=>{zv("create",[r,n]);let i={type:"create",in:{model:e,options:t}},o=[];e instanceof Uint8Array&&o.push(e.buffer),Lv.postMessage(i,o)}))}return Ev(e,t)},qv=async e=>{if(Mv())return Vv(),new Promise(((t,r)=>{zv("release",[t,r]);let n={type:"release",in:e};Lv.postMessage(n)}));Ov(e)},Jv=async e=>Mv()?(Vv(),new Promise(((t,r)=>{zv("configure",[t,r]);let n={type:"configure",in:e};Lv.postMessage(n)}))):Pv(e),Qv=async e=>Mv()?(Vv(),new Promise(((t,r)=>{zv("auth",[t,r]);let n={type:"auth",in:e};Lv.postMessage(n)}))):$v(e),ex=async(e,t,r,n,i,o)=>{if(Mv()){if(r.some((e=>"cpu"!==e[3])))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some((e=>e)))throw new Error("pre-allocated output tensor is not supported for proxy.");return Vv(),new Promise(((i,a)=>{zv("run",[i,a]);let s=r,u={type:"run",in:{sessionId:e,inputIndices:t,inputs:s,outputIndices:n,options:o}};Lv.postMessage(u,Dv(s))}))}return Rv(e,t,r,n,i,o)},tx=async e=>{if(Mv())return Vv(),new Promise(((t,r)=>{zv("end-profiling",[t,r]);let n={type:"end-profiling",in:e};Lv.postMessage(n)}));Bv(e)}})),cx=Nc((()=>{sd(),hx(),bb(),vb(),rx=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},nx=e=>{switch(e[3]){case"cpu":return new vc(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!Wd(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:i}=e[2];return vc.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:i})}default:throw new Error(`invalid data location: ${e[3]}`)}},ix=class{async fetchModelAndCopyToWasmMemory(e){return Xv(await Kd(e))}async loadModel(e,t){let r;Ic(),r="string"==typeof e?typeof $c<"u"&&$c.versions&&$c.versions.node?await Kd(e):await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames]=await Zv(r,t),Ac()}async dispose(){return qv(this.sessionId)}async configure(e){return Jv(e)}async auth(e){return Qv(e)}async run(e,t,r){Ic();let n=[],i=[];Object.entries(e).forEach((e=>{let t=e[0],r=e[1],o=this.inputNames.indexOf(t);if(-1===o)throw new Error(`invalid input '${t}'`);n.push(r),i.push(o)}));let o=[],a=[];Object.entries(t).forEach((e=>{let t=e[0],r=e[1],n=this.outputNames.indexOf(t);if(-1===n)throw new Error(`invalid output '${t}'`);o.push(r),a.push(n)}));let s=n.map(((e,t)=>rx(e,(()=>`input "${this.inputNames[i[t]]}"`)))),u=o.map(((e,t)=>e?rx(e,(()=>`output "${this.outputNames[a[t]]}"`)):null)),l=await ex(this.sessionId,i,s,a,u,r),h={};for(let e=0;e<l.length;e++)h[this.outputNames[a[e]]]=o[e]??nx(l[e]);return Ac(),h}startProfiling(){}endProfiling(){tx(this.sessionId)}}})),dx=Nc((()=>{sd(),hx(),cx(),ox=()=>{if(("number"!=typeof oc.wasm.initTimeout||oc.wasm.initTimeout<0)&&(oc.wasm.initTimeout=0),"boolean"!=typeof oc.wasm.simd&&(oc.wasm.simd=!0),"boolean"!=typeof oc.wasm.proxy&&(oc.wasm.proxy=!1),"boolean"!=typeof oc.wasm.trace&&(oc.wasm.trace=!1),"number"!=typeof oc.wasm.numThreads||!Number.isInteger(oc.wasm.numThreads)||oc.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof $c<"u"&&$c.versions&&$c.versions.node)&&(oc.wasm.numThreads=1);let e=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;oc.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},ax=class{async init(e){ox(),await Yv(),await Kv(e)}async createInferenceSessionHandler(e,t){let r=new ix;return await r.loadModel(e,t),Promise.resolve(r)}}})),fx={};jc(fx,{wasmBackend:()=>px});var px,yx=Nc((()=>{dx(),px=new ax}));sd(),sd(),sd();{let e=(yx(),Gc(fx)).wasmBackend;ec("webgpu",e,5),ec("cpu",e,10),ec("wasm",e,10)}Object.defineProperty(oc.versions,"web",{value:"1.17.0",enumerable:!0});var gx=r(5620),mx=r(4941),wx=r(9899),bx=r.n(wx);function vx(e){return vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vx(e)}function xx(){xx=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==vx(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(vx(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function _x(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Ix(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){_x(o,n,i,a,s,"next",e)}function s(e){_x(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Ax(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sx(n.key),n)}}function Sx(e){var t=function(e,t){if("object"!=vx(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=vx(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vx(t)?t:String(t)}var Tx,Cx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name="tsvb"}var t,r,n,i;return t=e,r=[{key:"get",value:function(){var e=Ix(xx().mark((function e(t,r){var n,i;return xx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cache){e.next=4;break}return e.next=3,caches.open(this._name);case 3:this._cache=e.sent;case 4:return e.next=6,this._cache.match(t);case 6:if(void 0===(n=e.sent)){e.next=9;break}return e.abrupt("return",n);case 9:return e.next=11,fetch(t);case 11:if((n=e.sent).ok){e.next=15;break}return o.ie.notify({message:"".concat(t," don't found"),emitter:o.E7.ML_INFERENCE}),e.abrupt("return",n);case 15:if(!r){e.next=20;break}return i=n.clone(),e.next=19,this._cache.put(t,n);case 19:return e.abrupt("return",i);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"delete",value:(i=Ix(xx().mark((function e(){return xx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.delete(this._name);case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],r&&Ax(t.prototype,r),n&&Ax(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ex(e){return Ex="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ex(e)}function Ox(){Ox=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Ex(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Ex(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function kx(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Px(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){kx(o,n,i,a,s,"next",e)}function s(e){kx(o,n,i,a,s,"throw",e)}a(void 0)}))}}function $x(){return Rx.apply(this,arguments)}function Rx(){return Rx=Px(Ox().mark((function e(){var t,r=arguments;return Ox().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},void 0===Tx){e.next=3;break}return e.abrupt("return",Tx);case 3:return e.next=5,Px(Ox().mark((function e(){var r;return Ox().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.gpu){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.gpu.requestAdapter(t);case 6:return r=e.sent,e.next=9,r.requestDevice();case 9:return e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})))();case 5:return Tx=e.sent,e.abrupt("return",Tx);case 7:case"end":return e.stop()}}),e)}))),Rx.apply(this,arguments)}function Bx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Dx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dx(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dx(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mx(e){return Mx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mx(e)}function Lx(){Lx=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Mx(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Mx(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Fx(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Nx(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Fx(o,n,i,a,s,"next",e)}function s(e){Fx(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Ux(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zx(n.key),n)}}function Gx(e,t,r){return t&&jx(e.prototype,t),r&&jx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zx(e){var t=function(e,t){if("object"!=Mx(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Mx(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Mx(t)?t:String(t)}var Vx={segmentation:4,facedetector:3,colorcorrector:3,lowlighter:3},Hx=function(){function e(){Ux(this,e),this.inference=null,this.ready=!1,this.preset="balanced",this.isGPU=!1}var t,r,n;return Gx(e,[{key:"onAuth",value:function(){}},{key:"setPresetManager",value:function(e){this.presetManager=e}},{key:"preload",value:(n=Nx(Lx().mark((function e(t){return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"cache",value:(r=Nx(Lx().mark((function e(t,r){return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"getType",value:function(){return"custom"}},{key:"setPreset",value:function(e){this.preset=e}},{key:"setBackend",value:function(e){this.inference=e}},{key:"init",value:(t=Nx(Lx().mark((function e(t){var r,n,i,a;return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.inference.setPreset(this.preset);case 3:return e.next=5,this.inference.configure(t);case 5:return n=e.sent,e.next=8,Xx(n,t);case 8:return i=e.sent,e.next=11,this.inference.auth(i.data.key);case 11:if(a=e.sent,"active"==JSON.parse(a).status){e.next=15;break}throw new Error("Authentication failed");case 15:this.ready=!0,o.ie.notify({message:"custom ".concat(this.preset),type:o.cL.INFO,emitter:o.E7.ML_INFERENCE}),e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(0),o.ie.notify({message:null!==(r=e.t0.message)&&void 0!==r?r:e.t0,emitter:o.E7.ML_INFERENCE,cause:e.t0}),e.t0;case 23:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(e){return t.apply(this,arguments)})},{key:"isReady",value:function(){return this.ready}},{key:"run",value:function(e,t,r){var n=this;return new Promise((function(t,r){t(n.inference.run(e))}))}}]),e}(),Wx=function(){function e(){Ux(this,e),this.sessions=new Map,this.sessionPromises=new Map,this.ready=!1,this.preset="balanced",this.segmentationModel="",this.isGPU=!1,this._loader=new Cx}var t,r,n,i,a;return Gx(e,[{key:"onAuth",value:function(e){var t="function"==typeof e;this.authFunction=t?e:void 0}},{key:"setPresetManager",value:function(e){this.presetManager=e}},{key:"getModel",value:function(e){return"segmentation"===e?this.segmentationModel:gx.M.getModelUrl(gx.M.MODELS[e])}},{key:"getType",value:function(){return"onnx"}},{key:"setBackend",value:function(e){}},{key:"setPreset",value:function(e){this.preset=e,this.presetManager?this.segmentationModel=this.presetManager.getModelURL(this.preset):this.segmentationModel=gx.M.getModelUrl(gx.M.PRESETS[gx.M.PRESET])}},{key:"cache",value:(a=Nx(Lx().mark((function e(){var t,r,n,i,o,a=arguments;return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>1&&void 0!==a[1]&&a[1],!(a.length>0&&void 0!==a[0]&&a[0])){e.next=6;break}return e.next=5,this._loader.delete();case 5:return e.abrupt("return");case 6:for(r=0,n=Object.entries(gx.M.MODELS);r<n.length;r++)i=Bx(n[r],2),o=i[0],""!==i[1]&&this._loader.get(this.getModel(o),!0);t||(this.setPreset(gx.M.PRESET),this._loader.get(this.getModel("segmentation"),!0));case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"preload",value:(i=Nx(Lx().mark((function e(){var t,r,n,i,o,a=arguments;return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]&&a[0],r=0,n=Object.entries(gx.M.MODELS);case 2:if(!(r<n.length)){e.next=10;break}if(i=Bx(n[r],2),o=i[0],""===i[1]){e.next=7;break}return e.next=7,this.init(gx.M.CUSTOMER_ID,o);case 7:r++,e.next=2;break;case 10:if(t){e.next=14;break}return this.setPreset(gx.M.PRESET),e.next=14,this.init(gx.M.CUSTOMER_ID,"segmentation");case 14:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"init",value:(n=Nx(Lx().mark((function e(t,r){var n,i,a,s,u,l,h,c,d,f=this;return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],this.sessionPromises.forEach((function(e,t,r){"pending"==e.state&&i.push(e.promise)})),e.next=4,Promise.all(i);case 4:if(a=this.getModel(r),!this.sessionPromises.has(a)){e.next=7;break}return e.abrupt("return",null===(n=this.sessionPromises.get(a))||void 0===n?void 0:n.promise);case 7:return s=new nh,this.sessionPromises.set(a,s),e.next=11,this._loader.get(a);case 11:return u=e.sent,e.next=14,u.arrayBuffer();case 14:if(l=e.sent,Pc.CU,h="wasm","segmentation"!=r){e.next=23;break}if("webgpu"!=gx.M.PROVIDER&&"auto"!=gx.M.PROVIDER){e.next=23;break}return e.next=21,$x();case 21:e.sent?h="webgpu":o.ie.notify({message:"WebGPU is not supported",emitter:o.E7.ML_INFERENCE});case 23:return"webgpu"==h?(c=this.createGPUSession(l),this.isGPU=!0):c=this.createCPUSession(l),e.abrupt("return",c.then((function(e){return(d=e).configure(t)})).then((function(e){if("extension"!==gx.M.APP_ENV)return Xx(e,gx.M.CUSTOMER_ID);if("function"!=typeof f.authFunction)throw"Can't find auth function";var t=gx.M.API_URL+gx.M.CUSTOMER_ID,r=mx.i.getInstance().getUID(gx.M.CUSTOMER_ID);return f.authFunction(t,{user_id:r,payload:e})})).then((function(e){var t;return d.auth(null!==(t=e.key)&&void 0!==t?t:e.data.key)})).then((function(e){if("active"!==JSON.parse(e).status)throw new Error("Authentication failed");f.ready=!0,f.sessions.set(a,d),s.resolve(),o.ie.notify({message:"init ".concat(r),type:o.cL.INFO,emitter:o.E7.ML_INFERENCE})})).catch((function(e){var t;throw o.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:o.E7.ML_INFERENCE,cause:e}),e})));case 25:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"createCPUSession",value:(r=Nx(Lx().mark((function e(t){var r;return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={executionProviders:["wasm"],enableCpuMemArena:!0,enableMemPattern:!0,executionMode:"parallel",graphOptimizationLevel:"all",extra:{session:{set_denormal_as_zero:"1",disable_prepacking:"1",dynamic_block_base:"4"},optimization:{enable_gelu_approximation:"1"}}},Pc._K.wasm.numThreads=1,gx.M.PROXY&&(Pc._K.wasm.proxy=!0),Object.keys(gx.M.WASM_PATHS).length&&(Pc._K.wasm.wasmPaths=gx.M.WASM_PATHS),e.abrupt("return",Pc.CU.create(t,r));case 5:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"createGPUSession",value:(t=Nx(Lx().mark((function e(t){var r,n,i,o,a,s,u,l;return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={executionProviders:["webgpu"]},oc.wasm.numThreads=1,gx.M.PROXY&&(oc.wasm.proxy=!0),Object.keys(gx.M.WASM_PATHS).length){for(n=[],i=0,o=Object.entries(gx.M.WASM_PATHS);i<o.length;i++)a=Bx(o[i],2),s=a[0],u=a[1],n[s]=u.replace(".wasm",".jsep.wasm");l=Object.assign({},n),oc.wasm.wasmPaths=l}return e.abrupt("return",Tc.create(t,r));case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"isReady",value:function(){return this.ready}},{key:"run",value:function(e,t,r,n){var i,a=new Pc.w3("float32",e,[1,Vx[n],r,t]),s=this.getModel(n);return this.sessions.has(s)?null===(i=this.sessions.get(s))||void 0===i?void 0:i.run({input:a}):(o.ie.notify({message:"ML inference for ".concat(n," model is not initialized"),emitter:o.E7.ML_INFERENCE}),null)}}]),e}(),Yx={onnx:Wx,custom:Hx},Kx=function(){function e(){Ux(this,e)}return Gx(e,null,[{key:"getInference",value:function(e){return new Yx[e]}}]),e}();function Xx(e,t){return Zx.apply(this,arguments)}function Zx(){return(Zx=Nx(Lx().mark((function e(t,r){return Lx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bx().post(gx.M.API_URL+r,{user_id:mx.i.getInstance().getUID(r),payload:t},{headers:{"Tsvb-Version":gx.M.VERSION}}).catch((function(e){throw new Error(e.response.data.message)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qx(e){return qx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qx(e)}function Jx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qx(n.key),n)}}function Qx(e){var t=function(e,t){if("object"!=qx(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=qx(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qx(t)?t:String(t)}var e_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=r,this.container=new yo,this.background=new wo(En.WHITE),this.background.tint=0,t.background&&(this.background.tint=t.background);var n={fontFamily:"Arial",fontSize:t.size?t.size:24,fill:t.color?t.color:16777215,align:"left"};this.text=new Lu("",n);var i=t.padding?t.padding:7;this.text.x=i,this.text.y=i,this.container.addChild(this.background),this.container.addChild(this.text),this.container.visible=!1,this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,r,n;return t=e,(r=[{key:"onOptionsUpdate",value:function(){this.text.style.fontSize=Math.round(.02*this.sdkOptions.width)}},{key:"updateText",value:function(e){this.text.text=e;var t=this.text.getLocalBounds();this.background.width=2*this.text.x+t.width,this.background.height=2*this.text.y+t.height}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}])&&Jx(t.prototype,r),n&&Jx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function t_(e){return t_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t_(e)}function r_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n_(n.key),n)}}function n_(e){var t=function(e,t){if("object"!=t_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=t_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==t_(t)?t:String(t)}function i_(e,t,r){return t=a_(t),function(e,t){if(t&&("object"===t_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,o_()?Reflect.construct(t,r||[],a_(e).constructor):t.apply(e,r))}function o_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(o_=function(){return!!e})()}function a_(e){return a_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a_(e)}function s_(e,t){return s_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s_(e,t)}var u_=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=i_(this,t,["in vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nout vec2 vVertexPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition; // * (outputFrame.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n}\n","precision mediump float;\nuniform sampler2D uSampler;\nin vec2 vTextureCoord;\nuniform vec4 filterArea;\nlayout(location = 0) out vec4 outColor;\n\nuniform sampler2D u_Texture;\nuniform float u_Offset;\nuniform vec2 u_ImgSize;\n//Y =  0.299R + 0.587G + 0.114B\n//U = -0.147R - 0.289G + 0.436B\n//V =  0.615R - 0.515G - 0.100B\nconst vec3 COEF_Y = vec3(0.2126, 0.7152, 0.0722);\nconst vec3 COEF_U = vec3(-0.1146, -0.3854, 0.5);\nconst vec3 COEF_V = vec3(0.5, -0.4542, -0.0458);\nconst float U_DIVIDE_LINE = 2.0 / 3.0;\nconst float V_DIVIDE_LINE = 5.0 / 6.0;\n\nvoid main() {\n  vec2 texelOffset = vec2(u_Offset, 0.0);\n  //outColor = vec4(vTextureCoord.y, vTextureCoord.y, vTextureCoord.y, vTextureCoord.y);\n\n  if (vTextureCoord.y <= U_DIVIDE_LINE) {\n    vec2 texCoord = vec2(vTextureCoord.x, vTextureCoord.y * 3.0 / 2.0);\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 3.0);\n\n    float y0 = dot(color0.rgb, COEF_Y);\n    float y1 = dot(color1.rgb, COEF_Y);\n    float y2 = dot(color2.rgb, COEF_Y);\n    float y3 = dot(color3.rgb, COEF_Y);\n    outColor = vec4(y0, y1, y2, y3);\n  } else if (vTextureCoord.y <= V_DIVIDE_LINE) {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - U_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - U_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float u0 = dot(color0.rgb, COEF_U) + 0.5;\n    float u1 = dot(color1.rgb, COEF_U) + 0.5;\n    float u2 = dot(color2.rgb, COEF_U) + 0.5;\n    float u3 = dot(color3.rgb, COEF_U) + 0.5;\n    outColor = vec4(u0, u1, u2, u3);\n  } else {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - V_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - V_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float v0 = dot(color0.rgb, COEF_V) + 0.5;\n    float v1 = dot(color1.rgb, COEF_V) + 0.5;\n    float v2 = dot(color2.rgb, COEF_V) + 0.5;\n    float v3 = dot(color3.rgb, COEF_V) + 0.5;\n    outColor = vec4(v0, v1, v2, v3);\n  }\n}\n",e.uniforms])).program.fragmentSrc.includes("#version 300 es")||(r.program.fragmentSrc="#version 300 es \n"+r.program.fragmentSrc),r.program.vertexSrc.includes("#version 300 es")||(r.program.vertexSrc="#version 300 es \n"+r.program.vertexSrc),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s_(e,t)}(t,e),r=t,n&&r_(r.prototype,n),i&&r_(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(gn);function l_(e){return l_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l_(e)}function h_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c_(n.key),n)}}function c_(e){var t=function(e,t){if("object"!=l_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=l_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l_(t)?t:String(t)}var d_=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=r;var n=this.sdkOptions.width,i=this.sdkOptions.height;this.renderer=t,this.widthYUV=n/4,this.heightYUV=3*i/2,this.textureYUV=On.create({width:this.widthYUV,height:this.heightYUV}),this.textureRBG=On.create({width:n,height:i}),this.spriteYUV=new wo(this.textureYUV),this.filterYUV=new u_({uniforms:{u_Offset:1/n,u_ImgSize:[n,i],u_Texture:this.textureRBG}}),this.spriteYUV.filters=[this.filterYUV],this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,r,n;return t=e,r=[{key:"onOptionsUpdate",value:function(){var e=this.sdkOptions.width,t=this.sdkOptions.height;this.widthYUV=e/4,this.heightYUV=3*t/2,this.textureYUV.resize(this.widthYUV,this.heightYUV),this.textureRBG.resize(e,t),this.filterYUV.uniforms.u_Offset=1/e,this.filterYUV.uniforms.u_ImgSize=[e,t]}},{key:"getVideoFrameArray",value:function(){var e=new Uint8Array(4*this.widthYUV*this.heightYUV),t=this.renderer.generateTexture(this.spriteYUV);this.renderer.renderTexture.bind(t);var r=t.framebuffer.glFramebuffers[this.renderer.CONTEXT_UID];r.blitFramebuffer&&this.renderer.framebuffer.bind(r.blitFramebuffer);var n=this.renderer.gl;return n.readPixels(0,0,this.widthYUV,this.heightYUV,n.RGBA,n.UNSIGNED_BYTE,e),t.destroy(!0),e}},{key:"getVideoFrameSettings",value:function(){return{format:"I420",codedWidth:this.sdkOptions.width,codedHeight:this.sdkOptions.height}}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],r&&h_(t.prototype,r),n&&h_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f_(e){return f_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f_(e)}function p_(){p_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==f_(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(f_(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function y_(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function g_(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){y_(o,n,i,a,s,"next",e)}function s(e){y_(o,n,i,a,s,"throw",e)}a(void 0)}))}}function m_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w_(n.key),n)}}function w_(e){var t=function(e,t){if("object"!=f_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=f_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f_(t)?t:String(t)}var b_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,i,o;return t=e,r=[{key:"clientWaitAsync",value:function(e,t,r,n){return new Promise((function(i,o){!function a(){var s=e.clientWaitSync(t,r,0);s!==e.WAIT_FAILED?s!==e.TIMEOUT_EXPIRED?i(!0):Dl(a,n):o()}()}))}},{key:"getBufferSubDataAsync",value:(o=g_(p_().mark((function e(t,r,n,i,o,a,s){var u;return p_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0),t.flush(),e.next=4,this.clientWaitAsync(t,u,0,2);case 4:t.deleteSync(u),t.bindBuffer(r,n),t.getBufferSubData(r,i,o,a,s),t.bindBuffer(r,null);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i,a,s){return o.apply(this,arguments)})},{key:"readPixelsAsync",value:(i=g_(p_().mark((function e(t,r,n,i,o,a,s,u){var l;return p_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.createBuffer(),t.bindBuffer(t.PIXEL_PACK_BUFFER,l),t.bufferData(t.PIXEL_PACK_BUFFER,u.byteLength,t.STREAM_READ),t.readPixels(r,n,i,o,a,s,0),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),e.next=7,this.getBufferSubDataAsync(t,t.PIXEL_PACK_BUFFER,l,0,u);case 7:return t.deleteBuffer(l),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,o,a,s,u){return i.apply(this,arguments)})}],r&&m_(t.prototype,r),n&&m_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v_(e){return v_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v_(e)}function x_(){x_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==v_(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(v_(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function __(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function I_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A_(n.key),n)}}function A_(e){var t=function(e,t){if("object"!=v_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=v_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v_(t)?t:String(t)}var S_=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.color=65280,this.frameFormat="RGBX",r&&(this.frameFormat=r),this.sdkOptions=t,this.PIXI=i,this.renderer=new Yo({width:this.sdkOptions.width,height:this.sdkOptions.height,antialias:!0}),this.filter_manager=new Mn(this.renderer.renderer),this.timinngs={stats:new O,sprite:new e_({size:Math.round(.02*this.sdkOptions.width),padding:5},this.sdkOptions)},this.effectsContainer=new yo,this.renderer.stage.addChild(this.effectsContainer),this.overlayContainer=new yo,this.renderer.stage.addChild(this.overlayContainer),this.stopTickers(),this.GLHelper=new b_,"I420"===this.frameFormat&&(this.converterYUV=new d_(this.renderer.renderer,this.sdkOptions)),this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,r,n,a;return t=e,r=[{key:"onOptionsUpdate",value:function(){this.renderer.renderer.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"stopTickers",value:function(){this.renderer.ticker.stop(),Fi.system.stop()}},{key:"startTickers",value:function(){this.renderer.ticker.start(),Fi.system.start()}},{key:"updateVideoFrame",value:function(e){this.video_frame||(this.video_frame=this.createFrom(e)),this.video_frame.texture.destroy(!0),this.video_frame.texture=En.from(e)}},{key:"addStatistics",value:function(){this.addToStage(this.timinngs.sprite.container)}},{key:"removeStatistics",value:function(){this.removeFromStage(this.timinngs.sprite.container)}},{key:"updateStatistics",value:function(e,t){this.timinngs.stats.updateStats(e,t)}},{key:"hideStatistics",value:function(){this.timinngs.sprite.container.visible=!1}},{key:"drawStatistics",value:function(){this.timinngs.sprite.updateText(this.timinngs.stats.getText()),this.timinngs.sprite.container.visible=!0}},{key:"destroy",value:function(){this.renderer.renderer&&(this.sdkOptions.off("update",this.onOptionsUpdate,this),this.converterYUV&&this.converterYUV.destroy(),this.timinngs.sprite&&this.timinngs.sprite.destroy(),this.renderer.destroy(!0,{children:!0,texture:!0,baseTexture:!0}))}},{key:"renderTo",value:function(e,t){var r;try{this.renderer.renderer.render(e,{renderTexture:t})}catch(e){o.ie.notify({message:null!==(r=e.message)&&void 0!==r?r:e,emitter:o.E7.RENDERER,cause:e})}}},{key:"createCanvas",value:function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}},{key:"createTextureFromBuffer",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return En.fromBuffer(e,t,r,n)}},{key:"createRenderTexture",value:function(e,t){return On.create({width:e,height:t})}},{key:"pixels",value:function(e){return this.renderer.renderer.extract.pixels(e)}},{key:"pixelsAsync",value:(a=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){__(o,n,i,a,s,"next",e)}function s(e){__(o,n,i,a,s,"throw",e)}a(void 0)}))}}(x_().mark((function e(t){var r,n,i;return x_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.renderer.renderer,n=new Uint8Array(4*t._frame.width*t._frame.height),r.renderTexture.bind(t),(i=t.framebuffer.glFramebuffers[r.CONTEXT_UID]).blitFramebuffer&&r.framebuffer.bind(i.blitFramebuffer),e.next=8,this.GLHelper.readPixelsAsync(r.gl,0,0,t._frame.width,t._frame.height,r.gl.RGBA,r.gl.UNSIGNED_BYTE,n);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"calculateSpriteMatrix",value:function(e){var t=new Pr;return this.filter_manager.calculateSpriteMatrix(t,e)}},{key:"getFilterManager",value:function(){return this.filter_manager}},{key:"setTintColor",value:function(e){this.color=e}},{key:"getTintColor",value:function(){return this.color}},{key:"createTexture",value:function(e){return e instanceof En?e:En.from(e)}},{key:"createFromTexture",value:function(e){return new wo(e)}},{key:"createFrom",value:function(e){return new wo(En.from(e))}},{key:"createFromURL",value:function(e){var t;return"string"==typeof e&&"color"===e?((t=new wo(En.WHITE)).tint=this.getTintColor(),t.width=this.sdkOptions.width,t.height=this.sdkOptions.height,t):t=wo.from(e)}},{key:"createContainer",value:function(){return new yo}},{key:"addToStage",value:function(e){var t;null===(t=this.renderer.stage)||void 0===t||t.addChild(e)}},{key:"addToEffects",value:function(e){var t;this.renderer.renderer&&(null===(t=this.effectsContainer)||void 0===t||t.addChild(e))}},{key:"addToOverlay",value:function(e){var t;null===(t=this.overlayContainer)||void 0===t||t.addChild(e)}},{key:"addToStageAt",value:function(e,t){var r;null===(r=this.renderer.stage)||void 0===r||r.addChildAt(e,t)}},{key:"addToEffectsAt",value:function(e,t){var r;null===(r=this.effectsContainer)||void 0===r||r.addChildAt(e,t)}},{key:"addToOverlayAt",value:function(e,t){var r;null===(r=this.overlayContainer)||void 0===r||r.addChildAt(e,t)}},{key:"removeFromStage",value:function(e){var t;null===(t=this.renderer.stage)||void 0===t||t.removeChild(e)}},{key:"removeFromEffects",value:function(e){var t;null===(t=this.effectsContainer)||void 0===t||t.removeChild(e)}},{key:"removeFromOverlay",value:function(e){var t;null===(t=this.overlayContainer)||void 0===t||t.removeChild(e)}},{key:"useAsMask",value:function(e){this.renderer.stage.mask=e}},{key:"setCanvas",value:function(e){this.canvas=e}},{key:"render",value:function(){var e;try{this.renderer.render(),this.converterYUV&&(this.renderTo(this.renderer.stage,this.converterYUV.textureRBG),this.renderer.renderer.render(this.renderer.stage,{renderTexture:this.converterYUV.textureYUV}))}catch(t){o.ie.notify({message:null!==(e=t.message)&&void 0!==e?e:t,emitter:o.E7.RENDERER,cause:t})}}},{key:"getVideoFrameData",value:function(){return this.converterYUV?this.converterYUV.getVideoFrameArray():this.renderer.renderer.view}},{key:"getVideoFrameSettings",value:function(){return this.converterYUV?this.converterYUV.getVideoFrameSettings():{displayHeight:this.sdkOptions.height,displayWidth:this.sdkOptions.width}}}],r&&I_(t.prototype,r),n&&I_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function T_(e){return T_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T_(e)}function C_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||O_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E_(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=O_(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function O_(e,t){if(e){if("string"==typeof e)return k_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k_(e,t):void 0}}function k_(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P_(){P_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==T_(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(T_(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function $_(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function R_(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){$_(o,n,i,a,s,"next",e)}function s(e){$_(o,n,i,a,s,"throw",e)}a(void 0)}))}}function B_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M_(n.key),n)}}function D_(e,t,r){return t&&B_(e.prototype,t),r&&B_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M_(e){var t=function(e,t){if("object"!=T_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=T_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T_(t)?t:String(t)}function L_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var F_=D_((function e(){L_(this,e),this.filters=[],this.transform=null})),N_=function(){function e(t){L_(this,e),this.isEnabled=!1,this.sdkOptions=t}var t;return D_(e,[{key:"useResources",value:function(e){this.resources=e}},{key:"prepare",value:function(){}},{key:"process",value:(t=R_(P_().mark((function e(){return P_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"nextFrame",value:function(e){}},{key:"clearBuffers",value:function(){}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1}},{key:"isDisabled",get:function(){return!this.isEnabled}},{key:"destroy",value:function(){}}]),e}(),U_=function(){function e(t,r){L_(this,e),this.effects=[],this.isPaused=!1,this.isSkipPipeline=!1,this.components={},this.hasFrames=!1,this.textures=[],this.resources=new F_,this.resources.renderer=t,this.components=null!=r?r:{},this.resources.texture=new Vl}var t;return D_(e,[{key:"destroy",value:function(){this.removeComponents(),this.resources.renderer.destroy(),this.effects.forEach((function(e){e.destroy()}))}},{key:"addEffect",value:function(e){e.useResources(this.resources),e.prepare(),this.effects.push(e)}},{key:"clearBuffers",value:function(){this.textures=[],this.effects.forEach((function(e,t){e.clearBuffers()}))}},{key:"pause",value:function(){this.isPaused=!0}},{key:"unpause",value:function(){this.isPaused=!1}},{key:"enablePipelineSkipping",value:function(){this.isSkipPipeline=!0}},{key:"disablePipelineSkipping",value:function(){this.isSkipPipeline=!1}},{key:"nextFrame",value:function(e){if(this.isPaused||this.isSkipPipeline)return e.texture.destroy(!0),void(this.textures=[]);if(this.effects.forEach((function(t,r){t.nextFrame(e)})),this.textures.length>1){var t=this.textures.shift();null==t||t.destroy()}this.textures.push(e)}},{key:"updateFrame",value:function(){if(this.textures.length){var e=this.textures.shift();e&&this.resources.texture.update(e.texture)}}},{key:"addComponents",value:function(){var e=this;this.components._getSortedComponentsArr.forEach((function(t){return e.resources.renderer.addToStage(t.container)}))}},{key:"removeComponents",value:function(){var e=this;Object.values(this.components).forEach((function(t){return e.resources.renderer.removeFromStage(t.container)}))}},{key:"process",value:(t=R_(P_().mark((function e(){var t,r,n,i,o,a;return P_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPaused){e.next=2;break}return e.abrupt("return");case 2:if(!this.isSkipPipeline){e.next=7;break}return this.addComponents(),this.resources.renderer.render(),this.removeComponents(),e.abrupt("return");case 7:this.updateFrame(),t=E_(this.effects.entries()),e.prev=9,t.s();case 11:if((r=t.n()).done){e.next=20;break}return n=C_(r.value,2),i=n[0],o=n[1],(a=i+1===this.effects.length)&&this.addComponents(),e.next=17,o.process();case 17:a&&this.removeComponents();case 18:e.next=11;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),t.e(e.t0);case 25:return e.prev=25,t.f(),e.finish(25);case 28:this.hasFrames=!0;case 29:case"end":return e.stop()}}),e,this,[[9,22,25,28]])}))),function(){return t.apply(this,arguments)})}]),e}();function j_(e){return j_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j_(e)}function G_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z_(n.key),n)}}function z_(e){var t=function(e,t){if("object"!=j_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=j_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==j_(t)?t:String(t)}function V_(e,t,r){return t=W_(t),function(e,t){if(t&&("object"===j_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,H_()?Reflect.construct(t,r||[],W_(e).constructor):t.apply(e,r))}function H_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(H_=function(){return!!e})()}function W_(e){return W_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W_(e)}function Y_(e,t){return Y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y_(e,t)}var K_=function(e){function t(e){var r,n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=V_(this,t,[void 0,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\n\nuniform float uFilterPart;\nuniform float uFilterPower;\nuniform float uLutSize;\nuniform float uNormalizator;\nuniform float uHalfPx;\nuniform int uEdges;\nuniform int uEnabled;\n\nvec4 newColor(float rectNum, vec2 coord) {\n  int num = int(rectNum);\n  int red = num - uEdges * (num / uEdges);\n  int green = num / uEdges;\n\n  vec2 bCoord = vec2(float(red) / float(uEdges), float(green) / float(uEdges));\n\n  vec2 lutTextureCoord = vec2(coord.r + bCoord.r, coord.g + bCoord.g);\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nfloat normalizeColor(float color) {\n  return color * uNormalizator + uHalfPx;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  //. Check enabled\n  if (uEnabled < 1) {\n    gl_FragColor = color;\n    return;\n  }\n\n  //. Check filter part\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(normalizeColor(color.r), normalizeColor(color.g));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * (uLutSize - 1.0);\n\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec4 colorInterpolated = mix(colorLut1, colorLut2, rectNumReal - rectNumMin);\n  vec3 resultColor = mix(color.rgb, colorLut1.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n\n",{uFilterPart:1,uFilterPower:1,uEnabled:0,uLutSize:null!==(n=null==e?void 0:e.lutSize)&&void 0!==n?n:36,uEdges:null!==(i=null==e?void 0:e.edges)&&void 0!==i?i:6,uLUT:null!==(o=null==e?void 0:e.texture)&&void 0!==o?o:En.WHITE}])).calcNormatizator(),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y_(e,t)}(t,e),r=t,n=[{key:"setLUT",value:function(e){var t;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=this.uniforms.uLUT)||void 0===t||t.destroy(!0)),(null==e?void 0:e.edges)&&(this.uniforms.uEdges=e.edges),(null==e?void 0:e.lutSize)&&(this.uniforms.uLutSize=e.lutSize),this.calcNormatizator(),(null==e?void 0:e.texture)?(this.uniforms.uLUT=e.texture,this.uniforms.uEnabled=1):this.uniforms.uEnabled=0}},{key:"setFilterPart",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e}},{key:"setFilterPower",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e}},{key:"calcNormatizator",value:function(){var e=this.uniforms,t=e.uLutSize,r=e.uEdges;this.uniforms.uNormalizator=(t-1)/(t*r),this.uniforms.uHalfPx=.5/(t*r)}}],n&&G_(r.prototype,n),i&&G_(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);function X_(e){return X_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X_(e)}function Z_(e){return function(e){if(Array.isArray(e))return q_(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q_(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q_(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J_(){J_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==X_(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(X_(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Q_(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function eI(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Q_(o,n,i,a,s,"next",e)}function s(e){Q_(o,n,i,a,s,"throw",e)}a(void 0)}))}}function tI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rI(n.key),n)}}function rI(e){var t=function(e,t){if("object"!=X_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=X_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==X_(t)?t:String(t)}var nI=["cube"],iI=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,i;return t=e,r=[{key:"parse",value:function(e){var t,r=this;return new Promise(function(){var n=eI(J_().mark((function n(i,o){var a,s,u,l,h;return J_().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e instanceof File)){n.next=14;break}if(r.checkFileExtention(e.name)){n.next=4;break}return o('[ Lut Parser ] - Invalid file extention (file "'.concat(e.name,'", available extentions: ').concat(nI.join(", "),")")),n.abrupt("return");case 4:return n.prev=4,n.next=7,r.readFile(e);case 7:t=n.sent,n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(4),o(n.t0),n.abrupt("return");case 14:if("string"!=typeof e){n.next=25;break}return n.prev=15,n.next=18,fetch(e).then((function(e){return e.text()}));case 18:t=n.sent,n.next=25;break;case 21:return n.prev=21,n.t1=n.catch(15),o(n.t1),n.abrupt("return");case 25:if("3D"===(a=r.parseCUBE(t)).type.toUpperCase()){n.next=29;break}return o("[ Lut Parser ] - invalid lut type(".concat(a.type,"). Support 3DLUT only")),n.abrupt("return");case 29:return s=Math.ceil(Math.sqrt(a.size)),u=r.prepareTextureArray(a,s),l=a.size*s,h=En.fromBuffer(u,l,l,{scaleMode:1,mipmap:H.OFF}),i({texture:h,lutSize:a.size,textureSize:l,edges:s}),n.abrupt("return");case 35:case"end":return n.stop()}}),n,null,[[4,10],[15,21]])})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"parseCUBE",value:function(e){for(var t,r={title:"",type:"",size:0,domain:[[0,0,0],[1,1,1]],data:[]},n=e.split("\n"),i=0;i<n.length;i++){var o=n[i].trim();if("#"!==o[0]&&""!==o){var a=o.split(/\s+/);switch(a[0]){case"TITLE":r.title=o.slice(7,-1);break;case"DOMAIN_MIN":r.domain[0]=a.slice(1).map(Number);break;case"DOMAIN_MAX":r.domain[1]=a.slice(1).map(Number);break;case"LUT_1D_SIZE":r.type="1D",r.size=Number(a[1]);break;case"LUT_3D_SIZE":r.type="3D",r.size=Number(a[1]);break;default:(t=r.data).push.apply(t,Z_(a.map(Number)))}}}return r}},{key:"prepareTextureArray",value:function(e,t){var r=e.data,n=e.size,i=n*n*n,o=new Uint8ClampedArray(4*Math.pow(n*t,2)),a={value:0,isNil:function(){return 0===a.value},setDefault:function(){return a.value=n*n},dec:function(){return a.value--}};a.setDefault();for(var s=0,u=0,l=function(e,r){return 4*(n*(t*u+s)+r%n)+e},h=0;h<3*i;h+=3)o[l(0,h/3)]=255*r[h+0],o[l(1,h/3)]=255*r[h+1],o[l(2,h/3)]=255*r[h+2],o[l(3,h/3)]=255,a.dec(),h/3%n==n-2&&u++,a.isNil()&&(a.setDefault(),++s>=t?s=0:u-=n);return o}},{key:"checkFileExtention",value:function(e){var t=e.split(".").pop();return!!t&&nI.includes(t.toLowerCase())}},{key:"readFile",value:(i=eI(J_().mark((function e(t){return J_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new FileReader;n.readAsText(t),n.onload=function(){e(n.result)},n.onerror=function(){r("[ Lut Parser ] - filereader: ".concat(n.error))}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})}],r&&tI(t.prototype,r),n&&tI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function oI(e){return oI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oI(e)}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sI(n.key),n)}}function sI(e){var t=function(e,t){if("object"!=oI(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=oI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==oI(t)?t:String(t)}var uI=function(){function e(t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=null!==(r=t.size)&&void 0!==r?r:1,this.store=[]}var t,r,n;return t=e,r=[{key:"add",value:function(e){var t=this,r=this.store.find((function(t){return t.id===e})),n=Date.now();if(r)return r.time=n,{hasItem:!0};var i={id:e,time:n};if(this.store.push(i),this.store.length<=this.size)return{};var o=this.store.reduce((function(e,r,n){return t.store[e].time<r.time?e:n}),0);return{removedID:this.store.splice(o,1)[0].id}}},{key:"setSize",value:function(e){var t;if(this.size=e,!(this.store.length<=e)){this.store=this.store.sort((function(e,t){return t.time-e.time}));for(var r=[];this.store.length>this.size;){var n=null===(t=this.store.pop())||void 0===t?void 0:t.id;void 0!==n&&r.push(n)}return r}}},{key:"checkItemByID",value:function(e){return!!~this.store.findIndex((function(t){return t.id===e}))}}],r&&aI(t.prototype,r),n&&aI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function lI(e){return lI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lI(e)}function hI(){hI=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==lI(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(lI(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function cI(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function dI(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){cI(o,n,i,a,s,"next",e)}function s(e){cI(o,n,i,a,s,"throw",e)}a(void 0)}))}}function fI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pI(n.key),n)}}function pI(e){var t=function(e,t){if("object"!=lI(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=lI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==lI(t)?t:String(t)}function yI(e,t,r){return t=mI(t),function(e,t){if(t&&("object"===lI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,gI()?Reflect.construct(t,r||[],mI(e).constructor):t.apply(e,r))}function gI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gI=function(){return!!e})()}function mI(e){return mI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mI(e)}function wI(e,t){return wI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wI(e,t)}var bI=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=yI(this,t,[e])).parser=new iI,r.lutStore={},r.config={lut:"none",part:1,power:1,capacity:1},r.activityIndexator=new uI({size:r.config.capacity}),r}var r,n,i,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wI(e,t)}(t,e),r=t,n=[{key:"prepare",value:function(){var e=this.resources.texture;this.original=new Ql(e,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.filter=new K_,this.original.frame.filters=[this.filter],this.setConfig(this.config),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"process",value:(a=dI(hI().mark((function e(){return hI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled&&"none"!==this.config.lut){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setConfig",value:function(e){this.setFilterPart(e.part),this.setFilterPower(e.power),this.setFilterLut(e.lut,e.promise),this.setCapacity(e.capacity)}},{key:"setFilterPart",value:function(e){void 0!==e&&(this.config.part=e,this.filter.setFilterPart(e))}},{key:"setFilterPower",value:function(e){void 0!==e&&(this.config.power=e,this.filter.setFilterPower(e))}},{key:"setFilterLut",value:(o=dI(hI().mark((function e(t,r){var n,i,o,a,s;return hI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if("none"!==t){e.next=5;break}return this.config.lut="none",e.abrupt("return");case 5:if(n=this.countID(t),this.config.lut=t,this.selectedID=n,i=this.activityIndexator.add(n),o=i.hasItem,a=i.removedID,o){e.next=19;break}return e.next=12,this.parser.parse(t);case 12:if(s=e.sent,this.activityIndexator.checkItemByID(n)){e.next=18;break}return s.texture.destroy(),this.removeLutByID(a),this.resolver(n,null==r?void 0:r.resolve()),e.abrupt("return");case 18:this.lutStore[n]=s;case 19:this.filter.setLUT(this.lutStore[this.selectedID],!1),this.removeLutByID(a),this.resolver(n,null==r?void 0:r.resolve());case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"setCapacity",value:function(e){var t=this;if(void 0!==e){this.config.capacity=e;var r=this.activityIndexator.setSize(e);(null==r?void 0:r.length)&&r.forEach((function(e){return t.removeLutByID(e)}))}}},{key:"removeLutByID",value:function(e){var t,r;void 0!==e&&(null===(r=null===(t=this.lutStore[e])||void 0===t?void 0:t.texture)||void 0===r||r.destroy(),delete this.lutStore[e])}},{key:"countID",value:function(e){return e instanceof File?e.name:e}},{key:"onSuccess",value:function(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0}},{key:"resolver",value:function(e,t){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction(e),"function"==typeof t&&t()}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&fI(r.prototype,n),i&&fI(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(N_);function vI(e){return vI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vI(e)}function xI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_I(n.key),n)}}function _I(e){var t=function(e,t){if("object"!=vI(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=vI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vI(t)?t:String(t)}function II(e,t,r){return t=SI(t),function(e,t){if(t&&("object"===vI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,AI()?Reflect.construct(t,r||[],SI(e).constructor):t.apply(e,r))}function AI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(AI=function(){return!!e})()}function SI(e){return SI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},SI(e)}function TI(e,t){return TI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},TI(e,t)}var CI=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),II(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\n#define SIGMA (10.0)\n#define BSIGMA (0.1)\n#define MSIZE (15)\n\nfloat kernel[MSIZE];\n\nuniform float uBeautyficationLevel;\nuniform int uWidth;\nuniform int uHeight;\n\nfloat normpdf(float x, float sigma) {\n  return 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n}\n\nfloat normpdf3(vec3 v, float sigma) {\n  return 0.39894 * exp(-0.5 * dot(v, v) / (sigma * sigma)) / sigma;\n}\n\nvec4 overlay(vec4 a, vec4 b) {\n  vec4 x = vec4(2.0) * a * b;\n  vec4 y = vec4(1.0) - vec4(2.0) * (vec4(1.0) - a) * (vec4(1.0) - b);\n  vec4 result;\n  result.r = mix(x.r, y.r, float(a.r > 0.5));\n  result.g = mix(x.g, y.g, float(a.g > 0.5));\n  result.b = mix(x.b, y.b, float(a.b > 0.5));\n  result.a = mix(x.a, y.a, float(a.a > 0.5));\n  return result;\n}\n\nvec3 rgb2xyz(vec3 c) {\n  vec3 tmp;\n  tmp.x = c.r > 0.04045 ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n  tmp.y = c.g > 0.04045 ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n    tmp.z = c.b > 0.04045 ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n  return 100.0 *\n  tmp *\n  mat3(0.4124, 0.3576, 0.1805, 0.2126, 0.7152, 0.0722, 0.0193, 0.1192, 0.9505);\n}\n\nvec3 xyz2lab(vec3 c) {\n  vec3 n = c / vec3(95.047, 100, 108.883);\n  vec3 v;\n  v.x = n.x > 0.008856 ? pow(n.x, 1.0 / 3.0) : 7.787 * n.x + 16.0 / 116.0;\n  v.y = n.y > 0.008856 ? pow(n.y, 1.0 / 3.0) : 7.787 * n.y + 16.0 / 116.0;\n  v.z = n.z > 0.008856 ? pow(n.z, 1.0 / 3.0) : 7.787 * n.z + 16.0 / 116.0;\n  return vec3(116.0 * v.y - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 rgb2lab(vec3 c) {\n  vec3 lab = xyz2lab(rgb2xyz(c));\n  return vec3(\n    lab.x / 100.0,\n    0.5 + 0.5 * (lab.y / 127.0),\n    0.5 + 0.5 * (lab.z / 127.0)\n  );\n}\n\nbool skin_mask(vec4 color) {\n  vec3 lab = rgb2lab(color.rgb);\n  return lab.g >= uBeautyficationLevel + 0.05 &&\n  lab.b >= uBeautyficationLevel + 0.04 &&\n  lab.r <= 0.98 &&\n  length(lab.gb) <= 0.9;\n}\n\nvoid main() {\n  vec2 iResolution = vec2(float(uWidth), float(uHeight));\n  vec3 c = texture2D(uSampler, vTextureCoord).rgb;\n  float a = texture2D(uSampler, vTextureCoord).a;\n\n  if (a > 0.9 && (uBeautyficationLevel > 0.95 || skin_mask(texture2D(uSampler, vTextureCoord)))) {\n    const int kSize = (MSIZE - 1) / 2;\n    vec3 final_colour = vec3(0.0);\n    float Z = 0.0;\n\n    kernel[0] = kernel[14] = 0.031225216;\n    kernel[1] = kernel[13] = 0.033322271;\n    kernel[2] = kernel[12] = 0.035206333;\n    kernel[3] = kernel[11] = 0.036826804;\n    kernel[4] = kernel[10] = 0.038138565;\n    kernel[5] = kernel[9] = 0.039104044;\n    kernel[6] = kernel[8] = 0.039695028;\n    kernel[7] = 0.039894;\n    float bZ = 0.2506642602897679;\n\n    //create the 1-D kernel\n\n    //   for (int j = 0; j <= kSize; ++j)\n    //   {\n    //     kernel[kSize+j] = kernel[kSize-j] = normpdf(float(j), SIGMA);\n    //   }\n\n    vec3 cc;\n    float factor;\n    //float bZ = 1.0/normpdf(0.0, BSIGMA);\n    //read out the texels\n    for (int i = -kSize; i <= kSize; ++i) {\n      for (int j = -kSize; j <= kSize; ++j) {\n        cc = texture2D(\n          uSampler,\n          vTextureCoord.xy + vec2(float(i), float(j)) / iResolution.xy\n        ).rgb;\n        factor =\n          normpdf3(cc - c, BSIGMA) * bZ * kernel[kSize + j] * kernel[kSize + i];\n        Z += factor;\n        final_colour += factor * cc;\n      }\n    }\n\n    //fragColor = vec4(final_colour / Z, 1.0);\n\n    vec4 origin = texture2D(uSampler, vTextureCoord);\n    vec4 blurred = vec4(final_colour / Z, 1.0);\n    vec4 highpass =\n      vec4(\n        origin.r - blurred.r,\n        origin.g - blurred.g,\n        origin.b - blurred.b,\n        1\n      ) +\n      vec4(0.5, 0.5, 0.5, 0);\n    vec4 highpass_inverted = vec4(\n      1.0 - highpass.r,\n      1.0 - highpass.g,\n      1.0 - highpass.b,\n      1\n    );\n    gl_FragColor = overlay(origin, highpass_inverted);\n\n  } else {\n    gl_FragColor = vec4(c, a);\n\n  }\n}\n",Object.assign({},e)])}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TI(e,t)}(t,e),r=t,(n=[{key:"setBeautificationLevel",value:function(e){this.uniforms.uBeautyficationLevel=e}}])&&xI(r.prototype,n),i&&xI(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);function EI(e){return EI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EI(e)}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kI(n.key),n)}}function kI(e){var t=function(e,t){if("object"!=EI(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=EI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==EI(t)?t:String(t)}function PI(e,t,r){return t=RI(t),function(e,t){if(t&&("object"===EI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$I()?Reflect.construct(t,r||[],RI(e).constructor):t.apply(e,r))}function $I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($I=function(){return!!e})()}function RI(e){return RI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RI(e)}function BI(e,t){return BI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},BI(e,t)}var DI=function(e){function t(e,r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=PI(this,t,["attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\nuniform mat3 uTransformMatrix;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n\n  vOriginCoord = (uTransformMatrix * vec3(vTextureCoord * inputSize.xy / outputFrame.zw, 1.0)).xy;\n}\n","uniform sampler2D uSampler;\nuniform sampler2D uOriginFrame;\n\nuniform bool useMask;\nuniform float distColor;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\n\nvec3 screen(vec3 a, vec3 b) {\n  return 1.0 - (1.0 - a) * (1.0 - b);\n}\nvec3 linearDodge(vec3 a, vec3 b) {\n  return a + b;\n}\n\nvoid main() {\n  float personMask = texture2D(uSampler, vTextureCoord).r;\n\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n\n  vec4 background = texture2D(uOriginFrame, vOriginCoord);\n  if (useMask) {\n    gl_FragColor = mix(vec4(0), background, personMask);  \n  } else {\n    gl_FragColor = mix(vec4(0), background, distColor);\n  }\n  //gl_FragColor = background;\n  //gl_FragColor = mix(vec4(0), background, 0.0);\n}\n",Object.assign({},e)])).matrix=new Pr,i.originalFrame=r,i.maskSprite=n,i.setLayout(),i}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BI(e,t)}(t,e),r=t,(n=[{key:"setLayout",value:function(){var e=this.maskSprite.position.x<0?1-Math.abs(this.maskSprite.position.x)/this.maskSprite.width:(this.originalFrame.width-this.maskSprite.position.x)/this.maskSprite.width;e=Math.min(1,e);var t=this.maskSprite.position.x<0?-this.maskSprite.position.x/this.maskSprite.width:0,r=this.maskSprite.position.y<0?1-Math.abs(this.maskSprite.position.y)/this.maskSprite.height:(this.originalFrame.height-this.maskSprite.position.y)/this.maskSprite.height;r=Math.min(1,r);var n=this.maskSprite.position.y<0?-this.maskSprite.position.y/this.maskSprite.height:0;this.matrix.a=e,this.matrix.d=r,this.matrix.tx=t,this.matrix.ty=n,this.uniforms.uTransformMatrix=this.matrix}},{key:"setOrigin",value:function(e){this.uniforms.uOriginFrame=e}},{key:"setLayoutMode",value:function(e){switch(e){case"segmentation":this.uniforms.useMask=!0,this.uniforms.distColor=0;break;case"full":this.uniforms.useMask=!1,this.uniforms.distColor=1;break;case"hide":this.uniforms.useMask=!1,this.uniforms.distColor=0}}},{key:"setIsBoundaryStrong",value:function(e){this.uniforms.uIsBoundaryStrong=e}}])&&OI(r.prototype,n),i&&OI(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);function MI(e){return MI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MI(e)}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FI(n.key),n)}}function FI(e){var t=function(e,t){if("object"!=MI(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=MI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==MI(t)?t:String(t)}function NI(e,t,r){return t=jI(t),function(e,t){if(t&&("object"===MI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,UI()?Reflect.construct(t,r||[],jI(e).constructor):t.apply(e,r))}function UI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(UI=function(){return!!e})()}function jI(e){return jI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jI(e)}function GI(e,t){return GI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},GI(e,t)}var zI=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=NI(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 pixelSize;\nuniform vec2 quarter;\nuniform vec2 _vrScale;\nuniform vec4 toPosTransform;\nuniform vec4 fromPosTransform;\nvec4 readTex(vec2 uv)\n{\n    return texture2D(uSampler, uv);\n}\nvec2 mapInsideChannel(vec2 pos)\n{\n    vec2 result = mod(pos, quarter) * 4.0;\n    result.y += floor(pos.x / quarter.x);\n    \n    return result;\n}\nvec4 extractChannel(vec4 c0, vec4 c1, vec4 c2, vec4 c3, float yPos)\n{\n    vec4 result = vec4(c0.r, c1.r, c2.r, c3.r);\n    \n    float condition = step(quarter.y, yPos);\n    result = mix(result, vec4(c0.g, c1.g, c2.g, c3.g), condition);\n    condition = step(2.0 * quarter.y, yPos);\n    result = mix(result, vec4(c0.b, c1.b, c2.b, c3.b), condition);\n    \n    \n    return result;\n}\nvec2 toPos(vec2 uv)\n{\n    return uv * toPosTransform.xy + toPosTransform.zw;\n}\nvec2 fromPos(vec2 pos)\n{\n    return ( pos * fromPosTransform.xy ) + fromPosTransform.zw;\n}\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    \n    vec2 pos = toPos(uv);\n    vec2 chPos = mapInsideChannel(pos);\n    uv = fromPos(chPos);\n    \n    vec4 c0 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c1 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c2 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c3 = readTex(uv);\n    gl_FragColor = extractChannel(c0, c1, c2, c3, pos.y);\n}"])).setSize(e,r),n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GI(e,t)}(t,e),r=t,(n=[{key:"setSize",value:function(e,t){var r=e,n=t;t>128&&(n=256),e<256&&(r=256),this.virtualSize=new Ar(e,t),this.realSize=new Ar(r,n),this._vrScale=new Ar(this.realSize.x/this.virtualSize.x,this.realSize.y/this.virtualSize.y),this.pixelSize=new Ar(1/this.realSize.x,1/this.realSize.y),this.quarter=new Ar(this.virtualSize.x/4,this.virtualSize.y/4),this.toPosTransform=[1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1),1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1),-.5*this.pixelSize.x*(1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1)),-.5*this.pixelSize.y*(1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1))],this.fromPosTransform=[(this.virtualSize.x-1)*this.pixelSize.x/(this.virtualSize.x-1),(this.virtualSize.y-1)*this.pixelSize.y/(this.virtualSize.y-1),.5*this.pixelSize.x,.5*this.pixelSize.y],this.uniforms.pixelSize=this.pixelSize,this.uniforms.quarter=this.quarter,this.uniforms.toPosTransform=this.toPosTransform,this.uniforms.fromPosTransform=this.fromPosTransform}}])&&LI(r.prototype,n),i&&LI(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);function VI(e){return VI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VI(e)}function HI(e){return function(e){if(Array.isArray(e))return WI(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return WI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WI(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WI(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KI(n.key),n)}}function KI(e){var t=function(e,t){if("object"!=VI(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=VI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==VI(t)?t:String(t)}function XI(e,t,r){return t=qI(t),function(e,t){if(t&&("object"===VI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ZI()?Reflect.construct(t,r||[],qI(e).constructor):t.apply(e,r))}function ZI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ZI=function(){return!!e})()}function qI(e){return qI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qI(e)}function JI(e,t){return JI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},JI(e,t)}var QI=function(e){function t(e){var r,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=XI(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uOffset;\n\nuniform int uHasMask;\nuniform sampler2D uMask;\n\nuniform int uClamped;\nuniform vec4 filterClamp;\n\nuniform mat3 uTransformMatrix;\n\nbool checkCoord(vec2 coord) {\n  vec4 color = texture2D(uMask, coord);\n  return color.r < 0.5;\n}\n\nvoid main(void ) {\n  vec4 color = vec4(0.0);\n  bool hasMask = uHasMask > 0;\n  bool isClamped = uClamped > 0;\n  bool isInside = hasMask && !checkCoord(vTextureCoord);\n\n  vec2 pickCoord[4];\n  pickCoord[0] = vTextureCoord + vec2(-1.0, +1.0) * uOffset;\n  pickCoord[1] = vTextureCoord + vec2(+1.0, +1.0) * uOffset;\n  pickCoord[2] = vTextureCoord + vec2(+1.0, -1.0) * uOffset;\n  pickCoord[3] = vTextureCoord + vec2(-1.0, -1.0) * uOffset;\n\n  for (int i = 0; i < 4; i += 1) {\n    vec2 coord = pickCoord[i];\n\n    //. Get original point if needed\n    if (hasMask && !isInside && !checkCoord(pickCoord[i])) {\n      coord = vTextureCoord;\n    }\n\n    //. Check clamped mode\n    color += isClamped\n      ? texture2D(uSampler, clamp(coord, filterClamp.xy, filterClamp.zw))\n      : texture2D(uSampler, coord);\n  }\n\n  gl_FragColor = color * 0.25;\n}\n"]))._kernels=[],r._blur=4,r._quality=3,r.isMaskEnabled=!0,r.uniforms.uOffset=new Float32Array(2),r.uniforms.uClamped=e.clamp?1:0,r.uniforms.uHasMask=0,r.uniforms.uMask=En.WHITE,r.uniforms.uTransformMatrix=new Pr,r._pixelSize=new Ar,r.pixelSize=1,r._clamp=!!e.clamp,Array.isArray(e.blur)?r.kernels=e.blur:(r._blur=null!==(n=e.blur)&&void 0!==n?n:4,r.quality=null!==(i=e.quality)&&void 0!==i?i:3),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JI(e,t)}(t,e),r=t,n=[{key:"apply",value:function(e,t,r,n){var i,o=this._pixelSize.x/t._frame.width,a=this._pixelSize.y/t._frame.height;if(1===this._quality||0===this._blur)i=this._kernels[0]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,t,r,n);else{for(var s,u=e.getFilterTexture(),l=t,h=u,c=this._quality-1,d=0;d<c;d++)i=this._kernels[d]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,l,h,1),s=l,l=h,h=s;i=this._kernels[c]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,l,r,n),e.returnFilterTexture(u)}}},{key:"_updatePadding",value:function(){this.padding=Math.ceil(this._kernels.reduce((function(e,t){return e+t+.5}),0))}},{key:"_generateKernels",value:function(){var e=this._blur,t=this._quality,r=[e];if(e>0)for(var n=e,i=e/t,o=1;o<t;o++)n-=i,r.push(n);this._kernels=r,this._updatePadding()}},{key:"kernels",get:function(){return this._kernels},set:function(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max.apply(Math,HI(e))):(this._kernels=[0],this._quality=1)}},{key:"clamp",get:function(){return this._clamp}},{key:"pixelSize",get:function(){return this._pixelSize},set:function(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof Ar?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}},{key:"blur",get:function(){return this._blur},set:function(e){this._blur=e,this._generateKernels()}},{key:"enableMask",value:function(){this.isMaskEnabled=!0}},{key:"disableMask",value:function(){this.isMaskEnabled=!1}},{key:"setMask",value:function(e){this.uniforms.uMask=e,this.uniforms.uHasMask=this.isMaskEnabled?1:0}}],n&&YI(r.prototype,n),i&&YI(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);function eA(e){return eA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eA(e)}function tA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rA(n.key),n)}}function rA(e){var t=function(e,t){if("object"!=eA(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=eA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eA(t)?t:String(t)}function nA(e,t,r){return t=oA(t),function(e,t){if(t&&("object"===eA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,iA()?Reflect.construct(t,r||[],oA(e).constructor):t.apply(e,r))}function iA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(iA=function(){return!!e})()}function oA(e){return oA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oA(e)}function aA(e,t){return aA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},aA(e,t)}var sA=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nA(this,t)}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aA(e,t)}(t,e),r=t,(n=[{key:"set",value:function(e,t,r){this.preset=e,this.width=t,this.height=r,this.size=4*this.width*this.height,this.emit("update",this)}}])&&tA(r.prototype,n),i&&tA(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(a),uA=r(4300),lA=r.n(uA),hA=r(8684),cA=r.n(hA);function dA(e,t,r){return t=pA(t),function(e,t){if(t&&("object"===mA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fA()?Reflect.construct(t,r||[],pA(e).constructor):t.apply(e,r))}function fA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fA=function(){return!!e})()}function pA(e){return pA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pA(e)}function yA(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gA(e,t)}function gA(e,t){return gA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gA(e,t)}function mA(e){return mA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mA(e)}function wA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xA(n.key),n)}}function vA(e,t,r){return t&&bA(e.prototype,t),r&&bA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xA(e){var t=function(e,t){if("object"!=mA(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=mA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mA(t)?t:String(t)}var _A=function(){function e(t){wA(this,e),this.isLandscape=!0,this.sdkOptions=t,this.landscapeSize={height:144,width:256},this.portraitSize={height:192,width:192},this.updateOrientation()}return vA(e,[{key:"isOrientationChanged",value:function(){return this.isLandscape!=this.sdkOptions.isLandscape()}},{key:"updateOrientation",value:function(){this.isLandscape=this.sdkOptions.isLandscape()}},{key:"getModelSize",value:function(){return this.isLandscape?this.landscapeSize:this.portraitSize}},{key:"getURL",value:function(){var e=this.isLandscape?"PRESETS":"PRESETS_PORTRAIT",t=gx.M[e][this.preset];return t?gx.M.getPresetUrl(t):gx.M.MODEL_URL}}]),e}(),IA=function(e){function t(e){var r;return wA(this,t),(r=dA(this,t,[e])).preset="quality",r}return yA(t,e),vA(t)}(_A),AA=function(e){function t(e){var r;return wA(this,t),(r=dA(this,t,[e])).preset="balanced",r.landscapeSize={height:128,width:256},r}return yA(t,e),vA(t)}(_A),SA=function(e){function t(e){var r;return wA(this,t),(r=dA(this,t,[e])).preset="speed",r.landscapeSize={height:160,width:256},r}return yA(t,e),vA(t)}(_A),TA=function(e){function t(e){var r;return wA(this,t),(r=dA(this,t,[e])).preset="lightning",r}return yA(t,e),vA(t)}(_A),CA=function(){function e(t){wA(this,e),this.modelMap=new Map,this.modelMap.set("balanced",new AA(t)),this.modelMap.set("quality",new IA(t)),this.modelMap.set("speed",new SA(t)),this.modelMap.set("lightning",new TA(t))}return vA(e,[{key:"isOrientationChanged",value:function(e){var t;return null===(t=this.getModel(e))||void 0===t?void 0:t.isOrientationChanged()}},{key:"updateOrientation",value:function(){return this.modelMap.forEach((function(e,t){e.updateOrientation()}))}},{key:"getModelSize",value:function(e){var t,r;return null!==(r=null===(t=this.getModel(e))||void 0===t?void 0:t.getModelSize())&&void 0!==r?r:{height:144,width:256}}},{key:"getModelURL",value:function(e){var t,r;return null!==(r=null===(t=this.getModel(e))||void 0===t?void 0:t.getURL())&&void 0!==r?r:""}},{key:"getModel",value:function(e){return this.modelMap.has(e)?this.modelMap.get(e):(o.ie.notify({emitter:o.E7.PRESET_INIT,message:"Can't find preset ".concat(e)}),null)}}]),e}();function EA(e){return EA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EA(e)}function OA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kA(n.key),n)}}function kA(e){var t=function(e,t){if("object"!=EA(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=EA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==EA(t)?t:String(t)}function PA(e,t,r){return t=RA(t),function(e,t){if(t&&("object"===EA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return BA(e)}(e,$A()?Reflect.construct(t,r||[],RA(e).constructor):t.apply(e,r))}function $A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($A=function(){return!!e})()}function RA(e){return RA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RA(e)}function BA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DA(e,t){return DA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},DA(e,t)}var MA,LA=function(e){function t(e,r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=PA(this,t)).filters={blur:{}},i.sdkOptions=e,i.type="origin",i.options=Object.assign({},t.defaultOptions,n),i.frame=r,i.filters.blur=new QI({blur:5,quality:5}),i.backgroundTrack=new _,i.backgroundTrack.on("ended",i.clearBackground,BA(i)),i.backgroundTrack.on("update",i.calculateBackgroundSize,BA(i)),i.globalWidth=e.width,i.globalHeight=e.height,i.sdkOptions.on("update",i.onOptionsUpdate,BA(i)),i}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DA(e,t)}(t,e),r=t,n=[{key:"destroy",value:function(){this.backgroundTrack.off("ended",this.clearBackground,this),this.backgroundTrack.off("update",this.calculateBackgroundSize,this),this.sdkOptions.off("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(e){this.globalWidth=e.width,this.globalHeight=e.height,this.frame.resize(this.globalWidth,this.globalHeight),this.calculateBackgroundSize()}},{key:"render",value:function(){this.backgroundTrack.update(),document.hidden&&this.frame.frame.texture.baseTexture.resource&&this.frame.frame.texture.baseTexture.resource.source instanceof HTMLVideoElement&&this.frame.frame.texture.baseTexture.update()}},{key:"set",value:function(e){this.backgroundTrack.stop(),this.applyBackground(e)}},{key:"applyBlur",value:function(e){this.frame.frame.filters=[],this.filters.blur.disableMask(),e&&(this.filters.blur.blur=+e,this.frame.frame.filters.push(this.filters.blur),"origin"==this.frame.active&&this.filters.blur.enableMask())}},{key:"setMask",value:function(e){this.filters.blur.blur&&this.filters.blur.setMask(e)}},{key:"applyBackground",value:function(e){var t,r=this;if(this.frame.frame.tint="color"==e?this.options.color:16777215,this.options.source!=e){if(this.options.source=e,null==e)return this.type="origin",void(this.frame.active!==this.type&&(this.frame.activateTexture(this.type),this.calculateBackgroundSize(),(null===(t=this.frame.frame.filters)||void 0===t?void 0:t.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask()));var n,i,o;switch(e.constructor){case String:"color"==e?(this.type="color",n=En.WHITE):(n=e,this.type="url");break;case MediaStream:this.backgroundTrack.set(e),(i=document.createElement("video")).srcObject=e,n=i,this.type="media_stream";break;case CanvasCaptureMediaStreamTrack:case BrowserCaptureMediaStreamTrack:case MediaStreamTrack:o=new MediaStream([e]),this.backgroundTrack.set(o),(i=document.createElement("video")).srcObject=o,n=i,this.type="media_stream_track";break;case HTMLVideoElement:n=e,this.type="video"}if(n&&n instanceof En)this.texture=n;else{if(e.constructor==String)return void En.fromURL(n).then((function(e){r.texture=e,r.onBackgroundLoaded()}));this.texture=En.from(n)}this.texture.baseTexture.valid?this.onBackgroundLoaded():this.texture.baseTexture.once("loaded",(function(){return r.onBackgroundLoaded()}))}}},{key:"onBackgroundLoaded",value:function(){this.texture.baseTexture&&(this.frame.addTexture("swap",this.texture),this.switchBackground(),this.calculateBackgroundSize(),this.loopAndRestart())}},{key:"loopAndRestart",value:function(){this.frame.frame.texture.baseTexture.resource.source instanceof HTMLVideoElement&&(this.frame.frame.texture.baseTexture.resource.source.loop=!0,this.frame.frame.texture.baseTexture.resource.source.currentTime=0,this.frame.frame.texture.baseTexture.resource.source.muted=!0)}},{key:"setColor",value:function(e){this.options.color=e,this.frame.frame.tint=this.options.color}},{key:"switchBackground",value:function(){var e;this.frame.activateTexture("swap"),"color"==this.type&&(this.frame.frame.tint=this.options.color),(null===(e=this.frame.frame.filters)||void 0===e?void 0:e.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask(),this.emit("update",this)}},{key:"clearBackground",value:function(){this.backgroundTrack.stop(),this.applyBackground(null),this.emit("clear",this)}},{key:"updateBackgroundSize",value:function(e,t,r,n){this.frame.frame.width=r,this.frame.frame.height=n,this.frame.frame.x=e,this.frame.frame.y=t}},{key:"setFitMode",value:function(e){this.options.fit_mode=e,this.calculateBackgroundSize()}},{key:"calculateBackgroundSize",value:function(){var e=this.globalWidth,t=this.globalHeight;if("color"!=this.type&&"origin"!=this.type){if(!(this.frame.frame.texture.baseTexture.width<20)){var r=this.frame.frame.texture.baseTexture.width/this.frame.frame.texture.baseTexture.height;"fill"==this.options.fit_mode?e/r>=t?this.updateBackgroundSize(0,-Math.abs(t-e/r)/2,e,e/r):this.updateBackgroundSize(-Math.abs(e-t*r)/2,0,t*r,t):e/r<=t?this.updateBackgroundSize(0,Math.abs(t-e/r)/2,e,e/r):this.updateBackgroundSize(Math.abs(e-t*r)/2,0,t*r,t)}}else this.updateBackgroundSize(0,0,e,t)}}],n&&OA(r.prototype,n),i&&OA(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(a);function FA(e){return FA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FA(e)}function NA(){NA=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==FA(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(FA(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function UA(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function jA(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){UA(o,n,i,a,s,"next",e)}function s(e){UA(o,n,i,a,s,"throw",e)}a(void 0)}))}}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zA(n.key),n)}}function zA(e){var t=function(e,t){if("object"!=FA(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=FA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==FA(t)?t:String(t)}function VA(e,t,r){return t=WA(t),function(e,t){if(t&&("object"===FA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return YA(e)}(e,HA()?Reflect.construct(t,r||[],WA(e).constructor):t.apply(e,r))}function HA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(HA=function(){return!!e})()}function WA(e){return WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},WA(e)}function YA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KA(e,t){return KA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},KA(e,t)}LA.defaultOptions={source:null,fit_mode:"fill",color:16777215},function(e){e.Segmentation="segmentation",e.Full="full",e.Hide="hide"}(MA||(MA={}));var XA=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=VA(this,t,[e])).pixels=[],n.filters={blurMask:{},show:{},beautification:{},nchw:{}},n.skip_frames_counter=0,n.customLayoutOptions={width:1280,height:720,xOffset:0,yOffset:0},n.customLayoutOptions.width=e.width,n.customLayoutOptions.height=e.height,n.customer_id=r,n.presetManager=new CA(n.sdkOptions),n.inferenceTimer=new E,n.drawTimer=new E,n.settings={boundary_level:0,boundary_mode:"strong",beautification:!1,beautification_level:.48,blur:0,layout:"center",preset:gx.M.PRESET,skip_frames:!1,layout_mode:MA.Segmentation},n.model=new sA,n.model.on("update",n.updateModelSize,YA(n)),n.is_running=!1,n.isNewPreset=!1,n.enable(),n}var r,n,i,a,s,u,l,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KA(e,t)}(t,e),r=t,n=[{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.mask.resize(this.sdkOptions.width,this.sdkOptions.height),this.applyLayout()}},{key:"clearBuffers",value:function(){this.pixels=[]}},{key:"nextFrame",value:function(e){if(this.isActive()&&!(this.pixels.length>1)){if(this.small.addTexture("frame",e.texture),this.small.activateTexture("frame"),this.resources.transform){var t=this.resources.transform.xOffset,r=this.resources.transform.yOffset,n=Math.abs(this.sdkOptions.width*this.resources.transform.scaleValue),i=Math.abs(this.sdkOptions.height*this.resources.transform.scaleValue);this.small.frame.texture.trim=new Tr(t,r,n,i)}this.small.frame.filters=[this.filters.nchw],this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.small.frame.filters=[],this.small.frame.texture.trim=new Tr(0,0,this.sdkOptions.width,this.sdkOptions.height),this.small.activateTexture("origin");var o=this.small.getBuffer("model");this.pixels.push(this.resources.renderer.pixelsAsync(o))}}},{key:"init",value:(h=jA(NA().mark((function e(t){var r=this;return NA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.disable(),this.inference=t,this.inference.setPresetManager(this.presetManager),this.inference.setPreset(this.settings.preset),e.next=6,this.setPreset(this.settings.preset);case 6:return e.abrupt("return",this.inference.init(this.customer_id,"segmentation").then((function(){r.enable()})));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"setPreset",value:(l=jA(NA().mark((function e(t){var r,n,i;return NA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.model.preset!=t||this.presetManager.isOrientationChanged(this.model.preset)){e.next=2;break}return e.abrupt("return");case 2:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break}return e.next=5,this.onProcessPromise.promise;case 5:this.isNewPreset=!0,this.settings.preset=t,this.presetManager.updateOrientation(),r=this.presetManager.getModelSize(t),n=r.width,i=r.height,this.model.set(t,n,i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"updateModelSize",value:(u=jA(NA().mark((function e(){var t,r;return NA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.buffer_pixels=new Uint8Array(this.model.size),this.buffer_mask=lA()(new Float32Array(this.model.size).fill(255),[1,this.model.height,this.model.width,4]),this.model.previous=lA()(new Float32Array(this.model.size),[1,1,this.model.height,this.model.width]),null===(t=this.small)||void 0===t||t.resize(this.model.width,this.model.height),null===(r=this.mask)||void 0===r||r.resize(this.model.width,this.model.height),this.filters.nchw=new zI(this.model.width,this.model.height),this.filters.nchw.setSize(this.model.width,this.model.height),this.mask&&this.applyLayout();case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"prepare",value:function(){var e=this.model.width,t=this.model.height;this.original=new Ql(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.background=new LA(this.sdkOptions,new Ql(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height})),this.small=new Ql(this.resources.texture,{width:e,height:t}),this.small.addBuffer("model"),this.small.addBuffer("mask"),this.mask=new Ql(this.small.getBuffer("mask"),{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.buffer_pixels=new Uint8Array(4*e*t),this.buffer_mask=lA()(new Float32Array(4*e*t).fill(255),[1,t,e,4]),this.prepareFilters(),this.applyBlur(),this.updateModelSize(),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"prepareFilters",value:function(){var e={uIsBoundaryStrong:"strong"===this.settings.boundary_mode,uOriginFrame:this.original.frame.texture,useMask:!0,distColor:1};this.filters.blurMask=new QI({blur:.1,quality:4,clamp:!0}),this.filters.show=new DI(e,this.original.frame,this.mask.frame),this.filters.nchw=new zI(this.model.width,this.model.height),this.filters.beautification=new CI({uBeautificationLevel:this.settings.beautification_level,uWidth:this.mask.frame.width,uHeight:this.mask.frame.height}),this.mask.frame.filters=[this.filters.show]}},{key:"clearBackground",value:function(){this.background.clearBackground()}},{key:"process",value:(s=jA(NA().mark((function e(){var t;return NA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break}return e.next=5,this.onProcessPromise.promise;case 5:if(this.onProcessPromise=new nh,this.drawTimer.start(),this.inference&&this.inference.isReady()){e.next=9;break}return e.abrupt("return");case 9:if(e.prev=9,!this.shouldSegmentationRun()){e.next=13;break}return e.next=13,this.prepareSegmentationMask();case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(9),o.ie.notify({message:null!==(t="Prepare segmentation mask. "+e.t0.message)&&void 0!==t?t:e.t0,emitter:o.E7.EFFECT_VIRTUAL_BACKGROUND,cause:e.t0}),this.disable();case 19:this.skip_frames_counter=this.skip_frames_counter?0:1,this.isActive()?(this.filters.show.setOrigin(this.original.frame.texture),this.resources.renderer.addToEffects(this.background.frame.frame),this.resources.renderer.addToEffects(this.mask.frame),this.resources.renderer.addStatistics(),this.background.render(),this.resources.renderer.render(),this.resources.renderer.removeStatistics(),this.resources.renderer.removeFromEffects(this.mask.frame),this.resources.renderer.removeFromEffects(this.background.frame.frame)):(this.resources.renderer.addToEffects(this.original.frame),this.resources.renderer.addStatistics(),this.resources.renderer.render(),this.resources.renderer.removeStatistics(),this.resources.renderer.removeFromEffects(this.original.frame)),this.drawTimer.finish(),this.resources.renderer.updateStatistics("frame_time",this.drawTimer.getFrameTime()),this.resources.renderer.updateStatistics("inference_time",this.inferenceTimer.getFrameTime()),this.onProcessPromise.resolve();case 25:case"end":return e.stop()}}),e,this,[[9,15]])}))),function(){return s.apply(this,arguments)})},{key:"isActive",value:function(){return null!==this.background.options.source||"center"!==this.settings.layout||!!this.settings.blur||!!this.settings.beautification}},{key:"shouldSegmentationRun",value:function(){return(!this.settings.skip_frames||!this.skip_frames_counter)&&this.isActive()}},{key:"setBoundaryMode",value:function(e){this.settings.boundary_mode=e,this.filters.show.setIsBoundaryStrong("strong"===e)}},{key:"setBoundaryLevel",value:function(e){o.ie.notify({type:o.cL.INFO,message:"Boundary level was deprecated and will not show any effect.",emitter:o.E7.EFFECT_VIRTUAL_BACKGROUND})}},{key:"setBeautificationLevel",value:function(e){e=.34+.34*(e=1-Math.min(Math.max(Number(e),0),1)),this.filters.beautification.setBeautificationLevel(e)}},{key:"enableFrameSkipping",value:function(){this.settings.skip_frames=!0}},{key:"disableFrameSkipping",value:function(){this.settings.skip_frames=!1}},{key:"enableBeautification",value:function(){this.settings.beautification||(this.mask.frame.filters.push(this.filters.beautification),this.settings.beautification=!0)}},{key:"disableBeautification",value:function(){this.settings.beautification&&(this.mask.frame.filters.pop(),this.settings.beautification=!1)}},{key:"getPreset",value:function(){return this.settings.preset}},{key:"setLayout",value:function(e){this.settings.layout=e,this.applyLayout()}},{key:"setLayoutMode",value:function(e){this.settings.layout_mode=e,this.filters.show.setLayoutMode(e)}},{key:"setCustomLayout",value:function(e){var t=this;Object.keys(e).forEach((function(r){t.customLayoutOptions[r]=e[r]})),this.updateMaskPosition(this.customLayoutOptions.width,this.customLayoutOptions.height,this.customLayoutOptions.xOffset,this.customLayoutOptions.yOffset)}},{key:"applyLayout",value:function(){switch(this.settings.layout){case"left":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,-this.sdkOptions.width/4,0);break;case"right":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,this.sdkOptions.width/4,0);break;case"left-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,0,this.sdkOptions.height/2);break;case"right-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,this.sdkOptions.width/2,this.sdkOptions.height/2);break;case"center":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,0,0)}}},{key:"updateMaskPosition",value:function(e,t,r,n){this.mask.frame.width=e,this.mask.frame.height=t,this.mask.frame.position.x=r,this.mask.frame.position.y=n,this.filters.show.setLayout()}},{key:"setBackground",value:function(e){this.background.set(e)}},{key:"setBackgroundFitMode",value:function(e){this.background.setFitMode(e)}},{key:"setBackgroundColor",value:function(e){this.background.setColor(e)}},{key:"setBlur",value:function(e){this.settings.blur=e,this.applyBlur()}},{key:"clearBlur",value:function(){this.settings.blur=0,this.applyBlur()}},{key:"applyBlur",value:function(){this.background.applyBlur(this.settings.blur)}},{key:"prepareSegmentationMask",value:(a=jA(NA().mark((function e(){var t,r,n,i,a,s=this;return NA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.model.width,r=this.model.height,this.pixels.length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.pixels.pop();case 6:if((null==(n=e.sent)?void 0:n.length)==4*t*r){e.next=9;break}return e.abrupt("return");case 9:return i=[1,1,r,t],a=lA()(new Float32Array(n),[1,4,r,t]),cA().assign(a.pick(0,3,null,null),this.model.previous.pick(0,0,null,null)),this.inferenceTimer.start(),e.abrupt("return",this.inference.run(a.data,t,r,"segmentation").then((function(e){var n,o,a;if(s.inferenceTimer.finish(),s.isNewPreset)s.isNewPreset=!1;else{var u=null!==(a=null!==(o=null===(n=e.seg)||void 0===n?void 0:n.data)&&void 0!==o?o:e.seg)&&void 0!==a?a:e,l=lA()(u,i);cA().assign(s.model.previous,l),cA().mulseq(l,255),cA().assign(s.buffer_mask.pick(0,null,null,0),l.pick(0,0,null,null));var h=s.resources.renderer.createTextureFromBuffer(new Uint8Array(s.buffer_mask.data),t,r);s.small.addTexture("mask",h,!0),s.small.activateTexture("mask"),s.small.frame.filters=[s.filters.blurMask],s.resources.renderer.renderTo(s.small.frame,s.small.getBuffer("mask")),s.small.frame.filters=[],s.small.activateTexture("origin"),s.background.setMask(s.small.getBuffer("mask"))}})).catch((function(e){var t;o.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:o.E7.EFFECT_VIRTUAL_BACKGROUND,cause:e})})));case 14:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this),this.model.off("update",this.updateModelSize,this),this.background.destroy()}}],n&&GA(r.prototype,n),i&&GA(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(N_);function ZA(e){return ZA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZA(e)}function qA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JA(n.key),n)}}function JA(e){var t=function(e,t){if("object"!=ZA(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ZA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ZA(t)?t:String(t)}function QA(e,t,r){return t=tS(t),function(e,t){if(t&&("object"===ZA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,eS()?Reflect.construct(t,r||[],tS(e).constructor):t.apply(e,r))}function eS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(eS=function(){return!!e})()}function tS(e){return tS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tS(e)}function rS(e,t){return rS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rS(e,t)}var nS=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),QA(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLL;\nuniform int uEnabled;\n\nvoid main() {\n  vec4 texel = texture2D(uSampler, vTextureCoord);\n\n  if (uEnabled == 0) {\n    gl_FragColor = vec4(texel);\n    return;\n  }\n\n  vec3 curve = texture2D(uLL, vTextureCoord).rgb;\n\n  vec3 x = texel.rgb + curve * (texel.rgb * texel.rgb - texel.rgb);\n\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n\n  x = clamp(x, 0.0, 1.0);\n\n  gl_FragColor = vec4(x, texel.a);\n}\n",{uLL:En.EMPTY,uEnabled:0}])}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rS(e,t)}(t,e),r=t,(n=[{key:"setLowLightTexture",value:function(e){this.uniforms.uLL=e,this.uniforms.uEnabled=1}}])&&qA(r.prototype,n),i&&qA(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);var iS={modelHeight:144,modelWidth:144,power:1};const oS=Symbol("Comlink.proxy"),aS=Symbol("Comlink.endpoint"),sS=Symbol("Comlink.releaseProxy"),uS=Symbol("Comlink.finalizer"),lS=Symbol("Comlink.thrown"),hS=e=>"object"==typeof e&&null!==e||"function"==typeof e,cS=new Map([["proxy",{canHandle:e=>hS(e)&&e[oS],serialize(e){const{port1:t,port2:r}=new MessageChannel;return dS(e,t),[r,[r]]},deserialize:e=>(e.start(),pS(e))}],["throw",{canHandle:e=>hS(e)&&lS in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function dS(e,t=globalThis,r=["*"]){t.addEventListener("message",(function n(i){if(!i||!i.data)return;if(!function(e,t){for(const r of e){if(t===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(t))return!0}return!1}(r,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:o,type:a,path:s}=Object.assign({path:[]},i.data),u=(i.data.argumentList||[]).map(IS);let l;try{const t=s.slice(0,-1).reduce(((e,t)=>e[t]),e),r=s.reduce(((e,t)=>e[t]),e);switch(a){case"GET":l=r;break;case"SET":t[s.slice(-1)[0]]=IS(i.data.value),l=!0;break;case"APPLY":l=r.apply(t,u);break;case"CONSTRUCT":l=function(e){return Object.assign(e,{[oS]:!0})}(new r(...u));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;dS(e,r),l=function(e,t){return xS.set(e,t),e}(t,[t])}break;case"RELEASE":l=void 0;break;default:return}}catch(e){l={value:e,[lS]:0}}Promise.resolve(l).catch((e=>({value:e,[lS]:0}))).then((r=>{const[i,s]=_S(r);t.postMessage(Object.assign(Object.assign({},i),{id:o}),s),"RELEASE"===a&&(t.removeEventListener("message",n),fS(t),uS in e&&"function"==typeof e[uS]&&e[uS]())})).catch((e=>{const[r,n]=_S({value:new TypeError("Unserializable return value"),[lS]:0});t.postMessage(Object.assign(Object.assign({},r),{id:o}),n)}))})),t.start&&t.start()}function fS(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function pS(e,t){return bS(e,[],t)}function yS(e){if(e)throw new Error("Proxy has been released and is not useable")}function gS(e){return AS(e,{type:"RELEASE"}).then((()=>{fS(e)}))}const mS=new WeakMap,wS="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(mS.get(e)||0)-1;mS.set(e,t),0===t&&gS(e)}));function bS(e,t=[],r=function(){}){let n=!1;const i=new Proxy(r,{get(r,o){if(yS(n),o===sS)return()=>{!function(e){wS&&wS.unregister(e)}(i),gS(e),n=!0};if("then"===o){if(0===t.length)return{then:()=>i};const r=AS(e,{type:"GET",path:t.map((e=>e.toString()))}).then(IS);return r.then.bind(r)}return bS(e,[...t,o])},set(r,i,o){yS(n);const[a,s]=_S(o);return AS(e,{type:"SET",path:[...t,i].map((e=>e.toString())),value:a},s).then(IS)},apply(r,i,o){yS(n);const a=t[t.length-1];if(a===aS)return AS(e,{type:"ENDPOINT"}).then(IS);if("bind"===a)return bS(e,t.slice(0,-1));const[s,u]=vS(o);return AS(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:s},u).then(IS)},construct(r,i){yS(n);const[o,a]=vS(i);return AS(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},a).then(IS)}});return function(e,t){const r=(mS.get(t)||0)+1;mS.set(t,r),wS&&wS.register(e,t,e)}(i,e),i}function vS(e){const t=e.map(_S);return[t.map((e=>e[0])),(r=t.map((e=>e[1])),Array.prototype.concat.apply([],r))];var r}const xS=new WeakMap;function _S(e){for(const[t,r]of cS)if(r.canHandle(e)){const[n,i]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},i]}return[{type:"RAW",value:e},xS.get(e)||[]]}function IS(e){switch(e.type){case"HANDLER":return cS.get(e.name).deserialize(e.value);case"RAW":return e.value}}function AS(e,t,r){return new Promise((n=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===i&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),r)}))}function SS(e){return SS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SS(e)}function TS(){TS=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==SS(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(SS(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function CS(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function ES(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){CS(o,n,i,a,s,"next",e)}function s(e){CS(o,n,i,a,s,"throw",e)}a(void 0)}))}}function OS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kS(n.key),n)}}function kS(e){var t=function(e,t){if("object"!=SS(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=SS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==SS(t)?t:String(t)}function PS(e,t,r){return t=BS(t),function(e,t){if(t&&("object"===SS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$S()?Reflect.construct(t,r||[],BS(e).constructor):t.apply(e,r))}function $S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($S=function(){return!!e})()}function RS(){return RS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BS(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},RS.apply(this,arguments)}function BS(e){return BS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},BS(e)}function DS(e,t){return DS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},DS(e,t)}var MS=new URL(r(8804),r.b).href,LS=new Worker(MS,{type:"module"}),FS=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=PS(this,t,[e])).customer_id=r,n.setConfig(iS),n.worker=pS(LS),n}var r,n,i,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DS(e,t)}(t,e),r=t,n=[{key:"init",value:(s=ES(TS().mark((function e(t){return TS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"lowlighter");case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"prepare",value:function(){this.filterLowLight=new nS,this.original=new Ql(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.original.addBuffer("output"),this.filterLUT=new K_,this.lut=new Ql(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.lut.addBuffer("result"),this.lut.frame.filters=[this.filterLUT];var e=this.config,t=e.modelHeight,r=e.modelWidth;this.small=new Ql(this.resources.texture,{width:r,height:t}),this.small.addBuffer("model"),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.lut.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"process",value:(a=ES(TS().mark((function e(){return TS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.isOutdatedLUT&&this.updateLUT(),this.resources.renderer.renderTo(this.lut.frame,this.lut.getBuffer("result")),this.resources.texture.update(this.lut.getBuffer("result"),!1);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setConfig",value:function(e){var t;this.config=Object.assign(null!==(t=this.config)&&void 0!==t?t:{},e),this.setFilterPower(e.power)}},{key:"onSuccess",value:function(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0}},{key:"enable",value:function(){RS(BS(t.prototype),"enable",this).call(this),this.isOutdatedLUT=!this.inWork}},{key:"updateLUT",value:function(){var e=this;if(!this.inWork){this.inWork=!0;var t=this.config,r=t.modelHeight,n=t.modelWidth;this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model"));var i=this.small.getBuffer("model"),a=this.resources.renderer.pixels(i),s=function(e,t,r){var n=lA()(new Float32Array(e),[1,r,t,4]);n=n.transpose(0,3,1,2);var i=lA()(new Float32Array(r*t*3),[1,3,r,t]);return cA().assign(i.pick(0,0,null,null),n.pick(0,0,null,null)),cA().assign(i.pick(0,1,null,null),n.pick(0,1,null,null)),cA().assign(i.pick(0,2,null,null),n.pick(0,2,null,null)),n=n.transpose(2,0,1),cA().mulseq(i,1/255),i}(new Uint8ClampedArray(a),n,r);this.inference.run(s.data,n,r,"lowlighter").then((function(t){e.original.activateBuffer("result"),e.original.frame.filters=[e.filterLowLight],e.filterLowLight.setLowLightTexture(t.coefs),e.resources.renderer.renderTo(e.original.frame,e.original.getBuffer("output")),e.original.activateTexture("origin"),e.original.frame.filters=[];var r=e.resources.renderer.pixels(e.original.getBuffer("output")),n=e.resources.renderer.pixels(e.original.getBuffer("result"));return e.worker.getLUTTexture(new Uint8ClampedArray(n),new Uint8ClampedArray(r))})).then((function(t){e.applyLowlightLUT(t),e.emitSuccess()})).catch((function(e){var t;o.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:o.E7.EFFECT_LOW_LIGHT,cause:e})})).finally((function(){e.inWork=!1,e.isOutdatedLUT=!1}))}}},{key:"applyLowlightLUT",value:function(e){var t=this.getLutTextureData(e).LUTTexture;this.filterLUT.setLUT({texture:t})}},{key:"getLutTextureData",value:function(e){var t=Math.sqrt(e.length/4);return{LUTTexture:En.fromBuffer(new Uint8Array(e),t,t,{scaleMode:1}),LUTSize:t}}},{key:"setFilterPower",value:function(e){var t;void 0!==e&&(this.config.power=e,null===(t=this.filterLUT)||void 0===t||t.setFilterPower(e))}},{key:"emitSuccess",value:function(){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction()}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&OS(r.prototype,n),i&&OS(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(N_);const NS={modelHeight:256,modelWidth:256,modelPediod_ms:1e3,filterPart:100,cc_power:100};function US(e,t,r){var n=lA()(new Float32Array(e),[1,r,t,4]);n=n.transpose(0,3,1,2);var i=lA()(new Float32Array(r*t*3),[1,3,r,t]);return cA().assign(i.pick(0,0,null,null),n.pick(0,0,null,null)),cA().assign(i.pick(0,1,null,null),n.pick(0,1,null,null)),cA().assign(i.pick(0,2,null,null),n.pick(0,2,null,null)),i}function jS(e){var t=e.tensor,r=33,n=35937,i=lA()(t.output.data,[3,r,r,r]).data,o=new Uint8ClampedArray(4*Math.pow(198,2)),a={value:0,isNil:function(){return 0===a.value},setDefault:function(){return a.value=1089},dec:function(){return a.value--}};a.setDefault();for(var s=0,u=0,l=function(e,t){return 4*(r*(6*u+s)+t%r)+e},h=function(e){[e,n+e,71874+e].forEach((function(t,r){o[l(r,e)]=255*i[t]})),o[l(3,e)]=255,a.dec(),e%r==32&&u++,a.isNil()&&(a.setDefault(),++s>=6?s=0:u-=r)},c=0;c<n;c++)h(c);return o}function GS(e){return GS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GS(e)}function zS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VS(n.key),n)}}function VS(e){var t=function(e,t){if("object"!=GS(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=GS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==GS(t)?t:String(t)}function HS(e,t,r){return t=YS(t),function(e,t){if(t&&("object"===GS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,WS()?Reflect.construct(t,r||[],YS(e).constructor):t.apply(e,r))}function WS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(WS=function(){return!!e})()}function YS(e){return YS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},YS(e)}function KS(e,t){return KS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},KS(e,t)}var XS=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=HS(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\nuniform float uFilterPart;\nuniform float uFilterPower;\n\nfloat clampedCoord(float coord) {\n  float min = 0.5 / 198.0;\n  float max = 1.0 - min;\n  return clamp(coord, min, max);\n}\n\nfloat clampColor(float color) {\n  float min = 1.0 / 256.0;\n  float max = 1.0 / 6.0 - min;\n  return clamp(color, min, max);\n}\n\nvec4 newColor(float rectNum, vec2 coord) {\n  vec2 bCoord = vec2(mod(rectNum, 6.0) / 6.0, floor(rectNum / 6.0) / 6.0);\n  vec2 lutTextureCoord = vec2(clampedCoord(coord.r + bCoord.r), clampedCoord(coord.g + bCoord.g));\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(clampColor(color.r / 6.0), clampColor(color.g / 6.0));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * 32.0;\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec3 interpolatedColor = mix(colorLut1.rgb, colorLut2.rgb, rectNumReal - rectNumMin);\n\n  //. Add filter power\n  vec3 resultColor = mix(color.rgb, interpolatedColor.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n",{uFilterPart:1,uFilterPower:1}])).lutTextureHeight=198,e.lutTextureWidth=198,e}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KS(e,t)}(t,e),r=t,n=[{key:"setLUT",value:function(e){var t;null===(t=this.lutTexture)||void 0===t||t.destroy(!0),this.lutTexture=En.fromBuffer(e,this.lutTextureWidth,this.lutTextureHeight,{scaleMode:1}),this.uniforms.uLUT=this.lutTexture}},{key:"setFilterPart",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e}},{key:"setFilterPower",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e}}],n&&zS(r.prototype,n),i&&zS(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);function ZS(e){return ZS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZS(e)}function qS(){qS=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==ZS(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(ZS(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function JS(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function QS(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){JS(o,n,i,a,s,"next",e)}function s(e){JS(o,n,i,a,s,"throw",e)}a(void 0)}))}}function eT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tT(n.key),n)}}function tT(e){var t=function(e,t){if("object"!=ZS(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ZS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ZS(t)?t:String(t)}function rT(e,t,r){return t=iT(t),function(e,t){if(t&&("object"===ZS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,nT()?Reflect.construct(t,r||[],iT(e).constructor):t.apply(e,r))}function nT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(nT=function(){return!!e})()}function iT(e){return iT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},iT(e)}function oT(e,t){return oT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oT(e,t)}var aT=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=rT(this,t,[e])).hasLUT=!1,n.inWork=!1,n.customer_id=r,n.config=Object.assign({},NS),n}var r,n,i,a,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oT(e,t)}(t,e),r=t,n=[{key:"init",value:(u=QS(qS().mark((function e(t){return qS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"colorcorrector");case 3:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"prepare",value:function(){var e=this.config,t=e.modelHeight,r=e.modelWidth,n=this.resources.texture;this.original=new Ql(n,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.small=new Ql(n,{width:r,height:t}),this.small.addBuffer("model"),this.ccFilter=new XS,this.original.frame.filters=[this.ccFilter],this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"process",value:(s=QS(qS().mark((function e(){return qS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.modelProcess(),this.hasLUT&&(this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1));case 5:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"modelProcess",value:(a=QS(qS().mark((function e(){var t,r,n,i,a,s,u=this;return qS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break}return e.abrupt("return");case 4:return this.inWork=!0,t=this.config,r=t.modelHeight,n=t.modelWidth,i=this.small.getBuffer("model"),e.next=9,this.resources.renderer.pixelsAsync(i);case 9:return a=e.sent,s=US(new Uint8ClampedArray(a),n,r),e.abrupt("return",this.inference.run(s.data,n,r,"colorcorrector").then((function(e){var t=jS({tensor:e});u.ccFilter.setLUT(t),u.hasLUT=!0})).catch((function(e){var t;o.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:o.E7.EFFECT_COLOR_CORRECTION,cause:e})})).finally((function(){return u.inWork=!1})));case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setConfig",value:function(e,t){this.config[e]=t,"filterPart"===e&&this.ccFilter.setFilterPart(t),"cc_power"===e&&this.ccFilter.setFilterPower(t)}},{key:"checkTimer",value:function(){return this.modelTimer?(performance.now()-this.modelTimer<this.config.modelPediod_ms||(this.modelTimer=0),!1):(this.modelTimer=performance.now(),!0)}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&eT(r.prototype,n),i&&eT(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(N_);const sT={smoothPower:20,sensitivityValue:.15,faceAreaProportion:.1,modelHeight:240,modelWidth:320,faceDetectorAccuracy:.75,waiterSeconds:1,isFaceSquareDrawingEnabled:!1,isPreFaceSquareDrawingEnabled:!1,faceDetectorPediod_ms:250};function uT(e){return uT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uT(e)}function lT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hT(n.key),n)}}function hT(e){var t=function(e,t){if("object"!=uT(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=uT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==uT(t)?t:String(t)}var cT=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setCoord(t),this.id=null!=r?r:Math.round(100*Math.random())}var t,r,n;return t=e,r=[{key:"setID",value:function(e){this.id=e}},{key:"getID",value:function(){return this.id}},{key:"checkSame",value:function(e){if(void 0===this.x1)return!1;if(!(e.x1>this.x1&&e.x1<this.x2||e.x2>this.x1&&e.x2<this.x2||this.x1>e.x1&&this.x1<e.x2||this.x2>e.x1&&this.x2<e.x2))return!1;if(!(e.y1>this.y1&&e.y1<this.y2||e.y2>this.y1&&e.y2<this.y2||this.y1>e.y1&&this.y1<e.y2||this.y2>e.y1&&this.y2<e.y2))return!1;var t=this.calcSquare(e),r=Math.abs(Math.max(this.x1,e.x1)-Math.min(this.x2,e.x2));return!!(Math.abs(Math.max(this.y1,e.y1)-Math.min(this.y2,e.y2))*r/Math.min(this.square,t)>.7)&&(this.setCoord(e),!0)}},{key:"getRect",value:function(){return{x1:this.x1,y1:this.y1,width:this.x2-this.x1,height:this.y2-this.y1}}},{key:"getCoord",value:function(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2}}},{key:"getSquare",value:function(){return this.square}},{key:"getCenter",value:function(){return{x:this.x1+(this.x2-this.x1)/2,y:this.y1+(this.y2-this.y1)/2}}},{key:"isEqual",value:function(e,t,r,n){if(!e)return!1;var i=e.getCoord();return!(Math.abs(this.x1-i.x1)/(null!=n?n:this.x2-this.x1)>t||Math.abs(this.x2-i.x2)/(null!=n?n:this.x2-this.x1)>t||Math.abs(this.y1-i.y1)/(null!=r?r:this.y2-this.y1)>t||Math.abs(this.y2-i.y2)/(null!=r?r:this.y2-this.y1)>t)}},{key:"setCoord",value:function(e){var t=void 0===this.x1;this.x1=t?e.x1:Math.min(this.x1,e.x1),this.y1=t?e.y1:Math.min(this.y1,e.y1),this.x2=t?e.x2:Math.max(this.x2,e.x2),this.y2=t?e.y2:Math.max(this.y2,e.y2),this.square=this.calcSquare(e)}},{key:"calcSquare",value:function(e){return(e.x2-e.x1)*(e.y2-e.y1)}}],r&&lT(t.prototype,r),n&&lT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const dT=[{x:.0125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.016666666666666666,w:.075,h:.1},{x:.0375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.016666666666666666,w:.075,h:.1},{x:.0625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.016666666666666666,w:.075,h:.1},{x:.0875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.016666666666666666,w:.075,h:.1},{x:.1125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.016666666666666666,w:.075,h:.1},{x:.1375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.016666666666666666,w:.075,h:.1},{x:.1625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.016666666666666666,w:.075,h:.1},{x:.1875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.016666666666666666,w:.075,h:.1},{x:.2125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.016666666666666666,w:.075,h:.1},{x:.2375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.016666666666666666,w:.075,h:.1},{x:.2625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.016666666666666666,w:.075,h:.1},{x:.2875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.016666666666666666,w:.075,h:.1},{x:.3125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.016666666666666666,w:.075,h:.1},{x:.3375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.016666666666666666,w:.075,h:.1},{x:.3625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.016666666666666666,w:.075,h:.1},{x:.3875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.016666666666666666,w:.075,h:.1},{x:.4125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.016666666666666666,w:.075,h:.1},{x:.4375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.016666666666666666,w:.075,h:.1},{x:.4625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.016666666666666666,w:.075,h:.1},{x:.4875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.016666666666666666,w:.075,h:.1},{x:.5125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.016666666666666666,w:.075,h:.1},{x:.5375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.016666666666666666,w:.075,h:.1},{x:.5625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.016666666666666666,w:.075,h:.1},{x:.5875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.016666666666666666,w:.075,h:.1},{x:.6125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.016666666666666666,w:.075,h:.1},{x:.6375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.016666666666666666,w:.075,h:.1},{x:.6625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.016666666666666666,w:.075,h:.1},{x:.6875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.016666666666666666,w:.075,h:.1},{x:.7125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.016666666666666666,w:.075,h:.1},{x:.7375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.016666666666666666,w:.075,h:.1},{x:.7625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.016666666666666666,w:.075,h:.1},{x:.7875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.016666666666666666,w:.075,h:.1},{x:.8125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.016666666666666666,w:.075,h:.1},{x:.8375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.016666666666666666,w:.075,h:.1},{x:.8625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.016666666666666666,w:.075,h:.1},{x:.8875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.016666666666666666,w:.075,h:.1},{x:.9125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.016666666666666666,w:.075,h:.1},{x:.9375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.016666666666666666,w:.075,h:.1},{x:.9625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.016666666666666666,w:.075,h:.1},{x:.9875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.016666666666666666,w:.075,h:.1},{x:.0125,y:.05,w:.03125,h:.041666666666666664},{x:.0125,y:.05,w:.05,h:.06666666666666667},{x:.0125,y:.05,w:.075,h:.1},{x:.0375,y:.05,w:.03125,h:.041666666666666664},{x:.0375,y:.05,w:.05,h:.06666666666666667},{x:.0375,y:.05,w:.075,h:.1},{x:.0625,y:.05,w:.03125,h:.041666666666666664},{x:.0625,y:.05,w:.05,h:.06666666666666667},{x:.0625,y:.05,w:.075,h:.1},{x:.0875,y:.05,w:.03125,h:.041666666666666664},{x:.0875,y:.05,w:.05,h:.06666666666666667},{x:.0875,y:.05,w:.075,h:.1},{x:.1125,y:.05,w:.03125,h:.041666666666666664},{x:.1125,y:.05,w:.05,h:.06666666666666667},{x:.1125,y:.05,w:.075,h:.1},{x:.1375,y:.05,w:.03125,h:.041666666666666664},{x:.1375,y:.05,w:.05,h:.06666666666666667},{x:.1375,y:.05,w:.075,h:.1},{x:.1625,y:.05,w:.03125,h:.041666666666666664},{x:.1625,y:.05,w:.05,h:.06666666666666667},{x:.1625,y:.05,w:.075,h:.1},{x:.1875,y:.05,w:.03125,h:.041666666666666664},{x:.1875,y:.05,w:.05,h:.06666666666666667},{x:.1875,y:.05,w:.075,h:.1},{x:.2125,y:.05,w:.03125,h:.041666666666666664},{x:.2125,y:.05,w:.05,h:.06666666666666667},{x:.2125,y:.05,w:.075,h:.1},{x:.2375,y:.05,w:.03125,h:.041666666666666664},{x:.2375,y:.05,w:.05,h:.06666666666666667},{x:.2375,y:.05,w:.075,h:.1},{x:.2625,y:.05,w:.03125,h:.041666666666666664},{x:.2625,y:.05,w:.05,h:.06666666666666667},{x:.2625,y:.05,w:.075,h:.1},{x:.2875,y:.05,w:.03125,h:.041666666666666664},{x:.2875,y:.05,w:.05,h:.06666666666666667},{x:.2875,y:.05,w:.075,h:.1},{x:.3125,y:.05,w:.03125,h:.041666666666666664},{x:.3125,y:.05,w:.05,h:.06666666666666667},{x:.3125,y:.05,w:.075,h:.1},{x:.3375,y:.05,w:.03125,h:.041666666666666664},{x:.3375,y:.05,w:.05,h:.06666666666666667},{x:.3375,y:.05,w:.075,h:.1},{x:.3625,y:.05,w:.03125,h:.041666666666666664},{x:.3625,y:.05,w:.05,h:.06666666666666667},{x:.3625,y:.05,w:.075,h:.1},{x:.3875,y:.05,w:.03125,h:.041666666666666664},{x:.3875,y:.05,w:.05,h:.06666666666666667},{x:.3875,y:.05,w:.075,h:.1},{x:.4125,y:.05,w:.03125,h:.041666666666666664},{x:.4125,y:.05,w:.05,h:.06666666666666667},{x:.4125,y:.05,w:.075,h:.1},{x:.4375,y:.05,w:.03125,h:.041666666666666664},{x:.4375,y:.05,w:.05,h:.06666666666666667},{x:.4375,y:.05,w:.075,h:.1},{x:.4625,y:.05,w:.03125,h:.041666666666666664},{x:.4625,y:.05,w:.05,h:.06666666666666667},{x:.4625,y:.05,w:.075,h:.1},{x:.4875,y:.05,w:.03125,h:.041666666666666664},{x:.4875,y:.05,w:.05,h:.06666666666666667},{x:.4875,y:.05,w:.075,h:.1},{x:.5125,y:.05,w:.03125,h:.041666666666666664},{x:.5125,y:.05,w:.05,h:.06666666666666667},{x:.5125,y:.05,w:.075,h:.1},{x:.5375,y:.05,w:.03125,h:.041666666666666664},{x:.5375,y:.05,w:.05,h:.06666666666666667},{x:.5375,y:.05,w:.075,h:.1},{x:.5625,y:.05,w:.03125,h:.041666666666666664},{x:.5625,y:.05,w:.05,h:.06666666666666667},{x:.5625,y:.05,w:.075,h:.1},{x:.5875,y:.05,w:.03125,h:.041666666666666664},{x:.5875,y:.05,w:.05,h:.06666666666666667},{x:.5875,y:.05,w:.075,h:.1},{x:.6125,y:.05,w:.03125,h:.041666666666666664},{x:.6125,y:.05,w:.05,h:.06666666666666667},{x:.6125,y:.05,w:.075,h:.1},{x:.6375,y:.05,w:.03125,h:.041666666666666664},{x:.6375,y:.05,w:.05,h:.06666666666666667},{x:.6375,y:.05,w:.075,h:.1},{x:.6625,y:.05,w:.03125,h:.041666666666666664},{x:.6625,y:.05,w:.05,h:.06666666666666667},{x:.6625,y:.05,w:.075,h:.1},{x:.6875,y:.05,w:.03125,h:.041666666666666664},{x:.6875,y:.05,w:.05,h:.06666666666666667},{x:.6875,y:.05,w:.075,h:.1},{x:.7125,y:.05,w:.03125,h:.041666666666666664},{x:.7125,y:.05,w:.05,h:.06666666666666667},{x:.7125,y:.05,w:.075,h:.1},{x:.7375,y:.05,w:.03125,h:.041666666666666664},{x:.7375,y:.05,w:.05,h:.06666666666666667},{x:.7375,y:.05,w:.075,h:.1},{x:.7625,y:.05,w:.03125,h:.041666666666666664},{x:.7625,y:.05,w:.05,h:.06666666666666667},{x:.7625,y:.05,w:.075,h:.1},{x:.7875,y:.05,w:.03125,h:.041666666666666664},{x:.7875,y:.05,w:.05,h:.06666666666666667},{x:.7875,y:.05,w:.075,h:.1},{x:.8125,y:.05,w:.03125,h:.041666666666666664},{x:.8125,y:.05,w:.05,h:.06666666666666667},{x:.8125,y:.05,w:.075,h:.1},{x:.8375,y:.05,w:.03125,h:.041666666666666664},{x:.8375,y:.05,w:.05,h:.06666666666666667},{x:.8375,y:.05,w:.075,h:.1},{x:.8625,y:.05,w:.03125,h:.041666666666666664},{x:.8625,y:.05,w:.05,h:.06666666666666667},{x:.8625,y:.05,w:.075,h:.1},{x:.8875,y:.05,w:.03125,h:.041666666666666664},{x:.8875,y:.05,w:.05,h:.06666666666666667},{x:.8875,y:.05,w:.075,h:.1},{x:.9125,y:.05,w:.03125,h:.041666666666666664},{x:.9125,y:.05,w:.05,h:.06666666666666667},{x:.9125,y:.05,w:.075,h:.1},{x:.9375,y:.05,w:.03125,h:.041666666666666664},{x:.9375,y:.05,w:.05,h:.06666666666666667},{x:.9375,y:.05,w:.075,h:.1},{x:.9625,y:.05,w:.03125,h:.041666666666666664},{x:.9625,y:.05,w:.05,h:.06666666666666667},{x:.9625,y:.05,w:.075,h:.1},{x:.9875,y:.05,w:.03125,h:.041666666666666664},{x:.9875,y:.05,w:.05,h:.06666666666666667},{x:.9875,y:.05,w:.075,h:.1},{x:.0125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.08333333333333333,w:.075,h:.1},{x:.0375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.08333333333333333,w:.075,h:.1},{x:.0625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.08333333333333333,w:.075,h:.1},{x:.0875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.08333333333333333,w:.075,h:.1},{x:.1125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.08333333333333333,w:.075,h:.1},{x:.1375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.08333333333333333,w:.075,h:.1},{x:.1625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.08333333333333333,w:.075,h:.1},{x:.1875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.08333333333333333,w:.075,h:.1},{x:.2125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.08333333333333333,w:.075,h:.1},{x:.2375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.08333333333333333,w:.075,h:.1},{x:.2625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.08333333333333333,w:.075,h:.1},{x:.2875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.08333333333333333,w:.075,h:.1},{x:.3125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.08333333333333333,w:.075,h:.1},{x:.3375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.08333333333333333,w:.075,h:.1},{x:.3625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.08333333333333333,w:.075,h:.1},{x:.3875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.08333333333333333,w:.075,h:.1},{x:.4125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.08333333333333333,w:.075,h:.1},{x:.4375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.08333333333333333,w:.075,h:.1},{x:.4625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.08333333333333333,w:.075,h:.1},{x:.4875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.08333333333333333,w:.075,h:.1},{x:.5125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.08333333333333333,w:.075,h:.1},{x:.5375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.08333333333333333,w:.075,h:.1},{x:.5625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.08333333333333333,w:.075,h:.1},{x:.5875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.08333333333333333,w:.075,h:.1},{x:.6125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.08333333333333333,w:.075,h:.1},{x:.6375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.08333333333333333,w:.075,h:.1},{x:.6625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.08333333333333333,w:.075,h:.1},{x:.6875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.08333333333333333,w:.075,h:.1},{x:.7125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.08333333333333333,w:.075,h:.1},{x:.7375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.08333333333333333,w:.075,h:.1},{x:.7625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.08333333333333333,w:.075,h:.1},{x:.7875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.08333333333333333,w:.075,h:.1},{x:.8125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.08333333333333333,w:.075,h:.1},{x:.8375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.08333333333333333,w:.075,h:.1},{x:.8625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.08333333333333333,w:.075,h:.1},{x:.8875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.08333333333333333,w:.075,h:.1},{x:.9125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.08333333333333333,w:.075,h:.1},{x:.9375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.08333333333333333,w:.075,h:.1},{x:.9625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.08333333333333333,w:.075,h:.1},{x:.9875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.08333333333333333,w:.075,h:.1},{x:.0125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.11666666666666667,w:.075,h:.1},{x:.0375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.11666666666666667,w:.075,h:.1},{x:.0625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.11666666666666667,w:.075,h:.1},{x:.0875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.11666666666666667,w:.075,h:.1},{x:.1125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.11666666666666667,w:.075,h:.1},{x:.1375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.11666666666666667,w:.075,h:.1},{x:.1625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.11666666666666667,w:.075,h:.1},{x:.1875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.11666666666666667,w:.075,h:.1},{x:.2125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.11666666666666667,w:.075,h:.1},{x:.2375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.11666666666666667,w:.075,h:.1},{x:.2625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.11666666666666667,w:.075,h:.1},{x:.2875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.11666666666666667,w:.075,h:.1},{x:.3125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.11666666666666667,w:.075,h:.1},{x:.3375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.11666666666666667,w:.075,h:.1},{x:.3625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.11666666666666667,w:.075,h:.1},{x:.3875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.11666666666666667,w:.075,h:.1},{x:.4125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.11666666666666667,w:.075,h:.1},{x:.4375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.11666666666666667,w:.075,h:.1},{x:.4625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.11666666666666667,w:.075,h:.1},{x:.4875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.11666666666666667,w:.075,h:.1},{x:.5125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.11666666666666667,w:.075,h:.1},{x:.5375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.11666666666666667,w:.075,h:.1},{x:.5625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.11666666666666667,w:.075,h:.1},{x:.5875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.11666666666666667,w:.075,h:.1},{x:.6125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.11666666666666667,w:.075,h:.1},{x:.6375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.11666666666666667,w:.075,h:.1},{x:.6625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.11666666666666667,w:.075,h:.1},{x:.6875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.11666666666666667,w:.075,h:.1},{x:.7125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.11666666666666667,w:.075,h:.1},{x:.7375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.11666666666666667,w:.075,h:.1},{x:.7625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.11666666666666667,w:.075,h:.1},{x:.7875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.11666666666666667,w:.075,h:.1},{x:.8125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.11666666666666667,w:.075,h:.1},{x:.8375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.11666666666666667,w:.075,h:.1},{x:.8625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.11666666666666667,w:.075,h:.1},{x:.8875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.11666666666666667,w:.075,h:.1},{x:.9125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.11666666666666667,w:.075,h:.1},{x:.9375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.11666666666666667,w:.075,h:.1},{x:.9625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.11666666666666667,w:.075,h:.1},{x:.9875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.11666666666666667,w:.075,h:.1},{x:.0125,y:.15,w:.03125,h:.041666666666666664},{x:.0125,y:.15,w:.05,h:.06666666666666667},{x:.0125,y:.15,w:.075,h:.1},{x:.0375,y:.15,w:.03125,h:.041666666666666664},{x:.0375,y:.15,w:.05,h:.06666666666666667},{x:.0375,y:.15,w:.075,h:.1},{x:.0625,y:.15,w:.03125,h:.041666666666666664},{x:.0625,y:.15,w:.05,h:.06666666666666667},{x:.0625,y:.15,w:.075,h:.1},{x:.0875,y:.15,w:.03125,h:.041666666666666664},{x:.0875,y:.15,w:.05,h:.06666666666666667},{x:.0875,y:.15,w:.075,h:.1},{x:.1125,y:.15,w:.03125,h:.041666666666666664},{x:.1125,y:.15,w:.05,h:.06666666666666667},{x:.1125,y:.15,w:.075,h:.1},{x:.1375,y:.15,w:.03125,h:.041666666666666664},{x:.1375,y:.15,w:.05,h:.06666666666666667},{x:.1375,y:.15,w:.075,h:.1},{x:.1625,y:.15,w:.03125,h:.041666666666666664},{x:.1625,y:.15,w:.05,h:.06666666666666667},{x:.1625,y:.15,w:.075,h:.1},{x:.1875,y:.15,w:.03125,h:.041666666666666664},{x:.1875,y:.15,w:.05,h:.06666666666666667},{x:.1875,y:.15,w:.075,h:.1},{x:.2125,y:.15,w:.03125,h:.041666666666666664},{x:.2125,y:.15,w:.05,h:.06666666666666667},{x:.2125,y:.15,w:.075,h:.1},{x:.2375,y:.15,w:.03125,h:.041666666666666664},{x:.2375,y:.15,w:.05,h:.06666666666666667},{x:.2375,y:.15,w:.075,h:.1},{x:.2625,y:.15,w:.03125,h:.041666666666666664},{x:.2625,y:.15,w:.05,h:.06666666666666667},{x:.2625,y:.15,w:.075,h:.1},{x:.2875,y:.15,w:.03125,h:.041666666666666664},{x:.2875,y:.15,w:.05,h:.06666666666666667},{x:.2875,y:.15,w:.075,h:.1},{x:.3125,y:.15,w:.03125,h:.041666666666666664},{x:.3125,y:.15,w:.05,h:.06666666666666667},{x:.3125,y:.15,w:.075,h:.1},{x:.3375,y:.15,w:.03125,h:.041666666666666664},{x:.3375,y:.15,w:.05,h:.06666666666666667},{x:.3375,y:.15,w:.075,h:.1},{x:.3625,y:.15,w:.03125,h:.041666666666666664},{x:.3625,y:.15,w:.05,h:.06666666666666667},{x:.3625,y:.15,w:.075,h:.1},{x:.3875,y:.15,w:.03125,h:.041666666666666664},{x:.3875,y:.15,w:.05,h:.06666666666666667},{x:.3875,y:.15,w:.075,h:.1},{x:.4125,y:.15,w:.03125,h:.041666666666666664},{x:.4125,y:.15,w:.05,h:.06666666666666667},{x:.4125,y:.15,w:.075,h:.1},{x:.4375,y:.15,w:.03125,h:.041666666666666664},{x:.4375,y:.15,w:.05,h:.06666666666666667},{x:.4375,y:.15,w:.075,h:.1},{x:.4625,y:.15,w:.03125,h:.041666666666666664},{x:.4625,y:.15,w:.05,h:.06666666666666667},{x:.4625,y:.15,w:.075,h:.1},{x:.4875,y:.15,w:.03125,h:.041666666666666664},{x:.4875,y:.15,w:.05,h:.06666666666666667},{x:.4875,y:.15,w:.075,h:.1},{x:.5125,y:.15,w:.03125,h:.041666666666666664},{x:.5125,y:.15,w:.05,h:.06666666666666667},{x:.5125,y:.15,w:.075,h:.1},{x:.5375,y:.15,w:.03125,h:.041666666666666664},{x:.5375,y:.15,w:.05,h:.06666666666666667},{x:.5375,y:.15,w:.075,h:.1},{x:.5625,y:.15,w:.03125,h:.041666666666666664},{x:.5625,y:.15,w:.05,h:.06666666666666667},{x:.5625,y:.15,w:.075,h:.1},{x:.5875,y:.15,w:.03125,h:.041666666666666664},{x:.5875,y:.15,w:.05,h:.06666666666666667},{x:.5875,y:.15,w:.075,h:.1},{x:.6125,y:.15,w:.03125,h:.041666666666666664},{x:.6125,y:.15,w:.05,h:.06666666666666667},{x:.6125,y:.15,w:.075,h:.1},{x:.6375,y:.15,w:.03125,h:.041666666666666664},{x:.6375,y:.15,w:.05,h:.06666666666666667},{x:.6375,y:.15,w:.075,h:.1},{x:.6625,y:.15,w:.03125,h:.041666666666666664},{x:.6625,y:.15,w:.05,h:.06666666666666667},{x:.6625,y:.15,w:.075,h:.1},{x:.6875,y:.15,w:.03125,h:.041666666666666664},{x:.6875,y:.15,w:.05,h:.06666666666666667},{x:.6875,y:.15,w:.075,h:.1},{x:.7125,y:.15,w:.03125,h:.041666666666666664},{x:.7125,y:.15,w:.05,h:.06666666666666667},{x:.7125,y:.15,w:.075,h:.1},{x:.7375,y:.15,w:.03125,h:.041666666666666664},{x:.7375,y:.15,w:.05,h:.06666666666666667},{x:.7375,y:.15,w:.075,h:.1},{x:.7625,y:.15,w:.03125,h:.041666666666666664},{x:.7625,y:.15,w:.05,h:.06666666666666667},{x:.7625,y:.15,w:.075,h:.1},{x:.7875,y:.15,w:.03125,h:.041666666666666664},{x:.7875,y:.15,w:.05,h:.06666666666666667},{x:.7875,y:.15,w:.075,h:.1},{x:.8125,y:.15,w:.03125,h:.041666666666666664},{x:.8125,y:.15,w:.05,h:.06666666666666667},{x:.8125,y:.15,w:.075,h:.1},{x:.8375,y:.15,w:.03125,h:.041666666666666664},{x:.8375,y:.15,w:.05,h:.06666666666666667},{x:.8375,y:.15,w:.075,h:.1},{x:.8625,y:.15,w:.03125,h:.041666666666666664},{x:.8625,y:.15,w:.05,h:.06666666666666667},{x:.8625,y:.15,w:.075,h:.1},{x:.8875,y:.15,w:.03125,h:.041666666666666664},{x:.8875,y:.15,w:.05,h:.06666666666666667},{x:.8875,y:.15,w:.075,h:.1},{x:.9125,y:.15,w:.03125,h:.041666666666666664},{x:.9125,y:.15,w:.05,h:.06666666666666667},{x:.9125,y:.15,w:.075,h:.1},{x:.9375,y:.15,w:.03125,h:.041666666666666664},{x:.9375,y:.15,w:.05,h:.06666666666666667},{x:.9375,y:.15,w:.075,h:.1},{x:.9625,y:.15,w:.03125,h:.041666666666666664},{x:.9625,y:.15,w:.05,h:.06666666666666667},{x:.9625,y:.15,w:.075,h:.1},{x:.9875,y:.15,w:.03125,h:.041666666666666664},{x:.9875,y:.15,w:.05,h:.06666666666666667},{x:.9875,y:.15,w:.075,h:.1},{x:.0125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0125,y:.18333333333333332,w:.075,h:.1},{x:.0375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0375,y:.18333333333333332,w:.075,h:.1},{x:.0625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0625,y:.18333333333333332,w:.075,h:.1},{x:.0875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0875,y:.18333333333333332,w:.075,h:.1},{x:.1125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1125,y:.18333333333333332,w:.075,h:.1},{x:.1375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1375,y:.18333333333333332,w:.075,h:.1},{x:.1625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1625,y:.18333333333333332,w:.075,h:.1},{x:.1875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1875,y:.18333333333333332,w:.075,h:.1},{x:.2125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2125,y:.18333333333333332,w:.075,h:.1},{x:.2375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2375,y:.18333333333333332,w:.075,h:.1},{x:.2625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2625,y:.18333333333333332,w:.075,h:.1},{x:.2875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2875,y:.18333333333333332,w:.075,h:.1},{x:.3125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3125,y:.18333333333333332,w:.075,h:.1},{x:.3375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3375,y:.18333333333333332,w:.075,h:.1},{x:.3625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3625,y:.18333333333333332,w:.075,h:.1},{x:.3875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3875,y:.18333333333333332,w:.075,h:.1},{x:.4125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4125,y:.18333333333333332,w:.075,h:.1},{x:.4375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4375,y:.18333333333333332,w:.075,h:.1},{x:.4625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4625,y:.18333333333333332,w:.075,h:.1},{x:.4875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4875,y:.18333333333333332,w:.075,h:.1},{x:.5125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5125,y:.18333333333333332,w:.075,h:.1},{x:.5375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5375,y:.18333333333333332,w:.075,h:.1},{x:.5625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5625,y:.18333333333333332,w:.075,h:.1},{x:.5875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5875,y:.18333333333333332,w:.075,h:.1},{x:.6125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6125,y:.18333333333333332,w:.075,h:.1},{x:.6375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6375,y:.18333333333333332,w:.075,h:.1},{x:.6625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6625,y:.18333333333333332,w:.075,h:.1},{x:.6875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6875,y:.18333333333333332,w:.075,h:.1},{x:.7125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7125,y:.18333333333333332,w:.075,h:.1},{x:.7375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7375,y:.18333333333333332,w:.075,h:.1},{x:.7625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7625,y:.18333333333333332,w:.075,h:.1},{x:.7875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7875,y:.18333333333333332,w:.075,h:.1},{x:.8125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8125,y:.18333333333333332,w:.075,h:.1},{x:.8375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8375,y:.18333333333333332,w:.075,h:.1},{x:.8625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8625,y:.18333333333333332,w:.075,h:.1},{x:.8875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8875,y:.18333333333333332,w:.075,h:.1},{x:.9125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9125,y:.18333333333333332,w:.075,h:.1},{x:.9375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9375,y:.18333333333333332,w:.075,h:.1},{x:.9625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9625,y:.18333333333333332,w:.075,h:.1},{x:.9875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9875,y:.18333333333333332,w:.075,h:.1},{x:.0125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.21666666666666667,w:.075,h:.1},{x:.0375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.21666666666666667,w:.075,h:.1},{x:.0625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.21666666666666667,w:.075,h:.1},{x:.0875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.21666666666666667,w:.075,h:.1},{x:.1125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.21666666666666667,w:.075,h:.1},{x:.1375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.21666666666666667,w:.075,h:.1},{x:.1625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.21666666666666667,w:.075,h:.1},{x:.1875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.21666666666666667,w:.075,h:.1},{x:.2125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.21666666666666667,w:.075,h:.1},{x:.2375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.21666666666666667,w:.075,h:.1},{x:.2625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.21666666666666667,w:.075,h:.1},{x:.2875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.21666666666666667,w:.075,h:.1},{x:.3125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.21666666666666667,w:.075,h:.1},{x:.3375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.21666666666666667,w:.075,h:.1},{x:.3625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.21666666666666667,w:.075,h:.1},{x:.3875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.21666666666666667,w:.075,h:.1},{x:.4125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.21666666666666667,w:.075,h:.1},{x:.4375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.21666666666666667,w:.075,h:.1},{x:.4625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.21666666666666667,w:.075,h:.1},{x:.4875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.21666666666666667,w:.075,h:.1},{x:.5125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.21666666666666667,w:.075,h:.1},{x:.5375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.21666666666666667,w:.075,h:.1},{x:.5625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.21666666666666667,w:.075,h:.1},{x:.5875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.21666666666666667,w:.075,h:.1},{x:.6125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.21666666666666667,w:.075,h:.1},{x:.6375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.21666666666666667,w:.075,h:.1},{x:.6625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.21666666666666667,w:.075,h:.1},{x:.6875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.21666666666666667,w:.075,h:.1},{x:.7125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.21666666666666667,w:.075,h:.1},{x:.7375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.21666666666666667,w:.075,h:.1},{x:.7625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.21666666666666667,w:.075,h:.1},{x:.7875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.21666666666666667,w:.075,h:.1},{x:.8125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.21666666666666667,w:.075,h:.1},{x:.8375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.21666666666666667,w:.075,h:.1},{x:.8625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.21666666666666667,w:.075,h:.1},{x:.8875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.21666666666666667,w:.075,h:.1},{x:.9125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.21666666666666667,w:.075,h:.1},{x:.9375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.21666666666666667,w:.075,h:.1},{x:.9625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.21666666666666667,w:.075,h:.1},{x:.9875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.21666666666666667,w:.075,h:.1},{x:.0125,y:.25,w:.03125,h:.041666666666666664},{x:.0125,y:.25,w:.05,h:.06666666666666667},{x:.0125,y:.25,w:.075,h:.1},{x:.0375,y:.25,w:.03125,h:.041666666666666664},{x:.0375,y:.25,w:.05,h:.06666666666666667},{x:.0375,y:.25,w:.075,h:.1},{x:.0625,y:.25,w:.03125,h:.041666666666666664},{x:.0625,y:.25,w:.05,h:.06666666666666667},{x:.0625,y:.25,w:.075,h:.1},{x:.0875,y:.25,w:.03125,h:.041666666666666664},{x:.0875,y:.25,w:.05,h:.06666666666666667},{x:.0875,y:.25,w:.075,h:.1},{x:.1125,y:.25,w:.03125,h:.041666666666666664},{x:.1125,y:.25,w:.05,h:.06666666666666667},{x:.1125,y:.25,w:.075,h:.1},{x:.1375,y:.25,w:.03125,h:.041666666666666664},{x:.1375,y:.25,w:.05,h:.06666666666666667},{x:.1375,y:.25,w:.075,h:.1},{x:.1625,y:.25,w:.03125,h:.041666666666666664},{x:.1625,y:.25,w:.05,h:.06666666666666667},{x:.1625,y:.25,w:.075,h:.1},{x:.1875,y:.25,w:.03125,h:.041666666666666664},{x:.1875,y:.25,w:.05,h:.06666666666666667},{x:.1875,y:.25,w:.075,h:.1},{x:.2125,y:.25,w:.03125,h:.041666666666666664},{x:.2125,y:.25,w:.05,h:.06666666666666667},{x:.2125,y:.25,w:.075,h:.1},{x:.2375,y:.25,w:.03125,h:.041666666666666664},{x:.2375,y:.25,w:.05,h:.06666666666666667},{x:.2375,y:.25,w:.075,h:.1},{x:.2625,y:.25,w:.03125,h:.041666666666666664},{x:.2625,y:.25,w:.05,h:.06666666666666667},{x:.2625,y:.25,w:.075,h:.1},{x:.2875,y:.25,w:.03125,h:.041666666666666664},{x:.2875,y:.25,w:.05,h:.06666666666666667},{x:.2875,y:.25,w:.075,h:.1},{x:.3125,y:.25,w:.03125,h:.041666666666666664},{x:.3125,y:.25,w:.05,h:.06666666666666667},{x:.3125,y:.25,w:.075,h:.1},{x:.3375,y:.25,w:.03125,h:.041666666666666664},{x:.3375,y:.25,w:.05,h:.06666666666666667},{x:.3375,y:.25,w:.075,h:.1},{x:.3625,y:.25,w:.03125,h:.041666666666666664},{x:.3625,y:.25,w:.05,h:.06666666666666667},{x:.3625,y:.25,w:.075,h:.1},{x:.3875,y:.25,w:.03125,h:.041666666666666664},{x:.3875,y:.25,w:.05,h:.06666666666666667},{x:.3875,y:.25,w:.075,h:.1},{x:.4125,y:.25,w:.03125,h:.041666666666666664},{x:.4125,y:.25,w:.05,h:.06666666666666667},{x:.4125,y:.25,w:.075,h:.1},{x:.4375,y:.25,w:.03125,h:.041666666666666664},{x:.4375,y:.25,w:.05,h:.06666666666666667},{x:.4375,y:.25,w:.075,h:.1},{x:.4625,y:.25,w:.03125,h:.041666666666666664},{x:.4625,y:.25,w:.05,h:.06666666666666667},{x:.4625,y:.25,w:.075,h:.1},{x:.4875,y:.25,w:.03125,h:.041666666666666664},{x:.4875,y:.25,w:.05,h:.06666666666666667},{x:.4875,y:.25,w:.075,h:.1},{x:.5125,y:.25,w:.03125,h:.041666666666666664},{x:.5125,y:.25,w:.05,h:.06666666666666667},{x:.5125,y:.25,w:.075,h:.1},{x:.5375,y:.25,w:.03125,h:.041666666666666664},{x:.5375,y:.25,w:.05,h:.06666666666666667},{x:.5375,y:.25,w:.075,h:.1},{x:.5625,y:.25,w:.03125,h:.041666666666666664},{x:.5625,y:.25,w:.05,h:.06666666666666667},{x:.5625,y:.25,w:.075,h:.1},{x:.5875,y:.25,w:.03125,h:.041666666666666664},{x:.5875,y:.25,w:.05,h:.06666666666666667},{x:.5875,y:.25,w:.075,h:.1},{x:.6125,y:.25,w:.03125,h:.041666666666666664},{x:.6125,y:.25,w:.05,h:.06666666666666667},{x:.6125,y:.25,w:.075,h:.1},{x:.6375,y:.25,w:.03125,h:.041666666666666664},{x:.6375,y:.25,w:.05,h:.06666666666666667},{x:.6375,y:.25,w:.075,h:.1},{x:.6625,y:.25,w:.03125,h:.041666666666666664},{x:.6625,y:.25,w:.05,h:.06666666666666667},{x:.6625,y:.25,w:.075,h:.1},{x:.6875,y:.25,w:.03125,h:.041666666666666664},{x:.6875,y:.25,w:.05,h:.06666666666666667},{x:.6875,y:.25,w:.075,h:.1},{x:.7125,y:.25,w:.03125,h:.041666666666666664},{x:.7125,y:.25,w:.05,h:.06666666666666667},{x:.7125,y:.25,w:.075,h:.1},{x:.7375,y:.25,w:.03125,h:.041666666666666664},{x:.7375,y:.25,w:.05,h:.06666666666666667},{x:.7375,y:.25,w:.075,h:.1},{x:.7625,y:.25,w:.03125,h:.041666666666666664},{x:.7625,y:.25,w:.05,h:.06666666666666667},{x:.7625,y:.25,w:.075,h:.1},{x:.7875,y:.25,w:.03125,h:.041666666666666664},{x:.7875,y:.25,w:.05,h:.06666666666666667},{x:.7875,y:.25,w:.075,h:.1},{x:.8125,y:.25,w:.03125,h:.041666666666666664},{x:.8125,y:.25,w:.05,h:.06666666666666667},{x:.8125,y:.25,w:.075,h:.1},{x:.8375,y:.25,w:.03125,h:.041666666666666664},{x:.8375,y:.25,w:.05,h:.06666666666666667},{x:.8375,y:.25,w:.075,h:.1},{x:.8625,y:.25,w:.03125,h:.041666666666666664},{x:.8625,y:.25,w:.05,h:.06666666666666667},{x:.8625,y:.25,w:.075,h:.1},{x:.8875,y:.25,w:.03125,h:.041666666666666664},{x:.8875,y:.25,w:.05,h:.06666666666666667},{x:.8875,y:.25,w:.075,h:.1},{x:.9125,y:.25,w:.03125,h:.041666666666666664},{x:.9125,y:.25,w:.05,h:.06666666666666667},{x:.9125,y:.25,w:.075,h:.1},{x:.9375,y:.25,w:.03125,h:.041666666666666664},{x:.9375,y:.25,w:.05,h:.06666666666666667},{x:.9375,y:.25,w:.075,h:.1},{x:.9625,y:.25,w:.03125,h:.041666666666666664},{x:.9625,y:.25,w:.05,h:.06666666666666667},{x:.9625,y:.25,w:.075,h:.1},{x:.9875,y:.25,w:.03125,h:.041666666666666664},{x:.9875,y:.25,w:.05,h:.06666666666666667},{x:.9875,y:.25,w:.075,h:.1},{x:.0125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.2833333333333333,w:.075,h:.1},{x:.0375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.2833333333333333,w:.075,h:.1},{x:.0625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.2833333333333333,w:.075,h:.1},{x:.0875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.2833333333333333,w:.075,h:.1},{x:.1125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.2833333333333333,w:.075,h:.1},{x:.1375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.2833333333333333,w:.075,h:.1},{x:.1625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.2833333333333333,w:.075,h:.1},{x:.1875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.2833333333333333,w:.075,h:.1},{x:.2125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.2833333333333333,w:.075,h:.1},{x:.2375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.2833333333333333,w:.075,h:.1},{x:.2625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.2833333333333333,w:.075,h:.1},{x:.2875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.2833333333333333,w:.075,h:.1},{x:.3125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.2833333333333333,w:.075,h:.1},{x:.3375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.2833333333333333,w:.075,h:.1},{x:.3625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.2833333333333333,w:.075,h:.1},{x:.3875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.2833333333333333,w:.075,h:.1},{x:.4125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.2833333333333333,w:.075,h:.1},{x:.4375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.2833333333333333,w:.075,h:.1},{x:.4625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.2833333333333333,w:.075,h:.1},{x:.4875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.2833333333333333,w:.075,h:.1},{x:.5125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.2833333333333333,w:.075,h:.1},{x:.5375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.2833333333333333,w:.075,h:.1},{x:.5625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.2833333333333333,w:.075,h:.1},{x:.5875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.2833333333333333,w:.075,h:.1},{x:.6125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.2833333333333333,w:.075,h:.1},{x:.6375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.2833333333333333,w:.075,h:.1},{x:.6625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.2833333333333333,w:.075,h:.1},{x:.6875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.2833333333333333,w:.075,h:.1},{x:.7125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.2833333333333333,w:.075,h:.1},{x:.7375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.2833333333333333,w:.075,h:.1},{x:.7625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.2833333333333333,w:.075,h:.1},{x:.7875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.2833333333333333,w:.075,h:.1},{x:.8125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.2833333333333333,w:.075,h:.1},{x:.8375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.2833333333333333,w:.075,h:.1},{x:.8625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.2833333333333333,w:.075,h:.1},{x:.8875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.2833333333333333,w:.075,h:.1},{x:.9125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.2833333333333333,w:.075,h:.1},{x:.9375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.2833333333333333,w:.075,h:.1},{x:.9625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.2833333333333333,w:.075,h:.1},{x:.9875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.2833333333333333,w:.075,h:.1},{x:.0125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0125,y:.31666666666666665,w:.075,h:.1},{x:.0375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0375,y:.31666666666666665,w:.075,h:.1},{x:.0625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0625,y:.31666666666666665,w:.075,h:.1},{x:.0875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0875,y:.31666666666666665,w:.075,h:.1},{x:.1125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1125,y:.31666666666666665,w:.075,h:.1},{x:.1375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1375,y:.31666666666666665,w:.075,h:.1},{x:.1625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1625,y:.31666666666666665,w:.075,h:.1},{x:.1875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1875,y:.31666666666666665,w:.075,h:.1},{x:.2125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2125,y:.31666666666666665,w:.075,h:.1},{x:.2375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2375,y:.31666666666666665,w:.075,h:.1},{x:.2625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2625,y:.31666666666666665,w:.075,h:.1},{x:.2875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2875,y:.31666666666666665,w:.075,h:.1},{x:.3125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3125,y:.31666666666666665,w:.075,h:.1},{x:.3375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3375,y:.31666666666666665,w:.075,h:.1},{x:.3625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3625,y:.31666666666666665,w:.075,h:.1},{x:.3875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3875,y:.31666666666666665,w:.075,h:.1},{x:.4125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4125,y:.31666666666666665,w:.075,h:.1},{x:.4375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4375,y:.31666666666666665,w:.075,h:.1},{x:.4625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4625,y:.31666666666666665,w:.075,h:.1},{x:.4875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4875,y:.31666666666666665,w:.075,h:.1},{x:.5125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5125,y:.31666666666666665,w:.075,h:.1},{x:.5375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5375,y:.31666666666666665,w:.075,h:.1},{x:.5625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5625,y:.31666666666666665,w:.075,h:.1},{x:.5875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5875,y:.31666666666666665,w:.075,h:.1},{x:.6125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6125,y:.31666666666666665,w:.075,h:.1},{x:.6375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6375,y:.31666666666666665,w:.075,h:.1},{x:.6625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6625,y:.31666666666666665,w:.075,h:.1},{x:.6875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6875,y:.31666666666666665,w:.075,h:.1},{x:.7125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7125,y:.31666666666666665,w:.075,h:.1},{x:.7375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7375,y:.31666666666666665,w:.075,h:.1},{x:.7625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7625,y:.31666666666666665,w:.075,h:.1},{x:.7875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7875,y:.31666666666666665,w:.075,h:.1},{x:.8125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8125,y:.31666666666666665,w:.075,h:.1},{x:.8375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8375,y:.31666666666666665,w:.075,h:.1},{x:.8625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8625,y:.31666666666666665,w:.075,h:.1},{x:.8875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8875,y:.31666666666666665,w:.075,h:.1},{x:.9125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9125,y:.31666666666666665,w:.075,h:.1},{x:.9375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9375,y:.31666666666666665,w:.075,h:.1},{x:.9625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9625,y:.31666666666666665,w:.075,h:.1},{x:.9875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9875,y:.31666666666666665,w:.075,h:.1},{x:.0125,y:.35,w:.03125,h:.041666666666666664},{x:.0125,y:.35,w:.05,h:.06666666666666667},{x:.0125,y:.35,w:.075,h:.1},{x:.0375,y:.35,w:.03125,h:.041666666666666664},{x:.0375,y:.35,w:.05,h:.06666666666666667},{x:.0375,y:.35,w:.075,h:.1},{x:.0625,y:.35,w:.03125,h:.041666666666666664},{x:.0625,y:.35,w:.05,h:.06666666666666667},{x:.0625,y:.35,w:.075,h:.1},{x:.0875,y:.35,w:.03125,h:.041666666666666664},{x:.0875,y:.35,w:.05,h:.06666666666666667},{x:.0875,y:.35,w:.075,h:.1},{x:.1125,y:.35,w:.03125,h:.041666666666666664},{x:.1125,y:.35,w:.05,h:.06666666666666667},{x:.1125,y:.35,w:.075,h:.1},{x:.1375,y:.35,w:.03125,h:.041666666666666664},{x:.1375,y:.35,w:.05,h:.06666666666666667},{x:.1375,y:.35,w:.075,h:.1},{x:.1625,y:.35,w:.03125,h:.041666666666666664},{x:.1625,y:.35,w:.05,h:.06666666666666667},{x:.1625,y:.35,w:.075,h:.1},{x:.1875,y:.35,w:.03125,h:.041666666666666664},{x:.1875,y:.35,w:.05,h:.06666666666666667},{x:.1875,y:.35,w:.075,h:.1},{x:.2125,y:.35,w:.03125,h:.041666666666666664},{x:.2125,y:.35,w:.05,h:.06666666666666667},{x:.2125,y:.35,w:.075,h:.1},{x:.2375,y:.35,w:.03125,h:.041666666666666664},{x:.2375,y:.35,w:.05,h:.06666666666666667},{x:.2375,y:.35,w:.075,h:.1},{x:.2625,y:.35,w:.03125,h:.041666666666666664},{x:.2625,y:.35,w:.05,h:.06666666666666667},{x:.2625,y:.35,w:.075,h:.1},{x:.2875,y:.35,w:.03125,h:.041666666666666664},{x:.2875,y:.35,w:.05,h:.06666666666666667},{x:.2875,y:.35,w:.075,h:.1},{x:.3125,y:.35,w:.03125,h:.041666666666666664},{x:.3125,y:.35,w:.05,h:.06666666666666667},{x:.3125,y:.35,w:.075,h:.1},{x:.3375,y:.35,w:.03125,h:.041666666666666664},{x:.3375,y:.35,w:.05,h:.06666666666666667},{x:.3375,y:.35,w:.075,h:.1},{x:.3625,y:.35,w:.03125,h:.041666666666666664},{x:.3625,y:.35,w:.05,h:.06666666666666667},{x:.3625,y:.35,w:.075,h:.1},{x:.3875,y:.35,w:.03125,h:.041666666666666664},{x:.3875,y:.35,w:.05,h:.06666666666666667},{x:.3875,y:.35,w:.075,h:.1},{x:.4125,y:.35,w:.03125,h:.041666666666666664},{x:.4125,y:.35,w:.05,h:.06666666666666667},{x:.4125,y:.35,w:.075,h:.1},{x:.4375,y:.35,w:.03125,h:.041666666666666664},{x:.4375,y:.35,w:.05,h:.06666666666666667},{x:.4375,y:.35,w:.075,h:.1},{x:.4625,y:.35,w:.03125,h:.041666666666666664},{x:.4625,y:.35,w:.05,h:.06666666666666667},{x:.4625,y:.35,w:.075,h:.1},{x:.4875,y:.35,w:.03125,h:.041666666666666664},{x:.4875,y:.35,w:.05,h:.06666666666666667},{x:.4875,y:.35,w:.075,h:.1},{x:.5125,y:.35,w:.03125,h:.041666666666666664},{x:.5125,y:.35,w:.05,h:.06666666666666667},{x:.5125,y:.35,w:.075,h:.1},{x:.5375,y:.35,w:.03125,h:.041666666666666664},{x:.5375,y:.35,w:.05,h:.06666666666666667},{x:.5375,y:.35,w:.075,h:.1},{x:.5625,y:.35,w:.03125,h:.041666666666666664},{x:.5625,y:.35,w:.05,h:.06666666666666667},{x:.5625,y:.35,w:.075,h:.1},{x:.5875,y:.35,w:.03125,h:.041666666666666664},{x:.5875,y:.35,w:.05,h:.06666666666666667},{x:.5875,y:.35,w:.075,h:.1},{x:.6125,y:.35,w:.03125,h:.041666666666666664},{x:.6125,y:.35,w:.05,h:.06666666666666667},{x:.6125,y:.35,w:.075,h:.1},{x:.6375,y:.35,w:.03125,h:.041666666666666664},{x:.6375,y:.35,w:.05,h:.06666666666666667},{x:.6375,y:.35,w:.075,h:.1},{x:.6625,y:.35,w:.03125,h:.041666666666666664},{x:.6625,y:.35,w:.05,h:.06666666666666667},{x:.6625,y:.35,w:.075,h:.1},{x:.6875,y:.35,w:.03125,h:.041666666666666664},{x:.6875,y:.35,w:.05,h:.06666666666666667},{x:.6875,y:.35,w:.075,h:.1},{x:.7125,y:.35,w:.03125,h:.041666666666666664},{x:.7125,y:.35,w:.05,h:.06666666666666667},{x:.7125,y:.35,w:.075,h:.1},{x:.7375,y:.35,w:.03125,h:.041666666666666664},{x:.7375,y:.35,w:.05,h:.06666666666666667},{x:.7375,y:.35,w:.075,h:.1},{x:.7625,y:.35,w:.03125,h:.041666666666666664},{x:.7625,y:.35,w:.05,h:.06666666666666667},{x:.7625,y:.35,w:.075,h:.1},{x:.7875,y:.35,w:.03125,h:.041666666666666664},{x:.7875,y:.35,w:.05,h:.06666666666666667},{x:.7875,y:.35,w:.075,h:.1},{x:.8125,y:.35,w:.03125,h:.041666666666666664},{x:.8125,y:.35,w:.05,h:.06666666666666667},{x:.8125,y:.35,w:.075,h:.1},{x:.8375,y:.35,w:.03125,h:.041666666666666664},{x:.8375,y:.35,w:.05,h:.06666666666666667},{x:.8375,y:.35,w:.075,h:.1},{x:.8625,y:.35,w:.03125,h:.041666666666666664},{x:.8625,y:.35,w:.05,h:.06666666666666667},{x:.8625,y:.35,w:.075,h:.1},{x:.8875,y:.35,w:.03125,h:.041666666666666664},{x:.8875,y:.35,w:.05,h:.06666666666666667},{x:.8875,y:.35,w:.075,h:.1},{x:.9125,y:.35,w:.03125,h:.041666666666666664},{x:.9125,y:.35,w:.05,h:.06666666666666667},{x:.9125,y:.35,w:.075,h:.1},{x:.9375,y:.35,w:.03125,h:.041666666666666664},{x:.9375,y:.35,w:.05,h:.06666666666666667},{x:.9375,y:.35,w:.075,h:.1},{x:.9625,y:.35,w:.03125,h:.041666666666666664},{x:.9625,y:.35,w:.05,h:.06666666666666667},{x:.9625,y:.35,w:.075,h:.1},{x:.9875,y:.35,w:.03125,h:.041666666666666664},{x:.9875,y:.35,w:.05,h:.06666666666666667},{x:.9875,y:.35,w:.075,h:.1},{x:.0125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0125,y:.38333333333333336,w:.075,h:.1},{x:.0375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0375,y:.38333333333333336,w:.075,h:.1},{x:.0625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0625,y:.38333333333333336,w:.075,h:.1},{x:.0875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0875,y:.38333333333333336,w:.075,h:.1},{x:.1125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1125,y:.38333333333333336,w:.075,h:.1},{x:.1375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1375,y:.38333333333333336,w:.075,h:.1},{x:.1625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1625,y:.38333333333333336,w:.075,h:.1},{x:.1875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1875,y:.38333333333333336,w:.075,h:.1},{x:.2125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2125,y:.38333333333333336,w:.075,h:.1},{x:.2375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2375,y:.38333333333333336,w:.075,h:.1},{x:.2625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2625,y:.38333333333333336,w:.075,h:.1},{x:.2875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2875,y:.38333333333333336,w:.075,h:.1},{x:.3125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3125,y:.38333333333333336,w:.075,h:.1},{x:.3375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3375,y:.38333333333333336,w:.075,h:.1},{x:.3625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3625,y:.38333333333333336,w:.075,h:.1},{x:.3875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3875,y:.38333333333333336,w:.075,h:.1},{x:.4125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4125,y:.38333333333333336,w:.075,h:.1},{x:.4375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4375,y:.38333333333333336,w:.075,h:.1},{x:.4625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4625,y:.38333333333333336,w:.075,h:.1},{x:.4875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4875,y:.38333333333333336,w:.075,h:.1},{x:.5125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5125,y:.38333333333333336,w:.075,h:.1},{x:.5375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5375,y:.38333333333333336,w:.075,h:.1},{x:.5625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5625,y:.38333333333333336,w:.075,h:.1},{x:.5875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5875,y:.38333333333333336,w:.075,h:.1},{x:.6125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6125,y:.38333333333333336,w:.075,h:.1},{x:.6375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6375,y:.38333333333333336,w:.075,h:.1},{x:.6625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6625,y:.38333333333333336,w:.075,h:.1},{x:.6875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6875,y:.38333333333333336,w:.075,h:.1},{x:.7125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7125,y:.38333333333333336,w:.075,h:.1},{x:.7375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7375,y:.38333333333333336,w:.075,h:.1},{x:.7625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7625,y:.38333333333333336,w:.075,h:.1},{x:.7875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7875,y:.38333333333333336,w:.075,h:.1},{x:.8125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8125,y:.38333333333333336,w:.075,h:.1},{x:.8375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8375,y:.38333333333333336,w:.075,h:.1},{x:.8625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8625,y:.38333333333333336,w:.075,h:.1},{x:.8875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8875,y:.38333333333333336,w:.075,h:.1},{x:.9125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9125,y:.38333333333333336,w:.075,h:.1},{x:.9375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9375,y:.38333333333333336,w:.075,h:.1},{x:.9625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9625,y:.38333333333333336,w:.075,h:.1},{x:.9875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9875,y:.38333333333333336,w:.075,h:.1},{x:.0125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.4166666666666667,w:.075,h:.1},{x:.0375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.4166666666666667,w:.075,h:.1},{x:.0625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.4166666666666667,w:.075,h:.1},{x:.0875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.4166666666666667,w:.075,h:.1},{x:.1125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.4166666666666667,w:.075,h:.1},{x:.1375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.4166666666666667,w:.075,h:.1},{x:.1625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.4166666666666667,w:.075,h:.1},{x:.1875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.4166666666666667,w:.075,h:.1},{x:.2125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.4166666666666667,w:.075,h:.1},{x:.2375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.4166666666666667,w:.075,h:.1},{x:.2625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.4166666666666667,w:.075,h:.1},{x:.2875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.4166666666666667,w:.075,h:.1},{x:.3125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.4166666666666667,w:.075,h:.1},{x:.3375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.4166666666666667,w:.075,h:.1},{x:.3625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.4166666666666667,w:.075,h:.1},{x:.3875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.4166666666666667,w:.075,h:.1},{x:.4125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.4166666666666667,w:.075,h:.1},{x:.4375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.4166666666666667,w:.075,h:.1},{x:.4625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.4166666666666667,w:.075,h:.1},{x:.4875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.4166666666666667,w:.075,h:.1},{x:.5125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.4166666666666667,w:.075,h:.1},{x:.5375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.4166666666666667,w:.075,h:.1},{x:.5625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.4166666666666667,w:.075,h:.1},{x:.5875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.4166666666666667,w:.075,h:.1},{x:.6125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.4166666666666667,w:.075,h:.1},{x:.6375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.4166666666666667,w:.075,h:.1},{x:.6625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.4166666666666667,w:.075,h:.1},{x:.6875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.4166666666666667,w:.075,h:.1},{x:.7125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.4166666666666667,w:.075,h:.1},{x:.7375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.4166666666666667,w:.075,h:.1},{x:.7625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.4166666666666667,w:.075,h:.1},{x:.7875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.4166666666666667,w:.075,h:.1},{x:.8125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.4166666666666667,w:.075,h:.1},{x:.8375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.4166666666666667,w:.075,h:.1},{x:.8625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.4166666666666667,w:.075,h:.1},{x:.8875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.4166666666666667,w:.075,h:.1},{x:.9125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.4166666666666667,w:.075,h:.1},{x:.9375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.4166666666666667,w:.075,h:.1},{x:.9625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.4166666666666667,w:.075,h:.1},{x:.9875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.4166666666666667,w:.075,h:.1},{x:.0125,y:.45,w:.03125,h:.041666666666666664},{x:.0125,y:.45,w:.05,h:.06666666666666667},{x:.0125,y:.45,w:.075,h:.1},{x:.0375,y:.45,w:.03125,h:.041666666666666664},{x:.0375,y:.45,w:.05,h:.06666666666666667},{x:.0375,y:.45,w:.075,h:.1},{x:.0625,y:.45,w:.03125,h:.041666666666666664},{x:.0625,y:.45,w:.05,h:.06666666666666667},{x:.0625,y:.45,w:.075,h:.1},{x:.0875,y:.45,w:.03125,h:.041666666666666664},{x:.0875,y:.45,w:.05,h:.06666666666666667},{x:.0875,y:.45,w:.075,h:.1},{x:.1125,y:.45,w:.03125,h:.041666666666666664},{x:.1125,y:.45,w:.05,h:.06666666666666667},{x:.1125,y:.45,w:.075,h:.1},{x:.1375,y:.45,w:.03125,h:.041666666666666664},{x:.1375,y:.45,w:.05,h:.06666666666666667},{x:.1375,y:.45,w:.075,h:.1},{x:.1625,y:.45,w:.03125,h:.041666666666666664},{x:.1625,y:.45,w:.05,h:.06666666666666667},{x:.1625,y:.45,w:.075,h:.1},{x:.1875,y:.45,w:.03125,h:.041666666666666664},{x:.1875,y:.45,w:.05,h:.06666666666666667},{x:.1875,y:.45,w:.075,h:.1},{x:.2125,y:.45,w:.03125,h:.041666666666666664},{x:.2125,y:.45,w:.05,h:.06666666666666667},{x:.2125,y:.45,w:.075,h:.1},{x:.2375,y:.45,w:.03125,h:.041666666666666664},{x:.2375,y:.45,w:.05,h:.06666666666666667},{x:.2375,y:.45,w:.075,h:.1},{x:.2625,y:.45,w:.03125,h:.041666666666666664},{x:.2625,y:.45,w:.05,h:.06666666666666667},{x:.2625,y:.45,w:.075,h:.1},{x:.2875,y:.45,w:.03125,h:.041666666666666664},{x:.2875,y:.45,w:.05,h:.06666666666666667},{x:.2875,y:.45,w:.075,h:.1},{x:.3125,y:.45,w:.03125,h:.041666666666666664},{x:.3125,y:.45,w:.05,h:.06666666666666667},{x:.3125,y:.45,w:.075,h:.1},{x:.3375,y:.45,w:.03125,h:.041666666666666664},{x:.3375,y:.45,w:.05,h:.06666666666666667},{x:.3375,y:.45,w:.075,h:.1},{x:.3625,y:.45,w:.03125,h:.041666666666666664},{x:.3625,y:.45,w:.05,h:.06666666666666667},{x:.3625,y:.45,w:.075,h:.1},{x:.3875,y:.45,w:.03125,h:.041666666666666664},{x:.3875,y:.45,w:.05,h:.06666666666666667},{x:.3875,y:.45,w:.075,h:.1},{x:.4125,y:.45,w:.03125,h:.041666666666666664},{x:.4125,y:.45,w:.05,h:.06666666666666667},{x:.4125,y:.45,w:.075,h:.1},{x:.4375,y:.45,w:.03125,h:.041666666666666664},{x:.4375,y:.45,w:.05,h:.06666666666666667},{x:.4375,y:.45,w:.075,h:.1},{x:.4625,y:.45,w:.03125,h:.041666666666666664},{x:.4625,y:.45,w:.05,h:.06666666666666667},{x:.4625,y:.45,w:.075,h:.1},{x:.4875,y:.45,w:.03125,h:.041666666666666664},{x:.4875,y:.45,w:.05,h:.06666666666666667},{x:.4875,y:.45,w:.075,h:.1},{x:.5125,y:.45,w:.03125,h:.041666666666666664},{x:.5125,y:.45,w:.05,h:.06666666666666667},{x:.5125,y:.45,w:.075,h:.1},{x:.5375,y:.45,w:.03125,h:.041666666666666664},{x:.5375,y:.45,w:.05,h:.06666666666666667},{x:.5375,y:.45,w:.075,h:.1},{x:.5625,y:.45,w:.03125,h:.041666666666666664},{x:.5625,y:.45,w:.05,h:.06666666666666667},{x:.5625,y:.45,w:.075,h:.1},{x:.5875,y:.45,w:.03125,h:.041666666666666664},{x:.5875,y:.45,w:.05,h:.06666666666666667},{x:.5875,y:.45,w:.075,h:.1},{x:.6125,y:.45,w:.03125,h:.041666666666666664},{x:.6125,y:.45,w:.05,h:.06666666666666667},{x:.6125,y:.45,w:.075,h:.1},{x:.6375,y:.45,w:.03125,h:.041666666666666664},{x:.6375,y:.45,w:.05,h:.06666666666666667},{x:.6375,y:.45,w:.075,h:.1},{x:.6625,y:.45,w:.03125,h:.041666666666666664},{x:.6625,y:.45,w:.05,h:.06666666666666667},{x:.6625,y:.45,w:.075,h:.1},{x:.6875,y:.45,w:.03125,h:.041666666666666664},{x:.6875,y:.45,w:.05,h:.06666666666666667},{x:.6875,y:.45,w:.075,h:.1},{x:.7125,y:.45,w:.03125,h:.041666666666666664},{x:.7125,y:.45,w:.05,h:.06666666666666667},{x:.7125,y:.45,w:.075,h:.1},{x:.7375,y:.45,w:.03125,h:.041666666666666664},{x:.7375,y:.45,w:.05,h:.06666666666666667},{x:.7375,y:.45,w:.075,h:.1},{x:.7625,y:.45,w:.03125,h:.041666666666666664},{x:.7625,y:.45,w:.05,h:.06666666666666667},{x:.7625,y:.45,w:.075,h:.1},{x:.7875,y:.45,w:.03125,h:.041666666666666664},{x:.7875,y:.45,w:.05,h:.06666666666666667},{x:.7875,y:.45,w:.075,h:.1},{x:.8125,y:.45,w:.03125,h:.041666666666666664},{x:.8125,y:.45,w:.05,h:.06666666666666667},{x:.8125,y:.45,w:.075,h:.1},{x:.8375,y:.45,w:.03125,h:.041666666666666664},{x:.8375,y:.45,w:.05,h:.06666666666666667},{x:.8375,y:.45,w:.075,h:.1},{x:.8625,y:.45,w:.03125,h:.041666666666666664},{x:.8625,y:.45,w:.05,h:.06666666666666667},{x:.8625,y:.45,w:.075,h:.1},{x:.8875,y:.45,w:.03125,h:.041666666666666664},{x:.8875,y:.45,w:.05,h:.06666666666666667},{x:.8875,y:.45,w:.075,h:.1},{x:.9125,y:.45,w:.03125,h:.041666666666666664},{x:.9125,y:.45,w:.05,h:.06666666666666667},{x:.9125,y:.45,w:.075,h:.1},{x:.9375,y:.45,w:.03125,h:.041666666666666664},{x:.9375,y:.45,w:.05,h:.06666666666666667},{x:.9375,y:.45,w:.075,h:.1},{x:.9625,y:.45,w:.03125,h:.041666666666666664},{x:.9625,y:.45,w:.05,h:.06666666666666667},{x:.9625,y:.45,w:.075,h:.1},{x:.9875,y:.45,w:.03125,h:.041666666666666664},{x:.9875,y:.45,w:.05,h:.06666666666666667},{x:.9875,y:.45,w:.075,h:.1},{x:.0125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.48333333333333334,w:.075,h:.1},{x:.0375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.48333333333333334,w:.075,h:.1},{x:.0625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.48333333333333334,w:.075,h:.1},{x:.0875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.48333333333333334,w:.075,h:.1},{x:.1125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.48333333333333334,w:.075,h:.1},{x:.1375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.48333333333333334,w:.075,h:.1},{x:.1625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.48333333333333334,w:.075,h:.1},{x:.1875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.48333333333333334,w:.075,h:.1},{x:.2125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.48333333333333334,w:.075,h:.1},{x:.2375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.48333333333333334,w:.075,h:.1},{x:.2625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.48333333333333334,w:.075,h:.1},{x:.2875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.48333333333333334,w:.075,h:.1},{x:.3125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.48333333333333334,w:.075,h:.1},{x:.3375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.48333333333333334,w:.075,h:.1},{x:.3625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.48333333333333334,w:.075,h:.1},{x:.3875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.48333333333333334,w:.075,h:.1},{x:.4125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.48333333333333334,w:.075,h:.1},{x:.4375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.48333333333333334,w:.075,h:.1},{x:.4625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.48333333333333334,w:.075,h:.1},{x:.4875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.48333333333333334,w:.075,h:.1},{x:.5125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.48333333333333334,w:.075,h:.1},{x:.5375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.48333333333333334,w:.075,h:.1},{x:.5625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.48333333333333334,w:.075,h:.1},{x:.5875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.48333333333333334,w:.075,h:.1},{x:.6125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.48333333333333334,w:.075,h:.1},{x:.6375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.48333333333333334,w:.075,h:.1},{x:.6625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.48333333333333334,w:.075,h:.1},{x:.6875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.48333333333333334,w:.075,h:.1},{x:.7125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.48333333333333334,w:.075,h:.1},{x:.7375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.48333333333333334,w:.075,h:.1},{x:.7625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.48333333333333334,w:.075,h:.1},{x:.7875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.48333333333333334,w:.075,h:.1},{x:.8125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.48333333333333334,w:.075,h:.1},{x:.8375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.48333333333333334,w:.075,h:.1},{x:.8625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.48333333333333334,w:.075,h:.1},{x:.8875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.48333333333333334,w:.075,h:.1},{x:.9125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.48333333333333334,w:.075,h:.1},{x:.9375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.48333333333333334,w:.075,h:.1},{x:.9625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.48333333333333334,w:.075,h:.1},{x:.9875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.48333333333333334,w:.075,h:.1},{x:.0125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.5166666666666667,w:.075,h:.1},{x:.0375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.5166666666666667,w:.075,h:.1},{x:.0625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.5166666666666667,w:.075,h:.1},{x:.0875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.5166666666666667,w:.075,h:.1},{x:.1125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.5166666666666667,w:.075,h:.1},{x:.1375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.5166666666666667,w:.075,h:.1},{x:.1625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.5166666666666667,w:.075,h:.1},{x:.1875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.5166666666666667,w:.075,h:.1},{x:.2125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.5166666666666667,w:.075,h:.1},{x:.2375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.5166666666666667,w:.075,h:.1},{x:.2625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.5166666666666667,w:.075,h:.1},{x:.2875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.5166666666666667,w:.075,h:.1},{x:.3125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.5166666666666667,w:.075,h:.1},{x:.3375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.5166666666666667,w:.075,h:.1},{x:.3625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.5166666666666667,w:.075,h:.1},{x:.3875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.5166666666666667,w:.075,h:.1},{x:.4125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.5166666666666667,w:.075,h:.1},{x:.4375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.5166666666666667,w:.075,h:.1},{x:.4625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.5166666666666667,w:.075,h:.1},{x:.4875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.5166666666666667,w:.075,h:.1},{x:.5125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.5166666666666667,w:.075,h:.1},{x:.5375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.5166666666666667,w:.075,h:.1},{x:.5625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.5166666666666667,w:.075,h:.1},{x:.5875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.5166666666666667,w:.075,h:.1},{x:.6125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.5166666666666667,w:.075,h:.1},{x:.6375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.5166666666666667,w:.075,h:.1},{x:.6625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.5166666666666667,w:.075,h:.1},{x:.6875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.5166666666666667,w:.075,h:.1},{x:.7125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.5166666666666667,w:.075,h:.1},{x:.7375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.5166666666666667,w:.075,h:.1},{x:.7625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.5166666666666667,w:.075,h:.1},{x:.7875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.5166666666666667,w:.075,h:.1},{x:.8125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.5166666666666667,w:.075,h:.1},{x:.8375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.5166666666666667,w:.075,h:.1},{x:.8625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.5166666666666667,w:.075,h:.1},{x:.8875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.5166666666666667,w:.075,h:.1},{x:.9125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.5166666666666667,w:.075,h:.1},{x:.9375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.5166666666666667,w:.075,h:.1},{x:.9625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.5166666666666667,w:.075,h:.1},{x:.9875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.5166666666666667,w:.075,h:.1},{x:.0125,y:.55,w:.03125,h:.041666666666666664},{x:.0125,y:.55,w:.05,h:.06666666666666667},{x:.0125,y:.55,w:.075,h:.1},{x:.0375,y:.55,w:.03125,h:.041666666666666664},{x:.0375,y:.55,w:.05,h:.06666666666666667},{x:.0375,y:.55,w:.075,h:.1},{x:.0625,y:.55,w:.03125,h:.041666666666666664},{x:.0625,y:.55,w:.05,h:.06666666666666667},{x:.0625,y:.55,w:.075,h:.1},{x:.0875,y:.55,w:.03125,h:.041666666666666664},{x:.0875,y:.55,w:.05,h:.06666666666666667},{x:.0875,y:.55,w:.075,h:.1},{x:.1125,y:.55,w:.03125,h:.041666666666666664},{x:.1125,y:.55,w:.05,h:.06666666666666667},{x:.1125,y:.55,w:.075,h:.1},{x:.1375,y:.55,w:.03125,h:.041666666666666664},{x:.1375,y:.55,w:.05,h:.06666666666666667},{x:.1375,y:.55,w:.075,h:.1},{x:.1625,y:.55,w:.03125,h:.041666666666666664},{x:.1625,y:.55,w:.05,h:.06666666666666667},{x:.1625,y:.55,w:.075,h:.1},{x:.1875,y:.55,w:.03125,h:.041666666666666664},{x:.1875,y:.55,w:.05,h:.06666666666666667},{x:.1875,y:.55,w:.075,h:.1},{x:.2125,y:.55,w:.03125,h:.041666666666666664},{x:.2125,y:.55,w:.05,h:.06666666666666667},{x:.2125,y:.55,w:.075,h:.1},{x:.2375,y:.55,w:.03125,h:.041666666666666664},{x:.2375,y:.55,w:.05,h:.06666666666666667},{x:.2375,y:.55,w:.075,h:.1},{x:.2625,y:.55,w:.03125,h:.041666666666666664},{x:.2625,y:.55,w:.05,h:.06666666666666667},{x:.2625,y:.55,w:.075,h:.1},{x:.2875,y:.55,w:.03125,h:.041666666666666664},{x:.2875,y:.55,w:.05,h:.06666666666666667},{x:.2875,y:.55,w:.075,h:.1},{x:.3125,y:.55,w:.03125,h:.041666666666666664},{x:.3125,y:.55,w:.05,h:.06666666666666667},{x:.3125,y:.55,w:.075,h:.1},{x:.3375,y:.55,w:.03125,h:.041666666666666664},{x:.3375,y:.55,w:.05,h:.06666666666666667},{x:.3375,y:.55,w:.075,h:.1},{x:.3625,y:.55,w:.03125,h:.041666666666666664},{x:.3625,y:.55,w:.05,h:.06666666666666667},{x:.3625,y:.55,w:.075,h:.1},{x:.3875,y:.55,w:.03125,h:.041666666666666664},{x:.3875,y:.55,w:.05,h:.06666666666666667},{x:.3875,y:.55,w:.075,h:.1},{x:.4125,y:.55,w:.03125,h:.041666666666666664},{x:.4125,y:.55,w:.05,h:.06666666666666667},{x:.4125,y:.55,w:.075,h:.1},{x:.4375,y:.55,w:.03125,h:.041666666666666664},{x:.4375,y:.55,w:.05,h:.06666666666666667},{x:.4375,y:.55,w:.075,h:.1},{x:.4625,y:.55,w:.03125,h:.041666666666666664},{x:.4625,y:.55,w:.05,h:.06666666666666667},{x:.4625,y:.55,w:.075,h:.1},{x:.4875,y:.55,w:.03125,h:.041666666666666664},{x:.4875,y:.55,w:.05,h:.06666666666666667},{x:.4875,y:.55,w:.075,h:.1},{x:.5125,y:.55,w:.03125,h:.041666666666666664},{x:.5125,y:.55,w:.05,h:.06666666666666667},{x:.5125,y:.55,w:.075,h:.1},{x:.5375,y:.55,w:.03125,h:.041666666666666664},{x:.5375,y:.55,w:.05,h:.06666666666666667},{x:.5375,y:.55,w:.075,h:.1},{x:.5625,y:.55,w:.03125,h:.041666666666666664},{x:.5625,y:.55,w:.05,h:.06666666666666667},{x:.5625,y:.55,w:.075,h:.1},{x:.5875,y:.55,w:.03125,h:.041666666666666664},{x:.5875,y:.55,w:.05,h:.06666666666666667},{x:.5875,y:.55,w:.075,h:.1},{x:.6125,y:.55,w:.03125,h:.041666666666666664},{x:.6125,y:.55,w:.05,h:.06666666666666667},{x:.6125,y:.55,w:.075,h:.1},{x:.6375,y:.55,w:.03125,h:.041666666666666664},{x:.6375,y:.55,w:.05,h:.06666666666666667},{x:.6375,y:.55,w:.075,h:.1},{x:.6625,y:.55,w:.03125,h:.041666666666666664},{x:.6625,y:.55,w:.05,h:.06666666666666667},{x:.6625,y:.55,w:.075,h:.1},{x:.6875,y:.55,w:.03125,h:.041666666666666664},{x:.6875,y:.55,w:.05,h:.06666666666666667},{x:.6875,y:.55,w:.075,h:.1},{x:.7125,y:.55,w:.03125,h:.041666666666666664},{x:.7125,y:.55,w:.05,h:.06666666666666667},{x:.7125,y:.55,w:.075,h:.1},{x:.7375,y:.55,w:.03125,h:.041666666666666664},{x:.7375,y:.55,w:.05,h:.06666666666666667},{x:.7375,y:.55,w:.075,h:.1},{x:.7625,y:.55,w:.03125,h:.041666666666666664},{x:.7625,y:.55,w:.05,h:.06666666666666667},{x:.7625,y:.55,w:.075,h:.1},{x:.7875,y:.55,w:.03125,h:.041666666666666664},{x:.7875,y:.55,w:.05,h:.06666666666666667},{x:.7875,y:.55,w:.075,h:.1},{x:.8125,y:.55,w:.03125,h:.041666666666666664},{x:.8125,y:.55,w:.05,h:.06666666666666667},{x:.8125,y:.55,w:.075,h:.1},{x:.8375,y:.55,w:.03125,h:.041666666666666664},{x:.8375,y:.55,w:.05,h:.06666666666666667},{x:.8375,y:.55,w:.075,h:.1},{x:.8625,y:.55,w:.03125,h:.041666666666666664},{x:.8625,y:.55,w:.05,h:.06666666666666667},{x:.8625,y:.55,w:.075,h:.1},{x:.8875,y:.55,w:.03125,h:.041666666666666664},{x:.8875,y:.55,w:.05,h:.06666666666666667},{x:.8875,y:.55,w:.075,h:.1},{x:.9125,y:.55,w:.03125,h:.041666666666666664},{x:.9125,y:.55,w:.05,h:.06666666666666667},{x:.9125,y:.55,w:.075,h:.1},{x:.9375,y:.55,w:.03125,h:.041666666666666664},{x:.9375,y:.55,w:.05,h:.06666666666666667},{x:.9375,y:.55,w:.075,h:.1},{x:.9625,y:.55,w:.03125,h:.041666666666666664},{x:.9625,y:.55,w:.05,h:.06666666666666667},{x:.9625,y:.55,w:.075,h:.1},{x:.9875,y:.55,w:.03125,h:.041666666666666664},{x:.9875,y:.55,w:.05,h:.06666666666666667},{x:.9875,y:.55,w:.075,h:.1},{x:.0125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.5833333333333334,w:.075,h:.1},{x:.0375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.5833333333333334,w:.075,h:.1},{x:.0625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.5833333333333334,w:.075,h:.1},{x:.0875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.5833333333333334,w:.075,h:.1},{x:.1125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.5833333333333334,w:.075,h:.1},{x:.1375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.5833333333333334,w:.075,h:.1},{x:.1625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.5833333333333334,w:.075,h:.1},{x:.1875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.5833333333333334,w:.075,h:.1},{x:.2125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.5833333333333334,w:.075,h:.1},{x:.2375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.5833333333333334,w:.075,h:.1},{x:.2625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.5833333333333334,w:.075,h:.1},{x:.2875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.5833333333333334,w:.075,h:.1},{x:.3125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.5833333333333334,w:.075,h:.1},{x:.3375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.5833333333333334,w:.075,h:.1},{x:.3625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.5833333333333334,w:.075,h:.1},{x:.3875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.5833333333333334,w:.075,h:.1},{x:.4125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.5833333333333334,w:.075,h:.1},{x:.4375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.5833333333333334,w:.075,h:.1},{x:.4625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.5833333333333334,w:.075,h:.1},{x:.4875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.5833333333333334,w:.075,h:.1},{x:.5125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.5833333333333334,w:.075,h:.1},{x:.5375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.5833333333333334,w:.075,h:.1},{x:.5625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.5833333333333334,w:.075,h:.1},{x:.5875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.5833333333333334,w:.075,h:.1},{x:.6125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.5833333333333334,w:.075,h:.1},{x:.6375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.5833333333333334,w:.075,h:.1},{x:.6625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.5833333333333334,w:.075,h:.1},{x:.6875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.5833333333333334,w:.075,h:.1},{x:.7125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.5833333333333334,w:.075,h:.1},{x:.7375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.5833333333333334,w:.075,h:.1},{x:.7625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.5833333333333334,w:.075,h:.1},{x:.7875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.5833333333333334,w:.075,h:.1},{x:.8125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.5833333333333334,w:.075,h:.1},{x:.8375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.5833333333333334,w:.075,h:.1},{x:.8625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.5833333333333334,w:.075,h:.1},{x:.8875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.5833333333333334,w:.075,h:.1},{x:.9125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.5833333333333334,w:.075,h:.1},{x:.9375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.5833333333333334,w:.075,h:.1},{x:.9625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.5833333333333334,w:.075,h:.1},{x:.9875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.5833333333333334,w:.075,h:.1},{x:.0125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.6166666666666667,w:.075,h:.1},{x:.0375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.6166666666666667,w:.075,h:.1},{x:.0625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.6166666666666667,w:.075,h:.1},{x:.0875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.6166666666666667,w:.075,h:.1},{x:.1125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.6166666666666667,w:.075,h:.1},{x:.1375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.6166666666666667,w:.075,h:.1},{x:.1625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.6166666666666667,w:.075,h:.1},{x:.1875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.6166666666666667,w:.075,h:.1},{x:.2125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.6166666666666667,w:.075,h:.1},{x:.2375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.6166666666666667,w:.075,h:.1},{x:.2625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.6166666666666667,w:.075,h:.1},{x:.2875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.6166666666666667,w:.075,h:.1},{x:.3125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.6166666666666667,w:.075,h:.1},{x:.3375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.6166666666666667,w:.075,h:.1},{x:.3625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.6166666666666667,w:.075,h:.1},{x:.3875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.6166666666666667,w:.075,h:.1},{x:.4125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.6166666666666667,w:.075,h:.1},{x:.4375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.6166666666666667,w:.075,h:.1},{x:.4625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.6166666666666667,w:.075,h:.1},{x:.4875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.6166666666666667,w:.075,h:.1},{x:.5125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.6166666666666667,w:.075,h:.1},{x:.5375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.6166666666666667,w:.075,h:.1},{x:.5625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.6166666666666667,w:.075,h:.1},{x:.5875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.6166666666666667,w:.075,h:.1},{x:.6125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.6166666666666667,w:.075,h:.1},{x:.6375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.6166666666666667,w:.075,h:.1},{x:.6625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.6166666666666667,w:.075,h:.1},{x:.6875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.6166666666666667,w:.075,h:.1},{x:.7125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.6166666666666667,w:.075,h:.1},{x:.7375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.6166666666666667,w:.075,h:.1},{x:.7625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.6166666666666667,w:.075,h:.1},{x:.7875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.6166666666666667,w:.075,h:.1},{x:.8125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.6166666666666667,w:.075,h:.1},{x:.8375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.6166666666666667,w:.075,h:.1},{x:.8625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.6166666666666667,w:.075,h:.1},{x:.8875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.6166666666666667,w:.075,h:.1},{x:.9125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.6166666666666667,w:.075,h:.1},{x:.9375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.6166666666666667,w:.075,h:.1},{x:.9625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.6166666666666667,w:.075,h:.1},{x:.9875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.6166666666666667,w:.075,h:.1},{x:.0125,y:.65,w:.03125,h:.041666666666666664},{x:.0125,y:.65,w:.05,h:.06666666666666667},{x:.0125,y:.65,w:.075,h:.1},{x:.0375,y:.65,w:.03125,h:.041666666666666664},{x:.0375,y:.65,w:.05,h:.06666666666666667},{x:.0375,y:.65,w:.075,h:.1},{x:.0625,y:.65,w:.03125,h:.041666666666666664},{x:.0625,y:.65,w:.05,h:.06666666666666667},{x:.0625,y:.65,w:.075,h:.1},{x:.0875,y:.65,w:.03125,h:.041666666666666664},{x:.0875,y:.65,w:.05,h:.06666666666666667},{x:.0875,y:.65,w:.075,h:.1},{x:.1125,y:.65,w:.03125,h:.041666666666666664},{x:.1125,y:.65,w:.05,h:.06666666666666667},{x:.1125,y:.65,w:.075,h:.1},{x:.1375,y:.65,w:.03125,h:.041666666666666664},{x:.1375,y:.65,w:.05,h:.06666666666666667},{x:.1375,y:.65,w:.075,h:.1},{x:.1625,y:.65,w:.03125,h:.041666666666666664},{x:.1625,y:.65,w:.05,h:.06666666666666667},{x:.1625,y:.65,w:.075,h:.1},{x:.1875,y:.65,w:.03125,h:.041666666666666664},{x:.1875,y:.65,w:.05,h:.06666666666666667},{x:.1875,y:.65,w:.075,h:.1},{x:.2125,y:.65,w:.03125,h:.041666666666666664},{x:.2125,y:.65,w:.05,h:.06666666666666667},{x:.2125,y:.65,w:.075,h:.1},{x:.2375,y:.65,w:.03125,h:.041666666666666664},{x:.2375,y:.65,w:.05,h:.06666666666666667},{x:.2375,y:.65,w:.075,h:.1},{x:.2625,y:.65,w:.03125,h:.041666666666666664},{x:.2625,y:.65,w:.05,h:.06666666666666667},{x:.2625,y:.65,w:.075,h:.1},{x:.2875,y:.65,w:.03125,h:.041666666666666664},{x:.2875,y:.65,w:.05,h:.06666666666666667},{x:.2875,y:.65,w:.075,h:.1},{x:.3125,y:.65,w:.03125,h:.041666666666666664},{x:.3125,y:.65,w:.05,h:.06666666666666667},{x:.3125,y:.65,w:.075,h:.1},{x:.3375,y:.65,w:.03125,h:.041666666666666664},{x:.3375,y:.65,w:.05,h:.06666666666666667},{x:.3375,y:.65,w:.075,h:.1},{x:.3625,y:.65,w:.03125,h:.041666666666666664},{x:.3625,y:.65,w:.05,h:.06666666666666667},{x:.3625,y:.65,w:.075,h:.1},{x:.3875,y:.65,w:.03125,h:.041666666666666664},{x:.3875,y:.65,w:.05,h:.06666666666666667},{x:.3875,y:.65,w:.075,h:.1},{x:.4125,y:.65,w:.03125,h:.041666666666666664},{x:.4125,y:.65,w:.05,h:.06666666666666667},{x:.4125,y:.65,w:.075,h:.1},{x:.4375,y:.65,w:.03125,h:.041666666666666664},{x:.4375,y:.65,w:.05,h:.06666666666666667},{x:.4375,y:.65,w:.075,h:.1},{x:.4625,y:.65,w:.03125,h:.041666666666666664},{x:.4625,y:.65,w:.05,h:.06666666666666667},{x:.4625,y:.65,w:.075,h:.1},{x:.4875,y:.65,w:.03125,h:.041666666666666664},{x:.4875,y:.65,w:.05,h:.06666666666666667},{x:.4875,y:.65,w:.075,h:.1},{x:.5125,y:.65,w:.03125,h:.041666666666666664},{x:.5125,y:.65,w:.05,h:.06666666666666667},{x:.5125,y:.65,w:.075,h:.1},{x:.5375,y:.65,w:.03125,h:.041666666666666664},{x:.5375,y:.65,w:.05,h:.06666666666666667},{x:.5375,y:.65,w:.075,h:.1},{x:.5625,y:.65,w:.03125,h:.041666666666666664},{x:.5625,y:.65,w:.05,h:.06666666666666667},{x:.5625,y:.65,w:.075,h:.1},{x:.5875,y:.65,w:.03125,h:.041666666666666664},{x:.5875,y:.65,w:.05,h:.06666666666666667},{x:.5875,y:.65,w:.075,h:.1},{x:.6125,y:.65,w:.03125,h:.041666666666666664},{x:.6125,y:.65,w:.05,h:.06666666666666667},{x:.6125,y:.65,w:.075,h:.1},{x:.6375,y:.65,w:.03125,h:.041666666666666664},{x:.6375,y:.65,w:.05,h:.06666666666666667},{x:.6375,y:.65,w:.075,h:.1},{x:.6625,y:.65,w:.03125,h:.041666666666666664},{x:.6625,y:.65,w:.05,h:.06666666666666667},{x:.6625,y:.65,w:.075,h:.1},{x:.6875,y:.65,w:.03125,h:.041666666666666664},{x:.6875,y:.65,w:.05,h:.06666666666666667},{x:.6875,y:.65,w:.075,h:.1},{x:.7125,y:.65,w:.03125,h:.041666666666666664},{x:.7125,y:.65,w:.05,h:.06666666666666667},{x:.7125,y:.65,w:.075,h:.1},{x:.7375,y:.65,w:.03125,h:.041666666666666664},{x:.7375,y:.65,w:.05,h:.06666666666666667},{x:.7375,y:.65,w:.075,h:.1},{x:.7625,y:.65,w:.03125,h:.041666666666666664},{x:.7625,y:.65,w:.05,h:.06666666666666667},{x:.7625,y:.65,w:.075,h:.1},{x:.7875,y:.65,w:.03125,h:.041666666666666664},{x:.7875,y:.65,w:.05,h:.06666666666666667},{x:.7875,y:.65,w:.075,h:.1},{x:.8125,y:.65,w:.03125,h:.041666666666666664},{x:.8125,y:.65,w:.05,h:.06666666666666667},{x:.8125,y:.65,w:.075,h:.1},{x:.8375,y:.65,w:.03125,h:.041666666666666664},{x:.8375,y:.65,w:.05,h:.06666666666666667},{x:.8375,y:.65,w:.075,h:.1},{x:.8625,y:.65,w:.03125,h:.041666666666666664},{x:.8625,y:.65,w:.05,h:.06666666666666667},{x:.8625,y:.65,w:.075,h:.1},{x:.8875,y:.65,w:.03125,h:.041666666666666664},{x:.8875,y:.65,w:.05,h:.06666666666666667},{x:.8875,y:.65,w:.075,h:.1},{x:.9125,y:.65,w:.03125,h:.041666666666666664},{x:.9125,y:.65,w:.05,h:.06666666666666667},{x:.9125,y:.65,w:.075,h:.1},{x:.9375,y:.65,w:.03125,h:.041666666666666664},{x:.9375,y:.65,w:.05,h:.06666666666666667},{x:.9375,y:.65,w:.075,h:.1},{x:.9625,y:.65,w:.03125,h:.041666666666666664},{x:.9625,y:.65,w:.05,h:.06666666666666667},{x:.9625,y:.65,w:.075,h:.1},{x:.9875,y:.65,w:.03125,h:.041666666666666664},{x:.9875,y:.65,w:.05,h:.06666666666666667},{x:.9875,y:.65,w:.075,h:.1},{x:.0125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.6833333333333333,w:.075,h:.1},{x:.0375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.6833333333333333,w:.075,h:.1},{x:.0625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.6833333333333333,w:.075,h:.1},{x:.0875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.6833333333333333,w:.075,h:.1},{x:.1125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.6833333333333333,w:.075,h:.1},{x:.1375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.6833333333333333,w:.075,h:.1},{x:.1625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.6833333333333333,w:.075,h:.1},{x:.1875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.6833333333333333,w:.075,h:.1},{x:.2125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.6833333333333333,w:.075,h:.1},{x:.2375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.6833333333333333,w:.075,h:.1},{x:.2625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.6833333333333333,w:.075,h:.1},{x:.2875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.6833333333333333,w:.075,h:.1},{x:.3125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.6833333333333333,w:.075,h:.1},{x:.3375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.6833333333333333,w:.075,h:.1},{x:.3625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.6833333333333333,w:.075,h:.1},{x:.3875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.6833333333333333,w:.075,h:.1},{x:.4125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.6833333333333333,w:.075,h:.1},{x:.4375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.6833333333333333,w:.075,h:.1},{x:.4625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.6833333333333333,w:.075,h:.1},{x:.4875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.6833333333333333,w:.075,h:.1},{x:.5125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.6833333333333333,w:.075,h:.1},{x:.5375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.6833333333333333,w:.075,h:.1},{x:.5625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.6833333333333333,w:.075,h:.1},{x:.5875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.6833333333333333,w:.075,h:.1},{x:.6125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.6833333333333333,w:.075,h:.1},{x:.6375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.6833333333333333,w:.075,h:.1},{x:.6625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.6833333333333333,w:.075,h:.1},{x:.6875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.6833333333333333,w:.075,h:.1},{x:.7125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.6833333333333333,w:.075,h:.1},{x:.7375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.6833333333333333,w:.075,h:.1},{x:.7625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.6833333333333333,w:.075,h:.1},{x:.7875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.6833333333333333,w:.075,h:.1},{x:.8125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.6833333333333333,w:.075,h:.1},{x:.8375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.6833333333333333,w:.075,h:.1},{x:.8625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.6833333333333333,w:.075,h:.1},{x:.8875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.6833333333333333,w:.075,h:.1},{x:.9125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.6833333333333333,w:.075,h:.1},{x:.9375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.6833333333333333,w:.075,h:.1},{x:.9625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.6833333333333333,w:.075,h:.1},{x:.9875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.6833333333333333,w:.075,h:.1},{x:.0125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.7166666666666667,w:.075,h:.1},{x:.0375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.7166666666666667,w:.075,h:.1},{x:.0625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.7166666666666667,w:.075,h:.1},{x:.0875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.7166666666666667,w:.075,h:.1},{x:.1125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.7166666666666667,w:.075,h:.1},{x:.1375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.7166666666666667,w:.075,h:.1},{x:.1625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.7166666666666667,w:.075,h:.1},{x:.1875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.7166666666666667,w:.075,h:.1},{x:.2125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.7166666666666667,w:.075,h:.1},{x:.2375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.7166666666666667,w:.075,h:.1},{x:.2625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.7166666666666667,w:.075,h:.1},{x:.2875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.7166666666666667,w:.075,h:.1},{x:.3125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.7166666666666667,w:.075,h:.1},{x:.3375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.7166666666666667,w:.075,h:.1},{x:.3625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.7166666666666667,w:.075,h:.1},{x:.3875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.7166666666666667,w:.075,h:.1},{x:.4125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.7166666666666667,w:.075,h:.1},{x:.4375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.7166666666666667,w:.075,h:.1},{x:.4625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.7166666666666667,w:.075,h:.1},{x:.4875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.7166666666666667,w:.075,h:.1},{x:.5125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.7166666666666667,w:.075,h:.1},{x:.5375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.7166666666666667,w:.075,h:.1},{x:.5625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.7166666666666667,w:.075,h:.1},{x:.5875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.7166666666666667,w:.075,h:.1},{x:.6125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.7166666666666667,w:.075,h:.1},{x:.6375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.7166666666666667,w:.075,h:.1},{x:.6625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.7166666666666667,w:.075,h:.1},{x:.6875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.7166666666666667,w:.075,h:.1},{x:.7125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.7166666666666667,w:.075,h:.1},{x:.7375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.7166666666666667,w:.075,h:.1},{x:.7625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.7166666666666667,w:.075,h:.1},{x:.7875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.7166666666666667,w:.075,h:.1},{x:.8125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.7166666666666667,w:.075,h:.1},{x:.8375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.7166666666666667,w:.075,h:.1},{x:.8625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.7166666666666667,w:.075,h:.1},{x:.8875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.7166666666666667,w:.075,h:.1},{x:.9125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.7166666666666667,w:.075,h:.1},{x:.9375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.7166666666666667,w:.075,h:.1},{x:.9625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.7166666666666667,w:.075,h:.1},{x:.9875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.7166666666666667,w:.075,h:.1},{x:.0125,y:.75,w:.03125,h:.041666666666666664},{x:.0125,y:.75,w:.05,h:.06666666666666667},{x:.0125,y:.75,w:.075,h:.1},{x:.0375,y:.75,w:.03125,h:.041666666666666664},{x:.0375,y:.75,w:.05,h:.06666666666666667},{x:.0375,y:.75,w:.075,h:.1},{x:.0625,y:.75,w:.03125,h:.041666666666666664},{x:.0625,y:.75,w:.05,h:.06666666666666667},{x:.0625,y:.75,w:.075,h:.1},{x:.0875,y:.75,w:.03125,h:.041666666666666664},{x:.0875,y:.75,w:.05,h:.06666666666666667},{x:.0875,y:.75,w:.075,h:.1},{x:.1125,y:.75,w:.03125,h:.041666666666666664},{x:.1125,y:.75,w:.05,h:.06666666666666667},{x:.1125,y:.75,w:.075,h:.1},{x:.1375,y:.75,w:.03125,h:.041666666666666664},{x:.1375,y:.75,w:.05,h:.06666666666666667},{x:.1375,y:.75,w:.075,h:.1},{x:.1625,y:.75,w:.03125,h:.041666666666666664},{x:.1625,y:.75,w:.05,h:.06666666666666667},{x:.1625,y:.75,w:.075,h:.1},{x:.1875,y:.75,w:.03125,h:.041666666666666664},{x:.1875,y:.75,w:.05,h:.06666666666666667},{x:.1875,y:.75,w:.075,h:.1},{x:.2125,y:.75,w:.03125,h:.041666666666666664},{x:.2125,y:.75,w:.05,h:.06666666666666667},{x:.2125,y:.75,w:.075,h:.1},{x:.2375,y:.75,w:.03125,h:.041666666666666664},{x:.2375,y:.75,w:.05,h:.06666666666666667},{x:.2375,y:.75,w:.075,h:.1},{x:.2625,y:.75,w:.03125,h:.041666666666666664},{x:.2625,y:.75,w:.05,h:.06666666666666667},{x:.2625,y:.75,w:.075,h:.1},{x:.2875,y:.75,w:.03125,h:.041666666666666664},{x:.2875,y:.75,w:.05,h:.06666666666666667},{x:.2875,y:.75,w:.075,h:.1},{x:.3125,y:.75,w:.03125,h:.041666666666666664},{x:.3125,y:.75,w:.05,h:.06666666666666667},{x:.3125,y:.75,w:.075,h:.1},{x:.3375,y:.75,w:.03125,h:.041666666666666664},{x:.3375,y:.75,w:.05,h:.06666666666666667},{x:.3375,y:.75,w:.075,h:.1},{x:.3625,y:.75,w:.03125,h:.041666666666666664},{x:.3625,y:.75,w:.05,h:.06666666666666667},{x:.3625,y:.75,w:.075,h:.1},{x:.3875,y:.75,w:.03125,h:.041666666666666664},{x:.3875,y:.75,w:.05,h:.06666666666666667},{x:.3875,y:.75,w:.075,h:.1},{x:.4125,y:.75,w:.03125,h:.041666666666666664},{x:.4125,y:.75,w:.05,h:.06666666666666667},{x:.4125,y:.75,w:.075,h:.1},{x:.4375,y:.75,w:.03125,h:.041666666666666664},{x:.4375,y:.75,w:.05,h:.06666666666666667},{x:.4375,y:.75,w:.075,h:.1},{x:.4625,y:.75,w:.03125,h:.041666666666666664},{x:.4625,y:.75,w:.05,h:.06666666666666667},{x:.4625,y:.75,w:.075,h:.1},{x:.4875,y:.75,w:.03125,h:.041666666666666664},{x:.4875,y:.75,w:.05,h:.06666666666666667},{x:.4875,y:.75,w:.075,h:.1},{x:.5125,y:.75,w:.03125,h:.041666666666666664},{x:.5125,y:.75,w:.05,h:.06666666666666667},{x:.5125,y:.75,w:.075,h:.1},{x:.5375,y:.75,w:.03125,h:.041666666666666664},{x:.5375,y:.75,w:.05,h:.06666666666666667},{x:.5375,y:.75,w:.075,h:.1},{x:.5625,y:.75,w:.03125,h:.041666666666666664},{x:.5625,y:.75,w:.05,h:.06666666666666667},{x:.5625,y:.75,w:.075,h:.1},{x:.5875,y:.75,w:.03125,h:.041666666666666664},{x:.5875,y:.75,w:.05,h:.06666666666666667},{x:.5875,y:.75,w:.075,h:.1},{x:.6125,y:.75,w:.03125,h:.041666666666666664},{x:.6125,y:.75,w:.05,h:.06666666666666667},{x:.6125,y:.75,w:.075,h:.1},{x:.6375,y:.75,w:.03125,h:.041666666666666664},{x:.6375,y:.75,w:.05,h:.06666666666666667},{x:.6375,y:.75,w:.075,h:.1},{x:.6625,y:.75,w:.03125,h:.041666666666666664},{x:.6625,y:.75,w:.05,h:.06666666666666667},{x:.6625,y:.75,w:.075,h:.1},{x:.6875,y:.75,w:.03125,h:.041666666666666664},{x:.6875,y:.75,w:.05,h:.06666666666666667},{x:.6875,y:.75,w:.075,h:.1},{x:.7125,y:.75,w:.03125,h:.041666666666666664},{x:.7125,y:.75,w:.05,h:.06666666666666667},{x:.7125,y:.75,w:.075,h:.1},{x:.7375,y:.75,w:.03125,h:.041666666666666664},{x:.7375,y:.75,w:.05,h:.06666666666666667},{x:.7375,y:.75,w:.075,h:.1},{x:.7625,y:.75,w:.03125,h:.041666666666666664},{x:.7625,y:.75,w:.05,h:.06666666666666667},{x:.7625,y:.75,w:.075,h:.1},{x:.7875,y:.75,w:.03125,h:.041666666666666664},{x:.7875,y:.75,w:.05,h:.06666666666666667},{x:.7875,y:.75,w:.075,h:.1},{x:.8125,y:.75,w:.03125,h:.041666666666666664},{x:.8125,y:.75,w:.05,h:.06666666666666667},{x:.8125,y:.75,w:.075,h:.1},{x:.8375,y:.75,w:.03125,h:.041666666666666664},{x:.8375,y:.75,w:.05,h:.06666666666666667},{x:.8375,y:.75,w:.075,h:.1},{x:.8625,y:.75,w:.03125,h:.041666666666666664},{x:.8625,y:.75,w:.05,h:.06666666666666667},{x:.8625,y:.75,w:.075,h:.1},{x:.8875,y:.75,w:.03125,h:.041666666666666664},{x:.8875,y:.75,w:.05,h:.06666666666666667},{x:.8875,y:.75,w:.075,h:.1},{x:.9125,y:.75,w:.03125,h:.041666666666666664},{x:.9125,y:.75,w:.05,h:.06666666666666667},{x:.9125,y:.75,w:.075,h:.1},{x:.9375,y:.75,w:.03125,h:.041666666666666664},{x:.9375,y:.75,w:.05,h:.06666666666666667},{x:.9375,y:.75,w:.075,h:.1},{x:.9625,y:.75,w:.03125,h:.041666666666666664},{x:.9625,y:.75,w:.05,h:.06666666666666667},{x:.9625,y:.75,w:.075,h:.1},{x:.9875,y:.75,w:.03125,h:.041666666666666664},{x:.9875,y:.75,w:.05,h:.06666666666666667},{x:.9875,y:.75,w:.075,h:.1},{x:.0125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.7833333333333333,w:.075,h:.1},{x:.0375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.7833333333333333,w:.075,h:.1},{x:.0625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.7833333333333333,w:.075,h:.1},{x:.0875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.7833333333333333,w:.075,h:.1},{x:.1125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.7833333333333333,w:.075,h:.1},{x:.1375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.7833333333333333,w:.075,h:.1},{x:.1625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.7833333333333333,w:.075,h:.1},{x:.1875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.7833333333333333,w:.075,h:.1},{x:.2125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.7833333333333333,w:.075,h:.1},{x:.2375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.7833333333333333,w:.075,h:.1},{x:.2625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.7833333333333333,w:.075,h:.1},{x:.2875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.7833333333333333,w:.075,h:.1},{x:.3125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.7833333333333333,w:.075,h:.1},{x:.3375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.7833333333333333,w:.075,h:.1},{x:.3625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.7833333333333333,w:.075,h:.1},{x:.3875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.7833333333333333,w:.075,h:.1},{x:.4125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.7833333333333333,w:.075,h:.1},{x:.4375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.7833333333333333,w:.075,h:.1},{x:.4625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.7833333333333333,w:.075,h:.1},{x:.4875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.7833333333333333,w:.075,h:.1},{x:.5125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.7833333333333333,w:.075,h:.1},{x:.5375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.7833333333333333,w:.075,h:.1},{x:.5625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.7833333333333333,w:.075,h:.1},{x:.5875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.7833333333333333,w:.075,h:.1},{x:.6125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.7833333333333333,w:.075,h:.1},{x:.6375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.7833333333333333,w:.075,h:.1},{x:.6625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.7833333333333333,w:.075,h:.1},{x:.6875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.7833333333333333,w:.075,h:.1},{x:.7125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.7833333333333333,w:.075,h:.1},{x:.7375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.7833333333333333,w:.075,h:.1},{x:.7625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.7833333333333333,w:.075,h:.1},{x:.7875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.7833333333333333,w:.075,h:.1},{x:.8125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.7833333333333333,w:.075,h:.1},{x:.8375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.7833333333333333,w:.075,h:.1},{x:.8625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.7833333333333333,w:.075,h:.1},{x:.8875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.7833333333333333,w:.075,h:.1},{x:.9125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.7833333333333333,w:.075,h:.1},{x:.9375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.7833333333333333,w:.075,h:.1},{x:.9625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.7833333333333333,w:.075,h:.1},{x:.9875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.7833333333333333,w:.075,h:.1},{x:.0125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.8166666666666667,w:.075,h:.1},{x:.0375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.8166666666666667,w:.075,h:.1},{x:.0625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.8166666666666667,w:.075,h:.1},{x:.0875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.8166666666666667,w:.075,h:.1},{x:.1125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.8166666666666667,w:.075,h:.1},{x:.1375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.8166666666666667,w:.075,h:.1},{x:.1625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.8166666666666667,w:.075,h:.1},{x:.1875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.8166666666666667,w:.075,h:.1},{x:.2125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.8166666666666667,w:.075,h:.1},{x:.2375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.8166666666666667,w:.075,h:.1},{x:.2625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.8166666666666667,w:.075,h:.1},{x:.2875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.8166666666666667,w:.075,h:.1},{x:.3125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.8166666666666667,w:.075,h:.1},{x:.3375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.8166666666666667,w:.075,h:.1},{x:.3625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.8166666666666667,w:.075,h:.1},{x:.3875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.8166666666666667,w:.075,h:.1},{x:.4125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.8166666666666667,w:.075,h:.1},{x:.4375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.8166666666666667,w:.075,h:.1},{x:.4625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.8166666666666667,w:.075,h:.1},{x:.4875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.8166666666666667,w:.075,h:.1},{x:.5125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.8166666666666667,w:.075,h:.1},{x:.5375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.8166666666666667,w:.075,h:.1},{x:.5625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.8166666666666667,w:.075,h:.1},{x:.5875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.8166666666666667,w:.075,h:.1},{x:.6125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.8166666666666667,w:.075,h:.1},{x:.6375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.8166666666666667,w:.075,h:.1},{x:.6625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.8166666666666667,w:.075,h:.1},{x:.6875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.8166666666666667,w:.075,h:.1},{x:.7125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.8166666666666667,w:.075,h:.1},{x:.7375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.8166666666666667,w:.075,h:.1},{x:.7625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.8166666666666667,w:.075,h:.1},{x:.7875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.8166666666666667,w:.075,h:.1},{x:.8125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.8166666666666667,w:.075,h:.1},{x:.8375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.8166666666666667,w:.075,h:.1},{x:.8625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.8166666666666667,w:.075,h:.1},{x:.8875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.8166666666666667,w:.075,h:.1},{x:.9125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.8166666666666667,w:.075,h:.1},{x:.9375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.8166666666666667,w:.075,h:.1},{x:.9625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.8166666666666667,w:.075,h:.1},{x:.9875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.8166666666666667,w:.075,h:.1},{x:.0125,y:.85,w:.03125,h:.041666666666666664},{x:.0125,y:.85,w:.05,h:.06666666666666667},{x:.0125,y:.85,w:.075,h:.1},{x:.0375,y:.85,w:.03125,h:.041666666666666664},{x:.0375,y:.85,w:.05,h:.06666666666666667},{x:.0375,y:.85,w:.075,h:.1},{x:.0625,y:.85,w:.03125,h:.041666666666666664},{x:.0625,y:.85,w:.05,h:.06666666666666667},{x:.0625,y:.85,w:.075,h:.1},{x:.0875,y:.85,w:.03125,h:.041666666666666664},{x:.0875,y:.85,w:.05,h:.06666666666666667},{x:.0875,y:.85,w:.075,h:.1},{x:.1125,y:.85,w:.03125,h:.041666666666666664},{x:.1125,y:.85,w:.05,h:.06666666666666667},{x:.1125,y:.85,w:.075,h:.1},{x:.1375,y:.85,w:.03125,h:.041666666666666664},{x:.1375,y:.85,w:.05,h:.06666666666666667},{x:.1375,y:.85,w:.075,h:.1},{x:.1625,y:.85,w:.03125,h:.041666666666666664},{x:.1625,y:.85,w:.05,h:.06666666666666667},{x:.1625,y:.85,w:.075,h:.1},{x:.1875,y:.85,w:.03125,h:.041666666666666664},{x:.1875,y:.85,w:.05,h:.06666666666666667},{x:.1875,y:.85,w:.075,h:.1},{x:.2125,y:.85,w:.03125,h:.041666666666666664},{x:.2125,y:.85,w:.05,h:.06666666666666667},{x:.2125,y:.85,w:.075,h:.1},{x:.2375,y:.85,w:.03125,h:.041666666666666664},{x:.2375,y:.85,w:.05,h:.06666666666666667},{x:.2375,y:.85,w:.075,h:.1},{x:.2625,y:.85,w:.03125,h:.041666666666666664},{x:.2625,y:.85,w:.05,h:.06666666666666667},{x:.2625,y:.85,w:.075,h:.1},{x:.2875,y:.85,w:.03125,h:.041666666666666664},{x:.2875,y:.85,w:.05,h:.06666666666666667},{x:.2875,y:.85,w:.075,h:.1},{x:.3125,y:.85,w:.03125,h:.041666666666666664},{x:.3125,y:.85,w:.05,h:.06666666666666667},{x:.3125,y:.85,w:.075,h:.1},{x:.3375,y:.85,w:.03125,h:.041666666666666664},{x:.3375,y:.85,w:.05,h:.06666666666666667},{x:.3375,y:.85,w:.075,h:.1},{x:.3625,y:.85,w:.03125,h:.041666666666666664},{x:.3625,y:.85,w:.05,h:.06666666666666667},{x:.3625,y:.85,w:.075,h:.1},{x:.3875,y:.85,w:.03125,h:.041666666666666664},{x:.3875,y:.85,w:.05,h:.06666666666666667},{x:.3875,y:.85,w:.075,h:.1},{x:.4125,y:.85,w:.03125,h:.041666666666666664},{x:.4125,y:.85,w:.05,h:.06666666666666667},{x:.4125,y:.85,w:.075,h:.1},{x:.4375,y:.85,w:.03125,h:.041666666666666664},{x:.4375,y:.85,w:.05,h:.06666666666666667},{x:.4375,y:.85,w:.075,h:.1},{x:.4625,y:.85,w:.03125,h:.041666666666666664},{x:.4625,y:.85,w:.05,h:.06666666666666667},{x:.4625,y:.85,w:.075,h:.1},{x:.4875,y:.85,w:.03125,h:.041666666666666664},{x:.4875,y:.85,w:.05,h:.06666666666666667},{x:.4875,y:.85,w:.075,h:.1},{x:.5125,y:.85,w:.03125,h:.041666666666666664},{x:.5125,y:.85,w:.05,h:.06666666666666667},{x:.5125,y:.85,w:.075,h:.1},{x:.5375,y:.85,w:.03125,h:.041666666666666664},{x:.5375,y:.85,w:.05,h:.06666666666666667},{x:.5375,y:.85,w:.075,h:.1},{x:.5625,y:.85,w:.03125,h:.041666666666666664},{x:.5625,y:.85,w:.05,h:.06666666666666667},{x:.5625,y:.85,w:.075,h:.1},{x:.5875,y:.85,w:.03125,h:.041666666666666664},{x:.5875,y:.85,w:.05,h:.06666666666666667},{x:.5875,y:.85,w:.075,h:.1},{x:.6125,y:.85,w:.03125,h:.041666666666666664},{x:.6125,y:.85,w:.05,h:.06666666666666667},{x:.6125,y:.85,w:.075,h:.1},{x:.6375,y:.85,w:.03125,h:.041666666666666664},{x:.6375,y:.85,w:.05,h:.06666666666666667},{x:.6375,y:.85,w:.075,h:.1},{x:.6625,y:.85,w:.03125,h:.041666666666666664},{x:.6625,y:.85,w:.05,h:.06666666666666667},{x:.6625,y:.85,w:.075,h:.1},{x:.6875,y:.85,w:.03125,h:.041666666666666664},{x:.6875,y:.85,w:.05,h:.06666666666666667},{x:.6875,y:.85,w:.075,h:.1},{x:.7125,y:.85,w:.03125,h:.041666666666666664},{x:.7125,y:.85,w:.05,h:.06666666666666667},{x:.7125,y:.85,w:.075,h:.1},{x:.7375,y:.85,w:.03125,h:.041666666666666664},{x:.7375,y:.85,w:.05,h:.06666666666666667},{x:.7375,y:.85,w:.075,h:.1},{x:.7625,y:.85,w:.03125,h:.041666666666666664},{x:.7625,y:.85,w:.05,h:.06666666666666667},{x:.7625,y:.85,w:.075,h:.1},{x:.7875,y:.85,w:.03125,h:.041666666666666664},{x:.7875,y:.85,w:.05,h:.06666666666666667},{x:.7875,y:.85,w:.075,h:.1},{x:.8125,y:.85,w:.03125,h:.041666666666666664},{x:.8125,y:.85,w:.05,h:.06666666666666667},{x:.8125,y:.85,w:.075,h:.1},{x:.8375,y:.85,w:.03125,h:.041666666666666664},{x:.8375,y:.85,w:.05,h:.06666666666666667},{x:.8375,y:.85,w:.075,h:.1},{x:.8625,y:.85,w:.03125,h:.041666666666666664},{x:.8625,y:.85,w:.05,h:.06666666666666667},{x:.8625,y:.85,w:.075,h:.1},{x:.8875,y:.85,w:.03125,h:.041666666666666664},{x:.8875,y:.85,w:.05,h:.06666666666666667},{x:.8875,y:.85,w:.075,h:.1},{x:.9125,y:.85,w:.03125,h:.041666666666666664},{x:.9125,y:.85,w:.05,h:.06666666666666667},{x:.9125,y:.85,w:.075,h:.1},{x:.9375,y:.85,w:.03125,h:.041666666666666664},{x:.9375,y:.85,w:.05,h:.06666666666666667},{x:.9375,y:.85,w:.075,h:.1},{x:.9625,y:.85,w:.03125,h:.041666666666666664},{x:.9625,y:.85,w:.05,h:.06666666666666667},{x:.9625,y:.85,w:.075,h:.1},{x:.9875,y:.85,w:.03125,h:.041666666666666664},{x:.9875,y:.85,w:.05,h:.06666666666666667},{x:.9875,y:.85,w:.075,h:.1},{x:.0125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.8833333333333333,w:.075,h:.1},{x:.0375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.8833333333333333,w:.075,h:.1},{x:.0625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.8833333333333333,w:.075,h:.1},{x:.0875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.8833333333333333,w:.075,h:.1},{x:.1125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.8833333333333333,w:.075,h:.1},{x:.1375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.8833333333333333,w:.075,h:.1},{x:.1625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.8833333333333333,w:.075,h:.1},{x:.1875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.8833333333333333,w:.075,h:.1},{x:.2125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.8833333333333333,w:.075,h:.1},{x:.2375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.8833333333333333,w:.075,h:.1},{x:.2625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.8833333333333333,w:.075,h:.1},{x:.2875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.8833333333333333,w:.075,h:.1},{x:.3125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.8833333333333333,w:.075,h:.1},{x:.3375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.8833333333333333,w:.075,h:.1},{x:.3625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.8833333333333333,w:.075,h:.1},{x:.3875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.8833333333333333,w:.075,h:.1},{x:.4125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.8833333333333333,w:.075,h:.1},{x:.4375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.8833333333333333,w:.075,h:.1},{x:.4625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.8833333333333333,w:.075,h:.1},{x:.4875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.8833333333333333,w:.075,h:.1},{x:.5125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.8833333333333333,w:.075,h:.1},{x:.5375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.8833333333333333,w:.075,h:.1},{x:.5625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.8833333333333333,w:.075,h:.1},{x:.5875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.8833333333333333,w:.075,h:.1},{x:.6125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.8833333333333333,w:.075,h:.1},{x:.6375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.8833333333333333,w:.075,h:.1},{x:.6625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.8833333333333333,w:.075,h:.1},{x:.6875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.8833333333333333,w:.075,h:.1},{x:.7125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.8833333333333333,w:.075,h:.1},{x:.7375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.8833333333333333,w:.075,h:.1},{x:.7625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.8833333333333333,w:.075,h:.1},{x:.7875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.8833333333333333,w:.075,h:.1},{x:.8125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.8833333333333333,w:.075,h:.1},{x:.8375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.8833333333333333,w:.075,h:.1},{x:.8625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.8833333333333333,w:.075,h:.1},{x:.8875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.8833333333333333,w:.075,h:.1},{x:.9125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.8833333333333333,w:.075,h:.1},{x:.9375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.8833333333333333,w:.075,h:.1},{x:.9625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.8833333333333333,w:.075,h:.1},{x:.9875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.8833333333333333,w:.075,h:.1},{x:.0125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.9166666666666666,w:.075,h:.1},{x:.0375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.9166666666666666,w:.075,h:.1},{x:.0625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.9166666666666666,w:.075,h:.1},{x:.0875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.9166666666666666,w:.075,h:.1},{x:.1125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.9166666666666666,w:.075,h:.1},{x:.1375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.9166666666666666,w:.075,h:.1},{x:.1625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.9166666666666666,w:.075,h:.1},{x:.1875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.9166666666666666,w:.075,h:.1},{x:.2125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.9166666666666666,w:.075,h:.1},{x:.2375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.9166666666666666,w:.075,h:.1},{x:.2625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.9166666666666666,w:.075,h:.1},{x:.2875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.9166666666666666,w:.075,h:.1},{x:.3125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.9166666666666666,w:.075,h:.1},{x:.3375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.9166666666666666,w:.075,h:.1},{x:.3625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.9166666666666666,w:.075,h:.1},{x:.3875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.9166666666666666,w:.075,h:.1},{x:.4125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.9166666666666666,w:.075,h:.1},{x:.4375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.9166666666666666,w:.075,h:.1},{x:.4625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.9166666666666666,w:.075,h:.1},{x:.4875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.9166666666666666,w:.075,h:.1},{x:.5125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.9166666666666666,w:.075,h:.1},{x:.5375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.9166666666666666,w:.075,h:.1},{x:.5625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.9166666666666666,w:.075,h:.1},{x:.5875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.9166666666666666,w:.075,h:.1},{x:.6125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.9166666666666666,w:.075,h:.1},{x:.6375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.9166666666666666,w:.075,h:.1},{x:.6625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.9166666666666666,w:.075,h:.1},{x:.6875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.9166666666666666,w:.075,h:.1},{x:.7125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.9166666666666666,w:.075,h:.1},{x:.7375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.9166666666666666,w:.075,h:.1},{x:.7625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.9166666666666666,w:.075,h:.1},{x:.7875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.9166666666666666,w:.075,h:.1},{x:.8125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.9166666666666666,w:.075,h:.1},{x:.8375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.9166666666666666,w:.075,h:.1},{x:.8625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.9166666666666666,w:.075,h:.1},{x:.8875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.9166666666666666,w:.075,h:.1},{x:.9125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.9166666666666666,w:.075,h:.1},{x:.9375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.9166666666666666,w:.075,h:.1},{x:.9625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.9166666666666666,w:.075,h:.1},{x:.9875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.9166666666666666,w:.075,h:.1},{x:.0125,y:.95,w:.03125,h:.041666666666666664},{x:.0125,y:.95,w:.05,h:.06666666666666667},{x:.0125,y:.95,w:.075,h:.1},{x:.0375,y:.95,w:.03125,h:.041666666666666664},{x:.0375,y:.95,w:.05,h:.06666666666666667},{x:.0375,y:.95,w:.075,h:.1},{x:.0625,y:.95,w:.03125,h:.041666666666666664},{x:.0625,y:.95,w:.05,h:.06666666666666667},{x:.0625,y:.95,w:.075,h:.1},{x:.0875,y:.95,w:.03125,h:.041666666666666664},{x:.0875,y:.95,w:.05,h:.06666666666666667},{x:.0875,y:.95,w:.075,h:.1},{x:.1125,y:.95,w:.03125,h:.041666666666666664},{x:.1125,y:.95,w:.05,h:.06666666666666667},{x:.1125,y:.95,w:.075,h:.1},{x:.1375,y:.95,w:.03125,h:.041666666666666664},{x:.1375,y:.95,w:.05,h:.06666666666666667},{x:.1375,y:.95,w:.075,h:.1},{x:.1625,y:.95,w:.03125,h:.041666666666666664},{x:.1625,y:.95,w:.05,h:.06666666666666667},{x:.1625,y:.95,w:.075,h:.1},{x:.1875,y:.95,w:.03125,h:.041666666666666664},{x:.1875,y:.95,w:.05,h:.06666666666666667},{x:.1875,y:.95,w:.075,h:.1},{x:.2125,y:.95,w:.03125,h:.041666666666666664},{x:.2125,y:.95,w:.05,h:.06666666666666667},{x:.2125,y:.95,w:.075,h:.1},{x:.2375,y:.95,w:.03125,h:.041666666666666664},{x:.2375,y:.95,w:.05,h:.06666666666666667},{x:.2375,y:.95,w:.075,h:.1},{x:.2625,y:.95,w:.03125,h:.041666666666666664},{x:.2625,y:.95,w:.05,h:.06666666666666667},{x:.2625,y:.95,w:.075,h:.1},{x:.2875,y:.95,w:.03125,h:.041666666666666664},{x:.2875,y:.95,w:.05,h:.06666666666666667},{x:.2875,y:.95,w:.075,h:.1},{x:.3125,y:.95,w:.03125,h:.041666666666666664},{x:.3125,y:.95,w:.05,h:.06666666666666667},{x:.3125,y:.95,w:.075,h:.1},{x:.3375,y:.95,w:.03125,h:.041666666666666664},{x:.3375,y:.95,w:.05,h:.06666666666666667},{x:.3375,y:.95,w:.075,h:.1},{x:.3625,y:.95,w:.03125,h:.041666666666666664},{x:.3625,y:.95,w:.05,h:.06666666666666667},{x:.3625,y:.95,w:.075,h:.1},{x:.3875,y:.95,w:.03125,h:.041666666666666664},{x:.3875,y:.95,w:.05,h:.06666666666666667},{x:.3875,y:.95,w:.075,h:.1},{x:.4125,y:.95,w:.03125,h:.041666666666666664},{x:.4125,y:.95,w:.05,h:.06666666666666667},{x:.4125,y:.95,w:.075,h:.1},{x:.4375,y:.95,w:.03125,h:.041666666666666664},{x:.4375,y:.95,w:.05,h:.06666666666666667},{x:.4375,y:.95,w:.075,h:.1},{x:.4625,y:.95,w:.03125,h:.041666666666666664},{x:.4625,y:.95,w:.05,h:.06666666666666667},{x:.4625,y:.95,w:.075,h:.1},{x:.4875,y:.95,w:.03125,h:.041666666666666664},{x:.4875,y:.95,w:.05,h:.06666666666666667},{x:.4875,y:.95,w:.075,h:.1},{x:.5125,y:.95,w:.03125,h:.041666666666666664},{x:.5125,y:.95,w:.05,h:.06666666666666667},{x:.5125,y:.95,w:.075,h:.1},{x:.5375,y:.95,w:.03125,h:.041666666666666664},{x:.5375,y:.95,w:.05,h:.06666666666666667},{x:.5375,y:.95,w:.075,h:.1},{x:.5625,y:.95,w:.03125,h:.041666666666666664},{x:.5625,y:.95,w:.05,h:.06666666666666667},{x:.5625,y:.95,w:.075,h:.1},{x:.5875,y:.95,w:.03125,h:.041666666666666664},{x:.5875,y:.95,w:.05,h:.06666666666666667},{x:.5875,y:.95,w:.075,h:.1},{x:.6125,y:.95,w:.03125,h:.041666666666666664},{x:.6125,y:.95,w:.05,h:.06666666666666667},{x:.6125,y:.95,w:.075,h:.1},{x:.6375,y:.95,w:.03125,h:.041666666666666664},{x:.6375,y:.95,w:.05,h:.06666666666666667},{x:.6375,y:.95,w:.075,h:.1},{x:.6625,y:.95,w:.03125,h:.041666666666666664},{x:.6625,y:.95,w:.05,h:.06666666666666667},{x:.6625,y:.95,w:.075,h:.1},{x:.6875,y:.95,w:.03125,h:.041666666666666664},{x:.6875,y:.95,w:.05,h:.06666666666666667},{x:.6875,y:.95,w:.075,h:.1},{x:.7125,y:.95,w:.03125,h:.041666666666666664},{x:.7125,y:.95,w:.05,h:.06666666666666667},{x:.7125,y:.95,w:.075,h:.1},{x:.7375,y:.95,w:.03125,h:.041666666666666664},{x:.7375,y:.95,w:.05,h:.06666666666666667},{x:.7375,y:.95,w:.075,h:.1},{x:.7625,y:.95,w:.03125,h:.041666666666666664},{x:.7625,y:.95,w:.05,h:.06666666666666667},{x:.7625,y:.95,w:.075,h:.1},{x:.7875,y:.95,w:.03125,h:.041666666666666664},{x:.7875,y:.95,w:.05,h:.06666666666666667},{x:.7875,y:.95,w:.075,h:.1},{x:.8125,y:.95,w:.03125,h:.041666666666666664},{x:.8125,y:.95,w:.05,h:.06666666666666667},{x:.8125,y:.95,w:.075,h:.1},{x:.8375,y:.95,w:.03125,h:.041666666666666664},{x:.8375,y:.95,w:.05,h:.06666666666666667},{x:.8375,y:.95,w:.075,h:.1},{x:.8625,y:.95,w:.03125,h:.041666666666666664},{x:.8625,y:.95,w:.05,h:.06666666666666667},{x:.8625,y:.95,w:.075,h:.1},{x:.8875,y:.95,w:.03125,h:.041666666666666664},{x:.8875,y:.95,w:.05,h:.06666666666666667},{x:.8875,y:.95,w:.075,h:.1},{x:.9125,y:.95,w:.03125,h:.041666666666666664},{x:.9125,y:.95,w:.05,h:.06666666666666667},{x:.9125,y:.95,w:.075,h:.1},{x:.9375,y:.95,w:.03125,h:.041666666666666664},{x:.9375,y:.95,w:.05,h:.06666666666666667},{x:.9375,y:.95,w:.075,h:.1},{x:.9625,y:.95,w:.03125,h:.041666666666666664},{x:.9625,y:.95,w:.05,h:.06666666666666667},{x:.9625,y:.95,w:.075,h:.1},{x:.9875,y:.95,w:.03125,h:.041666666666666664},{x:.9875,y:.95,w:.05,h:.06666666666666667},{x:.9875,y:.95,w:.075,h:.1},{x:.0125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.9833333333333333,w:.075,h:.1},{x:.0375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.9833333333333333,w:.075,h:.1},{x:.0625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.9833333333333333,w:.075,h:.1},{x:.0875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.9833333333333333,w:.075,h:.1},{x:.1125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.9833333333333333,w:.075,h:.1},{x:.1375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.9833333333333333,w:.075,h:.1},{x:.1625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.9833333333333333,w:.075,h:.1},{x:.1875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.9833333333333333,w:.075,h:.1},{x:.2125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.9833333333333333,w:.075,h:.1},{x:.2375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.9833333333333333,w:.075,h:.1},{x:.2625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.9833333333333333,w:.075,h:.1},{x:.2875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.9833333333333333,w:.075,h:.1},{x:.3125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.9833333333333333,w:.075,h:.1},{x:.3375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.9833333333333333,w:.075,h:.1},{x:.3625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.9833333333333333,w:.075,h:.1},{x:.3875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.9833333333333333,w:.075,h:.1},{x:.4125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.9833333333333333,w:.075,h:.1},{x:.4375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.9833333333333333,w:.075,h:.1},{x:.4625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.9833333333333333,w:.075,h:.1},{x:.4875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.9833333333333333,w:.075,h:.1},{x:.5125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.9833333333333333,w:.075,h:.1},{x:.5375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.9833333333333333,w:.075,h:.1},{x:.5625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.9833333333333333,w:.075,h:.1},{x:.5875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.9833333333333333,w:.075,h:.1},{x:.6125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.9833333333333333,w:.075,h:.1},{x:.6375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.9833333333333333,w:.075,h:.1},{x:.6625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.9833333333333333,w:.075,h:.1},{x:.6875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.9833333333333333,w:.075,h:.1},{x:.7125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.9833333333333333,w:.075,h:.1},{x:.7375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.9833333333333333,w:.075,h:.1},{x:.7625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.9833333333333333,w:.075,h:.1},{x:.7875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.9833333333333333,w:.075,h:.1},{x:.8125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.9833333333333333,w:.075,h:.1},{x:.8375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.9833333333333333,w:.075,h:.1},{x:.8625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.9833333333333333,w:.075,h:.1},{x:.8875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.9833333333333333,w:.075,h:.1},{x:.9125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.9833333333333333,w:.075,h:.1},{x:.9375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.9833333333333333,w:.075,h:.1},{x:.9625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.9833333333333333,w:.075,h:.1},{x:.9875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.9833333333333333,w:.075,h:.1},{x:.025,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.03333333333333333,w:.15,h:.2},{x:.075,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.03333333333333333,w:.15,h:.2},{x:.125,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.03333333333333333,w:.15,h:.2},{x:.175,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.03333333333333333,w:.15,h:.2},{x:.225,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.03333333333333333,w:.15,h:.2},{x:.275,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.03333333333333333,w:.15,h:.2},{x:.325,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.03333333333333333,w:.15,h:.2},{x:.375,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.03333333333333333,w:.15,h:.2},{x:.425,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.03333333333333333,w:.15,h:.2},{x:.475,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.03333333333333333,w:.15,h:.2},{x:.525,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.03333333333333333,w:.15,h:.2},{x:.575,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.03333333333333333,w:.15,h:.2},{x:.625,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.03333333333333333,w:.15,h:.2},{x:.675,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.03333333333333333,w:.15,h:.2},{x:.725,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.03333333333333333,w:.15,h:.2},{x:.775,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.03333333333333333,w:.15,h:.2},{x:.825,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.03333333333333333,w:.15,h:.2},{x:.875,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.03333333333333333,w:.15,h:.2},{x:.925,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.03333333333333333,w:.15,h:.2},{x:.975,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.03333333333333333,w:.15,h:.2},{x:.025,y:.1,w:.1,h:.13333333333333333},{x:.025,y:.1,w:.15,h:.2},{x:.075,y:.1,w:.1,h:.13333333333333333},{x:.075,y:.1,w:.15,h:.2},{x:.125,y:.1,w:.1,h:.13333333333333333},{x:.125,y:.1,w:.15,h:.2},{x:.175,y:.1,w:.1,h:.13333333333333333},{x:.175,y:.1,w:.15,h:.2},{x:.225,y:.1,w:.1,h:.13333333333333333},{x:.225,y:.1,w:.15,h:.2},{x:.275,y:.1,w:.1,h:.13333333333333333},{x:.275,y:.1,w:.15,h:.2},{x:.325,y:.1,w:.1,h:.13333333333333333},{x:.325,y:.1,w:.15,h:.2},{x:.375,y:.1,w:.1,h:.13333333333333333},{x:.375,y:.1,w:.15,h:.2},{x:.425,y:.1,w:.1,h:.13333333333333333},{x:.425,y:.1,w:.15,h:.2},{x:.475,y:.1,w:.1,h:.13333333333333333},{x:.475,y:.1,w:.15,h:.2},{x:.525,y:.1,w:.1,h:.13333333333333333},{x:.525,y:.1,w:.15,h:.2},{x:.575,y:.1,w:.1,h:.13333333333333333},{x:.575,y:.1,w:.15,h:.2},{x:.625,y:.1,w:.1,h:.13333333333333333},{x:.625,y:.1,w:.15,h:.2},{x:.675,y:.1,w:.1,h:.13333333333333333},{x:.675,y:.1,w:.15,h:.2},{x:.725,y:.1,w:.1,h:.13333333333333333},{x:.725,y:.1,w:.15,h:.2},{x:.775,y:.1,w:.1,h:.13333333333333333},{x:.775,y:.1,w:.15,h:.2},{x:.825,y:.1,w:.1,h:.13333333333333333},{x:.825,y:.1,w:.15,h:.2},{x:.875,y:.1,w:.1,h:.13333333333333333},{x:.875,y:.1,w:.15,h:.2},{x:.925,y:.1,w:.1,h:.13333333333333333},{x:.925,y:.1,w:.15,h:.2},{x:.975,y:.1,w:.1,h:.13333333333333333},{x:.975,y:.1,w:.15,h:.2},{x:.025,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.025,y:.16666666666666666,w:.15,h:.2},{x:.075,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.075,y:.16666666666666666,w:.15,h:.2},{x:.125,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.125,y:.16666666666666666,w:.15,h:.2},{x:.175,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.175,y:.16666666666666666,w:.15,h:.2},{x:.225,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.225,y:.16666666666666666,w:.15,h:.2},{x:.275,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.275,y:.16666666666666666,w:.15,h:.2},{x:.325,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.325,y:.16666666666666666,w:.15,h:.2},{x:.375,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.375,y:.16666666666666666,w:.15,h:.2},{x:.425,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.425,y:.16666666666666666,w:.15,h:.2},{x:.475,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.475,y:.16666666666666666,w:.15,h:.2},{x:.525,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.525,y:.16666666666666666,w:.15,h:.2},{x:.575,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.575,y:.16666666666666666,w:.15,h:.2},{x:.625,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.625,y:.16666666666666666,w:.15,h:.2},{x:.675,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.675,y:.16666666666666666,w:.15,h:.2},{x:.725,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.725,y:.16666666666666666,w:.15,h:.2},{x:.775,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.775,y:.16666666666666666,w:.15,h:.2},{x:.825,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.825,y:.16666666666666666,w:.15,h:.2},{x:.875,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.875,y:.16666666666666666,w:.15,h:.2},{x:.925,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.925,y:.16666666666666666,w:.15,h:.2},{x:.975,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.975,y:.16666666666666666,w:.15,h:.2},{x:.025,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.23333333333333334,w:.15,h:.2},{x:.075,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.23333333333333334,w:.15,h:.2},{x:.125,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.23333333333333334,w:.15,h:.2},{x:.175,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.23333333333333334,w:.15,h:.2},{x:.225,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.23333333333333334,w:.15,h:.2},{x:.275,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.23333333333333334,w:.15,h:.2},{x:.325,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.23333333333333334,w:.15,h:.2},{x:.375,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.23333333333333334,w:.15,h:.2},{x:.425,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.23333333333333334,w:.15,h:.2},{x:.475,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.23333333333333334,w:.15,h:.2},{x:.525,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.23333333333333334,w:.15,h:.2},{x:.575,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.23333333333333334,w:.15,h:.2},{x:.625,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.23333333333333334,w:.15,h:.2},{x:.675,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.23333333333333334,w:.15,h:.2},{x:.725,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.23333333333333334,w:.15,h:.2},{x:.775,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.23333333333333334,w:.15,h:.2},{x:.825,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.23333333333333334,w:.15,h:.2},{x:.875,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.23333333333333334,w:.15,h:.2},{x:.925,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.23333333333333334,w:.15,h:.2},{x:.975,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.23333333333333334,w:.15,h:.2},{x:.025,y:.3,w:.1,h:.13333333333333333},{x:.025,y:.3,w:.15,h:.2},{x:.075,y:.3,w:.1,h:.13333333333333333},{x:.075,y:.3,w:.15,h:.2},{x:.125,y:.3,w:.1,h:.13333333333333333},{x:.125,y:.3,w:.15,h:.2},{x:.175,y:.3,w:.1,h:.13333333333333333},{x:.175,y:.3,w:.15,h:.2},{x:.225,y:.3,w:.1,h:.13333333333333333},{x:.225,y:.3,w:.15,h:.2},{x:.275,y:.3,w:.1,h:.13333333333333333},{x:.275,y:.3,w:.15,h:.2},{x:.325,y:.3,w:.1,h:.13333333333333333},{x:.325,y:.3,w:.15,h:.2},{x:.375,y:.3,w:.1,h:.13333333333333333},{x:.375,y:.3,w:.15,h:.2},{x:.425,y:.3,w:.1,h:.13333333333333333},{x:.425,y:.3,w:.15,h:.2},{x:.475,y:.3,w:.1,h:.13333333333333333},{x:.475,y:.3,w:.15,h:.2},{x:.525,y:.3,w:.1,h:.13333333333333333},{x:.525,y:.3,w:.15,h:.2},{x:.575,y:.3,w:.1,h:.13333333333333333},{x:.575,y:.3,w:.15,h:.2},{x:.625,y:.3,w:.1,h:.13333333333333333},{x:.625,y:.3,w:.15,h:.2},{x:.675,y:.3,w:.1,h:.13333333333333333},{x:.675,y:.3,w:.15,h:.2},{x:.725,y:.3,w:.1,h:.13333333333333333},{x:.725,y:.3,w:.15,h:.2},{x:.775,y:.3,w:.1,h:.13333333333333333},{x:.775,y:.3,w:.15,h:.2},{x:.825,y:.3,w:.1,h:.13333333333333333},{x:.825,y:.3,w:.15,h:.2},{x:.875,y:.3,w:.1,h:.13333333333333333},{x:.875,y:.3,w:.15,h:.2},{x:.925,y:.3,w:.1,h:.13333333333333333},{x:.925,y:.3,w:.15,h:.2},{x:.975,y:.3,w:.1,h:.13333333333333333},{x:.975,y:.3,w:.15,h:.2},{x:.025,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.025,y:.36666666666666664,w:.15,h:.2},{x:.075,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.075,y:.36666666666666664,w:.15,h:.2},{x:.125,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.125,y:.36666666666666664,w:.15,h:.2},{x:.175,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.175,y:.36666666666666664,w:.15,h:.2},{x:.225,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.225,y:.36666666666666664,w:.15,h:.2},{x:.275,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.275,y:.36666666666666664,w:.15,h:.2},{x:.325,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.325,y:.36666666666666664,w:.15,h:.2},{x:.375,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.375,y:.36666666666666664,w:.15,h:.2},{x:.425,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.425,y:.36666666666666664,w:.15,h:.2},{x:.475,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.475,y:.36666666666666664,w:.15,h:.2},{x:.525,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.525,y:.36666666666666664,w:.15,h:.2},{x:.575,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.575,y:.36666666666666664,w:.15,h:.2},{x:.625,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.625,y:.36666666666666664,w:.15,h:.2},{x:.675,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.675,y:.36666666666666664,w:.15,h:.2},{x:.725,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.725,y:.36666666666666664,w:.15,h:.2},{x:.775,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.775,y:.36666666666666664,w:.15,h:.2},{x:.825,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.825,y:.36666666666666664,w:.15,h:.2},{x:.875,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.875,y:.36666666666666664,w:.15,h:.2},{x:.925,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.925,y:.36666666666666664,w:.15,h:.2},{x:.975,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.975,y:.36666666666666664,w:.15,h:.2},{x:.025,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.025,y:.43333333333333335,w:.15,h:.2},{x:.075,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.075,y:.43333333333333335,w:.15,h:.2},{x:.125,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.125,y:.43333333333333335,w:.15,h:.2},{x:.175,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.175,y:.43333333333333335,w:.15,h:.2},{x:.225,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.225,y:.43333333333333335,w:.15,h:.2},{x:.275,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.275,y:.43333333333333335,w:.15,h:.2},{x:.325,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.325,y:.43333333333333335,w:.15,h:.2},{x:.375,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.375,y:.43333333333333335,w:.15,h:.2},{x:.425,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.425,y:.43333333333333335,w:.15,h:.2},{x:.475,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.475,y:.43333333333333335,w:.15,h:.2},{x:.525,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.525,y:.43333333333333335,w:.15,h:.2},{x:.575,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.575,y:.43333333333333335,w:.15,h:.2},{x:.625,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.625,y:.43333333333333335,w:.15,h:.2},{x:.675,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.675,y:.43333333333333335,w:.15,h:.2},{x:.725,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.725,y:.43333333333333335,w:.15,h:.2},{x:.775,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.775,y:.43333333333333335,w:.15,h:.2},{x:.825,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.825,y:.43333333333333335,w:.15,h:.2},{x:.875,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.875,y:.43333333333333335,w:.15,h:.2},{x:.925,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.925,y:.43333333333333335,w:.15,h:.2},{x:.975,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.975,y:.43333333333333335,w:.15,h:.2},{x:.025,y:.5,w:.1,h:.13333333333333333},{x:.025,y:.5,w:.15,h:.2},{x:.075,y:.5,w:.1,h:.13333333333333333},{x:.075,y:.5,w:.15,h:.2},{x:.125,y:.5,w:.1,h:.13333333333333333},{x:.125,y:.5,w:.15,h:.2},{x:.175,y:.5,w:.1,h:.13333333333333333},{x:.175,y:.5,w:.15,h:.2},{x:.225,y:.5,w:.1,h:.13333333333333333},{x:.225,y:.5,w:.15,h:.2},{x:.275,y:.5,w:.1,h:.13333333333333333},{x:.275,y:.5,w:.15,h:.2},{x:.325,y:.5,w:.1,h:.13333333333333333},{x:.325,y:.5,w:.15,h:.2},{x:.375,y:.5,w:.1,h:.13333333333333333},{x:.375,y:.5,w:.15,h:.2},{x:.425,y:.5,w:.1,h:.13333333333333333},{x:.425,y:.5,w:.15,h:.2},{x:.475,y:.5,w:.1,h:.13333333333333333},{x:.475,y:.5,w:.15,h:.2},{x:.525,y:.5,w:.1,h:.13333333333333333},{x:.525,y:.5,w:.15,h:.2},{x:.575,y:.5,w:.1,h:.13333333333333333},{x:.575,y:.5,w:.15,h:.2},{x:.625,y:.5,w:.1,h:.13333333333333333},{x:.625,y:.5,w:.15,h:.2},{x:.675,y:.5,w:.1,h:.13333333333333333},{x:.675,y:.5,w:.15,h:.2},{x:.725,y:.5,w:.1,h:.13333333333333333},{x:.725,y:.5,w:.15,h:.2},{x:.775,y:.5,w:.1,h:.13333333333333333},{x:.775,y:.5,w:.15,h:.2},{x:.825,y:.5,w:.1,h:.13333333333333333},{x:.825,y:.5,w:.15,h:.2},{x:.875,y:.5,w:.1,h:.13333333333333333},{x:.875,y:.5,w:.15,h:.2},{x:.925,y:.5,w:.1,h:.13333333333333333},{x:.925,y:.5,w:.15,h:.2},{x:.975,y:.5,w:.1,h:.13333333333333333},{x:.975,y:.5,w:.15,h:.2},{x:.025,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.5666666666666667,w:.15,h:.2},{x:.075,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.5666666666666667,w:.15,h:.2},{x:.125,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.5666666666666667,w:.15,h:.2},{x:.175,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.5666666666666667,w:.15,h:.2},{x:.225,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.5666666666666667,w:.15,h:.2},{x:.275,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.5666666666666667,w:.15,h:.2},{x:.325,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.5666666666666667,w:.15,h:.2},{x:.375,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.5666666666666667,w:.15,h:.2},{x:.425,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.5666666666666667,w:.15,h:.2},{x:.475,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.5666666666666667,w:.15,h:.2},{x:.525,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.5666666666666667,w:.15,h:.2},{x:.575,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.5666666666666667,w:.15,h:.2},{x:.625,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.5666666666666667,w:.15,h:.2},{x:.675,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.5666666666666667,w:.15,h:.2},{x:.725,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.5666666666666667,w:.15,h:.2},{x:.775,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.5666666666666667,w:.15,h:.2},{x:.825,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.5666666666666667,w:.15,h:.2},{x:.875,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.5666666666666667,w:.15,h:.2},{x:.925,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.5666666666666667,w:.15,h:.2},{x:.975,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.5666666666666667,w:.15,h:.2},{x:.025,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.6333333333333333,w:.15,h:.2},{x:.075,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.6333333333333333,w:.15,h:.2},{x:.125,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.6333333333333333,w:.15,h:.2},{x:.175,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.6333333333333333,w:.15,h:.2},{x:.225,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.6333333333333333,w:.15,h:.2},{x:.275,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.6333333333333333,w:.15,h:.2},{x:.325,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.6333333333333333,w:.15,h:.2},{x:.375,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.6333333333333333,w:.15,h:.2},{x:.425,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.6333333333333333,w:.15,h:.2},{x:.475,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.6333333333333333,w:.15,h:.2},{x:.525,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.6333333333333333,w:.15,h:.2},{x:.575,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.6333333333333333,w:.15,h:.2},{x:.625,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.6333333333333333,w:.15,h:.2},{x:.675,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.6333333333333333,w:.15,h:.2},{x:.725,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.6333333333333333,w:.15,h:.2},{x:.775,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.6333333333333333,w:.15,h:.2},{x:.825,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.6333333333333333,w:.15,h:.2},{x:.875,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.6333333333333333,w:.15,h:.2},{x:.925,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.6333333333333333,w:.15,h:.2},{x:.975,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.6333333333333333,w:.15,h:.2},{x:.025,y:.7,w:.1,h:.13333333333333333},{x:.025,y:.7,w:.15,h:.2},{x:.075,y:.7,w:.1,h:.13333333333333333},{x:.075,y:.7,w:.15,h:.2},{x:.125,y:.7,w:.1,h:.13333333333333333},{x:.125,y:.7,w:.15,h:.2},{x:.175,y:.7,w:.1,h:.13333333333333333},{x:.175,y:.7,w:.15,h:.2},{x:.225,y:.7,w:.1,h:.13333333333333333},{x:.225,y:.7,w:.15,h:.2},{x:.275,y:.7,w:.1,h:.13333333333333333},{x:.275,y:.7,w:.15,h:.2},{x:.325,y:.7,w:.1,h:.13333333333333333},{x:.325,y:.7,w:.15,h:.2},{x:.375,y:.7,w:.1,h:.13333333333333333},{x:.375,y:.7,w:.15,h:.2},{x:.425,y:.7,w:.1,h:.13333333333333333},{x:.425,y:.7,w:.15,h:.2},{x:.475,y:.7,w:.1,h:.13333333333333333},{x:.475,y:.7,w:.15,h:.2},{x:.525,y:.7,w:.1,h:.13333333333333333},{x:.525,y:.7,w:.15,h:.2},{x:.575,y:.7,w:.1,h:.13333333333333333},{x:.575,y:.7,w:.15,h:.2},{x:.625,y:.7,w:.1,h:.13333333333333333},{x:.625,y:.7,w:.15,h:.2},{x:.675,y:.7,w:.1,h:.13333333333333333},{x:.675,y:.7,w:.15,h:.2},{x:.725,y:.7,w:.1,h:.13333333333333333},{x:.725,y:.7,w:.15,h:.2},{x:.775,y:.7,w:.1,h:.13333333333333333},{x:.775,y:.7,w:.15,h:.2},{x:.825,y:.7,w:.1,h:.13333333333333333},{x:.825,y:.7,w:.15,h:.2},{x:.875,y:.7,w:.1,h:.13333333333333333},{x:.875,y:.7,w:.15,h:.2},{x:.925,y:.7,w:.1,h:.13333333333333333},{x:.925,y:.7,w:.15,h:.2},{x:.975,y:.7,w:.1,h:.13333333333333333},{x:.975,y:.7,w:.15,h:.2},{x:.025,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.7666666666666667,w:.15,h:.2},{x:.075,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.7666666666666667,w:.15,h:.2},{x:.125,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.7666666666666667,w:.15,h:.2},{x:.175,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.7666666666666667,w:.15,h:.2},{x:.225,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.7666666666666667,w:.15,h:.2},{x:.275,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.7666666666666667,w:.15,h:.2},{x:.325,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.7666666666666667,w:.15,h:.2},{x:.375,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.7666666666666667,w:.15,h:.2},{x:.425,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.7666666666666667,w:.15,h:.2},{x:.475,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.7666666666666667,w:.15,h:.2},{x:.525,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.7666666666666667,w:.15,h:.2},{x:.575,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.7666666666666667,w:.15,h:.2},{x:.625,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.7666666666666667,w:.15,h:.2},{x:.675,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.7666666666666667,w:.15,h:.2},{x:.725,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.7666666666666667,w:.15,h:.2},{x:.775,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.7666666666666667,w:.15,h:.2},{x:.825,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.7666666666666667,w:.15,h:.2},{x:.875,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.7666666666666667,w:.15,h:.2},{x:.925,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.7666666666666667,w:.15,h:.2},{x:.975,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.7666666666666667,w:.15,h:.2},{x:.025,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.8333333333333334,w:.15,h:.2},{x:.075,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.8333333333333334,w:.15,h:.2},{x:.125,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.8333333333333334,w:.15,h:.2},{x:.175,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.8333333333333334,w:.15,h:.2},{x:.225,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.8333333333333334,w:.15,h:.2},{x:.275,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.8333333333333334,w:.15,h:.2},{x:.325,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.8333333333333334,w:.15,h:.2},{x:.375,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.8333333333333334,w:.15,h:.2},{x:.425,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.8333333333333334,w:.15,h:.2},{x:.475,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.8333333333333334,w:.15,h:.2},{x:.525,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.8333333333333334,w:.15,h:.2},{x:.575,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.8333333333333334,w:.15,h:.2},{x:.625,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.8333333333333334,w:.15,h:.2},{x:.675,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.8333333333333334,w:.15,h:.2},{x:.725,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.8333333333333334,w:.15,h:.2},{x:.775,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.8333333333333334,w:.15,h:.2},{x:.825,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.8333333333333334,w:.15,h:.2},{x:.875,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.8333333333333334,w:.15,h:.2},{x:.925,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.8333333333333334,w:.15,h:.2},{x:.975,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.8333333333333334,w:.15,h:.2},{x:.025,y:.9,w:.1,h:.13333333333333333},{x:.025,y:.9,w:.15,h:.2},{x:.075,y:.9,w:.1,h:.13333333333333333},{x:.075,y:.9,w:.15,h:.2},{x:.125,y:.9,w:.1,h:.13333333333333333},{x:.125,y:.9,w:.15,h:.2},{x:.175,y:.9,w:.1,h:.13333333333333333},{x:.175,y:.9,w:.15,h:.2},{x:.225,y:.9,w:.1,h:.13333333333333333},{x:.225,y:.9,w:.15,h:.2},{x:.275,y:.9,w:.1,h:.13333333333333333},{x:.275,y:.9,w:.15,h:.2},{x:.325,y:.9,w:.1,h:.13333333333333333},{x:.325,y:.9,w:.15,h:.2},{x:.375,y:.9,w:.1,h:.13333333333333333},{x:.375,y:.9,w:.15,h:.2},{x:.425,y:.9,w:.1,h:.13333333333333333},{x:.425,y:.9,w:.15,h:.2},{x:.475,y:.9,w:.1,h:.13333333333333333},{x:.475,y:.9,w:.15,h:.2},{x:.525,y:.9,w:.1,h:.13333333333333333},{x:.525,y:.9,w:.15,h:.2},{x:.575,y:.9,w:.1,h:.13333333333333333},{x:.575,y:.9,w:.15,h:.2},{x:.625,y:.9,w:.1,h:.13333333333333333},{x:.625,y:.9,w:.15,h:.2},{x:.675,y:.9,w:.1,h:.13333333333333333},{x:.675,y:.9,w:.15,h:.2},{x:.725,y:.9,w:.1,h:.13333333333333333},{x:.725,y:.9,w:.15,h:.2},{x:.775,y:.9,w:.1,h:.13333333333333333},{x:.775,y:.9,w:.15,h:.2},{x:.825,y:.9,w:.1,h:.13333333333333333},{x:.825,y:.9,w:.15,h:.2},{x:.875,y:.9,w:.1,h:.13333333333333333},{x:.875,y:.9,w:.15,h:.2},{x:.925,y:.9,w:.1,h:.13333333333333333},{x:.925,y:.9,w:.15,h:.2},{x:.975,y:.9,w:.1,h:.13333333333333333},{x:.975,y:.9,w:.15,h:.2},{x:.025,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.9666666666666667,w:.15,h:.2},{x:.075,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.9666666666666667,w:.15,h:.2},{x:.125,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.9666666666666667,w:.15,h:.2},{x:.175,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.9666666666666667,w:.15,h:.2},{x:.225,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.9666666666666667,w:.15,h:.2},{x:.275,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.9666666666666667,w:.15,h:.2},{x:.325,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.9666666666666667,w:.15,h:.2},{x:.375,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.9666666666666667,w:.15,h:.2},{x:.425,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.9666666666666667,w:.15,h:.2},{x:.475,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.9666666666666667,w:.15,h:.2},{x:.525,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.9666666666666667,w:.15,h:.2},{x:.575,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.9666666666666667,w:.15,h:.2},{x:.625,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.9666666666666667,w:.15,h:.2},{x:.675,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.9666666666666667,w:.15,h:.2},{x:.725,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.9666666666666667,w:.15,h:.2},{x:.775,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.9666666666666667,w:.15,h:.2},{x:.825,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.9666666666666667,w:.15,h:.2},{x:.875,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.9666666666666667,w:.15,h:.2},{x:.925,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.9666666666666667,w:.15,h:.2},{x:.975,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.9666666666666667,w:.15,h:.2},{x:.05,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.06666666666666667,w:.3,h:.4},{x:.15,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.06666666666666667,w:.3,h:.4},{x:.25,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.06666666666666667,w:.3,h:.4},{x:.35,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.06666666666666667,w:.3,h:.4},{x:.45,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.06666666666666667,w:.3,h:.4},{x:.55,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.06666666666666667,w:.3,h:.4},{x:.65,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.06666666666666667,w:.3,h:.4},{x:.75,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.06666666666666667,w:.3,h:.4},{x:.85,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.06666666666666667,w:.3,h:.4},{x:.95,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.06666666666666667,w:.3,h:.4},{x:.05,y:.2,w:.2,h:.26666666666666666},{x:.05,y:.2,w:.3,h:.4},{x:.15,y:.2,w:.2,h:.26666666666666666},{x:.15,y:.2,w:.3,h:.4},{x:.25,y:.2,w:.2,h:.26666666666666666},{x:.25,y:.2,w:.3,h:.4},{x:.35,y:.2,w:.2,h:.26666666666666666},{x:.35,y:.2,w:.3,h:.4},{x:.45,y:.2,w:.2,h:.26666666666666666},{x:.45,y:.2,w:.3,h:.4},{x:.55,y:.2,w:.2,h:.26666666666666666},{x:.55,y:.2,w:.3,h:.4},{x:.65,y:.2,w:.2,h:.26666666666666666},{x:.65,y:.2,w:.3,h:.4},{x:.75,y:.2,w:.2,h:.26666666666666666},{x:.75,y:.2,w:.3,h:.4},{x:.85,y:.2,w:.2,h:.26666666666666666},{x:.85,y:.2,w:.3,h:.4},{x:.95,y:.2,w:.2,h:.26666666666666666},{x:.95,y:.2,w:.3,h:.4},{x:.05,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.3333333333333333,w:.3,h:.4},{x:.15,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.3333333333333333,w:.3,h:.4},{x:.25,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.3333333333333333,w:.3,h:.4},{x:.35,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.3333333333333333,w:.3,h:.4},{x:.45,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.3333333333333333,w:.3,h:.4},{x:.55,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.3333333333333333,w:.3,h:.4},{x:.65,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.3333333333333333,w:.3,h:.4},{x:.75,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.3333333333333333,w:.3,h:.4},{x:.85,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.3333333333333333,w:.3,h:.4},{x:.95,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.3333333333333333,w:.3,h:.4},{x:.05,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.4666666666666667,w:.3,h:.4},{x:.15,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.4666666666666667,w:.3,h:.4},{x:.25,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.4666666666666667,w:.3,h:.4},{x:.35,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.4666666666666667,w:.3,h:.4},{x:.45,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.4666666666666667,w:.3,h:.4},{x:.55,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.4666666666666667,w:.3,h:.4},{x:.65,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.4666666666666667,w:.3,h:.4},{x:.75,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.4666666666666667,w:.3,h:.4},{x:.85,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.4666666666666667,w:.3,h:.4},{x:.95,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.4666666666666667,w:.3,h:.4},{x:.05,y:.6,w:.2,h:.26666666666666666},{x:.05,y:.6,w:.3,h:.4},{x:.15,y:.6,w:.2,h:.26666666666666666},{x:.15,y:.6,w:.3,h:.4},{x:.25,y:.6,w:.2,h:.26666666666666666},{x:.25,y:.6,w:.3,h:.4},{x:.35,y:.6,w:.2,h:.26666666666666666},{x:.35,y:.6,w:.3,h:.4},{x:.45,y:.6,w:.2,h:.26666666666666666},{x:.45,y:.6,w:.3,h:.4},{x:.55,y:.6,w:.2,h:.26666666666666666},{x:.55,y:.6,w:.3,h:.4},{x:.65,y:.6,w:.2,h:.26666666666666666},{x:.65,y:.6,w:.3,h:.4},{x:.75,y:.6,w:.2,h:.26666666666666666},{x:.75,y:.6,w:.3,h:.4},{x:.85,y:.6,w:.2,h:.26666666666666666},{x:.85,y:.6,w:.3,h:.4},{x:.95,y:.6,w:.2,h:.26666666666666666},{x:.95,y:.6,w:.3,h:.4},{x:.05,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.7333333333333333,w:.3,h:.4},{x:.15,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.7333333333333333,w:.3,h:.4},{x:.25,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.7333333333333333,w:.3,h:.4},{x:.35,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.7333333333333333,w:.3,h:.4},{x:.45,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.7333333333333333,w:.3,h:.4},{x:.55,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.7333333333333333,w:.3,h:.4},{x:.65,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.7333333333333333,w:.3,h:.4},{x:.75,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.7333333333333333,w:.3,h:.4},{x:.85,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.7333333333333333,w:.3,h:.4},{x:.95,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.7333333333333333,w:.3,h:.4},{x:.05,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.8666666666666667,w:.3,h:.4},{x:.15,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.8666666666666667,w:.3,h:.4},{x:.25,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.8666666666666667,w:.3,h:.4},{x:.35,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.8666666666666667,w:.3,h:.4},{x:.45,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.8666666666666667,w:.3,h:.4},{x:.55,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.8666666666666667,w:.3,h:.4},{x:.65,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.8666666666666667,w:.3,h:.4},{x:.75,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.8666666666666667,w:.3,h:.4},{x:.85,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.8666666666666667,w:.3,h:.4},{x:.95,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.8666666666666667,w:.3,h:.4},{x:.05,y:1,w:.2,h:.26666666666666666},{x:.05,y:1,w:.3,h:.4},{x:.15,y:1,w:.2,h:.26666666666666666},{x:.15,y:1,w:.3,h:.4},{x:.25,y:1,w:.2,h:.26666666666666666},{x:.25,y:1,w:.3,h:.4},{x:.35,y:1,w:.2,h:.26666666666666666},{x:.35,y:1,w:.3,h:.4},{x:.45,y:1,w:.2,h:.26666666666666666},{x:.45,y:1,w:.3,h:.4},{x:.55,y:1,w:.2,h:.26666666666666666},{x:.55,y:1,w:.3,h:.4},{x:.65,y:1,w:.2,h:.26666666666666666},{x:.65,y:1,w:.3,h:.4},{x:.75,y:1,w:.2,h:.26666666666666666},{x:.75,y:1,w:.3,h:.4},{x:.85,y:1,w:.2,h:.26666666666666666},{x:.85,y:1,w:.3,h:.4},{x:.95,y:1,w:.2,h:.26666666666666666},{x:.95,y:1,w:.3,h:.4},{x:.1,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.13333333333333333,w:.6,h:.8},{x:.1,y:.13333333333333333,w:.8,h:1},{x:.3,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.13333333333333333,w:.6,h:.8},{x:.3,y:.13333333333333333,w:.8,h:1},{x:.5,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.13333333333333333,w:.6,h:.8},{x:.5,y:.13333333333333333,w:.8,h:1},{x:.7,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.13333333333333333,w:.6,h:.8},{x:.7,y:.13333333333333333,w:.8,h:1},{x:.9,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.13333333333333333,w:.6,h:.8},{x:.9,y:.13333333333333333,w:.8,h:1},{x:.1,y:.4,w:.4,h:.5333333333333333},{x:.1,y:.4,w:.6,h:.8},{x:.1,y:.4,w:.8,h:1},{x:.3,y:.4,w:.4,h:.5333333333333333},{x:.3,y:.4,w:.6,h:.8},{x:.3,y:.4,w:.8,h:1},{x:.5,y:.4,w:.4,h:.5333333333333333},{x:.5,y:.4,w:.6,h:.8},{x:.5,y:.4,w:.8,h:1},{x:.7,y:.4,w:.4,h:.5333333333333333},{x:.7,y:.4,w:.6,h:.8},{x:.7,y:.4,w:.8,h:1},{x:.9,y:.4,w:.4,h:.5333333333333333},{x:.9,y:.4,w:.6,h:.8},{x:.9,y:.4,w:.8,h:1},{x:.1,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.1,y:.6666666666666666,w:.6,h:.8},{x:.1,y:.6666666666666666,w:.8,h:1},{x:.3,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.3,y:.6666666666666666,w:.6,h:.8},{x:.3,y:.6666666666666666,w:.8,h:1},{x:.5,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.5,y:.6666666666666666,w:.6,h:.8},{x:.5,y:.6666666666666666,w:.8,h:1},{x:.7,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.7,y:.6666666666666666,w:.6,h:.8},{x:.7,y:.6666666666666666,w:.8,h:1},{x:.9,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.9,y:.6666666666666666,w:.6,h:.8},{x:.9,y:.6666666666666666,w:.8,h:1},{x:.1,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.9333333333333333,w:.6,h:.8},{x:.1,y:.9333333333333333,w:.8,h:1},{x:.3,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.9333333333333333,w:.6,h:.8},{x:.3,y:.9333333333333333,w:.8,h:1},{x:.5,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.9333333333333333,w:.6,h:.8},{x:.5,y:.9333333333333333,w:.8,h:1},{x:.7,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.9333333333333333,w:.6,h:.8},{x:.7,y:.9333333333333333,w:.8,h:1},{x:.9,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.9333333333333333,w:.6,h:.8},{x:.9,y:.9333333333333333,w:.8,h:1}];function fT(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return pT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pT(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function pT(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yT(e,t,r){var n=lA()(new Float32Array(e),[1,r,t,4]);n=n.transpose(0,3,1,2);var i=lA()(new Float32Array(r*t*3),[1,3,r,t]);return cA().assign(i.pick(0,0,null,null),n.pick(0,0,null,null)),cA().assign(i.pick(0,1,null,null),n.pick(0,1,null,null)),cA().assign(i.pick(0,2,null,null),n.pick(0,2,null,null)),cA().mulseq(i,1/127.5),cA().subseq(i,1),i}function gT(e){for(var t=e.tensor,r=e.faceDetectorAccuracy,n=void 0===r?.85:r,i=e.outputHeight,o=void 0===i?240:i,a=e.outputWidth,s=void 0===a?320:a,u=[],l=lA()(t.boxes.data,[1,4420,4]),h=lA()(t.scores.data,[1,4420,2]),c=0;c<4420;c++){if(!(h.data[2*c+1]<=n)){var d=.1*l.data[4*c+0]*dT[c].w+dT[c].x,f=.1*l.data[4*c+1]*dT[c].h+dT[c].y,p=Math.exp(.2*l.data[4*c+2])*dT[c].w,y=Math.exp(.2*l.data[4*c+3])*dT[c].h,g={x1:(d-p/2)*s,y1:(f-y/2)*o,x2:(d+p/2)*s,y2:(f+y/2)*o};if(u.length){var m,w=!1,b=fT(u);try{for(b.s();!(m=b.n()).done;){if(m.value.checkSame(g)){w=!0;break}}}catch(e){b.e(e)}finally{b.f()}w||u.push(new cT(g))}else u.push(new cT(g))}}return u}function mT(e){return mT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mT(e)}function wT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bT(n.key),n)}}function bT(e){var t=function(e,t){if("object"!=mT(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=mT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mT(t)?t:String(t)}var vT=function(){function e(t){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isFinished=!0,this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(r=t.endValue)&&void 0!==r?r:t.startValue,this.smoothPower=null!==(n=t.smoothPower)&&void 0!==n?n:1,this.smoothFunction=function(e){switch(t.smoothFunctionType){case"ease-out-sine":return Math.sin(e*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-e,5);case"ease-out-cubic":Math.pow(1-e,3);default:return e}}}var t,r,n;return t=e,r=[{key:"isEnded",value:function(e){var t,r=Math.max(0,Math.min(1,null!==(t=null==e?void 0:e.percentage)&&void 0!==t?t:1));return(null==e?void 0:e.isreverse)&&(r=1-r),(null==e?void 0:e.isreverse)?this.currentStep<=this.smoothPower*r:this.currentStep>=this.smoothPower*r}},{key:"getCurrentValue",value:function(){return this.currentValue}},{key:"getEndValue",value:function(){return this.endValue}},{key:"setCurrentStep",value:function(e){this.currentStep=e}},{key:"checkEndValueChange",value:function(e){e!==this.endValue&&(this.startValue=this.currentValue,this.endValue=e,this.currentStep=1)}},{key:"useAnimationPart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=Math.min(1,Math.max(0,e));var r=Math.max(1,Math.round(this.smoothPower*e));t?this.currentStep<r&&(this.currentStep=r):this.currentStep>r&&(this.currentStep=r)}},{key:"useSmooth",value:function(e){var t;if(this.startValue===this.endValue)return this.currentValue;var r=(null==e?void 0:e.isReverse)?-1:1,n=this.currentStep/this.smoothPower,i=this.smoothFunction(n);return this.currentValue=this.startValue+(this.endValue-this.startValue)*i,this.smoothPower=null!==(t=null==e?void 0:e.newSmoothPower)&&void 0!==t?t:this.smoothPower,this.isFinished=this.currentStep===((null==e?void 0:e.isReverse)?0:this.smoothPower),this.currentStep=Math.max(0,Math.min(this.smoothPower,this.currentStep+r)),this.currentValue}}],r&&wT(t.prototype,r),n&&wT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xT(e){return xT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xT(e)}function _T(){_T=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==xT(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(xT(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function IT(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function AT(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){IT(o,n,i,a,s,"next",e)}function s(e){IT(o,n,i,a,s,"throw",e)}a(void 0)}))}}function ST(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TT(n.key),n)}}function TT(e){var t=function(e,t){if("object"!=xT(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=xT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xT(t)?t:String(t)}function CT(e,t,r){return t=kT(t),function(e,t){if(t&&("object"===xT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ET()?Reflect.construct(t,r||[],kT(e).constructor):t.apply(e,r))}function ET(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ET=function(){return!!e})()}function OT(){return OT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kT(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},OT.apply(this,arguments)}function kT(e){return kT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kT(e)}function PT(e,t){return PT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},PT(e,t)}var $T=["x1","x2","y1","y2"],RT=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=CT(this,t,[e])).faceCoord={},n.inWork=!1,n.customer_id=r,n.config=Object.assign({},sT),n}var r,n,i,a,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PT(e,t)}(t,e),r=t,n=[{key:"init",value:(u=AT(_T().mark((function e(t){return _T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"facedetector");case 3:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"prepare",value:function(){var e=this,t=this.config,r=t.modelHeight,n=t.modelWidth,i=t.smoothPower;this.globalWidth=this.sdkOptions.width,this.globalHeight=this.sdkOptions.height,this.original=new Ql(this.resources.texture,{width:this.globalWidth,height:this.globalHeight}),this.original.addBuffer("result"),this.small=new Ql(this.resources.texture,{width:n,height:r}),this.small.addBuffer("model"),this.scaleValue=1,this.xOffset=0,this.yOffset=0;var o=this.defaultFaceCoord(),a={};$T.forEach((function(t){e.faceCoord[t]=new vT({startValue:o[t],smoothPower:i}),a[t]=e.faceCoord[t].getCurrentValue()})),this.currentFace=new cT(a),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.globalWidth=this.sdkOptions.width,this.globalHeight=this.sdkOptions.height,this.original.resize(this.globalWidth,this.globalHeight),this.scaleValue=1,this.xOffset=0,this.yOffset=0}},{key:"process",value:(s=AT(_T().mark((function e(){var t=arguments;return _T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.fps=t[1]||1,this.updateWaiter(),this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.findFaces(),this.setCurrentFace(),this.calcScale(),this.calcOffset(),this.setTransfrom(),this.original.frame.setTransform(this.xOffset,this.yOffset,this.scaleValue,this.scaleValue),this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 13:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setCurrentFace",value:function(){var e,t=this;(null===(e=this.faces)||void 0===e?void 0:e.length)?this.checkCurrentFace():this.noFaceWay();var r={};$T.forEach((function(e){t.faceCoord[e].useSmooth({newSmoothPower:t.config.smoothPower}),r[e]=t.faceCoord[e].getCurrentValue()})),this.currentFace=new cT(r),this.config.isFaceSquareDrawingEnabled,this.config.isPreFaceSquareDrawingEnabled}},{key:"checkCurrentFace",value:function(){var e=this;this.updateWaiter(!0);var t=this.faces.reduce((function(e,t){return t.getSquare()>e.getSquare()&&(e=t),e}),this.faces[0]),r=this.config.sensitivityValue/this.scaleValue;if(!t.isEqual(this.currentFace,r,this.globalHeight,this.globalWidth)){var n=t.getCoord();$T.forEach((function(t){e.faceCoord[t].checkEndValueChange(n[t])}))}}},{key:"noFaceWay",value:function(){var e=this;if(this.waiter.value>0)return this.waiter.value--,void this.updateWaiter(!1);var t=this.defaultFaceCoord();$T.forEach((function(r){e.faceCoord[r].checkEndValueChange(t[r])})),this.updateWaiter(!0)}},{key:"calcScale",value:function(){var e=this.globalHeight*this.globalWidth,t=this.currentFace.getSquare()/e,r=this.config.faceAreaProportion/t;this.scaleValue=Math.sqrt(Math.max(r,1))}},{key:"calcOffset",value:function(){var e=this,t=this.currentFace.getCenter(),r={x:{faceCenter:t.x,newOffset:0,base:this.globalWidth},y:{faceCenter:t.y,newOffset:0,base:this.globalHeight}};Object.values(r).forEach((function(t){var r=(e.scaleValue-1)/2*t.base,n=(t.base/2-t.faceCenter)*e.scaleValue,i=(e.scaleValue-1)*t.base,o=Math.max(n-r,-i);t.newOffset=Math.min(0,o)})),this.xOffset=r.x.newOffset,this.yOffset=r.y.newOffset}},{key:"defaultFaceCoord",value:function(){var e=this.globalWidth/2,t=this.globalHeight/2,r=e*Math.sqrt(this.config.faceAreaProportion),n=t*Math.sqrt(this.config.faceAreaProportion);return{x1:e-r,x2:e+r,y1:t-n,y2:t+n}}},{key:"updateWaiter",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.waiter?this.waiter={value:this.fps*this.config.waiterSeconds,fps:this.fps}:(this.waiter.value=this.waiter.value/this.waiter.fps*this.fps,this.waiter.fps=this.fps)}},{key:"findFaces",value:(a=AT(_T().mark((function e(){var t,r,n,i,a,s,u,l=this;return _T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break}return e.abrupt("return");case 4:return this.inWork=!0,t=this.config,r=t.faceDetectorAccuracy,n=t.modelHeight,i=t.modelWidth,a=this.small.getBuffer("model"),e.next=9,this.resources.renderer.pixelsAsync(a);case 9:return s=e.sent,u=yT(new Uint8ClampedArray(s),i,n),e.abrupt("return",this.inference.run(u.data,320,240,"facedetector").then((function(e){l.faces=gT({tensor:e,faceDetectorAccuracy:r,outputHeight:l.globalHeight,outputWidth:l.globalWidth})})).catch((function(e){var t;o.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:o.E7.EFFECT_SMART_ZOOM,cause:e})})).finally((function(){return l.inWork=!1})));case 13:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"enable",value:function(){OT(kT(t.prototype),"enable",this).call(this),this.setTransfrom()}},{key:"setTransfrom",value:function(){this.resources.transform={xOffset:this.xOffset,yOffset:this.yOffset,scaleValue:this.scaleValue}}},{key:"disable",value:function(){OT(kT(t.prototype),"disable",this).call(this),this.resources.transform=null,this.scaleValue=1,this.xOffset=0,this.yOffset=0}},{key:"setConfig",value:function(e,t){this.config[e]=t}},{key:"checkTimer",value:function(){return this.faceDetectorTimer?(performance.now()-this.faceDetectorTimer<this.config.faceDetectorPediod_ms||(this.faceDetectorTimer=0),!1):(this.faceDetectorTimer=performance.now(),!0)}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&ST(r.prototype,n),i&&ST(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(N_);function BT(e){return BT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BT(e)}function DT(){DT=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==BT(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(BT(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function MT(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function LT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FT(n.key),n)}}function FT(e){var t=function(e,t){if("object"!=BT(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=BT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==BT(t)?t:String(t)}function NT(e,t,r){return t=jT(t),function(e,t){if(t&&("object"===BT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,UT()?Reflect.construct(t,r||[],jT(e).constructor):t.apply(e,r))}function UT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(UT=function(){return!!e})()}function jT(e){return jT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jT(e)}function GT(e,t){return GT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},GT(e,t)}var zT=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),NT(this,t,[e])}var r,n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GT(e,t)}(t,e),r=t,n=[{key:"prepare",value:function(){var e=this.resources.texture;this.original=new Ql(e,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.sdkOptions.isCustomSize()?(this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.enable()):this.disable()}},{key:"process",value:(o=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){MT(o,n,i,a,s,"next",e)}function s(e){MT(o,n,i,a,s,"throw",e)}a(void 0)}))}}(DT().mark((function e(){return DT().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&LT(r.prototype,n),i&&LT(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(N_);function VT(e){return VT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VT(e)}function HT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return WT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WT(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WT(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KT(n.key),n)}}function KT(e){var t=function(e,t){if("object"!=VT(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=VT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==VT(t)?t:String(t)}var XT=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={},this.sdkOptions=t,this.container=new yo,this.setOptions(r)}var t,r,n;return t=e,r=[{key:"setOptions",value:function(e){var t=this;e&&Object.entries(e).forEach((function(e){var r=HT(e,2),n=r[0],i=r[1];t.options[n]=i}))}},{key:"show",value:function(){this.beforeShowFunction&&this.beforeShowFunction(),this.container.visible=!0,this.afterShowFunction&&this.afterShowFunction()}},{key:"hide",value:function(){this.beforeHideFunction&&this.beforeHideFunction(),this.container.visible=!1,this.afterHideFunction&&this.afterHideFunction()}},{key:"onBeforeShow",value:function(e){"function"==typeof e&&(this.beforeShowFunction=e)}},{key:"onAfterShow",value:function(e){"function"==typeof e&&(this.afterShowFunction=e)}},{key:"onBeforeHide",value:function(e){"function"==typeof e&&(this.beforeHideFunction=e)}},{key:"onAfterHide",value:function(e){"function"==typeof e&&(this.afterHideFunction=e)}},{key:"isVisible",value:function(){return this.container.visible}},{key:"getOptions",value:function(){return this.options}},{key:"destroy",value:function(){this.container.destroy(!0)}},{key:"px",value:function(e){return this.sdkOptions.width/640*e}},{key:"render",value:function(){}}],r&&YT(t.prototype,r),n&&YT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ZT={set:function(e,t,r){return r instanceof XT?"_"!==t[0]?Reflect.set(e,t,r):e.hasOwnProperty(t)?void 0!==e[t]?(o.ie.notify({type:o.cL.WARNING,message:"You can't overwrite service component '".concat(t,"' (components that begin with a '_' character)"),emitter:o.E7.COMPONENTS_SYSTEM}),!1):Reflect.set(e,t,r):(o.ie.notify({type:o.cL.WARNING,message:"The component ID('".concat(t,"') cannot begin with the character '_', this case reserved for service components."),emitter:o.E7.COMPONENTS_SYSTEM}),!1):(o.ie.notify({type:o.cL.WARNING,message:"Wrong assigned value",emitter:o.E7.COMPONENTS_SYSTEM}),!1)},get:function(e,t,r){if("_getSortedComponentsArr"===t){var n=[],i=[];return Object.keys(e).forEach((function(t){e[t]&&("_"===t[0]?i.push(e[t]):n.push(e[t]))})),n.concat(i)}return Reflect.get(e,t,r)}},qT=r(9456);function JT(e){return JT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JT(e)}function QT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eC(n.key),n)}}function eC(e){var t=function(e,t){if("object"!=JT(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=JT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==JT(t)?t:String(t)}var tC=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sprite=wo.from(t),this.sprite.width=null!=r?r:this.sprite.texture.baseTexture.width,this.sprite.height=null!=n?n:this.sprite.texture.baseTexture.height,this.ratio=this.sprite.width/this.sprite.height}var t,r,n;return t=e,r=[{key:"destroy",value:function(){var e,t;null===(t=null===(e=this.sprite)||void 0===e?void 0:e.texture)||void 0===t||t.destroy(!0)}}],r&&QT(t.prototype,r),n&&QT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rC(){rC=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==dC(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(dC(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function nC(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function iC(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){nC(o,n,i,a,s,"next",e)}function s(e){nC(o,n,i,a,s,"throw",e)}a(void 0)}))}}function oC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aC(n.key),n)}}function aC(e){var t=function(e,t){if("object"!=dC(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=dC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dC(t)?t:String(t)}function sC(e,t,r){return t=hC(t),function(e,t){if(t&&("object"===dC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,uC()?Reflect.construct(t,r||[],hC(e).constructor):t.apply(e,r))}function uC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uC=function(){return!!e})()}function lC(){return lC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hC(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},lC.apply(this,arguments)}function hC(e){return hC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hC(e)}function cC(e,t){return cC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},cC(e,t)}function dC(e){return dC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dC(e)}var fC=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":dC(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},pC=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":dC(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yC=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=sC(this,t,[e,r])).isVideo=!1,n.hide(),n.render(),n}var r,n,i,a,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cC(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e=this;this.container.removeChildren(),this.defaultOverlaySprite=new tC(En.WHITE,1920,1280),this.initOverlayFromUrl(this.options).finally((function(){return e.setOverlayImage()}))}},{key:"show",value:function(){this.switchVideoTexture(!0),lC(hC(t.prototype),"show",this).call(this)}},{key:"hide",value:function(){lC(hC(t.prototype),"hide",this).call(this),this.switchVideoTexture(!1)}},{key:"initOverlayFromUrl",value:(u=iC(rC().mark((function e(t){return rC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.loadImage(null==t?void 0:t.url).then((function(){var e;return null===(e=null==t?void 0:t.promise)||void 0===e?void 0:e.resolve()})).catch((function(e){var r;return null===(r=null==t?void 0:t.promise)||void 0===r?void 0:r.reject(e)})).finally((function(){return null==t||delete t.promise})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setOptions",value:(s=iC(rC().mark((function e(t){return rC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:this.loadImage(t.url).then((function(){var e;return null===(e=t.promise)||void 0===e?void 0:e.resolve()})).catch((function(e){var r;return null===(r=t.promise)||void 0===r?void 0:r.reject(e)})).finally((function(){return null==t||delete t.promise}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"setOverlayImage",value:function(){var e,t=null!==(e=this.loadedOverlaySprite)&&void 0!==e?e:this.defaultOverlaySprite,r=t.sprite,n=t.ratio,i=this.sdkOptions.width,o=this.sdkOptions.height,a=i/o-n,s=r.width;r.width=a>0?i:i-i*a,r.height=r.height*r.width/s,r.anchor.set(.5-i/r.width/2,.5-o/r.height/2),this.container.addChild(r)}},{key:"loadImage",value:(a=iC(rC().mark((function e(t){var r=this;return rC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Invalid url");case 2:if(this.currentURL!==t&&this.processedURL!==t){e.next=4;break}throw new Error("Same url");case 4:return this.processedURL=t,e.next=7,fetch(t,{method:"HEAD"}).then((function(e){if(!e.ok)throw new Error("Overlay Screen: Image loading error")})).catch((function(e){throw o.ie.notify({type:o.cL.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:o.E7.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error")}));case 7:En.fromURL(t).then((function(e){var n,i;r.isVideo=(null===(n=e.baseTexture.resource)||void 0===n?void 0:n.source)instanceof HTMLVideoElement,r.resource=e.baseTexture.resource,r.isVideo&&(r.resource.source.loop=!0,r.resource.source.autoplay=!1,r.container.visible&&r.resource.source.play(),r.resource.source.loop=!0,r.resource.source.muted=!0),r.container.removeChildren(),null===(i=r.loadedOverlaySprite)||void 0===i||i.destroy(),r.loadedOverlaySprite=new tC(e),r.currentURL=t})).catch((function(e){throw o.ie.notify({type:o.cL.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:o.E7.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error")})).finally((function(){r.setOverlayImage(),r.processedURL=""}));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"switchVideoTexture",value:function(e){if(this.isVideo)return e?(this.resource.source.currentTime=0,void this.resource.source.play()):void this.resource.source.pause()}}],n&&oC(r.prototype,n),i&&oC(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(XT);function gC(e){return gC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gC(e)}function mC(){mC=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==gC(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(gC(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function wC(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function bC(e){return vC.apply(this,arguments)}function vC(){return vC=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){wC(o,n,i,a,s,"next",e)}function s(e){wC(o,n,i,a,s,"throw",e)}a(void 0)}))}}(mC().mark((function e(t){return mC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:if(e.sent.ok){e.next=5;break}throw new Error("Url is not available");case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)}))),vC.apply(this,arguments)}function xC(e){return xC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xC(e)}function _C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IC(n.key),n)}}function IC(e){var t=function(e,t){if("object"!=xC(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=xC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xC(t)?t:String(t)}fC([(0,qT.CS)("overlayScreen"),pC("design:type",Function),pC("design:paramtypes",[]),pC("design:returntype",void 0)],yC.prototype,"show",null),fC([(0,qT.CS)("overlayScreen"),pC("design:type",Function),pC("design:paramtypes",[]),pC("design:returntype",void 0)],yC.prototype,"hide",null);var AC=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"calcPosition",value:function(e,t,r,n){return"custom"===r.placement?this.getCustomPosition(e,t,r.x,r.y):this.getPositionFromPlacement(e,t,r.placement,n)}},{key:"getPositionFromPlacement",value:function(e,t,r,n){var i=n.height,o=n.width,a=e,s=t,u={x:0,y:0};return"center"==r?(u.x=(a-o)/2,u.y=(s-i)/2,u):(r.endsWith("right")&&(u.x=a-o),r.startsWith("bottom")&&(u.y=s-i),u)}},{key:"getCustomPosition",value:function(e,t,r,n){return{x:e*r,y:t*n}}}],(r=null)&&_C(t.prototype,r),n&&_C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function SC(e){return SC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SC(e)}function TC(){TC=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==SC(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(SC(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function CC(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function EC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OC(n.key),n)}}function OC(e){var t=function(e,t){if("object"!=SC(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=SC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==SC(t)?t:String(t)}function kC(e,t,r){return t=$C(t),function(e,t){if(t&&("object"===SC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,PC()?Reflect.construct(t,r||[],$C(e).constructor):t.apply(e,r))}function PC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(PC=function(){return!!e})()}function $C(e){return $C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$C(e)}function RC(e,t){return RC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},RC(e,t)}var BC=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=kC(this,t,[e])).sprite=new wo,n.sprite.visible=!1,n.container.addChild(n.sprite),n.setOptions(Object.assign({url:"",position:{placement:"top-left",x:0,y:0},size:.05},r)),n}var r,n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RC(e,t)}(t,e),r=t,n=[{key:"setOptions",value:function(e){(null==e?void 0:e.size)&&this.setSize(e.size),(null==e?void 0:e.position)&&this.setPosition(e.position),(null==e?void 0:e.url)&&this.setURL(e.url)}},{key:"setURL",value:(a=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){CC(o,n,i,a,s,"next",e)}function s(e){CC(o,n,i,a,s,"throw",e)}a(void 0)}))}}(TC().mark((function e(t){var r=this;return TC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.url!==t){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",bC(t).then((function(){return En.fromURL(t)})).then((function(e){r.sprite.visible=!0,r.sprite.texture=e,r.sprite.height=r.sdkOptions.height*r.options.size,r.sprite.width=e.width/e.height*r.sprite.height,r.options.url=t,r.sprite.visible=!0})).catch((function(e){var t;o.ie.notify({message:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e,emitter:o.E7.COMPONENTS_SYSTEM,cause:e})})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"setSize",value:function(e){this.options.size=Math.min(1,Math.max(.01,e));var t=this.sprite.width/this.sprite.height;this.sprite.height=this.sdkOptions.height*this.options.size,this.sprite.width=this.sprite.height*t,this.options.position&&"custom"!==this.options.position.placement&&this.setPosition(this.options.position)}},{key:"setPosition",value:function(e){this.options.position=e;var t={width:this.sprite.width,height:this.sprite.height},r=AC.calcPosition(this.sdkOptions.width,this.sdkOptions.height,e,t),n=r.x,i=r.y;this.sprite.position.x=n,this.sprite.position.y=i}},{key:"clear",value:function(){this.sprite.visible=!1}},{key:"render",value:function(){this.setSize(this.options.size),this.setPosition(this.options.position)}}],n&&EC(r.prototype,n),i&&EC(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(XT);function DC(e){return DC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DC(e)}function MC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LC(n.key),n)}}function LC(e){var t=function(e,t){if("object"!=DC(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=DC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==DC(t)?t:String(t)}var FC=function(){function e(t,r){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=t,this.sprite=r.sprite,this.id=r.id,this.player=r.player,this.canvas=r.canvas,this.aminationPhase=null!==(n=r.aminationPhase)&&void 0!==n?n:"static",this.sprite.alpha=0,this.shrink=Math.max(0,Math.min(1,r.shrink)),this.sourceRatio=this.sprite.texture.baseTexture.width/this.sprite.texture.baseTexture.height,this.setSpriteSize(r.size),this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink}var t,r,n;return t=e,(r=[{key:"isShowing",value:function(){return"showing"===this.aminationPhase}},{key:"isStatic",value:function(){return"static"===this.aminationPhase}},{key:"isHidingStop",value:function(){return 0===this.sprite.alpha}},{key:"animateAlpha",value:function(e){this.isStatic()||(this.sprite.alpha=this.isShowing()?Math.min(this.sprite.alpha+e,1):Math.max(this.sprite.alpha-e,0),1!==this.sprite.alpha&&0!==this.sprite.alpha||(this.aminationPhase="static"))}},{key:"animateSize",value:function(e){if(!this.isStatic()){var t=this.height*e*(1-this.shrink),r=this.width*e*(1-this.shrink);this.sprite.height=this.isShowing()?Math.min(this.sprite.height+t,this.height):Math.max(this.sprite.height-t,this.height*this.shrink),this.sprite.width=this.isShowing()?Math.min(this.sprite.width+r,this.width):Math.max(this.sprite.width-r,this.width*this.shrink)}}},{key:"animatePosition",value:function(e){this.isStatic()||(this.sprite.position.x=e.x+(this.width-this.sprite.width)/2,this.sprite.position.y=e.y+(this.height-this.sprite.height)/2)}},{key:"reset",value:function(){this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink,this.sprite.alpha=0}},{key:"setSpriteSize",value:function(e){this.height=this.sdkOptions.height*(null!=e?e:.3),this.width=this.height*this.sourceRatio,this.sprite.height=this.height,this.sprite.width=this.width}}])&&MC(t.prototype,r),n&&MC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),NC=r(6240),UC=r.n(NC);function jC(){jC=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==qC(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(qC(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function GC(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function zC(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){GC(o,n,i,a,s,"next",e)}function s(e){GC(o,n,i,a,s,"throw",e)}a(void 0)}))}}function VC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HC(n.key),n)}}function HC(e){var t=function(e,t){if("object"!=qC(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=qC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qC(t)?t:String(t)}function WC(e,t,r){return t=XC(t),function(e,t){if(t&&("object"===qC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,YC()?Reflect.construct(t,r||[],XC(e).constructor):t.apply(e,r))}function YC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(YC=function(){return!!e})()}function KC(){return KC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=XC(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},KC.apply(this,arguments)}function XC(e){return XC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},XC(e)}function ZC(e,t){return ZC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ZC(e,t)}function qC(e){return qC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qC(e)}var JC=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":qC(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},QC=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":qC(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},eE=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=WC(this,t,[e,Object.assign({capacity:8,duration:1500,animationSpeed:.08,position:{x:0,y:0,placement:"top-left"}},n)])).spriteStore=[],r.ticker=new Fi,r.ticker.add((function(){return r.animateSticker()})),r.hide(),r}var r,n,i,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZC(e,t)}(t,e),r=t,n=[{key:"show",value:function(){KC(XC(t.prototype),"show",this).call(this),this.ticker.start()}},{key:"hide",value:function(){KC(XC(t.prototype),"hide",this).call(this),this.ticker.stop()}},{key:"onLoadSucccess",value:function(e){var t="function"==typeof e;this.loadSuccesssFunc=t?e:void 0}},{key:"onLoadError",value:function(e){var t="function"==typeof e;this.loadErrorFunc=t?e:void 0}},{key:"setOptions",value:(a=zC(jC().mark((function e(r){return jC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:r.position&&(this.updateSpritePosition(r.position),delete r.position),r.sticker&&(this.addSticker(r.sticker),delete r.sticker),r.id&&(this.selectSticker(r.id),delete r.id),KC(XC(t.prototype),"setOptions",this).call(this,r),r.size&&this.activeSticker&&this.activeSticker.setSpriteSize(r.size),r.duration&&this.activeSticker&&!this.activeSticker.isHidingStop()&&this.setOptions({id:this.activeID});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"selectSticker",value:function(e){var t,r,n=this;if(e===this.activeID)return 0===this.activeSticker.sprite.alpha&&this.show(),this.activeSticker.aminationPhase="showing",clearTimeout(this.timerId),void(this.timerId=setTimeout((function(){return n.activeSticker.aminationPhase="hiding"}),this.options.duration));this.activeSticker&&(this.container.removeChildren(),null===(t=this.activeSticker.player)||void 0===t||t.stop(),this.activeSticker.reset()),this.activeID=e;var i=this.spriteStore.find((function(e){return e.id===n.activeID}));i&&(null===(r=i.player)||void 0===r||r.play(),i.sprite.position.x=this.options.position.x,i.sprite.position.y=this.options.position.y,i.aminationPhase="showing",this.container.addChild(i.sprite),this.activeSticker=i,this.activeSticker.setSpriteSize(this.options.size),this.calcPosition(),clearTimeout(this.timerId),this.show(),this.timerId=setTimeout((function(){n.activeSticker.aminationPhase="hiding"}),this.options.duration))}},{key:"loadSticker",value:(o=zC(jC().mark((function e(t){var r,n,i,o,a,s,u,l,h,c=arguments;return jC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]&&c[1],i=void 0,o=void 0,a=void 0,e.next=6,tE(t);case 6:if(!e.sent){e.next=16;break}return e.t0=wo,e.next=11,En.fromURL(t);case 11:e.t1=e.sent,(a=new e.t0(e.t1)).texture.baseTexture.resource.source.loop=!0,e.next=35;break;case 16:return e.next=18,fetch(t).then((function(e){return e.arrayBuffer()})).catch((function(e){throw console.log("[ Stickers component ] - url fetching: ".concat(e)),e}));case 18:if(s=e.sent,!((u=UC()(s))instanceof Error)){e.next=28;break}return e.t2=wo,e.next=24,En.fromURL(t);case 24:e.t3=e.sent,a=new e.t2(e.t3),e.next=35;break;case 28:return(i=document.createElement("canvas")).width=u.width,i.height=u.height,e.next=33,u.getPlayer(i.getContext("2d",{willReadFrequently:!0}),!0);case 33:o=e.sent,a=new wo(En.from(i));case 35:return this.spriteStore.push(new FC(this.sdkOptions,{id:t,sprite:a,player:o,canvas:i,shrink:.99,size:this.options.size})),r||this.setOptions({id:t}),l={},this.spriteStore.length>this.options.capacity&&(h=this.spriteStore.shift(),l.removedID=null==h?void 0:h.id,null==h||h.sprite.destroy(!0),null===(n=null==h?void 0:h.canvas)||void 0===n||n.remove()),e.abrupt("return",l);case 40:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"animateSticker",value:function(){var e,t,r;(null===(r=null===(t=null===(e=this.activeSticker)||void 0===e?void 0:e.sprite)||void 0===t?void 0:t.texture)||void 0===r?void 0:r.baseTexture)&&(this.activeSticker.animateSize(this.options.animationSpeed),this.activeSticker.animatePosition(this.options.position),this.activeSticker.animateAlpha(this.options.animationSpeed),this.activeSticker.isHidingStop()?this.hide():this.activeSticker.sprite.texture.update())}},{key:"updateSpritePosition",value:function(e){var t;this.options.position||(this.options.position={});var r=this.sdkOptions.width,n=this.sdkOptions.height;e.x&&(this.options.position.x=r*e.x),e.y&&(this.options.position.y=n*e.y),e.placement&&(this.options.position.placement=e.placement),(null===(t=this.activeSticker)||void 0===t?void 0:t.sprite)&&(this.calcPosition(),this.activeSticker.sprite.position.x=this.options.position.x,this.activeSticker.sprite.position.y=this.options.position.y)}},{key:"addSticker",value:function(e){var t=this,r=function(r){var n,i;"function"==typeof(null===(n=null==e?void 0:e.promise)||void 0===n?void 0:n.resolve)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.resolve(r)),"function"==typeof t.loadSuccesssFunc&&t.loadSuccesssFunc(e.url,null==r?void 0:r.removedID)};this.spriteStore.some((function(t){return t.id===e.url}))?r():this.loadSticker(e.url,null==e?void 0:e.silenceMode).then(r).catch((function(r){var n,i;"function"==typeof(null===(n=null==e?void 0:e.promise)||void 0===n?void 0:n.reject)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.reject(r)),"function"==typeof t.loadErrorFunc&&t.loadErrorFunc(e.url)}))}},{key:"calcPosition",value:function(){if("custom"!==this.options.position.placement&&this.options.position.placement){var e=this.sdkOptions.width-this.activeSticker.width,t=this.sdkOptions.height-this.activeSticker.height;if("center"===this.options.position.placement)return this.options.position.x=.5*e,void(this.options.position.y=.5*t);this.options.position.x=~this.options.position.placement.indexOf("left")?0:e,this.options.position.y=~this.options.position.placement.indexOf("top")?0:t}}}],n&&VC(r.prototype,n),i&&VC(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(XT);function tE(e){return rE.apply(this,arguments)}function rE(){return rE=zC(jC().mark((function e(t){var r;return jC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:return r=e.sent,e.abrupt("return",!!~r.headers.get("content-type").indexOf("video"));case 4:case"end":return e.stop()}}),e)}))),rE.apply(this,arguments)}function nE(){nE=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==cE(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(cE(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function iE(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function oE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aE(n.key),n)}}function aE(e){var t=function(e,t){if("object"!=cE(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=cE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cE(t)?t:String(t)}function sE(e,t,r){return t=lE(t),function(e,t){if(t&&("object"===cE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,uE()?Reflect.construct(t,r||[],lE(e).constructor):t.apply(e,r))}function uE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uE=function(){return!!e})()}function lE(e){return lE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lE(e)}function hE(e,t){return hE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hE(e,t)}function cE(e){return cE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cE(e)}JC([(0,qT.CS)(),QC("design:type",Function),QC("design:paramtypes",[String]),QC("design:returntype",void 0)],eE.prototype,"selectSticker",null);var dE=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":cE(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},fE=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":cE(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pE=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=sE(this,t,[e])).fonts={},n.isShowing=!1,n.isHiding=!1,n.options={position:{x:0,y:0,placement:"bottom-left"},color:{primary:33777,secondary:16777215,text:1118481},offset:{x:0,y:0},text:{title:"LowerThird Title",subtitle:"LowerThird Subtitle",maxLengthTitle:10,maxLengthSubtitle:100}},n.setOptions(r,!1),n.ticker=new Fi,n.container.visible=!1,n}var r,n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hE(e,t)}(t,e),r=t,n=[{key:"render",value:function(){}},{key:"setOptions",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(this.setColor(e.color),this.setOffset(e.offset),this.setPosition(e.position),this.setText(e.text),t&&this.render())}},{key:"showLowerThird",value:function(){this.stopHiding(),"function"==typeof this.showFunction&&(this.ticker.add(this.showFunction),this.ticker.started||this.ticker.start(),this.isShowing=!0)}},{key:"hideLowerThird",value:function(){this.stopShowing(),"function"==typeof this.hideFunction&&(this.isHiding=!0,this.ticker.add(this.hideFunction),this.ticker.started||this.ticker.start())}},{key:"stopShowing",value:function(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.showFunction),this.isShowing=!1}},{key:"stopHiding",value:function(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.hideFunction),this.isHiding=!1}},{key:"setColor",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.color[r]=e[r]}))}},{key:"setOffset",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.offset[r]=Math.min(.25,Math.max(0,e[r]))}))}},{key:"setPosition",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.position[r]=e[r]}))}},{key:"setText",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.text[r]=e[r]}))}},{key:"offsetX",value:function(){var e;return this.sdkOptions.width*(null!==(e=this.options.offset.x)&&void 0!==e?e:0)}},{key:"offsetY",value:function(){var e;return this.sdkOptions.height*(null!==(e=this.options.offset.y)&&void 0!==e?e:0)}},{key:"strTrimAndEllipsis",value:function(e,t){return(e=e.trim()).length<t?e:e.substring(0,t-3)+"..."}},{key:"showOffset",value:function(){var e=new uu;e.lineStyle({color:14550873,width:1}).drawRect(this.offsetX(),this.offsetY(),this.sdkOptions.width-2*this.offsetX(),this.sdkOptions.height-2*this.offsetY()),this.container.addChild(e)}},{key:"drawRectPrimary",value:function(e,t,r,n){var i=new uu;return i.beginFill(this.options.color.primary).drawRect(e,t,r,n).endFill(),i}},{key:"drawRectSecondary",value:function(e,t,r,n){var i=new uu;return i.beginFill(this.options.color.secondary).drawRect(e,t,r,n).endFill(),i}},{key:"fontFamily",value:function(e){var t;return null!==(t=this.fonts[e])&&void 0!==t?t:"Arial, Helvetica, sans-serif"}},{key:"loadFont",value:(a=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){iE(o,n,i,a,s,"next",e)}function s(e){iE(o,n,i,a,s,"throw",e)}a(void 0)}))}}(nE().mark((function e(t,r){var n=this;return nE().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ra.load(r).then((function(e){n.fonts[t]||(n.fonts[t]=[]),n.fonts[t].push('"'.concat(e.family.replace(/[\\"]/g,"\\$&"),'"'))})).catch((function(e){o.ie.notify({type:o.cL.WARNING,message:"LowerThird font loading. ".concat(e),cause:e,emitter:o.E7.COMPONENTS_SYSTEM})}));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"destroy",value:function(){var e;this.stopShowing(),this.stopHiding(),this.hide(),null===(e=this.container)||void 0===e||e.destroy(!0)}}],n&&oE(r.prototype,n),i&&oE(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(XT);function yE(e){return yE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yE(e)}function gE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mE(n.key),n)}}function mE(e){var t=function(e,t){if("object"!=yE(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=yE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yE(t)?t:String(t)}dE([(0,qT.CS)(),fE("design:type",Function),fE("design:paramtypes",[]),fE("design:returntype",void 0)],pE.prototype,"showLowerThird",null),dE([(0,qT.CS)(),fE("design:type",Function),fE("design:paramtypes",[]),fE("design:returntype",void 0)],pE.prototype,"hideLowerThird",null);var wE=function(){function e(t){var r,n,i,o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(r=t.endValue)&&void 0!==r?r:t.startValue,this.smoothPower=null!==(n=t.smoothPower)&&void 0!==n?n:1,this.range=this.endValue-this.startValue,this.speedNext=null!==(i=t.speedNext)&&void 0!==i?i:1,this.speedBack=null!==(a=null!==(o=t.speedBack)&&void 0!==o?o:t.speedNext)&&void 0!==a?a:1,this.smoothFunctionNext=this.getSmoothFunction(t.smoothFunctionNext),this.smoothFunctionBack=this.getSmoothFunction(null!==(s=t.smoothFunctionBack)&&void 0!==s?s:t.smoothFunctionNext)}var t,r,n;return t=e,r=[{key:"setCurrentStep",value:function(e){this.currentStep=Math.max(0,Math.min(e,this.smoothPower))}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"setEnd",value:function(){return this.currentStep=this.smoothPower,this.endValue}},{key:"isEnd",value:function(e){return this.currentStep>=this.smoothPower*(null!=e?e:1)}},{key:"isStart",value:function(e){return this.currentStep<=this.smoothPower*(null!=e?e:0)}},{key:"reset",value:function(){this.currentStep=0}},{key:"next",value:function(){if(this.startValue===this.endValue)return this.currentValue;var e=this.currentStep/this.smoothPower,t=this.smoothFunctionNext(e);return this.currentValue=this.startValue+this.range*t,this.currentStep=Math.min(this.smoothPower,this.currentStep+this.speedNext),this.currentValue}},{key:"back",value:function(){if(this.startValue===this.endValue)return this.currentValue;this.currentStep=Math.max(0,this.currentStep-this.speedBack);var e=this.currentStep/this.smoothPower,t=this.smoothFunctionBack(e);return this.currentValue=this.startValue+this.range*t,this.currentValue}},{key:"getSmoothFunction",value:function(e){return function(t){switch(e){case"ease-out-sine":return Math.sin(t*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-t,5);case"ease-out-cubic":Math.pow(1-t,3);default:return t}}}}],r&&gE(t.prototype,r),n&&gE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function bE(e){return bE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bE(e)}function vE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xE(n.key),n)}}function xE(e){var t=function(e,t){if("object"!=bE(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bE(t)?t:String(t)}function _E(e,t,r){return t=AE(t),function(e,t){if(t&&("object"===bE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,IE()?Reflect.construct(t,r||[],AE(e).constructor):t.apply(e,r))}function IE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(IE=function(){return!!e})()}function AE(e){return AE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},AE(e)}function SE(e,t){return SE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},SE(e,t)}var TE=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_E(this,t,[e,r])).animations={},n.smoothPower=65,n.ltContainer=new yo,n.container.addChild(n.ltContainer),n.addShowFunction(),n.addHideFunction(),n.render(),n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SE(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e;null===(e=this.ltContainer)||void 0===e||e.destroy(!0),this.ltContainer=new yo,this.ltContainer.position.x=this.offsetX(),this.container.addChild(this.ltContainer),this.createText(),this.addRectangles(),this.addSpriteMask(),this.ltContainer.addChild(this.rectBack),this.ltContainer.addChild(this.rectFront),this.ltContainer.addChild(this.title),this.ltContainer.addChild(this.subtitle)}},{key:"createText",value:function(){var e=this,t=this.sdkOptions.width-2*this.offsetX()-this.px(70),r=function(r,n,i){return{fontFamily:"Trebuchet MS",fontSize:e.px(r),fontWeight:n,fill:i,wordWrapWidth:t,wordWrap:!0,breakWords:!0}};this.subtitle=new Lu(this.options.text.subtitle,r(12,"400",this.options.color.primary)),this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.sdkOptions.height-this.offsetY()-this.px(12)-this.subtitle.height,this.animations.subtitle=new wE({startValue:-this.subtitle.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.title=new Lu(this.options.text.title,r(20,"700",1118481)),this.title.width=Math.min(t,this.title.width),this.title.position.x=-this.title.width,this.title.position.y=this.sdkOptions.height-this.offsetY()-this.px(15)-this.subtitle.height-this.title.height,this.animations.title=new wE({startValue:-this.title.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(45),this.ltHeight=this.title.height+this.subtitle.height+this.px(23),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"addRectangles",value:function(){var e=this.sdkOptions.height-this.offsetY()-this.ltHeight;this.rectBack=(new uu).beginFill(this.options.color.primary).drawRoundedRect(0,e,this.ltWidth,this.ltHeight,this.px(5)).endFill(),this.animations.rectBack=new wE({startValue:-this.rectBack.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.rectFront=(new uu).beginFill(16777215).drawRoundedRect(0,e,this.ltWidth-this.px(15),this.ltHeight,this.px(5)).endFill(),this.rectFront.position.x=-this.ltWidth+this.px(15),this.animations.rectFront=new wE({startValue:-this.rectFront.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.isVisible()&&(this.rectBack.position.x=this.animations.rectBack.setEnd(),this.rectFront.position.x=this.animations.rectFront.setEnd())}},{key:"addSpriteMask",value:function(){this.mask=new wo(En.WHITE),this.mask.width=this.ltWidth,this.mask.height=this.sdkOptions.height,this.ltContainer.addChild(this.mask),this.ltContainer.mask=this.mask}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd(.3)&&(e.rectFront.position.x=e.animations.rectFront.next()),e.animations.rectBack.isEnd(.8)&&(e.title.position.x=e.animations.title.next()),e.animations.title.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next()),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing()}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){e.isHiding||(e.stopHiding(),e.hide()),e.subtitle.position.x=e.animations.subtitle.back(),e.title.position.x=e.animations.title.back(),e.rectFront.position.x=e.animations.rectFront.back(),e.rectBack.position.x=e.animations.rectBack.back(),e.isHiding=!e.animations.rectBack.isStart()}}}],n&&vE(r.prototype,n),i&&vE(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(pE);function CE(e){return CE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CE(e)}function EE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OE(n.key),n)}}function OE(e){var t=function(e,t){if("object"!=CE(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=CE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==CE(t)?t:String(t)}function kE(e,t,r){return t=$E(t),function(e,t){if(t&&("object"===CE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,PE()?Reflect.construct(t,r||[],$E(e).constructor):t.apply(e,r))}function PE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(PE=function(){return!!e})()}function $E(e){return $E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$E(e)}function RE(e,t){return RE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},RE(e,t)}var BE={cyrillic:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVYNyB1Wk.woff2",latin:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVZNyB.woff2"},DE={cyrillic:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVYNyB1Wk.woff2",latin:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVZNyB.woff2"},ME=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=kE(this,t,[e,r])).isReady=!1,n.animations={},n.smoothPower={title:35,subtitle:35,middleLine:50},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",BE.cyrillic),n.loadFont("title",BE.latin),n.loadFont("subtitle",DE.cyrillic),n.loadFont("subtitle",DE.latin)]).finally((function(){n.isReady=!0,n.render()})),n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RE(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t;this.container.removeChild(this.middleLine),this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createText(),this.createRectangles(),this.container.addChild(this.middleLine),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer)}},{key:"createText",value:function(){this.title=new Lu(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(35),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.title.position.x=0,this.title.position.y=this.title.height,this.titleContainer=new yo,this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height+this.px(200);var e=new wo(En.WHITE);e.tint=0,e.width=this.title.width,e.height=this.title.height,e.position.x=0,e.position.y=0,this.titleContainer.addChild(e),this.titleContainer.mask=e,this.titleContainer.addChild(this.title),this.animations.title=new wE({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"}),this.subtitle=new Lu(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fontWeight:"100",fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.subtitle.position.x=0,this.subtitle.position.y=-this.subtitle.height-this.px(20),this.subtitleContainer=new yo,this.subtitleContainer.width=this.subtitle.width,this.subtitleContainer.height=this.subtitle.height+this.px(20);var t=new wo(En.WHITE);t.tint=0,t.width=this.subtitle.width,t.height=this.subtitle.height,t.position.x=0,t.position.y=0,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.subtitleContainer.addChild(this.subtitle),this.animations.subtitle=new wE({startValue:this.subtitle.position.y,smoothPower:this.smoothPower.subtitle,endValue:0,smoothFunctionNext:"ease-out-quint"}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(25),this.ltHeight=this.titleContainer.height+this.subtitleContainer.height+this.px(10),this.titleContainer.position.x=this.offsetX(),this.subtitleContainer.position.x=this.offsetX();var r=this.titleContainer.width-this.subtitleContainer.width;r>0?this.subtitleContainer.position.x+=r:this.titleContainer.position.x-=r,this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight,this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height,this.isVisible()&&(this.title.position.y=0,this.subtitle.position.y=0,this.animations.title.setCurrentStep(this.smoothPower.title),this.animations.subtitle.setCurrentStep(this.smoothPower.subtitle))}},{key:"createRectangles",value:function(){this.middleLine=new uu;var e=this.ltWidth+this.offsetX(),t=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height-this.px(8);this.middleLine.beginFill(this.options.color.primary).drawRoundedRect(-e-this.px(2),t,e,this.px(3),this.px(2)).endFill(),this.animations.middleLine=new wE({startValue:0,smoothPower:this.smoothPower.middleLine,endValue:e,smoothFunctionNext:"ease-out-quint"}),this.isVisible()&&(this.middleLine.position.x=e,this.animations.middleLine.setCurrentStep(this.smoothPower.middleLine))}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.middleLine.position.x=e.animations.middleLine.next(),e.animations.middleLine.isEnd(.5)&&(e.title.position.y=e.animations.title.next()),e.animations.middleLine.isEnd(.5)&&(e.subtitle.position.y=e.animations.subtitle.next()),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing())}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.y=e.animations.subtitle.back(),e.animations.title.isStart(.7)&&(e.middleLine.position.x=e.animations.middleLine.back()),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],n&&EE(r.prototype,n),i&&EE(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(pE);function LE(e){return LE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},LE(e)}function FE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NE(n.key),n)}}function NE(e){var t=function(e,t){if("object"!=LE(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=LE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==LE(t)?t:String(t)}function UE(e,t,r){return t=GE(t),function(e,t){if(t&&("object"===LE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,jE()?Reflect.construct(t,r||[],GE(e).constructor):t.apply(e,r))}function jE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jE=function(){return!!e})()}function GE(e){return GE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},GE(e)}function zE(e,t){return zE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zE(e,t)}var VE={cyrillic:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w9aXpsog.woff2",latin:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w5aXo.woff2"},HE={cyrillic:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw9aXpsog.woff2",latin:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw5aXo.woff2"},WE=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=UE(this,t,[e,r])).titleFontSize=35,n.animations={},n.isReady=!1,n.smoothPower={title:95,subtitle:95,titleRect:75,titleTextMask:75,titleRectMask:75,rectFront:40,rectBack:40},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",VE.cyrillic),n.loadFont("title",VE.latin),n.loadFont("subtitle",HE.cyrillic),n.loadFont("subtitle",HE.latin)]).finally((function(){n.isReady=!0,n.render()})),n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zE(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t,r;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),this.container.removeChild(this.vertLineContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),null===(r=this.vertLineContainer)||void 0===r||r.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer),this.container.addChild(this.vertLineContainer)}},{key:"createTitle",value:function(){var e;this.title=new Lu(null===(e=this.options.text.title)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("title"),fontSize:this.px(this.titleFontSize),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,lineHeight:this.px(this.titleFontSize)}),this.title.position.x=.3*this.title.width,this.animations.title=new wE({startValue:this.title.position.x,endValue:this.px(10),smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint",speedBack:1.3});var t=new yo;t.width=this.title.width+this.px(10),t.height=this.title.height,t.addChild(this.title),this.titleTextMask=new wo(En.WHITE),this.titleTextMask.width=0,this.titleTextMask.height=this.title.height,t.addChild(this.titleTextMask),t.mask=this.titleTextMask,this.animations.titleTextMask=new wE({startValue:0,endValue:this.title.width+this.px(10),smoothPower:this.smoothPower.titleTextMask,smoothFunctionNext:"ease-out-quint",speedBack:1.25}),this.titleRect=this.drawRectSecondary(0,this.px(this.titleFontSize/3.5),this.title.width,this.title.height-this.px(this.titleFontSize/2.2)),this.animations.titleRect=new wE({startValue:.2*-this.title.width,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRect,smoothFunctionNext:"ease-out-quint",speedNext:.5,speedBack:1.1});var r=new yo;r.width=this.titleRect.width,r.height=this.titleRect.height,r.addChild(this.titleRect),this.titleRectMask=new wo(En.WHITE),this.titleRectMask.width=0,this.titleRectMask.height=this.title.height,r.addChild(this.titleRectMask),r.mask=this.titleRectMask,this.animations.titleRectMask=new wE({startValue:0,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRectMask,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:1}),this.titleContainer=new yo,this.titleContainer.width=this.title.width+this.px(10),this.titleContainer.height=this.title.height,this.titleContainer.addChild(t),this.titleContainer.addChild(r),this.ltHeight=this.title.height+this.subtitleContainer.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight+this.px(3),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.titleTextMask.width=this.animations.titleTextMask.setEnd(),this.titleRect.position.x=this.animations.titleRect.setEnd(),this.titleRectMask.width=this.animations.titleRectMask.setEnd())}},{key:"createSubtitle",value:function(){var e;this.subtitle=new Lu(null===(e=this.options.text.subtitle)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(11),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.subtitle.position.x=-this.subtitle.width,this.animations.subtitle=new wE({startValue:this.subtitle.position.x,endValue:this.px(11),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint",speedBack:1.2}),this.subtitleContainer=new yo,this.subtitleContainer.width=this.subtitle.width+this.px(10),this.subtitleContainer.height=this.subtitle.height,this.subtitleContainer.addChild(this.subtitle),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height;var t=new wo(En.WHITE);t.width=this.subtitle.width+this.px(10),t.height=this.subtitle.height,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"createRectangles",value:function(){var e=this.title.height-this.px(this.titleFontSize/2.2);this.rectFront=this.drawRectPrimary(0,0,this.px(4),e),this.animations.rectFront=new wE({startValue:e,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:.8,speedBack:1}),this.rectBack=this.drawRectSecondary(0,0,this.px(4),this.px(4)),this.animations.rectBack=new wE({startValue:e,endValue:-this.px(4),smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:.6}),this.vertLineContainer=new yo,this.vertLineContainer.width=this.rectFront.width,this.vertLineContainer.height=e,this.vertLineContainer.addChild(this.rectBack),this.vertLineContainer.addChild(this.rectFront),this.vertLineContainer.position.x=this.offsetX(),this.vertLineContainer.position.y=this.titleContainer.position.y+this.px(this.titleFontSize/3.5);var t=new wo(En.WHITE);t.width=this.vertLineContainer.width,t.height=e,this.vertLineContainer.addChild(t),this.vertLineContainer.mask=t,this.isVisible()&&(this.rectFront.position.y=this.animations.rectFront.setEnd())}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectFront.position.y=e.animations.rectFront.next(),e.rectBack.position.y=e.animations.rectBack.next(),e.animations.rectFront.isEnd(.9)&&(e.title.position.x=e.animations.title.next(),e.subtitle.position.x=e.animations.subtitle.next(),e.titleTextMask.width=e.animations.titleTextMask.next(),e.titleRectMask.width=e.animations.titleRectMask.next(),e.titleRect.position.x=e.animations.titleRect.next(),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing()))}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.x=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.titleRect.getCurrentStep()<e.smoothPower.titleRect-2&&(e.titleTextMask.width=e.animations.titleTextMask.back()),e.titleRect.position.x=e.animations.titleRect.back(),e.titleRectMask.width=e.animations.titleRectMask.back(),e.animations.titleRectMask.isStart(.2)&&(e.rectBack.position.y=e.animations.rectBack.back(),e.rectFront.position.y=e.animations.rectFront.back()),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],n&&FE(r.prototype,n),i&&FE(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(pE);function YE(e){return YE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},YE(e)}function KE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XE(n.key),n)}}function XE(e){var t=function(e,t){if("object"!=YE(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=YE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==YE(t)?t:String(t)}function ZE(e,t,r){return t=JE(t),function(e,t){if(t&&("object"===YE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,qE()?Reflect.construct(t,r||[],JE(e).constructor):t.apply(e,r))}function qE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(qE=function(){return!!e})()}function JE(e){return JE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},JE(e)}function QE(e,t){return QE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},QE(e,t)}var eO={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWF1lEP2A.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWE1lE.woff2"},tO={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2"},rO=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ZE(this,t,[e,r])).animations={},n.isReady=!1,n.smoothPower={title:75,subtitle:65,rectFront:40,rectBack:40},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",eO.cyrillic),n.loadFont("title",eO.latin),n.loadFont("subtitle",tO.cyrillic),n.loadFont("subtitle",tO.latin)]).finally((function(){n.isReady=!0,n.render()})),n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QE(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer)}},{key:"createSubtitle",value:function(){this.subtitle=new Lu(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0});var e=this.subtitle.width+this.px(6);this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.px(3),this.animations.subtitle=new wE({startValue:this.subtitle.position.x,endValue:this.px(10),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint"}),this.subtitleContainer=new yo,this.subtitleContainer.width=e,this.subtitleContainer.height=this.subtitle.height+this.px(6),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height-this.px(6),this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"createTitle",value:function(){this.title=new Lu(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(30),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.title.position.y=this.title.height,this.animations.title=new wE({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"});var e=new wo(En.WHITE);e.width=this.title.width,e.height=this.title.height,this.titleContainer=new yo,this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height,this.titleContainer.addChild(this.title),this.titleContainer.addChild(e),this.titleContainer.mask=e,this.ltWidth=Math.max(this.title.width,this.subtitle.width+this.px(15)),this.ltHeight=this.title.height+this.subtitle.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight-this.px(6),this.isVisible()&&(this.title.position.y=this.animations.title.setEnd())}},{key:"createRectangles",value:function(){var e=this.subtitle.height+this.px(6),t=this.ltWidth;this.rectFront=this.drawRectPrimary(0,0,t,e),this.rectFront.position.x=-t,this.animations.rectFront=new wE({startValue:-t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"}),this.rectBack=this.drawRectSecondary(0,0,t,e),this.rectBack.position.x=t,this.animations.rectBack=new wE({startValue:t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"});var r=new wo(En.WHITE);r.width=t,r.height=this.subtitle.height+this.px(6),this.subtitleContainer.addChild(r),this.subtitleContainer.mask=r,this.subtitleContainer.addChild(this.rectBack),this.subtitleContainer.addChild(this.rectFront),this.subtitleContainer.addChild(this.subtitle),this.isVisible()&&(this.rectFront.position.x=this.animations.rectFront.setEnd(),this.rectBack.position.x=this.animations.rectBack.setEnd())}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd()&&(e.rectFront.position.x=e.animations.rectFront.next(),e.animations.rectFront.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next(),e.title.position.y=e.animations.title.next(),e.animations.title.isEnd()&&e.animations.subtitle.isEnd()&&e.stopShowing())))}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.subtitle.isStart(.5)&&(e.rectFront.position.x=e.animations.rectFront.back(),e.animations.rectFront.isStart()&&(e.rectBack.position.x=e.animations.rectBack.back())),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],n&&KE(r.prototype,n),i&&KE(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(pE);function nO(e){return nO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nO(e)}function iO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oO(n.key),n)}}function oO(e){var t=function(e,t){if("object"!=nO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=nO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nO(t)?t:String(t)}var aO=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.padding=20,this.smoothPower=75,this.startRectValue=0,this.sdkOptions=t,this.container=new yo,this.addText(r),this.addRect(r),this.addHidden(r);var n=new wo(En.WHITE);n.height=this.height,n.width=r.offsetX+this.width,n.position.x=-r.offsetX,this.container.addChild(n),this.container.mask=n,r.isVisible&&(this.text.position.x=this.textInAnimation.setEnd(),this.hiddenMask.position.x=this.hiddenMaskAnimation.setEnd(),this.rect.position.x=this.rectAnimation.setEnd())}var t,r,n;return t=e,r=[{key:"textInAnimateFunction",value:function(){this.text.position.x=this.textInAnimation.next()}},{key:"textOutAnimateFunction",value:function(){this.text.position.x=this.textOutAnimation.next()}},{key:"textResetFunction",value:function(){this.text.position.x=2*this.px(this.padding)+this.width}},{key:"rectAnimateFunction",value:function(e){this.rect.position.x=e?this.rectAnimation.next():this.rectAnimation.back()}},{key:"hiddenMaskAnimateFunction",value:function(e){this.hiddenMask.position.x=e?this.rectAnimation.next():this.rectAnimation.back()}},{key:"destroy",value:function(){var e;null===(e=this.container)||void 0===e||e.destroy(!0)}},{key:"addText",value:function(e){this.text=new Lu(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorText,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0}),this.height=1.2*this.text.height,this.width=this.text.width+2*this.px(this.padding);var t=2*this.px(this.padding)+this.width;this.text.position.x=t,this.text.position.y=this.px(e.size/8.5),this.textInAnimation=new wE({startValue:t,endValue:this.px(this.padding),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.textOutAnimation=new wE({startValue:this.px(this.padding),endValue:-this.width-this.px(this.padding)-e.offsetX,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.text)}},{key:"addRect",value:function(e){this.rect=(new uu).beginFill(e.colorRect).drawRect(0,0,this.width,this.height).endFill(),this.startRectValue=-e.offsetX-this.width,this.rect.position.x=this.startRectValue,this.rectAnimation=new wE({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.rect)}},{key:"addHidden",value:function(e){this.hiddenMask=new wo(En.WHITE),this.hiddenMask.width=this.width,this.hiddenMask.height=this.height,this.hiddenMask.position.x=this.startRectValue,this.hiddenMaskAnimation=new wE({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"});var t=new Lu(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorTextHidden,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0});this.hiddenContainer=new yo,this.hiddenContainer.addChild(t),this.hiddenContainer.position.x=this.px(this.padding),this.hiddenContainer.position.y=this.px(e.size/8.5),this.hiddenContainer.addChild(this.hiddenMask),this.hiddenContainer.mask=this.hiddenMask,this.container.addChild(this.hiddenContainer)}},{key:"px",value:function(e){return this.sdkOptions.width/640*e}}],r&&iO(t.prototype,r),n&&iO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function sO(e){return sO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sO(e)}function uO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lO(n.key),n)}}function lO(e){var t=function(e,t){if("object"!=sO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=sO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==sO(t)?t:String(t)}function hO(e,t,r){return t=dO(t),function(e,t){if(t&&("object"===sO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cO()?Reflect.construct(t,r||[],dO(e).constructor):t.apply(e,r))}function cO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(cO=function(){return!!e})()}function dO(e){return dO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dO(e)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fO(e,t)}var pO={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2"},yO={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-QSAA.woff2"},gO=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=hO(this,t,[e,r])).isTitleTextShown=!1,n.isTitleRectHidden=!1,n.isSubtitleTextShown=!1,n.isSubtitleRectHidden=!1,n.delay=300,n.gap=3,n.isReady=!1,n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",pO.cyrillic),n.loadFont("title",pO.latin),n.loadFont("subtitle",yO.cyrillic),n.loadFont("subtitle",yO.latin)]).finally((function(){n.isReady=!0,n.render()})),n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t,r,n;this.container.removeChild(null===(e=this.titleBox)||void 0===e?void 0:e.container),null===(t=this.titleBox)||void 0===t||t.destroy(),this.container.removeChild(null===(r=this.subtitleBox)||void 0===r?void 0:r.container),null===(n=this.subtitleBox)||void 0===n||n.destroy(),this.subtitleBox=new aO(this.sdkOptions,{fontfamily:this.fontFamily("subtitle"),text:this.options.text.subtitle,colorText:this.options.color.primary,colorTextHidden:16777215,colorRect:this.options.color.primary,size:12,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.subtitleBox.container.position.x=this.offsetX(),this.subtitleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleBox.height,this.titleBox=new aO(this.sdkOptions,{fontfamily:this.fontFamily("title"),text:this.options.text.title,colorText:this.options.color.primary,colorTextHidden:2236962,colorRect:this.options.color.secondary,size:25,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.titleBox.container.position.x=this.offsetX(),this.titleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.titleBox.height-this.subtitleBox.height-this.px(this.gap),this.container.addChild(this.titleBox.container),this.container.addChild(this.subtitleBox.container)}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){var t,r;e.isReady&&(e.isTitleRectHidden=!1,e.isSubtitleRectHidden=!1,null===(t=e.titleBox)||void 0===t||t.textOutAnimation.reset(),null===(r=e.subtitleBox)||void 0===r||r.textOutAnimation.reset(),e.show(),e.titleBox.textInAnimateFunction(),e.titleBox.textInAnimation.isEnd(.8)&&setTimeout((function(){return e.isTitleTextShown=!0}),e.delay),e.isTitleTextShown&&(e.titleBox.rectAnimateFunction(!0),e.titleBox.hiddenMaskAnimateFunction(!0)),e.subtitleBox.textInAnimateFunction(),e.subtitleBox.textInAnimation.isEnd(.8)&&setTimeout((function(){e.isSubtitleTextShown=!0}),e.delay),e.isSubtitleTextShown&&(e.subtitleBox.rectAnimateFunction(!0),e.subtitleBox.hiddenMaskAnimateFunction(!0)),e.titleBox.rectAnimation.isEnd()&&e.subtitleBox.rectAnimation.isEnd()&&e.stopShowing())}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(e.isTitleTextShown=!1,e.isSubtitleTextShown=!1,e.titleBox.textInAnimation.reset(),e.subtitleBox.textInAnimation.reset(),!e.isHiding)return e.stopHiding(),e.hide(),e.titleBox.textResetFunction(),void e.subtitleBox.textResetFunction();e.titleBox.rectAnimateFunction(!1),e.titleBox.hiddenMaskAnimateFunction(!1),e.titleBox.rectAnimation.isStart()&&setTimeout((function(){return e.isTitleRectHidden=!0}),e.delay),e.isTitleRectHidden&&e.titleBox.textOutAnimateFunction(),e.subtitleBox.rectAnimateFunction(!1),e.subtitleBox.hiddenMaskAnimateFunction(!1),e.subtitleBox.rectAnimation.isStart()&&setTimeout((function(){return e.isSubtitleRectHidden=!0}),e.delay),e.isSubtitleRectHidden&&e.subtitleBox.textOutAnimateFunction(),e.isHiding=!e.titleBox.textOutAnimation.isEnd()&&!e.subtitleBox.textOutAnimation.isEnd()}}}],n&&uO(r.prototype,n),i&&uO(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(pE);function mO(e){return mO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mO(e)}function wO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bO(n.key),n)}}function bO(e){var t=function(e,t){if("object"!=mO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=mO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mO(t)?t:String(t)}var vO=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=new Map}var t,r,n;return t=e,r=[{key:"setCallback",value:function(e,t){return"function"!=typeof t?(this.store.delete(e),!1):(this.store.set(e,t),!0)}},{key:"getCallback",value:function(e){return this.store.get(e)}},{key:"call",value:function(e){var t=this.store.get(e);if("function"==typeof t)return t()}}],r&&wO(t.prototype,r),n&&wO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),xO=r(4220),_O=r(4412),IO=r.n(_O);function AO(e){return AO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AO(e)}function SO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TO(n.key),n)}}function TO(e){var t=function(e,t){if("object"!=AO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=AO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==AO(t)?t:String(t)}var CO=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state="inactive",this._duration=0,this.timeStart=0}var t,r,n;return t=e,(r=[{key:"duration",get:function(){return"active"===this.state?Date.now()-this.timeStart+this._duration:this._duration}},{key:"start",value:function(){"inactive"===this.state&&(this._duration=0,this.state="active",this.timeStart=Date.now())}},{key:"stop",value:function(){"inactive"!==this.state&&("active"===this.state&&(this._duration=this._duration+Date.now()-this.timeStart),this.state="inactive")}},{key:"pause",value:function(){"active"===this.state&&(this.state="paused",this._duration=this._duration+Date.now()-this.timeStart)}},{key:"resume",value:function(){"paused"===this.state&&(this.state="active",this.timeStart=Date.now())}}])&&SO(t.prototype,r),n&&SO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function EO(){EO=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==$O(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError($O(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function OO(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function kO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PO(n.key),n)}}function PO(e){var t=function(e,t){if("object"!=$O(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$O(t)?t:String(t)}function $O(e){return $O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$O(e)}var RO=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":$O(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},BO=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":$O(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DO=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onStartFunction=function(){},this.blobPromise=new xO.w,this.timer=new CO}var t,r,n,i;return t=e,r=[{key:"removeTracks",value:function(e){var t=this;this.stream&&("audio"===e?t.stream.getAudioTracks():"video"===e?t.stream.getVideoTracks():t.stream.getTracks()).forEach((function(e){t.stream.removeTrack(e)}))}},{key:"initRecorder",value:function(e){var t=this;this.isActive()&&this.stop(),this.recorder=new MediaRecorder(e,{mimeType:this.mimeType}),this.recorder.ondataavailable=function(e){return t.blobPromise.resolve(e.data)}}},{key:"start",value:function(){return!!this.recorder&&"inactive"===this.recorder.state&&(this.blobPromise.createPromise(),this.recorder.start(),this.timer.start(),this.onStartFunction(),!0)}},{key:"resume",value:function(){return!!this.recorder&&"paused"===this.recorder.state&&(this.recorder.resume(),this.timer.resume(),!0)}},{key:"pause",value:function(){return!!this.recorder&&"recording"===this.recorder.state&&(this.recorder.pause(),this.timer.pause(),!0)}},{key:"stop",value:function(){return!!this.recorder&&"inactive"!==this.recorder.state&&(this.recorder.stop(),this.timer.stop(),!0)}},{key:"getRecord",value:(i=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){OO(o,n,i,a,s,"next",e)}function s(e){OO(o,n,i,a,s,"throw",e)}a(void 0)}))}}(EO().mark((function e(){var t;return EO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("inactive"===this.recorder.state){e.next=2;break}throw"[ recorder ]: Cannot get blob. First you need to stop the record.";case 2:return e.next=4,this.blobPromise.promise;case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.next=9,IO()(t,this.timer.duration,{logger:!1});case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setVideoTrack",value:function(e){e&&(this.removeTracks("video"),this.stream||(this.stream=new MediaStream),this.stream.addTrack(e),this.initRecorder(this.stream))}},{key:"setSDKVideoTrack",value:function(e){this.sdkVideoTrack=e,this.setVideoTrack(e)}},{key:"setAudioTracks",value:function(e){if(0!==e.length){if(this.removeTracks("audio"),this.stream||(this.stream=new MediaStream),1===e.length)return this.stream.addTrack(e[0]),void this.initRecorder(this.stream);var t=new AudioContext,r=t.createMediaStreamDestination();e.forEach((function(e){var n=new MediaStream;n.addTrack(e),t.createMediaStreamSource(n).connect(r)}));var n=r.stream;this.stream.addTrack(n.getAudioTracks()[0]),this.initRecorder(this.stream)}}},{key:"setMimeType",value:function(e){MediaRecorder.isTypeSupported(e)?(this.mimeType=e,this.recorder&&this.stream&&this.initRecorder(this.stream)):o.ie.notify({message:"mimeType ".concat(e," is not supported."),emitter:o.E7.RECORDER})}},{key:"onStart",value:function(e){"function"==typeof e&&(this.onStartFunction=e)}},{key:"isActive",value:function(){var e,t;return"recording"===(null===(e=this.recorder)||void 0===e?void 0:e.state)||"paused"===(null===(t=this.recorder)||void 0===t?void 0:t.state)}},{key:"getDuration",value:function(){return this.timer.duration}},{key:"getSDKTracks",value:function(){return{sdkAudioTrack:this.sdkAudioTrack,sdkVideoTrack:this.sdkVideoTrack}}}],r&&kO(t.prototype,r),n&&kO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function MO(e){return MO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MO(e)}function LO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FO(n.key),n)}}function FO(e){var t=function(e,t){if("object"!=MO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=MO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==MO(t)?t:String(t)}function NO(e,t,r){return t=jO(t),function(e,t){if(t&&("object"===MO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,UO()?Reflect.construct(t,r||[],jO(e).constructor):t.apply(e,r))}function UO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(UO=function(){return!!e})()}function jO(e){return jO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jO(e)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},GO(e,t)}DO=RO([(0,qT.cB)("recorder"),BO("design:paramtypes",[])],DO);var zO=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=NO(this,t)).width=1280,e.height=720,e.customWidth=1280,e.customHeight=720,e.customSize=!1,e}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}(t,e),r=t,(n=[{key:"setSize",value:function(e,t){var r=!1;this.width!=e&&(this.width=e,r=!0),this.height!=t&&(this.height=t,r=!0),r&&this.emit("update",this)}},{key:"setCustomSize",value:function(e,t){this.customSize=!0,this.setSize(e,t)}},{key:"isCustomSize",value:function(){return this.customSize}},{key:"isLandscape",value:function(){return this.getAspect()>1}},{key:"getAspect",value:function(){return this.width/this.height}}])&&LO(r.prototype,n),i&&LO(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(a);function VO(e){return VO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VO(e)}function HO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WO(n.key),n)}}function WO(e){var t=function(e,t){if("object"!=VO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=VO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==VO(t)?t:String(t)}function YO(e,t,r){return t=XO(t),function(e,t){if(t&&("object"===VO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,KO()?Reflect.construct(t,r||[],XO(e).constructor):t.apply(e,r))}function KO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(KO=function(){return!!e})()}function XO(e){return XO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},XO(e)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ZO(e,t)}var qO=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=YO(this,t,[void 0,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 uStep;\nuniform float uSharpnessPower;\n\nconst float FSR_RCAS_LIMIT = 0.25 - 1.0 / 16.0;\n\nfloat calcLuma(vec3 texel) {\n  float luma = texel.b * 0.5 + (texel.r * 0.5 + texel.g);\n  return luma;\n}\n\nvec3 min4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 min_ab = min(a, b);\n  vec3 min_cd = min(c, d);\n\n  return min(min_ab, min_cd);\n}\n\nvec3 max4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 max_ab = max(a, b);\n  vec3 max_cd = max(c, d);\n\n  return max(max_ab, max_cd);\n}\n\nfloat max3_float(float a, float b, float c) {\n  float max_ab = max(a, b);\n\n  return max(max_ab, c);\n}\n\nfloat max5_float(float a, float b, float c, float d, float e) {\n  float max_ab = max(a, b);\n  float max_cd = max(c, d);\n  float max_ab_cd = max(max_ab, max_cd);\n\n  return max(max_ab_cd, e);\n}\n\nfloat min5_float(float a, float b, float c, float d, float e) {\n  float min_ab = min(a, b);\n  float min_cd = min(c, d);\n  float min_ab_cd = min(min_ab, min_cd);\n\n  return min(min_ab_cd, e);\n}\n\nfloat saturate(float val) {\n  return min(1.0, max(0.0, val));\n}\n\nfloat rcp(float val) {\n  return 1.0 / val;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n  // Algorithm uses minimal 3x3 pixel neighborhood.\n  //    b\n  //  d e f\n  //    h\n\n  vec3 e_texel = color.rgb;\n  vec3 b_texel = texture2D(uSampler, vTextureCoord + vec2(0, -uStep.y)).rgb;\n  vec3 h_texel = texture2D(uSampler, vTextureCoord + vec2(0, +uStep.y)).rgb;\n  vec3 d_texel = texture2D(uSampler, vTextureCoord + vec2(-uStep.x, 0)).rgb;\n  vec3 f_texel = texture2D(uSampler, vTextureCoord + vec2(+uStep.x, 0)).rgb;\n\n  float e_luma = calcLuma(e_texel);\n  float b_luma = calcLuma(b_texel);\n  float h_luma = calcLuma(h_texel);\n  float d_luma = calcLuma(d_texel);\n  float f_luma = calcLuma(f_texel);\n\n  // Min and max of ring.\n  vec3 min_ring = min4_vec3(b_texel, h_texel, d_texel, f_texel);\n  vec3 max_ring = max4_vec3(b_texel, h_texel, d_texel, f_texel);\n  // Immediate constants for peak range.\n  vec2 peakC = vec2(1.0, 1.0 * 4.0);\n  // Limiters, these need to be high precision RCPs.\n  vec3 hit_min = min_ring / (4.0 * max_ring);\n  vec3 hit_max = (1.0 - max_ring) / (4.0 * min_ring - peakC.y);\n  vec3 lobeC = max(-hit_min, hit_max);\n\n  float max_lobeC = max3_float(lobeC.r, lobeC.g, lobeC.b);\n  float lobe = max(-FSR_RCAS_LIMIT, min(max_lobeC, 0.0)) * uSharpnessPower;\n\n  // Noise detection.\n  float noise = 0.25 * b_luma + 0.25 * d_luma + 0.25 * f_luma + 0.25 * h_luma - e_luma;\n  float max_luma = max5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  float min_luma = min5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  noise = saturate(abs(noise) * rcp(max_luma - min_luma));\n  noise = -0.5 * noise + 1.0;\n  lobe = lobe * noise;\n\n  vec3 result = (lobe * (b_texel + d_texel + h_texel + f_texel) + e_texel) / (4.0 * lobe + 1.0);\n\n  gl_FragColor = vec4(result, color.a);\n}\n"]),e.outputResolution&&r.setOutputResolution(e.outputResolution),r.setPower(null!==(n=e.power)&&void 0!==n?n:0),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}(t,e),r=t,(n=[{key:"setOutputResolution",value:function(e){var t=1/(e.width-1),r=1/(e.height-1);this.uniforms.uStep=[t,r]}},{key:"setPower",value:function(e){e=Math.max(0,e),e=Math.min(1,e),this.uniforms.uSharpnessPower=.3*e+1}}])&&HO(r.prototype,n),i&&HO(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(gn);function JO(e){return JO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JO(e)}function QO(){QO=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==JO(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(JO(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function ek(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function tk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rk(n.key),n)}}function rk(e){var t=function(e,t){if("object"!=JO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=JO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==JO(t)?t:String(t)}function nk(e,t,r){return t=ok(t),function(e,t){if(t&&("object"===JO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ak(e)}(e,ik()?Reflect.construct(t,r||[],ok(e).constructor):t.apply(e,r))}function ik(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ik=function(){return!!e})()}function ok(e){return ok=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ok(e)}function ak(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sk(e,t){return sk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sk(e,t)}var uk,lk=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},hk=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},ck=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=nk(this,t,[e]),uk.set(ak(r),void 0),r.config={power:0},r}var r,n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sk(e,t)}(t,e),r=t,n=[{key:"prepare",value:function(){var e=this.resources.texture,t=this.sdkOptions,r=t.width,n=t.height;lk(this,uk,new Ql(e,{width:r,height:n}),"f"),hk(this,uk,"f").addBuffer("result"),this.filterSharpness=new qO({outputResolution:{height:n,width:r}}),hk(this,uk,"f").frame.filters=[this.filterSharpness],this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){var e=this.sdkOptions,t=e.width,r=e.height;hk(this,uk,"f").resize(t,r),this.filterSharpness.setOutputResolution({height:r,width:t})}},{key:"process",value:(o=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){ek(o,n,i,a,s,"next",e)}function s(e){ek(o,n,i,a,s,"throw",e)}a(void 0)}))}}(QO().mark((function e(){return QO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDisabled){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(hk(this,uk,"f").frame,hk(this,uk,"f").getBuffer("result")),this.resources.texture.update(hk(this,uk,"f").getBuffer("result"),!1);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setConfig",value:function(e){this.setPower(e.power)}},{key:"setPower",value:function(e){void 0!==e&&(this.config.power=e,this.filterSharpness.setPower(e))}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&tk(r.prototype,n),i&&tk(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(N_);function dk(){dk=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:T(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function b(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==r&&n.call(_,a)&&(v=_);var I=b.prototype=m.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==mk(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=C(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function C(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(mk(t)+" is not iterable")}return w.prototype=b,i(I,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),l(I,u,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function fk(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function pk(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){fk(o,n,i,a,s,"next",e)}function s(e){fk(o,n,i,a,s,"throw",e)}a(void 0)}))}}function yk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gk(n.key),n)}}function gk(e){var t=function(e,t){if("object"!=mk(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=mk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mk(t)?t:String(t)}function mk(e){return mk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mk(e)}uk=new WeakMap;var wk,bk=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":mk(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},vk=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":mk(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},xk=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},_k=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},Ik=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.outputFrameFormat="RGBX",this.components=new Proxy({},ZT),wk.set(this,void 0),this.customer_id=t,gx.M.CUSTOMER_ID=t,gx.M.setVersion(),mx.i.getInstance().getUID(this.customer_id),qT.k7.Instance.setCustomerID(this.customer_id),r&&(this.custom_inference=Kx.getInference("custom"),this.custom_inference.setBackend(r)),this.onnx_inference=Kx.getInference("onnx"),this.sdkOptions=new zO,this.recorder=new DO,this.callbackStore=new vO,this.colorFilterEffect=new bI(this.sdkOptions),this.customResolutionEffect=new zT(this.sdkOptions),this.sharpnessEffect=new ck(this.sdkOptions),this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,r,n,i,a,s,u;return t=e,r=[{key:"onOptionsUpdate",value:function(e){Object.values(this.components).forEach((function(e){return e.render()})),this.virtualBackgroundEffect&&this.setSegmentationPreset(this.virtualBackgroundEffect.settings.preset)}},{key:"cache",value:(u=pk(dk().mark((function e(){var t,r,n=arguments;return dk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],r=!1,this.custom_inference&&(r=!0),e.abrupt("return",this.onnx_inference.cache(t,r));case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"preload",value:(s=pk(dk().mark((function e(){var t;return dk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,this.custom_inference&&(t=!0),e.abrupt("return",this.onnx_inference.preload(t));case 3:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"config",value:function(e){e.hasOwnProperty("app_env")&&(gx.M.APP_ENV=e.app_env),e.hasOwnProperty("api_url")&&(gx.M.API_URL=e.api_url),e.hasOwnProperty("model_url")&&(gx.M.MODEL_URL=e.model_url),e.hasOwnProperty("sdk_url")&&(gx.M.SDK_URL=e.sdk_url),e.hasOwnProperty("provider")&&(gx.M.PROVIDER=e.provider),e.hasOwnProperty("preset")&&(gx.M.PRESET=e.preset),e.hasOwnProperty("proxy")&&(gx.M.PROXY=e.proxy),e.hasOwnProperty("stats")&&(gx.M.STATS=e.stats),e.hasOwnProperty("wasmPaths")&&Object.keys(e.wasmPaths).length&&(gx.M.WASM_PATHS=Object.assign(gx.M.WASM_PATHS,e.wasmPaths)),e.hasOwnProperty("presets")&&Object.keys(e.presets).length&&(gx.M.PRESETS=Object.assign(gx.M.PRESETS,e.presets)),e.hasOwnProperty("models")&&Object.keys(e.models).length&&(gx.M.MODELS=Object.assign(gx.M.MODELS,e.models))}},{key:"init",value:(a=pk(dk().mark((function e(t){var r,n,i,a=this;return dk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.aborted){e.next=2;break}return e.abrupt("return");case 2:if(this.streamProcessor&&(this.streamProcessor.destroy(),this.effectProcessor.destroy(),delete this.streamProcessor,delete this.effectProcessor),n="requestAnimationFrameCallback","MediaStreamTrackProcessor"in window&&"MediaStreamTrackGenerator"in window?(this.streamProcessor=kc.getStreamProcessor("transform",this.sdkOptions),n="MediaStreamTrackProcessor"):"requestVideoFrameCallback"in HTMLVideoElement.prototype?(this.streamProcessor=kc.getStreamProcessor("videocallback",this.sdkOptions),n="requestVideoFrameCallback"):this.streamProcessor=kc.getStreamProcessor("animationcallback",this.sdkOptions),o.ie.notify({message:"".concat(n," supported"),type:o.cL.INFO,emitter:o.E7.TSVB}),this.streamProcessor.onFrameDraw(this.callbackStore.getCallback("onFrameDraw")),this.streamProcessor.onChangeInputResolution(this.callbackStore.getCallback("onChangeInputResolution")),i=new S_(this.sdkOptions,this.outputFrameFormat),this.streamProcessor.setRenderer(i),this.effectProcessor=new U_(i,this.components),t.aborted||this.effectProcessor.addEffect(this.customResolutionEffect),!gx.M.MODELS.lowlighter||""===gx.M.MODELS.lowlighter){e.next=16;break}return this.lowLightEffect=new FS(this.sdkOptions,this.customer_id),e.next=16,this.lowLightEffect.init(this.onnx_inference).then((function(){if(!t.aborted){a.effectProcessor.addEffect(a.lowLightEffect);var e=a.callbackStore.getCallback("onLowLightSuccess");a.lowLightEffect.onSuccess(e)}})).catch((function(){}));case 16:if(t.aborted||this.effectProcessor.addEffect(this.colorFilterEffect),t.aborted||this.effectProcessor.addEffect(this.sharpnessEffect),!gx.M.MODELS.colorcorrector||""===gx.M.MODELS.colorcorrector){e.next=22;break}return this.colorCorrectorEffect=new aT(this.sdkOptions,this.customer_id),e.next=22,this.colorCorrectorEffect.init(this.onnx_inference).then((function(){t.aborted||a.effectProcessor.addEffect(a.colorCorrectorEffect)})).catch((function(){}));case 22:if(!gx.M.MODELS.facedetector||""===gx.M.MODELS.facedetector){e.next=26;break}return this.smartZoomEffect=new RT(this.sdkOptions,this.customer_id),e.next=26,this.smartZoomEffect.init(this.onnx_inference).then((function(){t.aborted||a.effectProcessor.addEffect(a.smartZoomEffect)})).catch((function(){}));case 26:return this.virtualBackgroundEffect=new XA(this.sdkOptions,this.customer_id),e.next=29,this.virtualBackgroundEffect.init(null!==(r=this.custom_inference)&&void 0!==r?r:this.onnx_inference).then((function(){t.aborted||a.effectProcessor.addEffect(a.virtualBackgroundEffect)})).catch((function(){}));case 29:this.streamProcessor.useEffectProcessor(this.effectProcessor),this.callbackStore.call("onReady");case 31:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getCustomerId",value:function(){return this.customer_id}},{key:"useStream",value:function(e,t){var r;if(e.getVideoTracks().length){var n=e.getVideoTracks()[0].getSettings();if(t?this.sdkOptions.setCustomSize(t.width,t.height):this.sdkOptions.setSize(n.width,n.height),Object.values(this.components).forEach((function(e){return e.render()})),xk(this,wk,"f")&&xk(this,wk,"f").abort(),_k(this,wk,new AbortController,"f"),this.init(xk(this,wk,"f").signal),this.streamProcessor.useStream(e),this.streamProcessor.getInputVideoTrack()){this.streamProcessor.process();var i=null===(r=this.streamProcessor.getStream())||void 0===r?void 0:r.getVideoTracks()[0];i&&this.recorder.setSDKVideoTrack(i)}else o.ie.notify({message:"There is no input videoTrack to process",emitter:o.E7.TSVB})}else o.ie.notify({message:"There is no input videoTrack in the Media Stream",emitter:o.E7.TSVB})}},{key:"setSegmentationPreset",value:(i=pk(dk().mark((function e(t){var r;return dk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.virtualBackgroundEffect){e.next=2;break}return e.abrupt("return",!1);case 2:if(!this.onnx_inference.isGPU||["quality","balanced"].includes(t)){e.next=5;break}return o.ie.notify({message:"WebGPU backend support only quality and balanced presets",emitter:o.E7.TSVB}),e.abrupt("return",!1);case 5:return this.effectProcessor.hasFrames?this.effectProcessor.pause():this.streamProcessor.pause(),this.streamProcessor.clearBuffers(),this.streamProcessor.clearBuffers(),e.next=10,this.virtualBackgroundEffect.setPreset(t);case 10:return e.next=12,this.virtualBackgroundEffect.init(null!==(r=this.custom_inference)&&void 0!==r?r:this.onnx_inference);case 12:return this.effectProcessor.hasFrames?this.effectProcessor.unpause():this.streamProcessor.unpause(),e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getSegmentationPreset",value:function(){return this.virtualBackgroundEffect.getPreset()}},{key:"setBackgroundColor",value:function(e){this.virtualBackgroundEffect.setBackgroundColor(e)}},{key:"getStream",value:function(){return this.streamProcessor.getStream()}},{key:"toCanvas",value:function(e){this.streamProcessor.renderToCanvas(e)}},{key:"setFpsLimit",value:function(e){return!!this.streamProcessor&&(this.streamProcessor.setFpsLimit(e),!0)}},{key:"showFps",value:function(){return!!this.streamProcessor&&(this.streamProcessor.showFps(),!0)}},{key:"hideFps",value:function(){return!!this.streamProcessor&&(this.streamProcessor.hideFps(),!0)}},{key:"freeze",value:function(){return!!this.effectProcessor&&(this.effectProcessor.pause(),!0)}},{key:"unfreeze",value:function(){return!!this.effectProcessor&&(this.effectProcessor.unpause(),!0)}},{key:"enableBeautification",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.enableBeautification(),!0)}},{key:"disableBeautification",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.disableBeautification(),!0)}},{key:"setBoundaryMode",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBoundaryMode(e),!0)}},{key:"setBackgroundFitMode",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBackgroundFitMode(e),!0)}},{key:"setBoundaryLevel",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBoundaryLevel(e),!0)}},{key:"setBeautificationLevel",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBeautificationLevel(e),!0)}},{key:"setBlur",value:function(e){if(!this.virtualBackgroundEffect)return!1;var t=15*Math.cbrt(this.sdkOptions.height*this.sdkOptions.width)/67;return this.virtualBackgroundEffect.setBlur(Math.round(e*t)),!0}},{key:"clearBlur",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.clearBlur(),!0)}},{key:"setBackground",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBackground(e),!0)}},{key:"clearBackground",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.clearBackground(),!0)}},{key:"enableFrameSkipping",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.enableFrameSkipping(),!0)}},{key:"disableFrameSkipping",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.disableFrameSkipping(),!0)}},{key:"setLayout",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setLayout(e),!0)}},{key:"setLayoutMode",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setLayoutMode(e),!0)}},{key:"setCustomLayout",value:function(e){if(!this.virtualBackgroundEffect)return!1;var t={};return void 0!==e.xOffset&&(t.xOffset=e.xOffset*this.sdkOptions.width),void 0!==e.yOffset&&(t.yOffset=e.yOffset*this.sdkOptions.height),void 0!==e.size&&(t.width=e.size*this.sdkOptions.width,t.height=e.size*this.sdkOptions.height),this.virtualBackgroundEffect.setCustomLayout(t),!0}},{key:"setFaceArea",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,.01),e=Math.min(e,1),this.smartZoomEffect.setConfig("faceAreaProportion",e),!0)}},{key:"setFaceDetectorAccuracy",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,.2),e=Math.min(e,1),this.smartZoomEffect.setConfig("faceDetectorAccuracy",e),!0)}},{key:"setSmartZoomSmoothing",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,.01),e=Math.min(e,1),this.smartZoomEffect.setConfig("smoothPower",100*e),!0)}},{key:"setSmartZoomSensitivity",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,0),e=Math.min(e,1),this.smartZoomEffect.setConfig("sensitivityValue",e),!0)}},{key:"setSmartZoomPerod",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,0),e=Math.min(e,1e3),this.smartZoomEffect.setConfig("faceDetectorPediod_ms",e),!0)}},{key:"switchDrawFaceSquare",value:function(e){return!!this.smartZoomEffect&&(this.smartZoomEffect.setConfig("isFaceSquareDrawingEnabled",e),!0)}},{key:"switchDrawPreFaceSquare",value:function(e){return!!this.smartZoomEffect&&(this.smartZoomEffect.setConfig("isPreFaceSquareDrawingEnabled",e),!0)}},{key:"enableSmartZoom",value:function(){return!!this.smartZoomEffect&&(this.smartZoomEffect.enable(),!0)}},{key:"disableSmartZoom",value:function(){return!!this.smartZoomEffect&&(this.smartZoomEffect.disable(),!0)}},{key:"enableColorCorrector",value:function(){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.enable(),!0)}},{key:"disableColorCorrector",value:function(){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.disable(),!0)}},{key:"enableColorFilter",value:function(){return!!this.colorFilterEffect&&(this.colorFilterEffect.enable(),!0)}},{key:"disableColorFilter",value:function(){return!!this.colorFilterEffect&&(this.colorFilterEffect.disable(),!0)}},{key:"setColorFilterConfig",value:function(e){return!!this.colorFilterEffect&&(this.colorFilterEffect.setConfig(e),!0)}},{key:"setFilterPart",value:function(e){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.setConfig("filterPart",e),!0)}},{key:"setColorCorrectorPeriod",value:function(e){return!!this.colorCorrectorEffect&&(e=Math.max(e,0),e=Math.min(e,5e3),this.colorCorrectorEffect.setConfig("modelPediod_ms",e),!0)}},{key:"setColorCorrectorPower",value:function(e){return!!this.colorCorrectorEffect&&(e=Math.max(e,0),e=Math.min(e,1),this.colorCorrectorEffect.setConfig("cc_power",e),!0)}},{key:"enableLowLightEffect",value:function(){return!!this.lowLightEffect&&(this.lowLightEffect.enable(),!0)}},{key:"disableLowLightEffect",value:function(){return!!this.lowLightEffect&&(this.lowLightEffect.disable(),!0)}},{key:"setLowLightEffectConfig",value:function(e){return!!this.lowLightEffect&&(this.lowLightEffect.setConfig(e),!0)}},{key:"setLowLightEffectPower",value:function(e){return this.setLowLightEffectConfig({power:e}),!0}},{key:"enableSharpnessEffect",value:function(){return!!this.sharpnessEffect&&(this.sharpnessEffect.enable(),!0)}},{key:"disableSharpnessEffect",value:function(){return!!this.sharpnessEffect&&(this.sharpnessEffect.disable(),!0)}},{key:"setSharpnessEffectConfig",value:function(e){return!!this.sharpnessEffect&&(this.sharpnessEffect.setConfig(e),!0)}},{key:"clear",value:function(){return!!this.streamProcessor&&(this.streamProcessor.destroy(),!0)}},{key:"run",value:function(){return this.streamProcessor&&(this.streamProcessor.isRunning=!0),!0}},{key:"stop",value:function(){return this.streamProcessor&&(this.streamProcessor.isRunning=!1),!0}},{key:"enablePipelineSkipping",value:function(){var e;null===(e=this.effectProcessor)||void 0===e||e.enablePipelineSkipping()}},{key:"disablePipelineSkipping",value:function(){var e;null===(e=this.effectProcessor)||void 0===e||e.disablePipelineSkipping()}},{key:"getEffectProcessor",value:function(){return this.effectProcessor}},{key:"createComponent",value:function(e){return new Ak[e.component](this.sdkOptions,e.options)}},{key:"addComponent",value:function(e,t){this.components[t]=e}},{key:"getComponentConstructor",value:function(e){return Ak[e]}},{key:"setOutputResolution",value:function(e){this.streamProcessor&&this.streamProcessor.setOutputResolution(e.width,e.height)}},{key:"clearOutputResolution",value:function(){this.streamProcessor&&this.streamProcessor.clearOutputResolution()}},{key:"setOutputFrameFormat",value:function(e){this.outputFrameFormat=e}},{key:"onReady",set:function(e){this.callbackStore.setCallback("onReady",e)}},{key:"onError",value:function(e){o.ie.subscribe(e)}},{key:"onFrame",set:function(e){var t;this.callbackStore.setCallback("onFrameDraw",e),null===(t=this.streamProcessor)||void 0===t||t.onFrameDraw(e)}},{key:"onChangeInputResolution",value:function(e){var t;this.callbackStore.setCallback("onChangeInputResolution",e),null===(t=this.streamProcessor)||void 0===t||t.onChangeInputResolution(e)}},{key:"onAuthRequest",value:function(e){this.onnx_inference&&this.onnx_inference.onAuth(e)}},{key:"onColorFilterSuccess",value:function(e){this.callbackStore.setCallback("onColorFilterSuccess",e),this.colorFilterEffect.onSuccess(e)}},{key:"onLowLightSuccess",value:function(e){var t;this.callbackStore.setCallback("onLowLightSuccess",e),null===(t=this.lowLightEffect)||void 0===t||t.onSuccess(e)}}],r&&yk(t.prototype,r),n&&yk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();wk=new WeakMap,Ik=bk([(0,qT.cB)("tsvb"),vk("design:paramtypes",[String,Object])],Ik);var Ak={overlay_screen:yC,watermark:BC,lowerthird_1:TE,lowerthird_2:ME,lowerthird_3:WE,lowerthird_4:rO,lowerthird_5:gO,stickers:eE}},1140:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}r.d(t,{E7:()=>s,cL:()=>a,ie:()=>u});var a,s,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}],(r=[{key:"subscribe",value:function(e){var t="function"==typeof e;this.onErrorFunction=t?e:void 0}},{key:"notify",value:function(e){"function"==typeof this.onErrorFunction&&(e.emitter&&(e.message="[ ".concat(e.emitter," ]: ").concat(e.message)),e.type||(e.type=a.ERROR),this.onErrorFunction(e))}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}().getInstance();!function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error"}(a||(a={})),function(e){e.TSVB="tsvb",e.COMPONENTS_SYSTEM="components_system",e.SRTEAM_PROCESSOR="stream_processor",e.ML_INFERENCE="ml_inference",e.PRESET_INIT="preset_init",e.RENDERER="renderer",e.RECORDER="recorder",e.EFFECT_VIRTUAL_BACKGROUND="effect_virtual_background",e.EFFECT_COLOR_CORRECTION="effect_color_correction",e.EFFECT_COLOR_FILTER="effect_color_filter",e.EFFECT_SMART_ZOOM="effect_smart_zoom",e.EFFECT_LOW_LIGHT="effect_low_light"}(s||(s={}))},4220:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}r.d(t,{w:()=>a});var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"createPromise",value:function(){var e=this;return this._promise=new Promise((function(t,r){e.resolver=t,e.rejecter=r})),this._promise}},{key:"promise",get:function(){return this._promise}},{key:"resolve",value:function(e){if("function"!=typeof this.resolver)return!1;this.resolver(e),this.resolver=void 0}},{key:"reject",value:function(e){if("function"!=typeof this.rejecter)return!1;this.rejecter(e),this.rejecter=void 0,this._promise=void 0}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9456:(e,t,r)=>{function n(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}r.d(t,{cB:()=>$,CS:()=>p,k7:()=>f});var i=r(5620),o=r(4941),a=r(9899),s=r.n(a);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:String(t)}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=[],this.delay=5e3,this.isRunning=!1,this.deferred=new Set}var t,r,n;return t=e,n=[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}],(r=[{key:"setCustomerID",value:function(e){this.customer_id=e}},{key:"push",value:function(e){var t=this;i.M.STATS&&(this.checkRunning(e),this.isRunning?(clearTimeout(this.timer),this.data.push({feature:e,user_id:o.i.getInstance().getUID(this.customer_id)}),this.timer=setTimeout((function(){return t.send()}),this.delay)):this.deferred.add(e))}},{key:"send",value:function(){var e=this,t=l(this.data);this.data=[];var r=i.M.STATS_URL+this.customer_id,n={"Tsvb-Version":i.M.VERSION};s().post(r,t,{headers:n}).catch((function(r){return e.data=[].concat(l(t),l(e.data)),r}))}},{key:"checkRunning",value:function(e){var t=this,r=o.i.getInstance().getUID(this.customer_id);"run"===e&&(this.isRunning=!0,this.deferred.forEach((function(e){t.data.push({feature:e,user_id:r})})),this.deferred.clear())}}])&&c(t.prototype,r),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return function(t,r,i){var o=i.value;i.value=function(){var t=r+n(e);f.Instance.push(t);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return o.apply(this,a)}}}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:String(t)}var w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"isStattable",value:function(e,t){var r;return(null!==(r=this.FEATURES[e])&&void 0!==r?r:[]).includes(t)}}],(r=null)&&g(t.prototype,r),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(){v=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new $(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",g={};function m(){}function w(){}function x(){}var _={};l(_,a,(function(){return this}));var I=Object.getPrototypeOf,A=I&&I(I(R([])));A&&A!==r&&n.call(A,a)&&(_=A);var S=x.prototype=m.prototype=Object.create(_);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==b(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function E(t,r,n){var i=d;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function O(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,O(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(b(t)+" is not iterable")}return w.prototype=x,i(S,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(C.prototype),l(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new C(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,$.prototype={constructor:$,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}w.FEATURES={recorder:["start","stop","pause","resume"],tsvb:["run","stop","enableBeautification","disableBeautification","setBlur","clearBlur","setBackground","clearBackground","enableSmartZoom","disableSmartZoom","enableColorCorrector","disableColorCorrector","enableFrameSkipping","disableFrameSkipping","setLayout","enableColorFilter","disableColorFilter","setSegmentationPreset","enableLowLightEffect","disableLowLightEffect","enableSharpnessEffect","disableSharpnessEffect"]},w.SDK_RUNNING_INTERVALS=[{feature:"run5",delay_ms:3e5},{feature:"run10",delay_ms:3e5},{feature:"run15",delay_ms:3e5},{feature:"run20",delay_ms:3e5}];var x=v().mark(A);function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A(e){var t,r,n;return v().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=_(e),i.prev=1,t.s();case 3:if((r=t.n()).done){i.next=9;break}return n=r.value,i.next=7,n;case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(1),t.e(i.t0);case 14:return i.prev=14,t.f(),i.finish(14);case 17:case"end":return i.stop()}}),x,null,[[1,11,14,17]])}function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C(n.key),n)}}function C(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==S(t)?t:String(t)}var E=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,i=[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}],(r=[{key:"setFeatureData",value:function(e,t){this.feature=t,this.type=e}},{key:"handle",value:function(){this.isDisableToPush()||(this.pushStat(),this.isSdkRunFeature()&&(clearTimeout(this.sdkRunningTimer),this.intervalIterator=A(w.SDK_RUNNING_INTERVALS),this.handleSdkRunningInterval()),this.isSdkStopFeature()&&clearTimeout(this.sdkRunningTimer))}},{key:"isDisableToPush",value:function(){return!w.isStattable(this.type,this.feature)||!!this.isEqualLastPushedFeature()}},{key:"pushStat",value:function(){var e=this.getFeatureName();f.Instance.push(e),this.lastPushedFeature=e}},{key:"getFeatureName",value:function(){var e="tsvb"!==this.type?n(this.type):"";return this.feature+e}},{key:"isSdkRunFeature",value:function(){return"tsvb"===this.type&&"run"===this.feature}},{key:"isSdkStopFeature",value:function(){return"tsvb"===this.type&&"stop"===this.feature}},{key:"isEqualLastPushedFeature",value:function(){return this.lastPushedFeature===this.getFeatureName()}},{key:"handleSdkRunningInterval",value:function(){var e=this.intervalIterator.next(),t=e.value;e.done||this.startSdkRunningTimer(t.feature,t.delay_ms)}},{key:"startSdkRunningTimer",value:function(e,t){var r=this;this.sdkRunningTimer=setTimeout((function(){f.Instance.push(e),r.handleSdkRunningInterval()}),t)}}])&&T(t.prototype,r),i&&T(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}().getInstance();function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $(e){return function(t){var r,n=k(Object.getOwnPropertyNames(t.prototype));try{var i=function(){var n=r.value,i=Object.getOwnPropertyDescriptor(t.prototype,n);if(!i)return 0;var o=i.value;if(!(o instanceof Function))return 0;i.value=function(){E.setFeatureData(e,n),E.handle();for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=o.apply(this,r),s=function(){};if("object"===O(a)&&"function"==typeof a.then){var u=a.then(s);"function"==typeof u.catch&&u.catch((function(e){return e}))}return a},Object.defineProperty(t.prototype,n,i)};for(n.s();!(r=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}}}},4941:(e,t,r)=>{function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}r.d(t,{i:()=>y});var i=function e(t,r){function i(e,i,o){if("undefined"!=typeof document){"number"==typeof(o=n({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var s in o)o[s]&&(a+="; "+s,!0!==o[s]&&(a+="="+o[s].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+a}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var o=r[i].split("="),a=o.slice(1).join("=");try{var s=decodeURIComponent(o[0]);if(n[s]=t.read(a,s),e===s)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){i(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let a;const s=new Uint8Array(16);function u(){if(!a&&(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(s)}const l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));function h(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}const c=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();const n=(e=e||{}).random||(e.rng||u)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return h(n)};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}],(r=[{key:"getUID",value:function(e){if(this._uid)return this._uid;var t=i.get("TSVB_UID");return t||(t=c(),i.set("TSVB_UID",t)),t}},{key:"setUID",value:function(e){this._uid=e}}])&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},5704:(e,t)=>{t.byteLength=function(e){var t=s(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=s(e),a=o[0],u=o[1],l=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,u)),h=0,c=u>0?a-4:a;for(r=0;r<c;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;2===u&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[h++]=255&t);1===u&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=16383,s=0,l=n-i;s<l;s+=a)o.push(u(e,s,s+a>l?l:s+a));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=o[a],n[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},3296:(e,t,r)=>{var n=r(5704),i=r(4404),o=r(9600);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return l(this,e,t,r)}function l(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=d(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r);e=s(e,n);var i=e.write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|f(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(h(t),e=s(e,t<0?0:0|f(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function d(e,t){var r=t.length<0?0:0|f(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(n)return j(e).length;t=(""+t).toLowerCase(),n=!0}}function y(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return E(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var h=-1;for(o=r;o<s;o++)if(l(e,o)===l(t,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var c=!0,d=0;d<u;d++)if(l(e,o+d)!==l(t,d)){c=!1;break}if(c)return o}return-1}function b(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function v(e,t,r,n){return z(j(t,e.length-r),e,r,n)}function x(e,t,r,n){return z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return x(e,t,r,n)}function I(e,t,r,n){return z(G(t),e,r,n)}function A(e,t,r,n){return z(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function S(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,l=e[i],h=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=r)switch(c){case 1:l<128&&(h=l);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)>127&&(h=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&l)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(h=u)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}t.Sn=u,t.ZK=50,u.TYPED_ARRAY_SUPPORT=void 0!==r.g.TYPED_ARRAY_SUPPORT?r.g.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return l(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return h(t),t<=0?s(e,t):void 0!==r?"string"==typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t)}(null,e,t,r)},u.allocUnsafe=function(e){return c(null,e)},u.allocUnsafeSlow=function(e){return c(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):y.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.ZK;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),l=this.slice(n,i),h=e.slice(t,r),c=0;c<s;++c)if(l[c]!==h[c]){o=l[c],a=h[c];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":return x(this,e,t,r);case"latin1":case"binary":return _(this,e,t,r);case"base64":return I(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function E(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=U(e[o]);return i}function P(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function $(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function B(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(e,t,r,n,o){return o||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function F(e,t,r,n,o){return o||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUInt8=function(e,t){return t||$(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||$(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||$(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||$(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||$(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||$(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||$(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||$(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||$(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||$(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||$(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||$(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||$(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||$(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);R(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);R(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return F(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return F(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=u.isBuffer(e)?e:j(new u(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function G(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}},2768:(e,t,r)=>{var n=r(6604),i=r(4572),o=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i(r):r}},4572:(e,t,r)=>{var n=r(268),i=r(6604),o=r(2392),a=r(6556),s=i("%Function.prototype.apply%"),u=i("%Function.prototype.call%"),l=i("%Reflect.apply%",!0)||n.call(u,s),h=r(8252),c=i("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=l(n,u,arguments);return o(t,1+c(0,e.length-(arguments.length-1)),!0)};var d=function(){return l(n,s,arguments)};h?h(e.exports,"apply",{value:d}):e.exports.apply=d},1528:(e,t,r)=>{var n=r(6384);function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(e){var t=new i;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var o=0;o<r.length;++o){var a=r[o];if("array"===a||"object"==typeof a&&a.blockIndices){if(t.argTypes[o]="array",t.arrayArgs.push(o),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)t.scalarArgs.push(o),t.shimArgs.push("scalar"+o);else if("index"===a){if(t.indexArgs.push(o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(t.shapeArgs.push(o),o<t.pre.args.length&&t.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<t.post.args.length&&t.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+r[o]);t.argTypes[o]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(o)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,n(t)}},9676:(e,t,r)=>{var n=r(2248);function i(e,t,r){var n,i,o=e.length,a=t.arrayArgs.length,s=t.indexArgs.length>0,u=[],l=[],h=0,c=0;for(n=0;n<o;++n)l.push(["i",n,"=0"].join(""));for(i=0;i<a;++i)for(n=0;n<o;++n)c=h,h=e[n],0===n?l.push(["d",i,"s",n,"=t",i,"p",h].join("")):l.push(["d",i,"s",n,"=(t",i,"p",h,"-s",c,"*t",i,"p",c,")"].join(""));for(l.length>0&&u.push("var "+l.join(",")),n=o-1;n>=0;--n)h=e[n],u.push(["for(i",n,"=0;i",n,"<s",h,";++i",n,"){"].join(""));for(u.push(r),n=0;n<o;++n){for(c=h,h=e[n],i=0;i<a;++i)u.push(["p",i,"+=d",i,"s",n].join(""));s&&(n>0&&u.push(["index[",c,"]-=s",c].join("")),u.push(["++index[",h,"]"].join(""))),u.push("}")}return u.join("\n")}function o(e,t,r){for(var n=e.body,i=[],o=[],a=0;a<e.args.length;++a){var s=e.args[a];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),l="",h=t.arrayArgs.indexOf(a);switch(t.argTypes[a]){case"offset":var c=t.offsetArgIndex.indexOf(a);h=t.offsetArgs[c].array,l="+q"+c;case"array":l="p"+h+l;var d="l"+a,f="a"+h;if(0===t.arrayBlockIndices[h])1===s.count?"generic"===r[h]?s.lvalue?(i.push(["var ",d,"=",f,".get(",l,")"].join("")),n=n.replace(u,d),o.push([f,".set(",l,",",d,")"].join(""))):n=n.replace(u,[f,".get(",l,")"].join("")):n=n.replace(u,[f,"[",l,"]"].join("")):"generic"===r[h]?(i.push(["var ",d,"=",f,".get(",l,")"].join("")),n=n.replace(u,d),s.lvalue&&o.push([f,".set(",l,",",d,")"].join(""))):(i.push(["var ",d,"=",f,"[",l,"]"].join("")),n=n.replace(u,d),s.lvalue&&o.push([f,"[",l,"]=",d].join("")));else{for(var p=[s.name],y=[l],g=0;g<Math.abs(t.arrayBlockIndices[h]);g++)p.push("\\s*\\[([^\\]]+)\\]"),y.push("$"+(g+1)+"*t"+h+"b"+g);if(u=new RegExp(p.join(""),"g"),l=y.join("+"),"generic"===r[h])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(u,[f,"[",l,"]"].join(""))}break;case"scalar":n=n.replace(u,"Y"+t.scalarArgs.indexOf(a));break;case"index":n=n.replace(u,"index");break;case"shape":n=n.replace(u,"shape")}}}return[i.join("\n"),n,o.join("\n")].join("\n").trim()}function a(e){for(var t=new Array(e.length),r=!0,n=0;n<e.length;++n){var i=e[n],o=i.match(/\d+/);o=o?o[0]:"",0===i.charAt(0)?t[n]="u"+i.charAt(1)+o:t[n]=i.charAt(0)+o,n>0&&(r=r&&t[n]===t[n-1])}return r?t[0]:t.join("")}e.exports=function(e,t){for(var r=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,s=new Array(e.arrayArgs.length),u=new Array(e.arrayArgs.length),l=0;l<e.arrayArgs.length;++l)u[l]=t[2*l],s[l]=t[2*l+1];var h=[],c=[],d=[],f=[],p=[];for(l=0;l<e.arrayArgs.length;++l){e.arrayBlockIndices[l]<0?(d.push(0),f.push(r),h.push(r),c.push(r+e.arrayBlockIndices[l])):(d.push(e.arrayBlockIndices[l]),f.push(e.arrayBlockIndices[l]+r),h.push(0),c.push(e.arrayBlockIndices[l]));for(var y=[],g=0;g<s[l].length;g++)d[l]<=s[l][g]&&s[l][g]<f[l]&&y.push(s[l][g]-d[l]);p.push(y)}var m=["SS"],w=["'use strict'"],b=[];for(g=0;g<r;++g)b.push(["s",g,"=SS[",g,"]"].join(""));for(l=0;l<e.arrayArgs.length;++l){m.push("a"+l),m.push("t"+l),m.push("p"+l);for(g=0;g<r;++g)b.push(["t",l,"p",g,"=t",l,"[",d[l]+g,"]"].join(""));for(g=0;g<Math.abs(e.arrayBlockIndices[l]);++g)b.push(["t",l,"b",g,"=t",l,"[",h[l]+g,"]"].join(""))}for(l=0;l<e.scalarArgs.length;++l)m.push("Y"+l);if(e.shapeArgs.length>0&&b.push("shape=SS.slice(0)"),e.indexArgs.length>0){var v=new Array(r);for(l=0;l<r;++l)v[l]="0";b.push(["index=[",v.join(","),"]"].join(""))}for(l=0;l<e.offsetArgs.length;++l){var x=e.offsetArgs[l],_=[];for(g=0;g<x.offset.length;++g)0!==x.offset[g]&&(1===x.offset[g]?_.push(["t",x.array,"p",g].join("")):_.push([x.offset[g],"*t",x.array,"p",g].join("")));0===_.length?b.push("q"+l+"=0"):b.push(["q",l,"=",_.join("+")].join(""))}var I=n([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((b=b.concat(I)).length>0&&w.push("var "+b.join(",")),l=0;l<e.arrayArgs.length;++l)w.push("p"+l+"|=0");e.pre.body.length>3&&w.push(o(e.pre,e,u));var A=o(e.body,e,u),S=function(e){for(var t=0,r=e[0].length;t<r;){for(var n=1;n<e.length;++n)if(e[n][t]!==e[0][t])return t;++t}return t}(p);S<r?w.push(function(e,t,r,n){for(var o=t.length,a=r.arrayArgs.length,s=r.blockSize,u=r.indexArgs.length>0,l=[],h=0;h<a;++h)l.push(["var offset",h,"=p",h].join(""));for(h=e;h<o;++h)l.push(["for(var j"+h+"=SS[",t[h],"]|0;j",h,">0;){"].join("")),l.push(["if(j",h,"<",s,"){"].join("")),l.push(["s",t[h],"=j",h].join("")),l.push(["j",h,"=0"].join("")),l.push(["}else{s",t[h],"=",s].join("")),l.push(["j",h,"-=",s,"}"].join("")),u&&l.push(["index[",t[h],"]=j",h].join(""));for(h=0;h<a;++h){for(var c=["offset"+h],d=e;d<o;++d)c.push(["j",d,"*t",h,"p",t[d]].join(""));l.push(["p",h,"=(",c.join("+"),")"].join(""))}for(l.push(i(t,r,n)),h=e;h<o;++h)l.push("}");return l.join("\n")}(S,p[0],e,A)):w.push(i(p[0],e,A)),e.post.body.length>3&&w.push(o(e.post,e,u)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+w.join("\n")+"\n----------");var T=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",S,a(u)].join("");return new Function(["function ",T,"(",m.join(","),"){",w.join("\n"),"} return ",T].join(""))()}},6384:(e,t,r)=>{var n=r(9676);e.exports=function(e){var t=["'use strict'","var CACHED={}"],r=[],i=e.funcName+"_cwise_thunk";t.push(["return function ",i,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],u=[],l=[],h=0;h<e.arrayArgs.length;++h){var c=e.arrayArgs[h];r.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),o.push("t"+c),o.push("r"+c),a.push("t"+c),a.push("r"+c+".join()"),s.push("array"+c+".data"),s.push("array"+c+".stride"),s.push("array"+c+".offset|0"),h>0&&(u.push("array"+e.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[h]))),l.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[h])+"]"))}for(e.arrayArgs.length>1&&(t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),h=0;h<e.scalarArgs.length;++h)s.push("scalar"+e.scalarArgs[h]);return r.push(["type=[",a.join(","),"].join()"].join("")),r.push("proc=CACHED[type]"),t.push("var "+r.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(n.bind(void 0,e))}},5456:(e,t,r)=>{var n=r(8252),i=r(7668),o=r(6556),a=r(872);e.exports=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new o("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,h=arguments.length>6&&arguments[6],c=!!a&&a(e,t);if(n)n(e,t,{configurable:null===l&&c?c.configurable:!l,enumerable:null===s&&c?c.enumerable:!s,value:r,writable:null===u&&c?c.writable:!u});else{if(!h&&(s||u||l))throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},1948:e=>{function t(e,t,n){n=n||2;var o,a,s,u,c,d,p,y=t&&t.length,g=y?t[0]*n:e.length,m=r(e,0,g,n,!0),w=[];if(!m||m.next===m.prev)return w;if(y&&(m=function(e,t,n,i){var o,a,s,u=[];for(o=0,a=t.length;o<a;o++)(s=r(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i,!1))===s.next&&(s.steiner=!0),u.push(f(s));for(u.sort(l),o=0;o<u.length;o++)n=h(u[o],n);return n}(e,t,m,n)),e.length>80*n){o=s=e[0],a=u=e[1];for(var b=n;b<g;b+=n)(c=e[b])<o&&(o=c),(d=e[b+1])<a&&(a=d),c>s&&(s=c),d>u&&(u=d);p=0!==(p=Math.max(s-o,u-a))?32767/p:0}return i(m,w,n,o,a,p,0),w}function r(e,t,r,n,i){var o,a;if(i===T(e,t,r,n)>0)for(o=t;o<r;o+=n)a=I(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=I(o,e[o],e[o+1],a);return a&&m(a,a.next)&&(A(a),a=a.next),a}function n(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!m(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(A(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function i(e,t,r,l,h,c,f){if(e){!f&&c&&function(e,t,r,n){var i=e;do{0===i.z&&(i.z=d(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,u,l=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,l*=2}while(a>1)}(i)}(e,l,h,c);for(var p,y,g=e;e.prev!==e.next;)if(p=e.prev,y=e.next,c?a(e,l,h,c):o(e))t.push(p.i/r|0),t.push(e.i/r|0),t.push(y.i/r|0),A(e),e=y.next,g=y.next;else if((e=y)===g){f?1===f?i(e=s(n(e),t,r),t,r,l,h,c,2):2===f&&u(e,t,r,l,h,c):i(n(e),t,r,l,h,c,1);break}}}function o(e){var t=e.prev,r=e,n=e.next;if(g(t,r,n)>=0)return!1;for(var i=t.x,o=r.x,a=n.x,s=t.y,u=r.y,l=n.y,h=i<o?i<a?i:a:o<a?o:a,c=s<u?s<l?s:l:u<l?u:l,d=i>o?i>a?i:a:o>a?o:a,f=s>u?s>l?s:l:u>l?u:l,y=n.next;y!==t;){if(y.x>=h&&y.x<=d&&y.y>=c&&y.y<=f&&p(i,s,o,u,a,l,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function a(e,t,r,n){var i=e.prev,o=e,a=e.next;if(g(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,l=a.x,h=i.y,c=o.y,f=a.y,y=s<u?s<l?s:l:u<l?u:l,m=h<c?h<f?h:f:c<f?c:f,w=s>u?s>l?s:l:u>l?u:l,b=h>c?h>f?h:f:c>f?c:f,v=d(y,m,t,r,n),x=d(w,b,t,r,n),_=e.prevZ,I=e.nextZ;_&&_.z>=v&&I&&I.z<=x;){if(_.x>=y&&_.x<=w&&_.y>=m&&_.y<=b&&_!==i&&_!==a&&p(s,h,u,c,l,f,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,I.x>=y&&I.x<=w&&I.y>=m&&I.y<=b&&I!==i&&I!==a&&p(s,h,u,c,l,f,I.x,I.y)&&g(I.prev,I,I.next)>=0)return!1;I=I.nextZ}for(;_&&_.z>=v;){if(_.x>=y&&_.x<=w&&_.y>=m&&_.y<=b&&_!==i&&_!==a&&p(s,h,u,c,l,f,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;I&&I.z<=x;){if(I.x>=y&&I.x<=w&&I.y>=m&&I.y<=b&&I!==i&&I!==a&&p(s,h,u,c,l,f,I.x,I.y)&&g(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function s(e,t,r){var i=e;do{var o=i.prev,a=i.next.next;!m(o,a)&&w(o,i,i.next,a)&&x(o,a)&&x(a,o)&&(t.push(o.i/r|0),t.push(i.i/r|0),t.push(a.i/r|0),A(i),A(i.next),i=e=a),i=i.next}while(i!==e);return n(i)}function u(e,t,r,o,a,s){var u=e;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&y(u,l)){var h=_(u,l);return u=n(u,u.next),h=n(h,h.next),i(u,t,r,o,a,s,0),void i(h,t,r,o,a,s,0)}l=l.next}u=u.next}while(u!==e)}function l(e,t){return e.x-t.x}function h(e,t){var r=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a&&(a=s,r=n.x<n.next.x?n:n.next,s===i))return r}n=n.next}while(n!==t);if(!r)return null;var u,l=r,h=r.x,d=r.y,f=1/0;n=r;do{i>=n.x&&n.x>=h&&i!==n.x&&p(o<d?i:a,o,h,d,o<d?a:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),x(n,e)&&(u<f||u===f&&(n.x>r.x||n.x===r.x&&c(r,n)))&&(r=n,f=u)),n=n.next}while(n!==l);return r}(e,t);if(!r)return t;var i=_(r,e);return n(i,i.next),n(r,r.next)}function c(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function d(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function p(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&w(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(x(e,t)&&x(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||m(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function w(e,t,r,n){var i=v(g(e,t,r)),o=v(g(e,t,n)),a=v(g(r,n,e)),s=v(g(r,n,t));return i!==o&&a!==s||(!(0!==i||!b(e,r,t))||(!(0!==o||!b(e,n,t))||(!(0!==a||!b(r,e,n))||!(0!==s||!b(r,t,n)))))}function b(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function v(e){return e>0?1:e<0?-1:0}function x(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function _(e,t){var r=new S(e.i,e.x,e.y),n=new S(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function I(e,t,r,n){var i=new S(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function S(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(T(e,0,o,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,h=s<u-1?t[s+1]*r:e.length;a-=Math.abs(T(e,l,h,r))}var c=0;for(s=0;s<n.length;s+=3){var d=n[s]*r,f=n[s+1]*r,p=n[s+2]*r;c+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},t.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}},8252:(e,t,r)=>{var n=r(6604)("%Object.defineProperty%",!0)||!1;if(n)try{n({},"a",{value:1})}catch(e){n=!1}e.exports=n},9576:e=>{e.exports=EvalError},2772:e=>{e.exports=Error},5360:e=>{e.exports=RangeError},2380:e=>{e.exports=ReferenceError},7668:e=>{e.exports=SyntaxError},6556:e=>{e.exports=TypeError},568:e=>{e.exports=URIError},9328:e=>{var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,l,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,n),!0;case 4:return h.fn.call(h.context,t,n,i),!0;case 5:return h.fn.call(h.context,t,n,i,o),!0;case 6:return h.fn.call(h.context,t,n,i,o,a),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h.fn.apply(h.context,u)}else{var d,f=h.length;for(l=0;l<f;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),c){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,n);break;case 4:h[l].fn.call(h[l].context,t,n,i);break;default:if(!u)for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];h[l].fn.apply(h[l].context,u)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,l=[],h=s.length;u<h;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},3444:function(e,t){!function(e){var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,i=536870912,o=2*i,a=function(e,t){return function(r){var a=t.get(r),s=void 0===a?r.size:a<o?a+1:0;if(!r.has(s))return e(r,s);if(r.size<i){for(;r.has(s);)s=Math.floor(Math.random()*o);return e(r,s)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(s);)s=Math.floor(Math.random()*n);return e(r,s)}},s=new WeakMap,u=r(s),l=a(u,s),h=t(l);e.addUniqueNumber=h,e.generateUniqueNumber=l}(t)},4412:(e,t,r)=>{var n,i;void 0===(i="function"==typeof(n=function(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function r(e,t){this.name=e||"Unknown",this.type=t||"Unknown"}function n(e,t){r.call(this,e,t||"Uint")}function i(e){return e.length%2==1?"0"+e:e}function o(e,t){r.call(this,e,t||"Float")}function a(e,t){r.call(this,e,t||"Container")}function s(e){a.call(this,"File","File"),this.setSource(e)}function u(e,t,r,n){if("object"==typeof r&&(n=r,r=void 0),!r)return new Promise((function(r){u(e,t,r,n)}));try{var i=new FileReader;i.onloadend=function(){try{var o=new s(new Uint8Array(i.result));o.fixDuration(t,n)&&(e=o.toBlob(e.type))}catch(e){}r(e)},i.readAsArrayBuffer(e)}catch(t){r(e)}}return r.prototype.updateBySource=function(){},r.prototype.setSource=function(e){this.source=e,this.updateBySource()},r.prototype.updateByData=function(){},r.prototype.setData=function(e){this.data=e,this.updateByData()},t(n,r),n.prototype.updateBySource=function(){this.data="";for(var e=0;e<this.source.length;e++){var t=this.source[e].toString(16);this.data+=i(t)}},n.prototype.updateByData=function(){var e=this.data.length/2;this.source=new Uint8Array(e);for(var t=0;t<e;t++){var r=this.data.substr(2*t,2);this.source[t]=parseInt(r,16)}},n.prototype.getValue=function(){return parseInt(this.data,16)},n.prototype.setValue=function(e){this.setData(i(e.toString(16)))},t(o,r),o.prototype.getFloatArrayType=function(){return this.source&&4===this.source.length?Float32Array:Float64Array},o.prototype.updateBySource=function(){var e=this.source.reverse(),t=new(this.getFloatArrayType())(e.buffer);this.data=t[0]},o.prototype.updateByData=function(){var e=new(this.getFloatArrayType())([this.data]),t=new Uint8Array(e.buffer);this.source=t.reverse()},o.prototype.getValue=function(){return this.data},o.prototype.setValue=function(e){this.setData(e)},t(a,r),a.prototype.readByte=function(){return this.source[this.offset++]},a.prototype.readUint=function(){for(var e=this.readByte(),t=8-e.toString(2).length,r=e-(1<<7-t),n=0;n<t;n++)r*=256,r+=this.readByte();return r},a.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=s){var t=this.readUint(),i=this.readUint(),s=Math.min(this.offset+i,this.source.length),u=this.source.slice(this.offset,s),l=e[t]||{name:"Unknown",type:"Unknown"},h=r;switch(l.type){case"Container":h=a;break;case"Uint":h=n;break;case"Float":h=o}var c=new h(l.name,l.type);c.setSource(u),this.data.push({id:t,idHex:t.toString(16),data:c})}},a.prototype.writeUint=function(e,t){for(var r=1,n=128;e>=n&&r<8;r++,n*=128);if(!t)for(var i=n+e,o=r-1;o>=0;o--){var a=i%256;this.source[this.offset+o]=a,i=(i-a)/256}this.offset+=r},a.prototype.writeSections=function(e){this.offset=0;for(var t=0;t<this.data.length;t++){var r=this.data[t],n=r.data.source,i=n.length;this.writeUint(r.id,e),this.writeUint(i,e),e||this.source.set(n,this.offset),this.offset+=i}return this.offset},a.prototype.updateByData=function(){var e=this.writeSections("draft");this.source=new Uint8Array(e),this.writeSections()},a.prototype.getSectionById=function(e){for(var t=0;t<this.data.length;t++){var r=this.data[t];if(r.id===e)return r.data}return null},t(s,a),s.prototype.fixDuration=function(e,t){var r=t&&t.logger;void 0===r?r=function(e){console.log(e)}:r||(r=function(){});var n=this.getSectionById(139690087);if(!n)return r("[fix-webm-duration] Segment section is missing"),!1;var i=n.getSectionById(88713574);if(!i)return r("[fix-webm-duration] Info section is missing"),!1;var a=i.getSectionById(710577);if(!a)return r("[fix-webm-duration] TimecodeScale section is missing"),!1;var s=i.getSectionById(1161);if(s){if(!(s.getValue()<=0))return r("[fix-webm-duration] Duration section is present"),!1;r("[fix-webm-duration] Duration section is present, but the value is empty"),s.setValue(e)}else r("[fix-webm-duration] Duration section is missing"),(s=new o("Duration","Float")).setValue(e),i.data.push({id:1161,data:s});return a.setValue(1e6),i.updateByData(),n.updateByData(),this.updateByData(),!0},s.prototype.toBlob=function(e){return new Blob([this.source.buffer],{type:e||"video/webm"})},u.default=u,u})?n.call(t,r,t,e):n)||(e.exports=i)},7840:e=>{var t=Object.prototype.toString,r=Math.max,n=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var i=0;i<t.length;i+=1)r[i+e.length]=t[i];return r};e.exports=function(e){var i=this;if("function"!=typeof i||"[object Function]"!==t.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,a=function(e,t){for(var r=[],n=t||0,i=0;n<e.length;n+=1,i+=1)r[i]=e[n];return r}(arguments,1),s=r(0,i.length-a.length),u=[],l=0;l<s;l++)u[l]="$"+l;if(o=Function("binder","return function ("+function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r}(u,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var t=i.apply(this,n(a,arguments));return Object(t)===t?t:this}return i.apply(e,n(a,arguments))})),i.prototype){var h=function(){};h.prototype=i.prototype,o.prototype=new h,h.prototype=null}return o}},268:(e,t,r)=>{var n=r(7840);e.exports=Function.prototype.bind||n},6604:(e,t,r)=>{var n,i=r(2772),o=r(9576),a=r(5360),s=r(2380),u=r(7668),l=r(6556),h=r(568),c=Function,d=function(e){try{return c('"use strict"; return ('+e+").constructor;")()}catch(e){}},f=Object.getOwnPropertyDescriptor;if(f)try{f({},"")}catch(e){f=null}var p=function(){throw new l},y=f?function(){try{return p}catch(e){try{return f(arguments,"callee").get}catch(e){return p}}}():p,g=r(4308)(),m=r(7636)(),w=Object.getPrototypeOf||(m?function(e){return e.__proto__}:null),b={},v="undefined"!=typeof Uint8Array&&w?w(Uint8Array):n,x={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":g&&w?w([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":i,"%eval%":eval,"%EvalError%":o,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":c,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":g&&w?w(w([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&g&&w?w((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":a,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&g&&w?w((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":g&&w?w(""[Symbol.iterator]()):n,"%Symbol%":g?Symbol:n,"%SyntaxError%":u,"%ThrowTypeError%":y,"%TypedArray%":v,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":h,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(w)try{null.error}catch(e){var _=w(w(e));x["%Error.prototype%"]=_}var I=function e(t){var r;if("%AsyncFunction%"===t)r=d("async function () {}");else if("%GeneratorFunction%"===t)r=d("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=d("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&w&&(r=w(i.prototype))}return x[t]=r,r},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},S=r(268),T=r(5176),C=S.call(Function.call,Array.prototype.concat),E=S.call(Function.apply,Array.prototype.splice),O=S.call(Function.call,String.prototype.replace),k=S.call(Function.call,String.prototype.slice),P=S.call(Function.call,RegExp.prototype.exec),$=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,R=/\\(\\)?/g,B=function(e,t){var r,n=e;if(T(A,n)&&(n="%"+(r=A[n])[0]+"%"),T(x,n)){var i=x[n];if(i===b&&(i=I(n)),void 0===i&&!t)throw new l("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new u("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new l('"allowMissing" argument must be a boolean');if(null===P(/^%?[^%]*%?$/,e))throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=k(e,0,1),r=k(e,-1);if("%"===t&&"%"!==r)throw new u("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new u("invalid intrinsic syntax, expected opening `%`");var n=[];return O(e,$,(function(e,t,r,i){n[n.length]=r?O(i,R,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=B("%"+n+"%",t),o=i.name,a=i.value,s=!1,h=i.alias;h&&(n=h[0],E(r,C([0,1],h)));for(var c=1,d=!0;c<r.length;c+=1){var p=r[c],y=k(p,0,1),g=k(p,-1);if(('"'===y||"'"===y||"`"===y||'"'===g||"'"===g||"`"===g)&&y!==g)throw new u("property names with quotes must have matching quotes");if("constructor"!==p&&d||(s=!0),T(x,o="%"+(n+="."+p)+"%"))a=x[o];else if(null!=a){if(!(p in a)){if(!t)throw new l("base intrinsic for "+e+" exists, but the property is not available.");return}if(f&&c+1>=r.length){var m=f(a,p);a=(d=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:a[p]}else d=T(a,p),a=a[p];d&&!s&&(x[o]=a)}}return a}},872:(e,t,r)=>{var n=r(6604)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},1188:(e,t,r)=>{var n=r(8252),i=function(){return!!n};i.hasArrayLengthDefineBug=function(){if(!n)return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=i},7636:e=>{var t={foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof r)}},4308:(e,t,r)=>{var n="undefined"!=typeof Symbol&&Symbol,i=r(1968);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},1968:e=>{e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},5176:(e,t,r)=>{var n=Function.prototype.call,i=Object.prototype.hasOwnProperty,o=r(268);e.exports=o.call(n,i)},4404:(e,t)=>{t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,h=-7,c=r?i-1:0,d=r?-1:1,f=e[t+c];for(c+=d,o=f&(1<<-h)-1,f>>=-h,h+=s;h>0;o=256*o+e[t+c],c+=d,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=256*a+e[t+c],c+=d,h-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=l}return(f?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,u,l=8*o-i-1,h=(1<<l)-1,c=h>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+c>=1?d/u:d*Math.pow(2,1-c))*u>=2&&(a++,u/=2),a+c>=h?(s=0,a=h):a+c>=1?(s=(t*u-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;e[r+f]=255&a,f+=p,a/=256,l-=8);e[r+f-p]|=128*y}},4819:e=>{e.exports=function(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=r;return t}},6792:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},9600:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},8684:(e,t,r)=>{var n=r(1528),i={body:"",args:[],thisVars:[],localVars:[]};function o(e){if(!e)return i;for(var t=0;t<e.args.length;++t){var r=e.args[t];e.args[t]=0===t?{name:r,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:r,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function a(e){for(var t=[],r=0;r<e.args.length;++r)t.push("a"+r);return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(function(e){return n({args:e.args,pre:o(e.pre),body:o(e.body),post:o(e.proc),funcName:e.funcName})}(e))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var r=s[e];t[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+r+"c"},funcName:e}),t[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a"+r+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+r+"s"},funcName:e+"s"}),t[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a"+r+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var r=u[e];t[e]=a({args:["array","array"],body:{args:["a","b"],body:"a="+r+"b"},funcName:e}),t[e+"eq"]=a({args:["array"],body:{args:["a"],body:"a="+r+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in l){var r=l[e];t[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+r+"c"},funcName:e}),t[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+r+"s"},funcName:e+"s"}),t[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a=a"+r+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+r+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var h=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<h.length;++e){var r=h[e];t[r]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:r}),t[r+"eq"]=a({args:["array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"eq"})}}();var c=["max","min","atan2","pow"];!function(){for(var e=0;e<c.length;++e){var r=c[e];t[r]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:r}),t[r+"s"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:r+"s"}),t[r+"eq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"eq"}),t[r+"seq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"seq"})}}();var d=["atan2","pow"];!function(){for(var e=0;e<d.length;++e){var r=d[e];t[r+"op"]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:r+"op"}),t[r+"ops"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:r+"ops"}),t[r+"opeq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"opeq"}),t[r+"opseq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"opseq"})}}(),t.any=n({args:["array"],pre:i,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=n({args:["array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=n({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=n({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=n({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=n({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=a({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=a({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=a({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=n({args:["array","array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},4300:(e,t,r)=>{var n=r(4819),i=r(6792),o="undefined"!=typeof Float64Array;function a(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,r=new Array(t.length);for(e=0;e<r.length;++e)r[e]=[Math.abs(t[e]),e];r.sort(a);var n=new Array(r.length);for(e=0;e<n.length;++e)n[e]=r[e][1];return n}function u(e,t){var r=["View",t,"d",e].join("");t<0&&(r="View_Nil"+e);var i="generic"===e;if(-1===t){var o="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";return new Function(o)()}if(0===t){o="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";return new Function("TrivialArray",o)(l[e][0])}o=["'use strict'"];var a=n(t),u=a.map((function(e){return"i"+e})),h="this.offset+"+a.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),c=a.map((function(e){return"b"+e})).join(","),d=a.map((function(e){return"c"+e})).join(",");o.push("function "+r+"(a,"+c+","+d+",d){this.data=a","this.shape=["+c+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+a.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+r+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+r+"_set("+u.join(",")+",v){"),i?o.push("return this.data.set("+h+",v)}"):o.push("return this.data["+h+"]=v}"),o.push("proto.get=function "+r+"_get("+u.join(",")+"){"),i?o.push("return this.data.get("+h+")}"):o.push("return this.data["+h+"]}"),o.push("proto.index=function "+r+"_index(",u.join(),"){return "+h+"}"),o.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+a.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+a.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var f=a.map((function(e){return"a"+e+"=this.shape["+e+"]"})),p=a.map((function(e){return"c"+e+"=this.stride["+e+"]"}));o.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+f.join(",")+","+p.join(","));for(var y=0;y<t;++y)o.push("if(typeof i"+y+"==='number'&&i"+y+">=0){d=i"+y+"|0;b+=c"+y+"*d;a"+y+"-=d}");o.push("return new "+r+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"c"+e})).join(",")+",b)}"),o.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+a.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+a.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(y=0;y<t;++y)o.push("if(typeof i"+y+"==='number'){d=i"+y+"|0;if(d<0){c+=b"+y+"*(a"+y+"-1);a"+y+"=ceil(-a"+y+"/d)}else{a"+y+"=ceil(a"+y+"/d)}b"+y+"*=d}");o.push("return new "+r+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"b"+e})).join(",")+",c)}");var g=new Array(t),m=new Array(t);for(y=0;y<t;++y)g[y]="a[i"+y+"]",m[y]="b[i"+y+"]";o.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+g.join(",")+","+m.join(",")+",this.offset)}"),o.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(y=0;y<t;++y)o.push("if(typeof i"+y+"==='number'&&i"+y+">=0){c=(c+this.stride["+y+"]*i"+y+")|0}else{a.push(this.shape["+y+"]);b.push(this.stride["+y+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+a.map((function(e){return"shape["+e+"]"})).join(",")+","+a.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(l[e],s)}var l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,r,n){if(void 0===e)return(0,l.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===r){r=new Array(a);for(var s=a-1,h=1;s>=0;--s)r[s]=h,h*=t[s]}if(void 0===n){n=0;for(s=0;s<a;++s)r[s]<0&&(n-=(t[s]-1)*r[s])}for(var c=function(e){if(i(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),d=l[c];d.length<=a+1;)d.push(u(c,d.length-1));return(0,d[a+1])(e,t,r,n)}},7872:(e,t,r)=>{var n="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=n&&i&&"function"==typeof i.get?i.get:null,a=n&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=s&&u&&"function"==typeof u.get?u.get:null,h=s&&Set.prototype.forEach,c="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,f="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,y=Object.prototype.toString,g=Function.prototype.toString,m=String.prototype.match,w=String.prototype.slice,b=String.prototype.replace,v=String.prototype.toUpperCase,x=String.prototype.toLowerCase,_=RegExp.prototype.test,I=Array.prototype.concat,A=Array.prototype.join,S=Array.prototype.slice,T=Math.floor,C="function"==typeof BigInt?BigInt.prototype.valueOf:null,E=Object.getOwnPropertySymbols,O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,k="function"==typeof Symbol&&"object"==typeof Symbol.iterator,P="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===k||"symbol")?Symbol.toStringTag:null,$=Object.prototype.propertyIsEnumerable,R=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function B(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-T(-e):T(e);if(n!==e){var i=String(n),o=w.call(t,i.length+1);return b.call(i,r,"$&_")+"."+b.call(b.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,r,"$&_")}var D=r(6204),M=D.custom,L=G(M)?M:null;function F(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function N(e){return b.call(String(e),/"/g,"&quot;")}function U(e){return!("[object Array]"!==H(e)||P&&"object"==typeof e&&P in e)}function j(e){return!("[object RegExp]"!==H(e)||P&&"object"==typeof e&&P in e)}function G(e){if(k)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!O)return!1;try{return O.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,i,s){var u=n||{};if(V(u,"quoteStyle")&&"single"!==u.quoteStyle&&"double"!==u.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(V(u,"maxStringLength")&&("number"==typeof u.maxStringLength?u.maxStringLength<0&&u.maxStringLength!==1/0:null!==u.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var y=!V(u,"customInspect")||u.customInspect;if("boolean"!=typeof y&&"symbol"!==y)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(V(u,"indent")&&null!==u.indent&&"\t"!==u.indent&&!(parseInt(u.indent,10)===u.indent&&u.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(V(u,"numericSeparator")&&"boolean"!=typeof u.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=u.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return Y(t,u);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var _=String(t);return v?B(t,_):_}if("bigint"==typeof t){var T=String(t)+"n";return v?B(t,T):T}var E=void 0===u.depth?5:u.depth;if(void 0===i&&(i=0),i>=E&&E>0&&"object"==typeof t)return U(t)?"[Array]":"[Object]";var M=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=A.call(Array(e.indent+1)," ")}return{base:r,prev:A.call(Array(t+1),r)}}(u,i);if(void 0===s)s=[];else if(W(s,t)>=0)return"[Circular]";function z(t,r,n){if(r&&(s=S.call(s)).push(r),n){var o={depth:u.depth};return V(u,"quoteStyle")&&(o.quoteStyle=u.quoteStyle),e(t,o,i+1,s)}return e(t,u,i+1,s)}if("function"==typeof t&&!j(t)){var K=function(e){if(e.name)return e.name;var t=m.call(g.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),ee=Q(t,z);return"[Function"+(K?": "+K:" (anonymous)")+"]"+(ee.length>0?" { "+A.call(ee,", ")+" }":"")}if(G(t)){var te=k?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):O.call(t);return"object"!=typeof t||k?te:X(te)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var re="<"+x.call(String(t.nodeName)),ne=t.attributes||[],ie=0;ie<ne.length;ie++)re+=" "+ne[ie].name+"="+F(N(ne[ie].value),"double",u);return re+=">",t.childNodes&&t.childNodes.length&&(re+="..."),re+="</"+x.call(String(t.nodeName))+">"}if(U(t)){if(0===t.length)return"[]";var oe=Q(t,z);return M&&!function(e){for(var t=0;t<e.length;t++)if(W(e[t],"\n")>=0)return!1;return!0}(oe)?"["+J(oe,M)+"]":"[ "+A.call(oe,", ")+" ]"}if(function(e){return!("[object Error]"!==H(e)||P&&"object"==typeof e&&P in e)}(t)){var ae=Q(t,z);return"cause"in Error.prototype||!("cause"in t)||$.call(t,"cause")?0===ae.length?"["+String(t)+"]":"{ ["+String(t)+"] "+A.call(ae,", ")+" }":"{ ["+String(t)+"] "+A.call(I.call("[cause]: "+z(t.cause),ae),", ")+" }"}if("object"==typeof t&&y){if(L&&"function"==typeof t[L]&&D)return D(t,{depth:E-i});if("symbol"!==y&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=typeof e)return!1;try{o.call(e);try{l.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var se=[];return a&&a.call(t,(function(e,r){se.push(z(r,t,!0)+" => "+z(e,t))})),q("Map",o.call(t),se,M)}if(function(e){if(!l||!e||"object"!=typeof e)return!1;try{l.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var ue=[];return h&&h.call(t,(function(e){ue.push(z(e,t))})),q("Set",l.call(t),ue,M)}if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e,c);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Z("WeakMap");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{c.call(e,c)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Z("WeakSet");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{return f.call(e),!0}catch(e){}return!1}(t))return Z("WeakRef");if(function(e){return!("[object Number]"!==H(e)||P&&"object"==typeof e&&P in e)}(t))return X(z(Number(t)));if(function(e){if(!e||"object"!=typeof e||!C)return!1;try{return C.call(e),!0}catch(e){}return!1}(t))return X(z(C.call(t)));if(function(e){return!("[object Boolean]"!==H(e)||P&&"object"==typeof e&&P in e)}(t))return X(p.call(t));if(function(e){return!("[object String]"!==H(e)||P&&"object"==typeof e&&P in e)}(t))return X(z(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if(t===r.g)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==H(e)||P&&"object"==typeof e&&P in e)}(t)&&!j(t)){var le=Q(t,z),he=R?R(t)===Object.prototype:t instanceof Object||t.constructor===Object,ce=t instanceof Object?"":"null prototype",de=!he&&P&&Object(t)===t&&P in t?w.call(H(t),8,-1):ce?"Object":"",fe=(he||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(de||ce?"["+A.call(I.call([],de||[],ce||[]),": ")+"] ":"");return 0===le.length?fe+"{}":M?fe+"{"+J(le,M)+"}":fe+"{ "+A.call(le,", ")+" }"}return String(t)};var z=Object.prototype.hasOwnProperty||function(e){return e in this};function V(e,t){return z.call(e,t)}function H(e){return y.call(e)}function W(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function Y(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Y(w.call(e,0,t.maxStringLength),t)+n}return F(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,K),"single",t)}function K(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+v.call(t.toString(16))}function X(e){return"Object("+e+")"}function Z(e){return e+" { ? }"}function q(e,t,r,n){return e+" ("+t+") {"+(n?J(r,n):A.call(r,", "))+"}"}function J(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+A.call(e,","+r)+"\n"+t.prev}function Q(e,t){var r=U(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=V(e,i)?t(e[i],e):""}var o,a="function"==typeof E?E(e):[];if(k){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var u in e)V(e,u)&&(r&&String(Number(u))===u&&u<e.length||k&&o["$"+u]instanceof Symbol||(_.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if("function"==typeof E)for(var l=0;l<a.length;l++)$.call(e,a[l])&&n.push("["+t(a[l])+"]: "+t(e[a[l]],e));return n}},6512:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,u=[],l=!1,h=-1;function c(){l&&s&&(l=!1,s.length?u=s.concat(u):h=-1,u.length&&d())}function d(){if(!l){var e=a(c);l=!0;for(var t=u.length;t;){for(s=u,u=[];++h<t;)s&&s[h].run();h=-1,t=u.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||l||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},7568:function(e,t,r){var n;e=r.nmd(e),function(i){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r.g&&r.g;o.global!==o&&o.window!==o&&o.self;var a,s=2147483647,u=36,l=1,h=26,c=38,d=700,f=72,p=128,y="-",g=/^xn--/,m=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=u-l,x=Math.floor,_=String.fromCharCode;function I(e){throw new RangeError(b[e])}function A(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function S(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+A((e=e.replace(w,".")).split("."),t).join(".")}function T(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function C(e){return A(e,(function(e){var t="";return e>65535&&(t+=_((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=_(e)})).join("")}function E(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function O(e,t,r){var n=0;for(e=r?x(e/d):e>>1,e+=x(e/t);e>v*h>>1;n+=u)e=x(e/v);return x(n+(v+1)*e/(e+c))}function k(e){var t,r,n,i,o,a,c,d,g,m,w,b=[],v=e.length,_=0,A=p,S=f;for((r=e.lastIndexOf(y))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&I("not-basic"),b.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<v;){for(o=_,a=1,c=u;i>=v&&I("invalid-input"),((d=(w=e.charCodeAt(i++))-48<10?w-22:w-65<26?w-65:w-97<26?w-97:u)>=u||d>x((s-_)/a))&&I("overflow"),_+=d*a,!(d<(g=c<=S?l:c>=S+h?h:c-S));c+=u)a>x(s/(m=u-g))&&I("overflow"),a*=m;S=O(_-o,t=b.length+1,0==o),x(_/t)>s-A&&I("overflow"),A+=x(_/t),_%=t,b.splice(_++,0,A)}return C(b)}function P(e){var t,r,n,i,o,a,c,d,g,m,w,b,v,A,S,C=[];for(b=(e=T(e)).length,t=p,r=0,o=f,a=0;a<b;++a)(w=e[a])<128&&C.push(_(w));for(n=i=C.length,i&&C.push(y);n<b;){for(c=s,a=0;a<b;++a)(w=e[a])>=t&&w<c&&(c=w);for(c-t>x((s-r)/(v=n+1))&&I("overflow"),r+=(c-t)*v,t=c,a=0;a<b;++a)if((w=e[a])<t&&++r>s&&I("overflow"),w==t){for(d=r,g=u;!(d<(m=g<=o?l:g>=o+h?h:g-o));g+=u)S=d-m,A=u-m,C.push(_(E(m+S%A,0))),d=x(S/A);C.push(_(E(d,0))),o=O(r,v,n==i),r=0,++n}++r,++t}return C.join("")}a={version:"1.4.1",ucs2:{decode:T,encode:C},decode:k,encode:P,toASCII:function(e){return S(e,(function(e){return m.test(e)?"xn--"+P(e):e}))},toUnicode:function(e){return S(e,(function(e){return g.test(e)?k(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return a}.call(t,r,t,e))||(e.exports=n)}()},6515:e=>{var t=String.prototype.replace,r=/%20/g,n="RFC1738",i="RFC3986";e.exports={default:i,formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:n,RFC3986:i}},7392:(e,t,r)=>{var n=r(4368),i=r(4812),o=r(6515);e.exports={formats:o,parse:i,stringify:n}},4812:(e,t,r)=>{var n=r(5872),i=Object.prototype.hasOwnProperty,o=Array.isArray,a={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},u=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},l=function(e,t,r,n){if(e){var o=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(o),l=s?o.slice(0,s.index):o,h=[];if(l){if(!r.plainObjects&&i.call(Object.prototype,l)&&!r.allowPrototypes)return;h.push(l)}for(var c=0;r.depth>0&&null!==(s=a.exec(o))&&c<r.depth;){if(c+=1,!r.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;h.push(s[1])}return s&&h.push("["+o.slice(s.index)+"]"),function(e,t,r,n){for(var i=n?t:u(t,r),o=e.length-1;o>=0;--o){var a,s=e[o];if("[]"===s&&r.parseArrays)a=[].concat(i);else{a=r.plainObjects?Object.create(null):{};var l="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,h=parseInt(l,10);r.parseArrays||""!==l?!isNaN(h)&&s!==l&&String(h)===l&&h>=0&&r.parseArrays&&h<=r.arrayLimit?(a=[])[h]=i:"__proto__"!==l&&(a[l]=i):a={0:i}}i=a}return i}(h,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:a.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var h="string"==typeof e?function(e,t){var r,l={__proto__:null},h=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,c=t.parameterLimit===1/0?void 0:t.parameterLimit,d=h.split(t.delimiter,c),f=-1,p=t.charset;if(t.charsetSentinel)for(r=0;r<d.length;++r)0===d[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===d[r]?p="utf-8":"utf8=%26%2310003%3B"===d[r]&&(p="iso-8859-1"),f=r,r=d.length);for(r=0;r<d.length;++r)if(r!==f){var y,g,m=d[r],w=m.indexOf("]="),b=-1===w?m.indexOf("="):w+1;-1===b?(y=t.decoder(m,a.decoder,p,"key"),g=t.strictNullHandling?null:""):(y=t.decoder(m.slice(0,b),a.decoder,p,"key"),g=n.maybeMap(u(m.slice(b+1),t),(function(e){return t.decoder(e,a.decoder,p,"value")}))),g&&t.interpretNumericEntities&&"iso-8859-1"===p&&(g=s(g)),m.indexOf("[]=")>-1&&(g=o(g)?[g]:g),i.call(l,y)?l[y]=n.combine(l[y],g):l[y]=g}return l}(e,r):e,c=r.plainObjects?Object.create(null):{},d=Object.keys(h),f=0;f<d.length;++f){var p=d[f],y=l(p,h[p],r,"string"==typeof e);c=n.merge(c,y,r)}return!0===r.allowSparse?c:n.compact(c)}},4368:(e,t,r)=>{var n=r(7223),i=r(5872),o=r(6515),a=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Array.isArray,l=Array.prototype.push,h=function(e,t){l.apply(e,u(t)?t:[t])},c=Date.prototype.toISOString,d=o.default,f={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:d,formatter:o.formatters[d],indices:!1,serializeDate:function(e){return c.call(e)},skipNulls:!1,strictNullHandling:!1},p={},y=function e(t,r,o,a,s,l,c,d,y,g,m,w,b,v,x,_){for(var I,A=t,S=_,T=0,C=!1;void 0!==(S=S.get(p))&&!C;){var E=S.get(t);if(T+=1,void 0!==E){if(E===T)throw new RangeError("Cyclic object value");C=!0}void 0===S.get(p)&&(T=0)}if("function"==typeof d?A=d(r,A):A instanceof Date?A=m(A):"comma"===o&&u(A)&&(A=i.maybeMap(A,(function(e){return e instanceof Date?m(e):e}))),null===A){if(s)return c&&!v?c(r,f.encoder,x,"key",w):r;A=""}if("string"==typeof(I=A)||"number"==typeof I||"boolean"==typeof I||"symbol"==typeof I||"bigint"==typeof I||i.isBuffer(A))return c?[b(v?r:c(r,f.encoder,x,"key",w))+"="+b(c(A,f.encoder,x,"value",w))]:[b(r)+"="+b(String(A))];var O,k=[];if(void 0===A)return k;if("comma"===o&&u(A))v&&c&&(A=i.maybeMap(A,c)),O=[{value:A.length>0?A.join(",")||null:void 0}];else if(u(d))O=d;else{var P=Object.keys(A);O=y?P.sort(y):P}for(var $=a&&u(A)&&1===A.length?r+"[]":r,R=0;R<O.length;++R){var B=O[R],D="object"==typeof B&&void 0!==B.value?B.value:A[B];if(!l||null!==D){var M=u(A)?"function"==typeof o?o($,B):$:$+(g?"."+B:"["+B+"]");_.set(t,T);var L=n();L.set(p,_),h(k,e(D,M,o,a,s,l,"comma"===o&&v&&u(A)?null:c,d,y,g,m,w,b,v,x,L))}}return k};e.exports=function(e,t){var r,i=e,l=function(e){if(!e)return f;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||f.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=o.default;if(void 0!==e.format){if(!a.call(o.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=o.formatters[r],i=f.filter;return("function"==typeof e.filter||u(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:f.addQueryPrefix,allowDots:void 0===e.allowDots?f.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:f.charsetSentinel,delimiter:void 0===e.delimiter?f.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:f.encode,encoder:"function"==typeof e.encoder?e.encoder:f.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:f.encodeValuesOnly,filter:i,format:r,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:f.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:f.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:f.strictNullHandling}}(t);"function"==typeof l.filter?i=(0,l.filter)("",i):u(l.filter)&&(r=l.filter);var c,d=[];if("object"!=typeof i||null===i)return"";c=t&&t.arrayFormat in s?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var p=s[c];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var g="comma"===p&&t&&t.commaRoundTrip;r||(r=Object.keys(i)),l.sort&&r.sort(l.sort);for(var m=n(),w=0;w<r.length;++w){var b=r[w];l.skipNulls&&null===i[b]||h(d,y(i[b],b,p,g,l.strictNullHandling,l.skipNulls,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,m))}var v=d.join(l.delimiter),x=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?x+="utf8=%26%2310003%3B&":x+="utf8=%E2%9C%93&"),v.length>0?x+v:""}},5872:(e,t,r)=>{var n=r(6515),i=Object.prototype.hasOwnProperty,o=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:s,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],a=i.obj[i.prop],s=Object.keys(a),u=0;u<s.length;++u){var l=s[u],h=a[l];"object"==typeof h&&null!==h&&-1===r.indexOf(h)&&(t.push({obj:a,prop:l}),r.push(h))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(o(r)){for(var n=[],i=0;i<r.length;++i)void 0!==r[i]&&n.push(r[i]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r,i,o){if(0===e.length)return e;var s=e;if("symbol"==typeof e?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var u="",l=0;l<s.length;++l){var h=s.charCodeAt(l);45===h||46===h||95===h||126===h||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||o===n.RFC1738&&(40===h||41===h)?u+=s.charAt(l):h<128?u+=a[h]:h<2048?u+=a[192|h>>6]+a[128|63&h]:h<55296||h>=57344?u+=a[224|h>>12]+a[128|h>>6&63]+a[128|63&h]:(l+=1,h=65536+((1023&h)<<10|1023&s.charCodeAt(l)),u+=a[240|h>>18]+a[128|h>>12&63]+a[128|h>>6&63]+a[128|63&h])}return u},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(o(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(o(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!i.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var a=t;return o(t)&&!o(r)&&(a=s(t,n)),o(t)&&o(r)?(r.forEach((function(r,o){if(i.call(t,o)){var a=t[o];a&&"object"==typeof a&&r&&"object"==typeof r?t[o]=e(a,r,n):t.push(r)}else t[o]=r})),t):Object.keys(r).reduce((function(t,o){var a=r[o];return i.call(t,o)?t[o]=e(t[o],a,n):t[o]=a,t}),a)}}},2392:(e,t,r)=>{var n=r(6604),i=r(5456),o=r(1188)(),a=r(872),s=r(6556),u=n("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new s("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||u(t)!==t)throw new s("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,l=!0;if("length"in e&&a){var h=a(e,"length");h&&!h.configurable&&(n=!1),h&&!h.writable&&(l=!1)}return(n||l||!r)&&(o?i(e,"length",t,!0,!0):i(e,"length",t)),e}},7223:(e,t,r)=>{var n=r(6604),i=r(2768),o=r(7872),a=r(6556),s=n("%WeakMap%",!0),u=n("%Map%",!0),l=i("WeakMap.prototype.get",!0),h=i("WeakMap.prototype.set",!0),c=i("WeakMap.prototype.has",!0),d=i("Map.prototype.get",!0),f=i("Map.prototype.set",!0),p=i("Map.prototype.has",!0),y=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new a("Side channel does not contain "+o(e))},get:function(n){if(s&&n&&("object"==typeof n||"function"==typeof n)){if(e)return l(e,n)}else if(u){if(t)return d(t,n)}else if(r)return function(e,t){var r=y(e,t);return r&&r.value}(r,n)},has:function(n){if(s&&n&&("object"==typeof n||"function"==typeof n)){if(e)return c(e,n)}else if(u){if(t)return p(t,n)}else if(r)return function(e,t){return!!y(e,t)}(r,n);return!1},set:function(n,i){s&&n&&("object"==typeof n||"function"==typeof n)?(e||(e=new s),h(e,n,i)):u?(t||(t=new u),f(t,n,i)):(r||(r={key:{},next:null}),function(e,t,r){var n=y(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,i))}};return n}},2248:e=>{e.exports=function(e,t,r){return 0===e.length?e:t?(r||e.sort(t),function(e,t){for(var r=1,n=e.length,i=e[0],o=e[0],a=1;a<n;++a)if(o=i,t(i=e[a],o)){if(a===r){r++;continue}e[r++]=i}return e.length=r,e}(e,t)):(r||e.sort(),function(e){for(var t=1,r=e.length,n=e[0],i=e[0],o=1;o<r;++o,i=n)if(i=n,(n=e[o])!==i){if(o===t){t++;continue}e[t++]=n}return e.length=t,e}(e))}},4776:(e,t,r)=>{var n=r(7568);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),h=["%","/","?",";","#"].concat(l),c=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=r(7392);function w(e,t,r){if(e&&"object"==typeof e&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),a=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var w=e=u.join(a);if(w=w.trim(),!r&&1===e.split("#").length){var b=s.exec(w);if(b)return this.path=w,this.href=w,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?m.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var v=o.exec(w);if(v){var x=(v=v[0]).toLowerCase();this.protocol=x,w=w.substr(v.length)}if(r||v||w.match(/^\/\/[^@/]+@[^@/]+/)){var _="//"===w.substr(0,2);!_||v&&y[v]||(w=w.substr(2),this.slashes=!0)}if(!y[v]&&(_||v&&!g[v])){for(var I,A,S=-1,T=0;T<c.length;T++){-1!==(C=w.indexOf(c[T]))&&(-1===S||C<S)&&(S=C)}-1!==(A=-1===S?w.lastIndexOf("@"):w.lastIndexOf("@",S))&&(I=w.slice(0,A),w=w.slice(A+1),this.auth=decodeURIComponent(I)),S=-1;for(T=0;T<h.length;T++){var C;-1!==(C=w.indexOf(h[T]))&&(-1===S||C<S)&&(S=C)}-1===S&&(S=w.length),this.host=w.slice(0,S),w=w.slice(S),this.parseHost(),this.hostname=this.hostname||"";var E="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!E)for(var O=this.hostname.split(/\./),k=(T=0,O.length);T<k;T++){var P=O[T];if(P&&!P.match(d)){for(var $="",R=0,B=P.length;R<B;R++)P.charCodeAt(R)>127?$+="x":$+=P[R];if(!$.match(d)){var D=O.slice(0,T),M=O.slice(T+1),L=P.match(f);L&&(D.push(L[1]),M.unshift(L[2])),M.length&&(w="/"+M.join(".")+w),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=n.toASCII(this.hostname));var F=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+F,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==w[0]&&(w="/"+w))}if(!p[x])for(T=0,k=l.length;T<k;T++){var U=l[T];if(-1!==w.indexOf(U)){var j=encodeURIComponent(U);j===U&&(j=escape(U)),w=w.split(U).join(j)}}var G=w.indexOf("#");-1!==G&&(this.hash=w.substr(G),w=w.slice(0,G));var z=w.indexOf("?");if(-1!==z?(this.search=w.substr(z),this.query=w.substr(z+1),t&&(this.query=m.parse(this.query)),w=w.slice(0,z)):t&&(this.search="",this.query={}),w&&(this.pathname=w),g[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var V=this.search||"";this.path=F+V}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(o=m.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(w(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if("string"==typeof e){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),o=0;o<n.length;o++){var a=n[o];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var l=s[u];"protocol"!==l&&(r[l]=e[l])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var h=Object.keys(e),c=0;c<h.length;c++){var d=h[c];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||y[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",m=r.search||"";r.path=p+m}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var w=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),v=b||w||r.host&&e.pathname,x=v,_=r.pathname&&r.pathname.split("/")||[],I=(f=e.pathname&&e.pathname.split("/")||[],r.protocol&&!g[r.protocol]);if(I&&(r.hostname="",r.port=null,r.host&&(""===_[0]?_[0]=r.host:_.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),v=v&&(""===f[0]||""===_[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,_=f;else if(f.length)_||(_=[]),_.pop(),_=_.concat(f),r.search=e.search,r.query=e.query;else if(null!=e.search){if(I)r.host=_.shift(),r.hostname=r.host,(E=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=E.shift(),r.hostname=E.shift(),r.host=r.hostname);return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!_.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var A=_.slice(-1)[0],S=(r.host||e.host||_.length>1)&&("."===A||".."===A)||""===A,T=0,C=_.length;C>=0;C--)"."===(A=_[C])?_.splice(C,1):".."===A?(_.splice(C,1),T++):T&&(_.splice(C,1),T--);if(!v&&!x)for(;T--;T)_.unshift("..");!v||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),S&&"/"!==_.join("/").substr(-1)&&_.push("");var E,O=""===_[0]||_[0]&&"/"===_[0].charAt(0);I&&(r.hostname=O?"":_.length?_.shift():"",r.host=r.hostname,(E=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=E.shift(),r.hostname=E.shift(),r.host=r.hostname));return(v=v||r.host&&_.length)&&!O&&_.unshift(""),_.length>0?r.pathname=_.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.K0=w,t.WI=function(e,t){return w(e,!1,!0).resolve(t)},t.E9=function(e){return"string"==typeof e&&(e=w(e)),e instanceof i?e.format():i.prototype.format.call(e)}},8804:e=>{e.exports="data:application/javascript;base64,ZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQociwgbCkgeyB2YXIgdCA9IG51bGwgPT0gciA/IG51bGwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU3ltYm9sICYmIHJbU3ltYm9sLml0ZXJhdG9yXSB8fCByWyJAQGl0ZXJhdG9yIl07IGlmIChudWxsICE9IHQpIHsgdmFyIGUsIG4sIGksIHUsIGEgPSBbXSwgZiA9ICEwLCBvID0gITE7IHRyeSB7IGlmIChpID0gKHQgPSB0LmNhbGwocikpLm5leHQsIDAgPT09IGwpIHsgaWYgKE9iamVjdCh0KSAhPT0gdCkgcmV0dXJuOyBmID0gITE7IH0gZWxzZSBmb3IgKDsgIShmID0gKGUgPSBpLmNhbGwodCkpLmRvbmUpICYmIChhLnB1c2goZS52YWx1ZSksIGEubGVuZ3RoICE9PSBsKTsgZiA9ICEwKTsgfSBjYXRjaCAocikgeyBvID0gITAsIG4gPSByOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIWYgJiYgbnVsbCAhPSB0WyJyZXR1cm4iXSAmJiAodSA9IHRbInJldHVybiJdKCksIE9iamVjdCh1KSAhPT0gdSkpIHJldHVybjsgfSBmaW5hbGx5IHsgaWYgKG8pIHRocm93IG47IH0gfSByZXR1cm4gYTsgfSB9CmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQpmdW5jdGlvbiBfY29uc3RydWN0KHQsIGUsIHIpIHsgaWYgKF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSkgcmV0dXJuIFJlZmxlY3QuY29uc3RydWN0LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7IHZhciBvID0gW251bGxdOyBvLnB1c2guYXBwbHkobywgZSk7IHZhciBwID0gbmV3ICh0LmJpbmQuYXBwbHkodCwgbykpKCk7IHJldHVybiByICYmIF9zZXRQcm90b3R5cGVPZihwLCByLnByb3RvdHlwZSksIHA7IH0KZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgdHJ5IHsgdmFyIHQgPSAhQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyB9IGNhdGNoICh0KSB7fSByZXR1cm4gKF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyByZXR1cm4gISF0OyB9KSgpOyB9CmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZi5iaW5kKCkgOiBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfQpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgJiYgaXRlcltTeW1ib2wuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlclsiQEBpdGVyYXRvciJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7IH0KZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBrZXkgPSBfdG9Qcm9wZXJ0eUtleShrZXkpOyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KZnVuY3Rpb24gX3RvUHJvcGVydHlLZXkodCkgeyB2YXIgaSA9IF90b1ByaW1pdGl2ZSh0LCAic3RyaW5nIik7IHJldHVybiAic3ltYm9sIiA9PSBfdHlwZW9mKGkpID8gaSA6IFN0cmluZyhpKTsgfQpmdW5jdGlvbiBfdG9QcmltaXRpdmUodCwgcikgeyBpZiAoIm9iamVjdCIgIT0gX3R5cGVvZih0KSB8fCAhdCkgcmV0dXJuIHQ7IHZhciBlID0gdFtTeW1ib2wudG9QcmltaXRpdmVdOyBpZiAodm9pZCAwICE9PSBlKSB7IHZhciBpID0gZS5jYWxsKHQsIHIgfHwgImRlZmF1bHQiKTsgaWYgKCJvYmplY3QiICE9IF90eXBlb2YoaSkpIHJldHVybiBpOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoInN0cmluZyIgPT09IHIgPyBTdHJpbmcgOiBOdW1iZXIpKHQpOyB9CmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7IHZhciBpdCA9IHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSB8fCBvWyJAQGl0ZXJhdG9yIl07IGlmICghaXQpIHsgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHsgaWYgKGl0KSBvID0gaXQ7IHZhciBpID0gMDsgdmFyIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4geyBkb25lOiB0cnVlIH07IHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogb1tpKytdIH07IH0sIGU6IGZ1bmN0aW9uIGUoX2U0KSB7IHRocm93IF9lNDsgfSwgZjogRiB9OyB9IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfSB2YXIgbm9ybWFsQ29tcGxldGlvbiA9IHRydWUsIGRpZEVyciA9IGZhbHNlLCBlcnI7IHJldHVybiB7IHM6IGZ1bmN0aW9uIHMoKSB7IGl0ID0gaXQuY2FsbChvKTsgfSwgbjogZnVuY3Rpb24gbigpIHsgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7IG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7IHJldHVybiBzdGVwOyB9LCBlOiBmdW5jdGlvbiBlKF9lNSkgeyBkaWRFcnIgPSB0cnVlOyBlcnIgPSBfZTU7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdFsicmV0dXJuIl0gIT0gbnVsbCkgaXRbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChkaWRFcnIpIHRocm93IGVycjsgfSB9IH07IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH0KZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTsgcmV0dXJuIGFycjI7IH0KZnVuY3Rpb24gX3R5cGVvZihvKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IHJldHVybiBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykgeyByZXR1cm4gdHlwZW9mIG87IH0gOiBmdW5jdGlvbiAobykgeyByZXR1cm4gbyAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvOyB9LCBfdHlwZW9mKG8pOyB9Ci8qISBGb3IgbGljZW5zZSBpbmZvcm1hdGlvbiBwbGVhc2Ugc2VlIGxvd0xpZ2h0LmpzLkxJQ0VOU0UudHh0ICovCihmdW5jdGlvbiAoKSB7CiAgInVzZSBzdHJpY3QiOwoKICBmdW5jdGlvbiB0KGUpIHsKICAgIHJldHVybiB0ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIHQoZSk7CiAgfQogIGZ1bmN0aW9uIGUodCwgZSkgewogICAgZm9yICh2YXIgciA9IDA7IHIgPCBlLmxlbmd0aDsgcisrKSB7CiAgICAgIHZhciBhID0gZVtyXTsKICAgICAgYS5lbnVtZXJhYmxlID0gYS5lbnVtZXJhYmxlIHx8ICExLCBhLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIGEgJiYgKGEud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBuKGEua2V5KSwgYSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG4oZSkgewogICAgdmFyIG4gPSBmdW5jdGlvbiAoZSwgbikgewogICAgICBpZiAoIm9iamVjdCIgIT0gdChlKSB8fCAhZSkgcmV0dXJuIGU7CiAgICAgIHZhciByID0gZVtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSByKSB7CiAgICAgICAgdmFyIGEgPSByLmNhbGwoZSwgbiB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSB0KGEpKSByZXR1cm4gYTsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IG4gPyBTdHJpbmcgOiBOdW1iZXIpKGUpOwogICAgfShlLCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gdChuKSA/IG4gOiBTdHJpbmcobik7CiAgfQogIHZhciByID0gLjAwODg1NiwKICAgIGEgPSAxIC8gTWF0aC5zcXJ0KDIpLAogICAgbyA9IDEgLyBNYXRoLnNxcnQoMyksCiAgICBpID0gMSAvIE1hdGguc3FydCg2KSwKICAgIHUgPSBNYXRoLmxvZygxMCksCiAgICBsID0gZnVuY3Rpb24gKCkgewogICAgICBmdW5jdGlvbiB0KCkgewogICAgICAgICFmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgICB9KHRoaXMsIHQpOwogICAgICB9CiAgICAgIHZhciBuLCBsLCBjOwogICAgICByZXR1cm4gbiA9IHQsIGMgPSBbewogICAgICAgIGtleTogIlJHQnRvWFlaIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlIsCiAgICAgICAgICAgIG4gPSB0LkcsCiAgICAgICAgICAgIHIgPSB0LkI7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBYOiAuNDEyNDUzICogKGUgPSBhKGUpKSArIC4zNTc1OCAqIChuID0gYShuKSkgKyAuMTgwNDIzICogKHIgPSBhKHIpKSwKICAgICAgICAgICAgWTogLjIxMjY3MSAqIGUgKyAuNzE1MTYgKiBuICsgLjA3MjE2OSAqIHIsCiAgICAgICAgICAgIFo6IC4wMTkzMzQgKiBlICsgLjExOTE5MyAqIG4gKyAuOTUwMjI3ICogcgogICAgICAgICAgfTsKICAgICAgICAgIGZ1bmN0aW9uIGEodCkgewogICAgICAgICAgICByZXR1cm4gKHQgLz0gMjU1KSA+IC4wNDA0NSA/IE1hdGgucG93KCh0ICsgLjA1NSkgLyAxLjA1NSwgMi40KSA6IHQgLyAxMi45MjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJSR0J0b0NJRUxhYiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLlhZWnRvQ0lFTGFiKHRoaXMuUkdCdG9YWVoodCkpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlJHQnRvTE1TIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlIsCiAgICAgICAgICAgIG4gPSB0LkcsCiAgICAgICAgICAgIHIgPSB0LkI7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBMOiAuMzgxMSAqIGUgKyAuNTc4MyAqIG4gKyAuMDQwMiAqIHIsCiAgICAgICAgICAgIE06IC4xOTY3ICogZSArIC43MjQ0ICogbiArIC4wNzgyICogciwKICAgICAgICAgICAgUzogLjAyNDEgKiBlICsgLjEyODggKiBuICsgLjg0NDQgKiByCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlJHQnRvTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuTE1TdG9MYWIodGhpcy5SR0J0b0xNUyh0KSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiUkdCdG9ZIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgWTogKC4yOTkgKiB0LlIgKyAuNTg3ICogdC5HICsgLjExNCAqIHQuQikgLyAyNTUKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiWFladG9SR0IiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuWCwKICAgICAgICAgICAgbiA9IHQuWSwKICAgICAgICAgICAgciA9IHQuWiwKICAgICAgICAgICAgYSA9IHUoMy4yNDA2ICogZSArIC0xLjUzNzIgKiBuICsgLS40OTg2ICogciksCiAgICAgICAgICAgIG8gPSB1KC0uOTY4OSAqIGUgKyAxLjg3NTggKiBuICsgLjA0MTUgKiByKSwKICAgICAgICAgICAgaSA9IHUoLjA1NTcgKiBlICsgLS4yMDQgKiBuICsgMS4wNTcgKiByKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFI6IHMoMjU1ICogYSksCiAgICAgICAgICAgIEc6IHMoMjU1ICogbyksCiAgICAgICAgICAgIEI6IHMoMjU1ICogaSkKICAgICAgICAgIH07CiAgICAgICAgICBmdW5jdGlvbiB1KHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgPiAuMDAzMTMwOCA/IDEuMDU1ICogTWF0aC5wb3codCwgMSAvIDIuNCkgLSAuMDU1IDogMTIuOTIgKiB0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlhZWnRvQ0lFTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlgsCiAgICAgICAgICAgIG4gPSB0LlksCiAgICAgICAgICAgIGEgPSB0LlosCiAgICAgICAgICAgIG8gPSAhKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdKSB8fCBhcmd1bWVudHNbMV0sCiAgICAgICAgICAgIGkgPSBuID4gciA/IDExNiAqIE1hdGgucG93KG4sIDEgLyAzKSAtIDE2IDogOTAzLjMgKiBuLAogICAgICAgICAgICB1ID0gNTAwICogKHMoZSkgLSBzKG4pKSwKICAgICAgICAgICAgbCA9IDIwMCAqIChzKG4pIC0gcyhhKSk7CiAgICAgICAgICByZXR1cm4gbyA/IHRoaXMubm9ybWFsaXplQ0lFTGFiKHsKICAgICAgICAgICAgTDogaSwKICAgICAgICAgICAgYTogdSwKICAgICAgICAgICAgYjogbAogICAgICAgICAgfSkgOiB7CiAgICAgICAgICAgIEw6IGksCiAgICAgICAgICAgIGE6IHUsCiAgICAgICAgICAgIGI6IGwKICAgICAgICAgIH07CiAgICAgICAgICBmdW5jdGlvbiBzKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgPiByID8gTWF0aC5wb3codCwgMSAvIDMpIDogNy43ODcgKiB0ICsgMTYgLyAxMTY7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiQ0lFTGFidG9YWVoiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdICYmICFhcmd1bWVudHNbMV0gPyB0IDogdGhpcy5ub3JtYWxpemVCYWNrQ0lFTGFiKHQpLAogICAgICAgICAgICBuID0gZS5MLAogICAgICAgICAgICBhID0gZS5hLAogICAgICAgICAgICBvID0gZS5iLAogICAgICAgICAgICBpID0gKG4gKyAxNikgLyAxMTYsCiAgICAgICAgICAgIHUgPSBzKGEgLyA1MDAgKyBpKSwKICAgICAgICAgICAgbCA9IHMoaSAtIG8gLyAyMDApOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgWDogdSwKICAgICAgICAgICAgWTogcyhpKSwKICAgICAgICAgICAgWjogbAogICAgICAgICAgfTsKICAgICAgICAgIGZ1bmN0aW9uIHModCkgewogICAgICAgICAgICB2YXIgZSA9IE1hdGgucG93KHQsIDMpOwogICAgICAgICAgICByZXR1cm4gZSA+IHIgPyBlIDogKHQgLSAxNiAvIDExNikgLyA3Ljc4NzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJDSUVMYWJ0b1JHQiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLlhZWnRvUkdCKHRoaXMuQ0lFTGFidG9YWVoodCkpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIm5vcm1hbGl6ZUNJRUxhYiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIEw6IHQuTCAvIDEwMCwKICAgICAgICAgICAgYTogKHQuYSArIDEyOCkgLyAyNTUsCiAgICAgICAgICAgIGI6ICh0LmIgKyAxMjgpIC8gMjU1CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIm5vcm1hbGl6ZUJhY2tDSUVMYWIiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuYSwKICAgICAgICAgICAgciA9IHQuYjsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIEw6IE1hdGgubWluKDEwMCwgTWF0aC5tYXgoMCwgMTAwICogZSkpLAogICAgICAgICAgICBhOiBNYXRoLm1pbigxMjcsIE1hdGgubWF4KC0xMjcsIDI1NSAqIG4gLSAxMjgpKSwKICAgICAgICAgICAgYjogTWF0aC5taW4oMTI3LCBNYXRoLm1heCgtMTI3LCAyNTUgKiByIC0gMTI4KSkKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiTE1TdG9SR0IiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuTSwKICAgICAgICAgICAgciA9IHQuUzsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFI6IHMoNC40Njg2ICogZSAtIDMuNTg4NiAqIG4gKyAuMTE5NiAqIHIpLAogICAgICAgICAgICBHOiBzKC0xLjIxOTcgKiBlICsgMi4zODMgKiBuIC0gLjE2MjYgKiByKSwKICAgICAgICAgICAgQjogcyguMDU4NSAqIGUgLSAuMjYxICogbiArIDEuMjA1NiAqIHIpCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIkxNU3RvTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LkwsCiAgICAgICAgICAgIG4gPSB0Lk0sCiAgICAgICAgICAgIHIgPSB0LlM7CiAgICAgICAgICByZXR1cm4gZSAmJiAoZSA9IE1hdGgubG9nKGUpIC8gdSksIG4gJiYgKG4gPSBNYXRoLmxvZyhuKSAvIHUpLCByICYmIChyID0gTWF0aC5sb2cocikgLyB1KSwgewogICAgICAgICAgICBMOiAoZSArIG4gKyByKSAqIG8sCiAgICAgICAgICAgIGE6IChlICsgbiAtIDIgKiByKSAqIGksCiAgICAgICAgICAgIGI6IChlIC0gbikgKiBhCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIkxhYnRvUkdCIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuTE1TdG9SR0IodGhpcy5MYWJ0b0xNUyh0KSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiTGFidG9MTVMiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuYSwKICAgICAgICAgICAgciA9IHQuYjsKICAgICAgICAgIHJldHVybiBlICo9IG8sIG4gKj0gaSwgciAqPSBhLCB7CiAgICAgICAgICAgIEw6IE1hdGgucG93KDEwLCBlICsgbiArIHIpLAogICAgICAgICAgICBNOiBNYXRoLnBvdygxMCwgZSArIG4gLSByKSwKICAgICAgICAgICAgUzogTWF0aC5wb3coMTAsIGUgLSAyICogbikKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9XSwgKGwgPSBudWxsKSAmJiBlKG4ucHJvdG90eXBlLCBsKSwgYyAmJiBlKG4sIGMpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkobiwgInByb3RvdHlwZSIsIHsKICAgICAgICB3cml0YWJsZTogITEKICAgICAgfSksIHQ7CiAgICB9KCk7CiAgZnVuY3Rpb24gcyh0KSB7CiAgICByZXR1cm4gTWF0aC5taW4oMjU1LCBNYXRoLm1heCgwLCB0KSk7CiAgfQogIGZ1bmN0aW9uIGModCkgewogICAgcmV0dXJuIGMgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gX3R5cGVvZihTeW1ib2wuaXRlcmF0b3IpID8gZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuIF90eXBlb2YodCk7CiAgICB9IDogZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuIHQgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIHQuY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiB0ICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mKHQpOwogICAgfSwgYyh0KTsKICB9CiAgZnVuY3Rpb24gZih0LCBlKSB7CiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsKICAgICAgdmFyIHIgPSBlW25dOwogICAgICByLmVudW1lcmFibGUgPSByLmVudW1lcmFibGUgfHwgITEsIHIuY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gciAmJiAoci53cml0YWJsZSA9ICEwKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGgoci5rZXkpLCByKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gaCh0KSB7CiAgICB2YXIgZSA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgIGlmICgib2JqZWN0IiAhPSBjKHQpIHx8ICF0KSByZXR1cm4gdDsKICAgICAgdmFyIG4gPSB0W1N5bWJvbC50b1ByaW1pdGl2ZV07CiAgICAgIGlmICh2b2lkIDAgIT09IG4pIHsKICAgICAgICB2YXIgciA9IG4uY2FsbCh0LCBlIHx8ICJkZWZhdWx0Iik7CiAgICAgICAgaWYgKCJvYmplY3QiICE9IGMocikpIHJldHVybiByOwogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuIik7CiAgICAgIH0KICAgICAgcmV0dXJuICgic3RyaW5nIiA9PT0gZSA/IFN0cmluZyA6IE51bWJlcikodCk7CiAgICB9KHQsICJzdHJpbmciKTsKICAgIHJldHVybiAic3ltYm9sIiA9PSBjKGUpID8gZSA6IFN0cmluZyhlKTsKICB9CiAgdmFyIHYgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiB0KGUpIHsKICAgICAgIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfSh0aGlzLCB0KSwgdGhpcy5hQXZlcmFnZSA9IHt9LCB0aGlzLnN0ZERldiA9IHt9LCB0aGlzLnN1bSA9IHt9LCB0aGlzLnN1bVNxciA9IHt9LCB0aGlzLnBpeGVsc0NvdW50ID0gZTsKICAgIH0KICAgIHZhciBlLCBuLCByOwogICAgcmV0dXJuIGUgPSB0LCAobiA9IFt7CiAgICAgIGtleTogImFkZFBpeGVsIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgT2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgICAgdmFyIHIsIGE7CiAgICAgICAgICBlLnN1bVtuXSA9IChudWxsICE9PSAociA9IGUuc3VtW25dKSAmJiB2b2lkIDAgIT09IHIgPyByIDogMCkgKyB0W25dLCBlLnN1bVNxcltuXSA9IChudWxsICE9PSAoYSA9IGUuc3VtU3FyW25dKSAmJiB2b2lkIDAgIT09IGEgPyBhIDogMCkgKyBNYXRoLnBvdyh0W25dLCAyKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjb3VudEF2ZXJhZ2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnN1bSkuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIG47CiAgICAgICAgICB0LmFBdmVyYWdlW2VdID0gKG51bGwgIT09IChuID0gdC5zdW1bZV0pICYmIHZvaWQgMCAhPT0gbiA/IG4gOiAwKSAvIHQucGl4ZWxzQ291bnQ7CiAgICAgICAgfSksIHRoaXMuYUF2ZXJhZ2U7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY291bnRTdGREZXYiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnN1bVNxcikuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIG4sCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIGEgPSAobnVsbCAhPT0gKG4gPSB0LnN1bVNxcltlXSkgJiYgdm9pZCAwICE9PSBuID8gbiA6IDApIC0gdC5waXhlbHNDb3VudCAqIE1hdGgucG93KG51bGwgIT09IChyID0gdC5hQXZlcmFnZVtlXSkgJiYgdm9pZCAwICE9PSByID8gciA6IDAsIDIpOwogICAgICAgICAgdC5zdGREZXZbZV0gPSBNYXRoLnNxcnQoK2EudG9GaXhlZCg1KSAvICh0LnBpeGVsc0NvdW50IC0gMSkpOwogICAgICAgIH0pLCB0aGlzLnN0ZERldjsKICAgICAgfQogICAgfV0pICYmIGYoZS5wcm90b3R5cGUsIG4pLCByICYmIGYoZSwgciksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAicHJvdG90eXBlIiwgewogICAgICB3cml0YWJsZTogITEKICAgIH0pLCB0OwogIH0oKTsKICBmdW5jdGlvbiBiKHQpIHsKICAgIHJldHVybiBiID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIGIodCk7CiAgfQogIGZ1bmN0aW9uIHkodCwgZSkgewogICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgIHZhciByID0gZVtuXTsKICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBtKHIua2V5KSwgcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG0odCkgewogICAgdmFyIGUgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICBpZiAoIm9iamVjdCIgIT0gYih0KSB8fCAhdCkgcmV0dXJuIHQ7CiAgICAgIHZhciBuID0gdFtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSBuKSB7CiAgICAgICAgdmFyIHIgPSBuLmNhbGwodCwgZSB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSBiKHIpKSByZXR1cm4gcjsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IGUgPyBTdHJpbmcgOiBOdW1iZXIpKHQpOwogICAgfSh0LCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gYihlKSA/IGUgOiBTdHJpbmcoZSk7CiAgfQogIHZhciBwID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gdChlKSB7CiAgICAgICFmdW5jdGlvbiAodCwgZSkgewogICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBlKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgICAgIH0odGhpcywgdCksIHRoaXMuZGF0YVJHQmEgPSBlLCB0aGlzLnBpeGVsc0NvdW50ID0gZS5sZW5ndGggLyA0LCB0aGlzLmNoYW5uZWxzQ0lFTGFiID0gbmV3IHYodGhpcy5waXhlbHNDb3VudCksIHRoaXMuY2hhbm5lbHNMYWIgPSBuZXcgdih0aGlzLnBpeGVsc0NvdW50KSwgdGhpcy5jaGFubmVsc1kgPSBuZXcgdih0aGlzLnBpeGVsc0NvdW50KTsKICAgIH0KICAgIHZhciBlLCBuLCByOwogICAgcmV0dXJuIGUgPSB0LCAobiA9IFt7CiAgICAgIGtleTogImNvdW50QXZlcmFnZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICB0aGlzLmNoYW5uZWxzQ0lFTGFiLmNvdW50QXZlcmFnZSgpLCB0aGlzLmNoYW5uZWxzTGFiLmNvdW50QXZlcmFnZSgpLCB0aGlzLmNoYW5uZWxzWS5jb3VudEF2ZXJhZ2UoKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjb3VudFN0ZERldiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICB0aGlzLmNoYW5uZWxzQ0lFTGFiLmNvdW50U3RkRGV2KCksIHRoaXMuY2hhbm5lbHNMYWIuY291bnRTdGREZXYoKSwgdGhpcy5jaGFubmVsc1kuY291bnRTdGREZXYoKTsKICAgICAgfQogICAgfV0pICYmIHkoZS5wcm90b3R5cGUsIG4pLCByICYmIHkoZSwgciksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAicHJvdG90eXBlIiwgewogICAgICB3cml0YWJsZTogITEKICAgIH0pLCB0OwogIH0oKTsKICBmdW5jdGlvbiBMKHQpIHsKICAgIHJldHVybiBMID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIEwodCk7CiAgfQogIGZ1bmN0aW9uIGQodCwgZSkgewogICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgIHZhciByID0gZVtuXTsKICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBnKHIua2V5KSwgcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGcodCkgewogICAgdmFyIGUgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICBpZiAoIm9iamVjdCIgIT0gTCh0KSB8fCAhdCkgcmV0dXJuIHQ7CiAgICAgIHZhciBuID0gdFtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSBuKSB7CiAgICAgICAgdmFyIHIgPSBuLmNhbGwodCwgZSB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSBMKHIpKSByZXR1cm4gcjsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IGUgPyBTdHJpbmcgOiBOdW1iZXIpKHQpOwogICAgfSh0LCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gTChlKSA/IGUgOiBTdHJpbmcoZSk7CiAgfQogIHZhciBFID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gdCgpIHsKICAgICAgIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfSh0aGlzLCB0KSwgdGhpcy5kZWZhdWx0TFVUMzZfUkdCID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9SR0IoKSwgdGhpcy5kZWZhdWx0TFVUMzZfQ0lFTGFiID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9DSUVMYWIodGhpcy5kZWZhdWx0TFVUMzZfUkdCKSwgdGhpcy5kZWZhdWx0TFVUMzZfTGFiID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9MYWIodGhpcy5kZWZhdWx0TFVUMzZfUkdCKSwgdGhpcy5kZWZhdWx0TFVUMzZfWSA9IHRoaXMuZ2VuZXJhdGVEZWZhdWx0TFVUMzZfWSh0aGlzLmRlZmF1bHRMVVQzNl9SR0IpOwogICAgfQogICAgdmFyIGUsIG4sIHI7CiAgICByZXR1cm4gZSA9IHQsIG4gPSBbewogICAgICBrZXk6ICJwcm9jZXNzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIGUpIHsKICAgICAgICBmb3IgKHZhciBuID0gdGhpcywgciA9IG5ldyBwKHQpLCBhID0gbmV3IHAoZSksIG8gPSAwOyBvIDwgci5kYXRhUkdCYS5sZW5ndGg7IG8gKz0gNCkgewogICAgICAgICAgdmFyIGkgPSB7CiAgICAgICAgICAgICAgUjogci5kYXRhUkdCYVtvICsgMF0sCiAgICAgICAgICAgICAgRzogci5kYXRhUkdCYVtvICsgMV0sCiAgICAgICAgICAgICAgQjogci5kYXRhUkdCYVtvICsgMl0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgdSA9IHsKICAgICAgICAgICAgICBSOiBhLmRhdGFSR0JhW28gKyAwXSwKICAgICAgICAgICAgICBHOiBhLmRhdGFSR0JhW28gKyAxXSwKICAgICAgICAgICAgICBCOiBhLmRhdGFSR0JhW28gKyAyXQogICAgICAgICAgICB9LAogICAgICAgICAgICBzID0gbC5SR0J0b0NJRUxhYihpKSwKICAgICAgICAgICAgYyA9IGwuUkdCdG9DSUVMYWIodSk7CiAgICAgICAgICByLmNoYW5uZWxzQ0lFTGFiLmFkZFBpeGVsKHMpLCBhLmNoYW5uZWxzQ0lFTGFiLmFkZFBpeGVsKGMpOwogICAgICAgICAgdmFyIGYgPSBsLlJHQnRvTGFiKGkpLAogICAgICAgICAgICBoID0gbC5SR0J0b0xhYih1KTsKICAgICAgICAgIHIuY2hhbm5lbHNMYWIuYWRkUGl4ZWwoZiksIGEuY2hhbm5lbHNMYWIuYWRkUGl4ZWwoaCk7CiAgICAgICAgICB2YXIgdiA9IGwuUkdCdG9ZKGkpLAogICAgICAgICAgICBiID0gbC5SR0J0b1kodSk7CiAgICAgICAgICByLmNoYW5uZWxzWS5hZGRQaXhlbCh2KSwgYS5jaGFubmVsc1kuYWRkUGl4ZWwoYik7CiAgICAgICAgfQogICAgICAgIHIuY291bnRBdmVyYWdlKCksIGEuY291bnRBdmVyYWdlKCksIHIuY291bnRTdGREZXYoKSwgYS5jb3VudFN0ZERldigpOwogICAgICAgIGZvciAodmFyIHkgPSBbXSwgbSA9IGZ1bmN0aW9uIG0oKSB7CiAgICAgICAgICAgIHZhciB0ID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9DSUVMYWJbMyAqIEwgKyAwXSwgIkwiLCByLmNoYW5uZWxzQ0lFTGFiLCBhLmNoYW5uZWxzQ0lFTGFiLCAhMCksCiAgICAgICAgICAgICAgZSA9IG4ubWVyZ2Uobi5kZWZhdWx0TFVUMzZfQ0lFTGFiWzMgKiBMICsgMV0sICJhIiwgci5jaGFubmVsc0NJRUxhYiwgYS5jaGFubmVsc0NJRUxhYiwgITApLAogICAgICAgICAgICAgIG8gPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X0NJRUxhYlszICogTCArIDJdLCAiYiIsIHIuY2hhbm5lbHNDSUVMYWIsIGEuY2hhbm5lbHNDSUVMYWIsICEwKSwKICAgICAgICAgICAgICBpID0gbC5DSUVMYWJ0b1JHQih7CiAgICAgICAgICAgICAgICBMOiB0LAogICAgICAgICAgICAgICAgYTogZSwKICAgICAgICAgICAgICAgIGI6IG8KICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICB1ID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9MYWJbMyAqIEwgKyAwXSwgIkwiLCByLmNoYW5uZWxzTGFiLCBhLmNoYW5uZWxzTGFiKSwKICAgICAgICAgICAgICBzID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9MYWJbMyAqIEwgKyAxXSwgImEiLCByLmNoYW5uZWxzTGFiLCBhLmNoYW5uZWxzTGFiKSwKICAgICAgICAgICAgICBjID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9MYWJbMyAqIEwgKyAyXSwgImIiLCByLmNoYW5uZWxzTGFiLCBhLmNoYW5uZWxzTGFiKSwKICAgICAgICAgICAgICBmID0gbC5MYWJ0b1JHQih7CiAgICAgICAgICAgICAgICBMOiB1LAogICAgICAgICAgICAgICAgYTogcywKICAgICAgICAgICAgICAgIGI6IGMKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBoID0gbi5taXgoaSwgZiwgLjYpLAogICAgICAgICAgICAgIHYgPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X1lbTF0sICJZIiwgci5jaGFubmVsc1ksIGEuY2hhbm5lbHNZLCAhMCksCiAgICAgICAgICAgICAgYiA9IGwuUkdCdG9ZKGgpLlksCiAgICAgICAgICAgICAgbSA9IGZ1bmN0aW9uIG0odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKDI1NSwgdCAqIHYgLyBNYXRoLm1heChiLCAxIC8gMjU1KSk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBwID0gewogICAgICAgICAgICAgICAgUjogbShoLlIpLAogICAgICAgICAgICAgICAgRzogbShoLkcpLAogICAgICAgICAgICAgICAgQjogbShoLkIpCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkID0gewogICAgICAgICAgICAgICAgUjogMjU1ICogbi5kZWZhdWx0TFVUMzZfWVtMXSwKICAgICAgICAgICAgICAgIEc6IDI1NSAqIG4uZGVmYXVsdExVVDM2X1lbTF0sCiAgICAgICAgICAgICAgICBCOiAyNTUgKiBuLmRlZmF1bHRMVVQzNl9ZW0xdCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBnID0gbi5taXgocCwgZCwgLjkpOwogICAgICAgICAgICB5LnB1c2goZy5SLCBnLkcsIGcuQiwgMjU1KTsKICAgICAgICAgIH0sIEwgPSAwOyBMIDwgdGhpcy5kZWZhdWx0TFVUMzZfUkdCLmxlbmd0aCAvIDM7IEwrKykgbSgpOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBORVdfTFVUMzZfUkdCYV9USU5URUQ6IHkKICAgICAgICB9OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdlbmVyYXRlRGVmYXVsdExVVDM2X1JHQiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICBmb3IgKHZhciB0ID0gMzYsIGUgPSBNYXRoLnBvdygyMTYsIDIpLCBuID0gMjU1IC8gdCwgciA9IG5ldyBVaW50OENsYW1wZWRBcnJheSgzICogZSksIGEgPSAwOyBhIDwgZTsgYSsrKSB7CiAgICAgICAgICB2YXIgbyA9IGkoYSwgNiwgdCk7CiAgICAgICAgICByWzMgKiBhICsgMF0gPSBhICUgdCAqIG4sIHJbMyAqIGEgKyAxXSA9IE1hdGgudHJ1bmMoYSAvIDIxNiAlIHQpICogbiwgclszICogYSArIDJdID0gbyAqICgyNTUgLyAzNik7CiAgICAgICAgfQogICAgICAgIHJldHVybiByOwogICAgICAgIGZ1bmN0aW9uIGkodCwgZSwgbikgewogICAgICAgICAgdmFyIHIgPSBNYXRoLnRydW5jKHQgLyBuKSAlIGU7CiAgICAgICAgICByZXR1cm4gZSAqIE1hdGgudHJ1bmModCAvIChuICogbiAqIGUpKSArIHI7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdlbmVyYXRlRGVmYXVsdExVVDM2X0NJRUxhYiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgZm9yICh2YXIgZSA9IG5ldyBBcnJheSh0Lmxlbmd0aCksIG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgewogICAgICAgICAgdmFyIHIgPSB7CiAgICAgICAgICAgICAgUjogdFszICogbiArIDBdLAogICAgICAgICAgICAgIEc6IHRbMyAqIG4gKyAxXSwKICAgICAgICAgICAgICBCOiB0WzMgKiBuICsgMl0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgYSA9IGwuUkdCdG9DSUVMYWIociksCiAgICAgICAgICAgIG8gPSBhLkwsCiAgICAgICAgICAgIGkgPSBhLmEsCiAgICAgICAgICAgIHUgPSBhLmI7CiAgICAgICAgICBlWzMgKiBuICsgMF0gPSBvLCBlWzMgKiBuICsgMV0gPSBpLCBlWzMgKiBuICsgMl0gPSB1OwogICAgICAgIH0KICAgICAgICByZXR1cm4gZTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZW5lcmF0ZURlZmF1bHRMVVQzNl9MYWIiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgIGZvciAodmFyIGUgPSBuZXcgQXJyYXkodC5sZW5ndGgpLCBuID0gMDsgbiA8IHQubGVuZ3RoIC8gMzsgbisrKSB7CiAgICAgICAgICB2YXIgciA9IHsKICAgICAgICAgICAgICBSOiB0WzMgKiBuICsgMF0sCiAgICAgICAgICAgICAgRzogdFszICogbiArIDFdLAogICAgICAgICAgICAgIEI6IHRbMyAqIG4gKyAyXQogICAgICAgICAgICB9LAogICAgICAgICAgICBhID0gbC5SR0J0b0xhYihyKSwKICAgICAgICAgICAgbyA9IGEuTCwKICAgICAgICAgICAgaSA9IGEuYSwKICAgICAgICAgICAgdSA9IGEuYjsKICAgICAgICAgIGVbMyAqIG4gKyAwXSA9IG8sIGVbMyAqIG4gKyAxXSA9IGksIGVbMyAqIG4gKyAyXSA9IHU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdlbmVyYXRlRGVmYXVsdExVVDM2X1kiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgIGZvciAodmFyIGUgPSBbXSwgbiA9IDA7IG4gPCB0Lmxlbmd0aCAvIDM7IG4rKykgewogICAgICAgICAgdmFyIHIgPSB7CiAgICAgICAgICAgICAgUjogdFszICogbiArIDBdLAogICAgICAgICAgICAgIEc6IHRbMyAqIG4gKyAxXSwKICAgICAgICAgICAgICBCOiB0WzMgKiBuICsgMl0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgYSA9IGwuUkdCdG9ZKHIpLlk7CiAgICAgICAgICBlLnB1c2goYSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm1lcmdlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIGUsIG4sIHIpIHsKICAgICAgICB2YXIgYSwKICAgICAgICAgIG8sCiAgICAgICAgICBpLAogICAgICAgICAgdSwKICAgICAgICAgIGwgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1s0XSAmJiBhcmd1bWVudHNbNF0sCiAgICAgICAgICBzID0gbnVsbCAhPT0gKGEgPSBuLmFBdmVyYWdlW2VdKSAmJiB2b2lkIDAgIT09IGEgPyBhIDogMCwKICAgICAgICAgIGMgPSBudWxsICE9PSAobyA9IHIuYUF2ZXJhZ2VbZV0pICYmIHZvaWQgMCAhPT0gbyA/IG8gOiAwLAogICAgICAgICAgZiA9IG51bGwgIT09IChpID0gbi5zdGREZXZbZV0pICYmIHZvaWQgMCAhPT0gaSA/IGkgOiAwLAogICAgICAgICAgaCA9IG51bGwgIT09ICh1ID0gci5zdGREZXZbZV0pICYmIHZvaWQgMCAhPT0gdSA/IHUgOiAwOwogICAgICAgIGlmICghbi5zdGREZXZbZV0gfHwgIXIuc3RkRGV2W2VdKSB7CiAgICAgICAgICB2YXIgdiA9IHQgKyBjIC0gczsKICAgICAgICAgIHJldHVybiBNYXRoLm1pbigxLCBNYXRoLm1heCgwLCB2KSk7CiAgICAgICAgfQogICAgICAgIHZhciBiID0gKHQgLSBzKSAvIGYgKiBoICsgYzsKICAgICAgICByZXR1cm4gbCA/IE1hdGgubWluKDEsIE1hdGgubWF4KDAsIGIpKSA6IGI7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAibWl4IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIGUsIG4pIHsKICAgICAgICByZXR1cm4gbiA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIG4pKSwgewogICAgICAgICAgUjogcih0LlIsIGUuUiksCiAgICAgICAgICBHOiByKHQuRywgZS5HKSwKICAgICAgICAgIEI6IHIodC5CLCBlLkIpCiAgICAgICAgfTsKICAgICAgICBmdW5jdGlvbiByKHQsIGUpIHsKICAgICAgICAgIHJldHVybiB0ICogbiArIGUgKiAoMSAtIG4pOwogICAgICAgIH0KICAgICAgfQogICAgfV0sIG4gJiYgZChlLnByb3RvdHlwZSwgbiksIHIgJiYgZChlLCByKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsICJwcm90b3R5cGUiLCB7CiAgICAgIHdyaXRhYmxlOiAhMQogICAgfSksIHQ7CiAgfSgpOwogIHZhciBTID0gU3ltYm9sKCJDb21saW5rLnByb3h5IiksCiAgICBSID0gU3ltYm9sKCJDb21saW5rLmVuZHBvaW50IiksCiAgICB3ID0gU3ltYm9sKCJDb21saW5rLnJlbGVhc2VQcm94eSIpLAogICAgRyA9IFN5bWJvbCgiQ29tbGluay5maW5hbGl6ZXIiKSwKICAgIE0gPSBTeW1ib2woIkNvbWxpbmsudGhyb3duIiksCiAgICBCID0gZnVuY3Rpb24gQih0KSB7CiAgICAgIHJldHVybiAib2JqZWN0IiA9PSBfdHlwZW9mKHQpICYmIG51bGwgIT09IHQgfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdDsKICAgIH0sCiAgICBUID0gbmV3IE1hcChbWyJwcm94eSIsIHsKICAgICAgY2FuSGFuZGxlOiBmdW5jdGlvbiBjYW5IYW5kbGUodCkgewogICAgICAgIHJldHVybiBCKHQpICYmIHRbU107CiAgICAgIH0sCiAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24gc2VyaWFsaXplKHQpIHsKICAgICAgICB2YXIgX01lc3NhZ2VDaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCksCiAgICAgICAgICBlID0gX01lc3NhZ2VDaGFubmVsLnBvcnQxLAogICAgICAgICAgbiA9IF9NZXNzYWdlQ2hhbm5lbC5wb3J0MjsKICAgICAgICByZXR1cm4gQyh0LCBlKSwgW24sIFtuXV07CiAgICAgIH0sCiAgICAgIGRlc2VyaWFsaXplOiBmdW5jdGlvbiBkZXNlcmlhbGl6ZSh0KSB7CiAgICAgICAgcmV0dXJuIHQuc3RhcnQoKSwgXyh0LCBbXSwgZSk7CiAgICAgICAgdmFyIGU7CiAgICAgIH0KICAgIH1dLCBbInRocm93IiwgewogICAgICBjYW5IYW5kbGU6IGZ1bmN0aW9uIGNhbkhhbmRsZSh0KSB7CiAgICAgICAgcmV0dXJuIEIodCkgJiYgTSBpbiB0OwogICAgICB9LAogICAgICBzZXJpYWxpemU6IGZ1bmN0aW9uIHNlcmlhbGl6ZShfcmVmKSB7CiAgICAgICAgdmFyIHQgPSBfcmVmLnZhbHVlOwogICAgICAgIHZhciBlOwogICAgICAgIHJldHVybiBlID0gdCBpbnN0YW5jZW9mIEVycm9yID8gewogICAgICAgICAgaXNFcnJvcjogITAsCiAgICAgICAgICB2YWx1ZTogewogICAgICAgICAgICBtZXNzYWdlOiB0Lm1lc3NhZ2UsCiAgICAgICAgICAgIG5hbWU6IHQubmFtZSwKICAgICAgICAgICAgc3RhY2s6IHQuc3RhY2sKICAgICAgICAgIH0KICAgICAgICB9IDogewogICAgICAgICAgaXNFcnJvcjogITEsCiAgICAgICAgICB2YWx1ZTogdAogICAgICAgIH0sIFtlLCBbXV07CiAgICAgIH0sCiAgICAgIGRlc2VyaWFsaXplOiBmdW5jdGlvbiBkZXNlcmlhbGl6ZSh0KSB7CiAgICAgICAgaWYgKHQuaXNFcnJvcikgdGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3IodC52YWx1ZS5tZXNzYWdlKSwgdC52YWx1ZSk7CiAgICAgICAgdGhyb3cgdC52YWx1ZTsKICAgICAgfQogICAgfV1dKTsKICBmdW5jdGlvbiBDKHQpIHsKICAgIHZhciBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBnbG9iYWxUaGlzOwogICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IFsiKiJdOwogICAgZS5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgZnVuY3Rpb24gcihhKSB7CiAgICAgIGlmICghYSB8fCAhYS5kYXRhKSByZXR1cm47CiAgICAgIGlmICghZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodCksCiAgICAgICAgICBfc3RlcDsKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIF9uID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgIGlmIChlID09PSBfbiB8fCAiKiIgPT09IF9uKSByZXR1cm4gITA7CiAgICAgICAgICAgIGlmIChfbiBpbnN0YW5jZW9mIFJlZ0V4cCAmJiBfbi50ZXN0KGUpKSByZXR1cm4gITA7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gITE7CiAgICAgIH0obiwgYS5vcmlnaW4pKSByZXR1cm4gdm9pZCBjb25zb2xlLndhcm4oIkludmFsaWQgb3JpZ2luICciLmNvbmNhdChhLm9yaWdpbiwgIicgZm9yIGNvbWxpbmsgcHJveHkiKSk7CiAgICAgIHZhciBfT2JqZWN0JGFzc2lnbiA9IE9iamVjdC5hc3NpZ24oewogICAgICAgICAgcGF0aDogW10KICAgICAgICB9LCBhLmRhdGEpLAogICAgICAgIG8gPSBfT2JqZWN0JGFzc2lnbi5pZCwKICAgICAgICBpID0gX09iamVjdCRhc3NpZ24udHlwZSwKICAgICAgICB1ID0gX09iamVjdCRhc3NpZ24ucGF0aCwKICAgICAgICBsID0gKGEuZGF0YS5hcmd1bWVudExpc3QgfHwgW10pLm1hcChEKTsKICAgICAgdmFyIHM7CiAgICAgIHRyeSB7CiAgICAgICAgdmFyIF9lID0gdS5zbGljZSgwLCAtMSkucmVkdWNlKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgIHJldHVybiB0W2VdOwogICAgICAgICAgfSwgdCksCiAgICAgICAgICBfbjIgPSB1LnJlZHVjZShmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICByZXR1cm4gdFtlXTsKICAgICAgICAgIH0sIHQpOwogICAgICAgIHN3aXRjaCAoaSkgewogICAgICAgICAgY2FzZSAiR0VUIjoKICAgICAgICAgICAgcyA9IF9uMjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJTRVQiOgogICAgICAgICAgICBfZVt1LnNsaWNlKC0xKVswXV0gPSBEKGEuZGF0YS52YWx1ZSksIHMgPSAhMDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJBUFBMWSI6CiAgICAgICAgICAgIHMgPSBfbjIuYXBwbHkoX2UsIGwpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIkNPTlNUUlVDVCI6CiAgICAgICAgICAgIHMgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHQsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgUywgITApKTsKICAgICAgICAgICAgfShfY29uc3RydWN0KF9uMiwgX3RvQ29uc3VtYWJsZUFycmF5KGwpKSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiRU5EUE9JTlQiOgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdmFyIF9NZXNzYWdlQ2hhbm5lbDIgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKSwKICAgICAgICAgICAgICAgIF9lMiA9IF9NZXNzYWdlQ2hhbm5lbDIucG9ydDEsCiAgICAgICAgICAgICAgICBfbjMgPSBfTWVzc2FnZUNoYW5uZWwyLnBvcnQyOwogICAgICAgICAgICAgIEModCwgX24zKSwgcyA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gai5zZXQodCwgZSksIHQ7CiAgICAgICAgICAgICAgfShfZTIsIFtfZTJdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIlJFTEVBU0UiOgogICAgICAgICAgICBzID0gdm9pZCAwOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICBzID0gX2RlZmluZVByb3BlcnR5KHsKICAgICAgICAgIHZhbHVlOiB0CiAgICAgICAgfSwgTSwgMCk7CiAgICAgIH0KICAgICAgUHJvbWlzZS5yZXNvbHZlKHMpWyJjYXRjaCJdKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgcmV0dXJuIF9kZWZpbmVQcm9wZXJ0eSh7CiAgICAgICAgICB2YWx1ZTogdAogICAgICAgIH0sIE0sIDApOwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgdmFyIF9BID0gQShuKSwKICAgICAgICAgIF9BMiA9IF9zbGljZWRUb0FycmF5KF9BLCAyKSwKICAgICAgICAgIGEgPSBfQTJbMF0sCiAgICAgICAgICB1ID0gX0EyWzFdOwogICAgICAgIGUucG9zdE1lc3NhZ2UoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBhKSwgewogICAgICAgICAgaWQ6IG8KICAgICAgICB9KSwgdSksICJSRUxFQVNFIiA9PT0gaSAmJiAoZS5yZW1vdmVFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgciksIGsoZSksIEcgaW4gdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiB0W0ddICYmIHRbR10oKSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgdmFyIF9BMyA9IEEoX2RlZmluZVByb3BlcnR5KHsKICAgICAgICAgICAgdmFsdWU6IG5ldyBUeXBlRXJyb3IoIlVuc2VyaWFsaXphYmxlIHJldHVybiB2YWx1ZSIpCiAgICAgICAgICB9LCBNLCAwKSksCiAgICAgICAgICBfQTQgPSBfc2xpY2VkVG9BcnJheShfQTMsIDIpLAogICAgICAgICAgbiA9IF9BNFswXSwKICAgICAgICAgIHIgPSBfQTRbMV07CiAgICAgICAgZS5wb3N0TWVzc2FnZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG4pLCB7CiAgICAgICAgICBpZDogbwogICAgICAgIH0pLCByKTsKICAgICAgfSk7CiAgICB9KSwgZS5zdGFydCAmJiBlLnN0YXJ0KCk7CiAgfQogIGZ1bmN0aW9uIGsodCkgewogICAgKGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiAiTWVzc2FnZVBvcnQiID09PSB0LmNvbnN0cnVjdG9yLm5hbWU7CiAgICB9KSh0KSAmJiB0LmNsb3NlKCk7CiAgfQogIGZ1bmN0aW9uIEkodCkgewogICAgaWYgKHQpIHRocm93IG5ldyBFcnJvcigiUHJveHkgaGFzIGJlZW4gcmVsZWFzZWQgYW5kIGlzIG5vdCB1c2VhYmxlIik7CiAgfQogIGZ1bmN0aW9uIFkodCkgewogICAgcmV0dXJuIE8odCwgewogICAgICB0eXBlOiAiUkVMRUFTRSIKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBrKHQpOwogICAgfSk7CiAgfQogIHZhciB4ID0gbmV3IFdlYWtNYXAoKSwKICAgIFAgPSAiRmluYWxpemF0aW9uUmVnaXN0cnkiIGluIGdsb2JhbFRoaXMgJiYgbmV3IEZpbmFsaXphdGlvblJlZ2lzdHJ5KGZ1bmN0aW9uICh0KSB7CiAgICAgIHZhciBlID0gKHguZ2V0KHQpIHx8IDApIC0gMTsKICAgICAgeC5zZXQodCwgZSksIDAgPT09IGUgJiYgWSh0KTsKICAgIH0pOwogIGZ1bmN0aW9uIF8odCkgewogICAgdmFyIGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFtdOwogICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZ1bmN0aW9uICgpIHt9OwogICAgdmFyIHIgPSAhMTsKICAgIHZhciBhID0gbmV3IFByb3h5KG4sIHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQobiwgbykgewogICAgICAgIGlmIChJKHIpLCBvID09PSB3KSByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgIWZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIFAgJiYgUC51bnJlZ2lzdGVyKHQpOwogICAgICAgICAgfShhKSwgWSh0KSwgciA9ICEwOwogICAgICAgIH07CiAgICAgICAgaWYgKCJ0aGVuIiA9PT0gbykgewogICAgICAgICAgaWYgKDAgPT09IGUubGVuZ3RoKSByZXR1cm4gewogICAgICAgICAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKCkgewogICAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgdmFyIF9uNCA9IE8odCwgewogICAgICAgICAgICB0eXBlOiAiR0VUIiwKICAgICAgICAgICAgcGF0aDogZS5tYXAoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gdC50b1N0cmluZygpOwogICAgICAgICAgICB9KQogICAgICAgICAgfSkudGhlbihEKTsKICAgICAgICAgIHJldHVybiBfbjQudGhlbi5iaW5kKF9uNCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfKHQsIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZSksIFtvXSkpOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChuLCBhLCBvKSB7CiAgICAgICAgSShyKTsKICAgICAgICB2YXIgX0E2ID0gQShvKSwKICAgICAgICAgIF9BNyA9IF9zbGljZWRUb0FycmF5KF9BNiwgMiksCiAgICAgICAgICBpID0gX0E3WzBdLAogICAgICAgICAgdSA9IF9BN1sxXTsKICAgICAgICByZXR1cm4gTyh0LCB7CiAgICAgICAgICB0eXBlOiAiU0VUIiwKICAgICAgICAgIHBhdGg6IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZSksIFthXSkubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHJldHVybiB0LnRvU3RyaW5nKCk7CiAgICAgICAgICB9KSwKICAgICAgICAgIHZhbHVlOiBpCiAgICAgICAgfSwgdSkudGhlbihEKTsKICAgICAgfSwKICAgICAgYXBwbHk6IGZ1bmN0aW9uIGFwcGx5KG4sIGEsIG8pIHsKICAgICAgICBJKHIpOwogICAgICAgIHZhciBpID0gZVtlLmxlbmd0aCAtIDFdOwogICAgICAgIGlmIChpID09PSBSKSByZXR1cm4gTyh0LCB7CiAgICAgICAgICB0eXBlOiAiRU5EUE9JTlQiCiAgICAgICAgfSkudGhlbihEKTsKICAgICAgICBpZiAoImJpbmQiID09PSBpKSByZXR1cm4gXyh0LCBlLnNsaWNlKDAsIC0xKSk7CiAgICAgICAgdmFyIF9VID0gVShvKSwKICAgICAgICAgIF9VMiA9IF9zbGljZWRUb0FycmF5KF9VLCAyKSwKICAgICAgICAgIHUgPSBfVTJbMF0sCiAgICAgICAgICBsID0gX1UyWzFdOwogICAgICAgIHJldHVybiBPKHQsIHsKICAgICAgICAgIHR5cGU6ICJBUFBMWSIsCiAgICAgICAgICBwYXRoOiBlLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgICAgICByZXR1cm4gdC50b1N0cmluZygpOwogICAgICAgICAgfSksCiAgICAgICAgICBhcmd1bWVudExpc3Q6IHUKICAgICAgICB9LCBsKS50aGVuKEQpOwogICAgICB9LAogICAgICBjb25zdHJ1Y3Q6IGZ1bmN0aW9uIGNvbnN0cnVjdChuLCBhKSB7CiAgICAgICAgSShyKTsKICAgICAgICB2YXIgX1UzID0gVShhKSwKICAgICAgICAgIF9VNCA9IF9zbGljZWRUb0FycmF5KF9VMywgMiksCiAgICAgICAgICBvID0gX1U0WzBdLAogICAgICAgICAgaSA9IF9VNFsxXTsKICAgICAgICByZXR1cm4gTyh0LCB7CiAgICAgICAgICB0eXBlOiAiQ09OU1RSVUNUIiwKICAgICAgICAgIHBhdGg6IGUubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHJldHVybiB0LnRvU3RyaW5nKCk7CiAgICAgICAgICB9KSwKICAgICAgICAgIGFyZ3VtZW50TGlzdDogbwogICAgICAgIH0sIGkpLnRoZW4oRCk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgIHZhciBuID0gKHguZ2V0KGUpIHx8IDApICsgMTsKICAgICAgeC5zZXQoZSwgbiksIFAgJiYgUC5yZWdpc3Rlcih0LCBlLCB0KTsKICAgIH0oYSwgdCksIGE7CiAgfQogIGZ1bmN0aW9uIFUodCkgewogICAgdmFyIGUgPSB0Lm1hcChBKTsKICAgIHJldHVybiBbZS5tYXAoZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuIHRbMF07CiAgICB9KSwgKG4gPSBlLm1hcChmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gdFsxXTsKICAgIH0pLCBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBuKSldOwogICAgdmFyIG47CiAgfQogIHZhciBqID0gbmV3IFdlYWtNYXAoKTsKICBmdW5jdGlvbiBBKHQpIHsKICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoVCksCiAgICAgIF9zdGVwMjsKICAgIHRyeSB7CiAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgdmFyIF9zdGVwMiR2YWx1ZSA9IF9zbGljZWRUb0FycmF5KF9zdGVwMi52YWx1ZSwgMiksCiAgICAgICAgICBfZTMgPSBfc3RlcDIkdmFsdWVbMF0sCiAgICAgICAgICBfbjUgPSBfc3RlcDIkdmFsdWVbMV07CiAgICAgICAgaWYgKF9uNS5jYW5IYW5kbGUodCkpIHsKICAgICAgICAgIHZhciBfbjUkc2VyaWFsaXplID0gX241LnNlcmlhbGl6ZSh0KSwKICAgICAgICAgICAgX241JHNlcmlhbGl6ZTIgPSBfc2xpY2VkVG9BcnJheShfbjUkc2VyaWFsaXplLCAyKSwKICAgICAgICAgICAgX3IgPSBfbjUkc2VyaWFsaXplMlswXSwKICAgICAgICAgICAgX2EgPSBfbjUkc2VyaWFsaXplMlsxXTsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICB0eXBlOiAiSEFORExFUiIsCiAgICAgICAgICAgIG5hbWU6IF9lMywKICAgICAgICAgICAgdmFsdWU6IF9yCiAgICAgICAgICB9LCBfYV07CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICB9IGZpbmFsbHkgewogICAgICBfaXRlcmF0b3IyLmYoKTsKICAgIH0KICAgIHJldHVybiBbewogICAgICB0eXBlOiAiUkFXIiwKICAgICAgdmFsdWU6IHQKICAgIH0sIGouZ2V0KHQpIHx8IFtdXTsKICB9CiAgZnVuY3Rpb24gRCh0KSB7CiAgICBzd2l0Y2ggKHQudHlwZSkgewogICAgICBjYXNlICJIQU5ETEVSIjoKICAgICAgICByZXR1cm4gVC5nZXQodC5uYW1lKS5kZXNlcmlhbGl6ZSh0LnZhbHVlKTsKICAgICAgY2FzZSAiUkFXIjoKICAgICAgICByZXR1cm4gdC52YWx1ZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gTyh0LCBlLCBuKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHIpIHsKICAgICAgdmFyIGEgPSBuZXcgQXJyYXkoNCkuZmlsbCgwKS5tYXAoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikudG9TdHJpbmcoMTYpOwogICAgICB9KS5qb2luKCItIik7CiAgICAgIHQuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uIGUobikgewogICAgICAgIG4uZGF0YSAmJiBuLmRhdGEuaWQgJiYgbi5kYXRhLmlkID09PSBhICYmICh0LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBlKSwgcihuLmRhdGEpKTsKICAgICAgfSksIHQuc3RhcnQgJiYgdC5zdGFydCgpLCB0LnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24oewogICAgICAgIGlkOiBhCiAgICAgIH0sIGUpLCBuKTsKICAgIH0pOwogIH0KICB2YXIgTiA9IG5ldyBFKCk7CiAgQyh7CiAgICBnZXRMVVRUZXh0dXJlOiBmdW5jdGlvbiBnZXRMVVRUZXh0dXJlKHQsIGUpIHsKICAgICAgcmV0dXJuIE4ucHJvY2Vzcyh0LCBlKS5ORVdfTFVUMzZfUkdCYV9USU5URUQ7CiAgICB9CiAgfSk7Cn0pKCk7"},6204:()=>{},1472:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{CU:()=>Nd,_K:()=>ee,w3:()=>Re});var process=__webpack_require__(6512),Buffer=__webpack_require__(3296).Sn,Fd=Object.create,kn=Object.defineProperty,Cd=Object.getOwnPropertyDescriptor,$d=Object.getOwnPropertyNames,Bd=Object.getPrototypeOf,kd=Object.prototype.hasOwnProperty,Ka=(a=function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},typeof require<"u"?require:typeof Proxy<"u"?new Proxy(a,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):a),a,L=(e,t)=>()=>(e&&(t=e(e=0)),t),ye=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),kr=(e,t)=>{for(var r in t)kn(e,r,{get:t[r],enumerable:!0})},Ja=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of $d(t))!kd.call(e,i)&&i!==r&&kn(e,i,{get:()=>t[i],enumerable:!(n=Cd(t,i))||n.enumerable});return e},Nr=(e,t,r)=>(r=null!=e?Fd(Bd(e)):{},Ja(!t&&e&&e.__esModule?r:kn(r,"default",{value:e,enumerable:!0}),e)),fr=e=>Ja(kn({},"__esModule",{value:!0}),e),Nn,cr,pr,Rn,Mn=L((()=>{Nn=new Map,cr=[],pr=(e,t,r)=>{if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{let n=Nn.get(e);if(void 0===n)Nn.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let t=cr.indexOf(e);-1!==t&&cr.splice(t,1);for(let t=0;t<cr.length;t++)if(Nn.get(cr[t]).priority<=r)return void cr.splice(t,0,e);cr.push(e)}}},Rn=async e=>{let t=0===e.length?cr:e,r=[];for(let e of t){let t=Nn.get(e);if(t){if(t.initialized)return t.backend;if(t.aborted)continue;let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(i){n||r.push({name:e,err:i}),t.aborted=!0}finally{delete t.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map((e=>`[${e.name}] ${e.err}`)).join(", ")}`)}})),Za=L((()=>{Mn()})),Qa,es=L((()=>{Qa="1.17.0"})),ts,dr,Ko=L((()=>{es(),ts="warning",dr={wasm:{},webgl:{},webgpu:{},versions:{common:Qa},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error(`Unsupported logging level: ${e}`);ts=e}},get logLevel(){return ts}},Object.defineProperty(dr,"logLevel",{enumerable:!0})})),ee,rs=L((()=>{Ko(),ee=dr})),ns,os,is=L((()=>{ns=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(null!=n){let i,o;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);let a,s,u=void 0!==t?.format?t.format:"RGB",l=t?.norm;void 0===l||void 0===l.mean?a=[255,255,255,255]:"number"==typeof l.mean?a=[l.mean,l.mean,l.mean,l.mean]:(a=[l.mean[0],l.mean[1],l.mean[2],0],void 0!==l.mean[3]&&(a[3]=l.mean[3])),void 0===l||void 0===l.bias?s=[0,0,0,0]:"number"==typeof l.bias?s=[l.bias,l.bias,l.bias,l.bias]:(s=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(s[3]=l.bias[3]));let h=o*i,c=0,d=h,f=2*h,p=-1;"RGBA"===u?(c=0,d=h,f=2*h,p=3*h):"RGB"===u?(c=0,d=h,f=2*h):"RBG"===u&&(c=0,f=h,d=2*h);for(let t=0;t<o;t++)for(let r=0;r<i;r++){let i=(e.data[c++]-s[0])*a[0],o=(e.data[d++]-s[1])*a[1],u=(e.data[f++]-s[2])*a[2],l=-1===p?255:(e.data[p++]-s[3])*a[3];n.fillStyle="rgba("+i+","+o+","+u+","+l+")",n.fillRect(r,t,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},os=(e,t)=>{let r,n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==n)throw new Error("Can not access image data");{let i,o,a;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[1],a=e.dims[3]):(i=e.dims[3],o=e.dims[2],a=e.dims[1]);let s,u,l=void 0!==t&&void 0!==t.format?t.format:"RGB",h=t?.norm;void 0===h||void 0===h.mean?s=[255,255,255,255]:"number"==typeof h.mean?s=[h.mean,h.mean,h.mean,h.mean]:(s=[h.mean[0],h.mean[1],h.mean[2],255],void 0!==h.mean[3]&&(s[3]=h.mean[3])),void 0===h||void 0===h.bias?u=[0,0,0,0]:"number"==typeof h.bias?u=[h.bias,h.bias,h.bias,h.bias]:(u=[h.bias[0],h.bias[1],h.bias[2],0],void 0!==h.bias[3]&&(u[3]=h.bias[3]));let c=o*i;if(void 0!==t&&(void 0!==t.format&&4===a&&"RGBA"!==t.format||3===a&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");let d=4,f=0,p=1,y=2,g=3,m=0,w=c,b=2*c,v=-1;"RGBA"===l?(m=0,w=c,b=2*c,v=3*c):"RGB"===l?(m=0,w=c,b=2*c):"RBG"===l&&(m=0,b=c,w=2*c),r=n.createImageData(i,o);for(let t=0;t<o*i;f+=d,p+=d,y+=d,g+=d,t++)r.data[f]=(e.data[m++]-u[0])*s[0],r.data[p]=(e.data[w++]-u[1])*s[1],r.data[y]=(e.data[b++]-u[2])*s[2],r.data[g]=-1===v?255:(e.data[v++]-u[3])*s[3]}return r}})),Jo,as,ss,us,ls,fs=L((()=>{Gn(),Jo=(e,t)=>{if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");let r,n,{height:i,width:o}=t,a=t.norm??{mean:255,bias:0};r="number"==typeof a.mean?[a.mean,a.mean,a.mean,a.mean]:[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],n="number"==typeof a.bias?[a.bias,a.bias,a.bias,a.bias]:[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let s=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",l=i*o,h="RGBA"===u?new Float32Array(4*l):new Float32Array(3*l),c=4,d=0,f=1,p=2,y=3,g=0,m=l,w=2*l,b=-1;"RGB"===s&&(c=3,d=0,f=1,p=2,y=-1),"RGBA"===u?b=3*l:"RBG"===u?(g=0,w=l,m=2*l):"BGR"===u&&(w=0,m=l,g=2*l);for(let t=0;t<l;t++,d+=c,p+=c,f+=c,y+=c)h[g++]=(e[d]+n[0])/r[0],h[m++]=(e[f]+n[1])/r[1],h[w++]=(e[p]+n[2])/r[2],-1!==b&&-1!==y&&(h[b++]=(e[y]+n[3])/r[3]);return new Xe("float32",h,"RGBA"===u?[1,4,i,o]:[1,3,i,o])},as=async(e,t)=>{let r,n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,i=typeof ImageData<"u"&&e instanceof ImageData,o=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,a="string"==typeof e,s=t??{},u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=e=>e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null==i)throw new Error("Can not access image data");{let n=e.height,o=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(n=t.resizedHeight,o=t.resizedWidth),void 0!==t){if(s=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=n,s.width=o}else s.tensorFormat="RGBA",s.height=n,s.width=o;i.drawImage(e,0,0),r=i.getImageData(0,0,o,n).data}}else{if(!i){if(o){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null!=i){let t=e.height,n=e.width;return i.drawImage(e,0,0,n,t),r=i.getImageData(0,0,n,t).data,s.height=t,s.width=n,Jo(r,s)}throw new Error("Can not access image data")}if(a)return new Promise(((t,r)=>{let n=u(),i=l(n);if(!e||!i)return r();let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{n.width=o.width,n.height=o.height,i.drawImage(o,0,0,n.width,n.height);let e=i.getImageData(0,0,n.width,n.height);s.height=n.height,s.width=n.width,t(Jo(e.data,s))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{let n,i;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,i=t.resizedWidth):(n=e.height,i=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=n,s.width=i,void 0!==t){let t=u();t.width=i,t.height=n;let o=l(t);if(null==o)throw new Error("Can not access image data");o.putImageData(e,0,0),r=o.getImageData(0,0,i,n).data}else r=e.data}}if(void 0!==r)return Jo(r,s);throw new Error("Input data provided is not supported - aborted tensor creation")},ss=(e,t)=>{let{width:r,height:n,download:i,dispose:o}=t;return new Xe({location:"texture",type:"float32",texture:e,dims:[1,n,r,4],download:i,dispose:o})},us=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:o}=t;return new Xe({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:i,dispose:o})},ls=(e,t,r)=>new Xe({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})})),an,Un,cs,ps,ds=L((()=>{an=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Un=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),cs=!1,ps=()=>{if(!cs){cs=!0;let e=typeof BigInt64Array<"u"&&"function"==typeof BigInt64Array.from,t=typeof BigUint64Array<"u"&&"function"==typeof BigUint64Array.from;e&&(an.set("int64",BigInt64Array),Un.set(BigInt64Array,"int64")),t&&(an.set("uint64",BigUint64Array),Un.set(BigUint64Array,"uint64"))}}})),hs,ms,bs=L((()=>{Gn(),hs=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if("number"!=typeof n||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},ms=(e,t)=>{switch(e.location){case"cpu":return new Xe(e.type,e.data,t);case"cpu-pinned":return new Xe({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Xe({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Xe({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}})),Xe,Gn=L((()=>{is(),fs(),ds(),bs(),Xe=class{constructor(e,t,r){let n,i;if(ps(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{let t=an.get(n);if(!t)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw new TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==n&&"float16"!==n&&"int32"!==n&&"int64"!==n&&"uint32"!==n&&"bool"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,a;if("string"==typeof e)if(n=e,a=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{let r=an.get(e);if(void 0===r)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");o="uint64"===e||"int64"===e?r.from(t,BigInt):r.from(t)}else{if(!(t instanceof r))throw new TypeError(`A ${n} tensor's data must be type of ${r}`);o=t}}else if(a=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)n="string",o=e;else{if("boolean"!==t)throw new TypeError(`Invalid element type of data array: ${t}.`);n="bool",o=Uint8Array.from(e)}}else{let t=Un.get(e.constructor);if(void 0===t)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=t,o=e}if(void 0===a)a=[o.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");i=a,this.cpuData=o,this.dataLocation="cpu"}let o=hs(i);if(this.cpuData&&o!==this.cpuData.length)throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=i,this.size=o}static async fromImage(e,t){return as(e,t)}static fromTexture(e,t){return ss(e,t)}static fromGpuBuffer(e,t){return us(e,t)}static fromPinnedBuffer(e,t,r){return ls(e,t,r)}toDataURL(e){return ns(this,e)}toImageData(e){return os(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return ms(this,e)}}})),Re,zn=L((()=>{Gn(),Re=Xe})),gs,ys,hr,mr,Zo=L((()=>{Ko(),gs=(e,t)=>{dr.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},ys=(e,t)=>{let r=(new Error).stack?.split(/\r\n|\r|\n/g)||[],n=!1;for(let i=0;i<r.length;i++){if(n&&!r[i].includes("TRACE_FUNC")){let n=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;return t&&(n+=`::${t}`),void gs("CPU",n)}r[i].includes("TRACE_FUNC")&&(n=!0)}},hr=e=>{dr.wasm.trace&&ys("BEGIN",e)},mr=e=>{dr.wasm.trace&&ys("END",e)}})),Wn,Ts=L((()=>{Mn(),zn(),Zo(),Wn=class e{constructor(e){this.handler=e}async run(e,t,r){hr();let n={},i={};if("object"!=typeof e||null===e||e instanceof Re||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if("object"==typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof Re)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let e of t){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);n[e]=null}if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,a=Object.getOwnPropertyNames(t);for(let r of this.outputNames)if(-1!==a.indexOf(r)){let i=t[r];(null===i||i instanceof Re)&&(e=!0,o=!1,n[r]=i)}if(e){if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(typeof e[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(o)for(let e of this.outputNames)n[e]=null;let a=await this.handler.run(e,n,i),s={};for(let e in a)if(Object.hasOwnProperty.call(a,e)){let t=a[e];s[e]=t instanceof Re?t:new Re(t.type,t.data,t.dims)}return mr(),s}async release(){return this.handler.dispose()}async configure(e){return await this.handler.configure(e)}async auth(e){return await this.handler.auth(e)}static async create(t,r,n,i){hr();let o,a={};if("string"==typeof t){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{if(!(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{let e=t,s=0,u=t.byteLength;if("object"==typeof r&&null!==r)a=r;else if("number"==typeof r){if(s=r,!Number.isSafeInteger(s))throw new RangeError("'byteOffset' must be an integer.");if(s<0||s>=e.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(u=t.byteLength-s,"number"==typeof n){if(u=n,!Number.isSafeInteger(u))throw new RangeError("'byteLength' must be an integer.");if(u<=0||s+u>e.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${e.byteLength-s}].`);if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(e,s,u)}}let s=(a.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),u=await(await Rn(s)).createInferenceSessionHandler(o,a);return mr(),new e(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}})),Nd,xs=L((()=>{Ts(),Nd=Wn})),ws=L((()=>{})),Rd,Vn,vs=L((()=>{Mn(),zn(),Rd="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Vn=class e{constructor(e,t,r){this.handler=e,this.hasOptimizerModel=t,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(t,r){let n=t.evalModel||"",i=t.optimizerModel||"",o=r||{},a=(o.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),s=await Rn(a);if(s.createTrainingSessionHandler){let r=await s.createTrainingSessionHandler(t.checkpointState,t.trainModel,n,i,o);return new e(r,!!t.optimizerModel,!!t.evalModel)}throw new Error(Rd)}typeNarrowingForRunStep(e,t,r,n,i){let o={},a={};if("object"!=typeof r||null===r||r instanceof Re||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if("object"==typeof n){if(null===n)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Re)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(0===n.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let e of n){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);o[e]=null}if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,r=Object.getOwnPropertyNames(n);for(let i of t)if(-1!==r.indexOf(i)){let t=n[i];(null===t||t instanceof Re)&&(e=!0,s=!1,o[i]=t)}if(e){if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else a=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of e)if(typeof r[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(s)for(let e of t)o[e]=null;return[o,a]}convertHandlerReturnTypeToMapOfTensors(e){let t={};for(let r in e)if(Object.hasOwnProperty.call(e,r)){let n=e[r];t[r]=n instanceof Re?n:new Re(n.type,n.data,n.dims)}return t}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(e,t,r){let[n,i]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,t,r),o=await this.handler.runTrainStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}async runOptimizerStep(e){if(!this.hasOptimizerModel)throw new Error("This TrainingSession has no OptimizerModel loaded.");await this.handler.runOptimizerStep(e||{})}async runEvalStep(e,t,r){if(this.hasEvalModel){let[n,i]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,t,r),o=await this.handler.runEvalStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(e=!0){return this.handler.getParametersSize(e)}async loadParametersBuffer(e,t=!0){let r=await this.getParametersSize(t);if(e.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,t)}async getContiguousParameters(e=!0){return this.handler.getContiguousParameters(e)}async release(){return this.handler.dispose()}}})),Md,_s=L((()=>{vs(),Md=Vn})),Qo={};kr(Qo,{InferenceSession:()=>Nd,TRACE:()=>gs,TRACE_FUNC_BEGIN:()=>hr,TRACE_FUNC_END:()=>mr,Tensor:()=>Re,TrainingSession:()=>Md,env:()=>ee,registerBackend:()=>pr});var It=L((()=>{Za(),rs(),xs(),zn(),Zo(),ws(),_s()}));function Zt(e,t,r,n){if(void 0===t)return Ud(e);if(void 0===r)Hn(e,t,1);else if("number"==typeof r&&void 0===n)Hn(e,t,r);else if("string"==typeof r&&void 0===n)Hn(e,r,1,t);else{if("string"!=typeof r||"number"!=typeof n)throw new TypeError("input is valid");Hn(e,r,n,t)}}function Ud(e){return{verbose:Zt.verbose.bind(null,e),info:Zt.info.bind(null,e),warning:Zt.warning.bind(null,e),error:Zt.error.bind(null,e),fatal:Zt.fatal.bind(null,e)}}function Hn(e,t,r,n){let i=sn[n||""]||sn[""];Is[e]<Is[i.minimalSeverity]||(i.logDateTime&&(t=`${(new Date).toISOString()}|${t}`),i.logSourceLocation,Gd[i.provider].log(e,t,n))}var ei,ti,Is,Gd,Ss,sn,pe,qn,Yn,Xn,jn,dt=L((()=>{ei=class{log(e,t,r){}},ti=class{log(e,t,r){console.log(`${this.color(e)} ${r?"[35m"+r+"[0m ":""}${t}`)}color(e){switch(e){case"verbose":return"[34;40mv[0m";case"info":return"[32mi[0m";case"warning":return"[30;43mw[0m";case"error":return"[31;40me[0m";case"fatal":return"[101mf[0m";default:throw new Error(`unsupported severity: ${e}`)}}},Is={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},Gd={none:new ei,console:new ti},sn={"":Ss={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1}},(e=>{function t(e){sn={},r("",e||{})}function r(e,r){if("*"===e)t(r);else{let t=sn[e]||Ss;sn[e]={provider:r.provider||t.provider,minimalSeverity:r.minimalSeverity||t.minimalSeverity,logDateTime:void 0===r.logDateTime?t.logDateTime:r.logDateTime,logSourceLocation:void 0===r.logSourceLocation?t.logSourceLocation:r.logSourceLocation}}}e.verbose=function(t,r){e("verbose",t,r)},e.info=function(t,r){e("info",t,r)},e.warning=function(t,r){e("warning",t,r)},e.error=function(t,r){e("error",t,r)},e.fatal=function(t,r){e("fatal",t,r)},e.reset=t,e.set=r,e.setWithEnv=function(e){let t={};e.logLevel&&(t.minimalSeverity=e.logLevel),r("",t)}})(Zt||={}),pe=Zt,qn=class{constructor(e,t,r,n,i,o){this.category=e,this.name=t,this.startTime=r,this.endCallback=n,this.timer=i,this.ctx=o}async end(){return this.endCallback(this)}async checkTimer(){if(void 0===this.ctx||void 0===this.timer)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}},Yn=class{constructor(e,t,r,n){this.category=e,this.name=t,this.startTime=r,this.endTime=n}},Xn=class{constructor(e,t,r){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=void 0===e?1e4:e,this._flushBatchSize=void 0===t?10:t,this._flushIntervalInMilliseconds=void 0===r?5e3:r}static create(e){return void 0===e?new this:new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=jn(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(e,t,r,n){let i=this._started?this.begin(e,t,n):void 0,o=!1,a=r();if(a&&"function"==typeof a.then)return o=!0,new Promise(((e,t)=>{a.then((async t=>{i&&await i.end(),e(t)}),(async e=>{i&&await i.end(),t(e)}))}));if(!o&&i){let e=i.end();if(e&&"function"==typeof e.then)return new Promise(((t,r)=>{e.then((()=>{t(a)}),(e=>{r(e)}))}))}return a}begin(e,t,r){if(!this._started)throw new Error("profiler is not started yet");if(void 0===r){let r=jn();return this.flush(r),new qn(e,t,r,(e=>this.endSync(e)))}{let n=r.beginTimer();return new qn(e,t,0,(async e=>this.end(e)),n,r)}}async end(e){let t=await e.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(e.category,e.name,e.startTime,t)),this.flush(t))}endSync(e){let t=jn();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(e.category,e.name,e.startTime,t)),this.flush(t))}logOneEvent(e){pe.verbose(`Profiler.${e.category}`,`${(e.endTime-e.startTime).toFixed(2)}ms on event '${e.name}' at ${e.endTime.toFixed(2)}`)}flush(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(let e=this._flushPointer;this._flushPointer<e+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=jn()}}get started(){return this._started}},jn=typeof performance<"u"&&performance.now?()=>performance.now():Date.now}));function As(e,t,r){for(let n of r){let r=n[0],i=n[1],o=n[2],a=n[3],s=n[4];if(e.opType===r)for(let e of t)if((e.domain===i||"ai.onnx"===e.domain&&""===i)&&zd(e.version,o))return{opImpl:a,opInit:s}}throw new TypeError(`cannot resolve operator '${e.opType}' with opsets: ${t.map((e=>`${e.domain||"ai.onnx"} v${e.version}`)).join(", ")}`)}function zd(e,t){if(t.endsWith("+")){let r=Number.parseInt(t.substring(0,t.length-1),10);return!isNaN(r)&&r<=e}if(2===t.split("-").length){let r=t.split("-"),n=Number.parseInt(r[0],10),i=Number.parseInt(r[1],10);return!isNaN(n)&&!isNaN(i)&&n<=e&&e<=i}return Number.parseInt(t,10)===e}var Es=L((()=>{})),Ps=ye((e=>{e.__esModule=!0;var t=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var r=t.toString();return t&&(t instanceof e||e.validator.test(r))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();e.Guid=t}));function Te(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function He(e){return!0===(e&&e.__isLong__)}function Ds(e){var t=Math.clz32(e&-e);return e?31-t:t}function br(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=Fs[e])?n:(r=le(e,0,!0),i&&(Fs[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=Ls[e])?n:(r=le(e,e<0?-1:0,!1),i&&(Ls[e]=r),r)}function mt(e,t){if(isNaN(e))return t?Ht:St;if(t){if(e<0)return Ht;if(e>=ks)return Ms}else{if(e<=-$s)return rt;if(e+1>=$s)return Rs}return e<0?mt(-e,t).neg():le(e%Mr|0,e/Mr|0,t)}function le(e,t,r){return new Te(e,t,r)}function oi(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?Ht:St;if((r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return oi(e.substring(1),t,r).neg();for(var i=mt(Kn(r,8)),o=St,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),r);if(s<8){var l=mt(Kn(r,s));o=o.mul(l).add(mt(u))}else o=(o=o.mul(i)).add(mt(u))}return o.unsigned=t,o}function At(e,t){return"number"==typeof e?mt(e,t):"string"==typeof e?oi(e,t):le(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}var ht,Ls,Fs,Kn,Cs,Vd,Mr,ks,$s,Bs,St,Ht,Rr,Ns,ni,Rs,Ms,rt,k,jt,ii=L((()=>{ht=null;try{ht=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}Te.prototype.__isLong__,Object.defineProperty(Te.prototype,"__isLong__",{value:!0}),Te.isLong=He,Ls={},Fs={},Te.fromInt=br,Te.fromNumber=mt,Te.fromBits=le,Kn=Math.pow,Te.fromString=oi,Te.fromValue=At,$s=(ks=(Mr=(Cs=65536)*Cs)*Mr)/2,Bs=br(Vd=1<<24),St=br(0),Te.ZERO=St,Ht=br(0,!0),Te.UZERO=Ht,Rr=br(1),Te.ONE=Rr,Ns=br(1,!0),Te.UONE=Ns,ni=br(-1),Te.NEG_ONE=ni,Rs=le(-1,2147483647,!1),Te.MAX_VALUE=Rs,Ms=le(-1,-1,!0),Te.MAX_UNSIGNED_VALUE=Ms,rt=le(0,-2147483648,!1),Te.MIN_VALUE=rt,(k=Te.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*Mr+(this.low>>>0):this.high*Mr+(this.low>>>0)},k.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(rt)){var t=mt(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=mt(Kn(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(rt)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},k.isZero=function(){return 0===this.high&&0===this.low},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return 1==(1&this.low)},k.isEven=function(){return 0==(1&this.low)},k.equals=function(e){return He(e)||(e=At(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},k.eq=k.equals,k.notEquals=function(e){return!this.eq(e)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(e){return this.comp(e)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(e){return this.comp(e)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(e){return this.comp(e)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(e){return this.comp(e)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(e){if(He(e)||(e=At(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(rt)?rt:this.not().add(Rr)},k.neg=k.negate,k.add=function(e){He(e)||(e=At(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,l=0,h=0,c=0;return h+=(c+=i+(65535&e.low))>>>16,l+=(h+=n+s)>>>16,u+=(l+=r+a)>>>16,u+=t+o,le((h&=65535)<<16|(c&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},k.subtract=function(e){return He(e)||(e=At(e)),this.add(e.neg())},k.sub=k.subtract,k.multiply=function(e){if(this.isZero())return this;if(He(e)||(e=At(e)),ht)return le(ht.mul(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned);if(e.isZero())return this.unsigned?Ht:St;if(this.eq(rt))return e.isOdd()?rt:St;if(e.eq(rt))return this.isOdd()?rt:St;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Bs)&&e.lt(Bs))return mt(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,l=0,h=0,c=0,d=0;return c+=(d+=i*u)>>>16,h+=(c+=n*u)>>>16,c&=65535,h+=(c+=i*s)>>>16,l+=(h+=r*u)>>>16,h&=65535,l+=(h+=n*s)>>>16,h&=65535,l+=(h+=i*a)>>>16,l+=t*u+r*s+n*a+i*o,le((c&=65535)<<16|(d&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},k.mul=k.multiply,k.divide=function(e){if(He(e)||(e=At(e)),e.isZero())throw Error("division by zero");var t,r,n;if(ht)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?le((this.unsigned?ht.div_u:ht.div_s)(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Ht:St;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ht;if(e.gt(this.shru(1)))return Ns;n=Ht}else{if(this.eq(rt))return e.eq(Rr)||e.eq(ni)?rt:e.eq(rt)?Rr:(t=this.shr(1).div(e).shl(1)).eq(St)?e.isNegative()?Rr:ni:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(rt))return this.unsigned?Ht:St;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=St}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:Kn(2,i-48),a=mt(t),s=a.mul(e);s.isNegative()||s.gt(r);)s=(a=mt(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=Rr),n=n.add(a),r=r.sub(s)}return n},k.div=k.divide,k.modulo=function(e){return He(e)||(e=At(e)),ht?le((this.unsigned?ht.rem_u:ht.rem_s)(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return le(~this.low,~this.high,this.unsigned)},k.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},k.clz=k.countLeadingZeros,k.countTrailingZeros=function(){return this.low?Ds(this.low):Ds(this.high)+32},k.ctz=k.countTrailingZeros,k.and=function(e){return He(e)||(e=At(e)),le(this.low&e.low,this.high&e.high,this.unsigned)},k.or=function(e){return He(e)||(e=At(e)),le(this.low|e.low,this.high|e.high,this.unsigned)},k.xor=function(e){return He(e)||(e=At(e)),le(this.low^e.low,this.high^e.high,this.unsigned)},k.shiftLeft=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):le(0,this.low<<e-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):le(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):le(32===e?this.high:this.high>>>e-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.rotateLeft=function(e){var t;return He(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),le(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},k.rotl=k.rotateLeft,k.rotateRight=function(e){var t;return He(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),le(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},k.rotr=k.rotateRight,k.toSigned=function(){return this.unsigned?le(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:le(this.low,this.high,!0)},k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Te.fromBytes=function(e,t,r){return r?Te.fromBytesLE(e,t):Te.fromBytesBE(e,t)},Te.fromBytesLE=function(e,t){return new Te(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Te.fromBytesBE=function(e,t){return new Te(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},jt=Te})),O,Jn=L((()=>{O={},O.Table,O.SIZEOF_SHORT=2,O.SIZEOF_INT=4,O.FILE_IDENTIFIER_LENGTH=4,O.SIZE_PREFIX_LENGTH=4,O.Encoding={UTF8_BYTES:1,UTF16_STRING:2},O.int32=new Int32Array(2),O.float32=new Float32Array(O.int32.buffer),O.float64=new Float64Array(O.int32.buffer),O.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],O.Long=function(e,t){this.low=0|e,this.high=0|t},O.Long.create=function(e,t){return 0==e&&0==t?O.Long.ZERO:new O.Long(e,t)},O.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},O.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high},O.Long.ZERO=new O.Long(0,0),O.Builder=function(e){if(e)var t=e;else t=1024;this.bb=O.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},O.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},O.Builder.prototype.forceDefaults=function(e){this.force_defaults=e},O.Builder.prototype.dataBuffer=function(){return this.bb},O.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},O.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var r=1+~(this.bb.capacity()-this.space+t)&e-1;this.space<r+e+t;){var n=this.bb.capacity();this.bb=O.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(r)},O.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0)},O.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)},O.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)},O.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)},O.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)},O.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)},O.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)},O.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)},O.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)},O.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)},O.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)},O.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)},O.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)},O.Builder.prototype.addFieldInt8=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt8(t),this.slot(e))},O.Builder.prototype.addFieldInt16=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt16(t),this.slot(e))},O.Builder.prototype.addFieldInt32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt32(t),this.slot(e))},O.Builder.prototype.addFieldInt64=function(e,t,r){(this.force_defaults||!t.equals(r))&&(this.addInt64(t),this.slot(e))},O.Builder.prototype.addFieldFloat32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat32(t),this.slot(e))},O.Builder.prototype.addFieldFloat64=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat64(t),this.slot(e))},O.Builder.prototype.addFieldOffset=function(e,t,r){(this.force_defaults||t!=r)&&(this.addOffset(t),this.slot(e))},O.Builder.prototype.addFieldStruct=function(e,t,r){t!=r&&(this.nested(t),this.slot(e))},O.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},O.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},O.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()},O.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},O.Builder.growByteBuffer=function(e){var t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=t<<1,n=O.ByteBuffer.allocate(r);return n.setPosition(r-t),n.bytes().set(e.bytes(),r-t),n},O.Builder.prototype.addOffset=function(e){this.prep(O.SIZEOF_INT,0),this.writeInt32(this.offset()-e+O.SIZEOF_INT)},O.Builder.prototype.startObject=function(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()},O.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&0==this.vtable[t];t--);for(var r=t+1;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);var n=(r+2)*O.SIZEOF_SHORT;this.addInt16(n);var i=0,o=this.space;e:for(t=0;t<this.vtables.length;t++){var a=this.bb.capacity()-this.vtables[t];if(n==this.bb.readInt16(a)){for(var s=O.SIZEOF_SHORT;s<n;s+=O.SIZEOF_SHORT)if(this.bb.readInt16(o+s)!=this.bb.readInt16(a+s))continue e;i=this.vtables[t];break}}return i?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,i-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e},O.Builder.prototype.finish=function(e,t,r){var n=r?O.SIZE_PREFIX_LENGTH:0;if(t){var i=t;if(this.prep(this.minalign,O.SIZEOF_INT+O.FILE_IDENTIFIER_LENGTH+n),i.length!=O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+O.FILE_IDENTIFIER_LENGTH);for(var o=O.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(i.charCodeAt(o))}this.prep(this.minalign,O.SIZEOF_INT+n),this.addOffset(e),n&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},O.Builder.prototype.finishSizePrefixed=function(e,t){this.finish(e,t,!0)},O.Builder.prototype.requiredField=function(e,t){var r=this.bb.capacity()-e,n=r-this.bb.readInt32(r);if(!(0!=this.bb.readInt16(n+t)))throw new Error("FlatBuffers: field "+t+" must be set")},O.Builder.prototype.startVector=function(e,t,r){this.notNested(),this.vector_num_elems=t,this.prep(O.SIZEOF_INT,e*t),this.prep(r,e*t)},O.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},O.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else{t=[];for(var r=0;r<e.length;){var n,i=e.charCodeAt(r++);if(i<55296||i>=56320)n=i;else n=(i<<10)+e.charCodeAt(r++)+-56613888;n<128?t.push(n):(n<2048?t.push(n>>6&31|192):(n<65536?t.push(n>>12&15|224):t.push(n>>18&7|240,n>>12&63|128),t.push(n>>6&63|128)),t.push(63&n|128))}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);r=0;for(var o=this.space,a=this.bb.bytes();r<t.length;r++)a[o++]=t[r];return this.endVector()},O.Builder.prototype.createLong=function(e,t){return O.Long.create(e,t)},O.ByteBuffer=function(e){this.bytes_=e,this.position_=0},O.ByteBuffer.allocate=function(e){return new O.ByteBuffer(new Uint8Array(e))},O.ByteBuffer.prototype.clear=function(){this.position_=0},O.ByteBuffer.prototype.bytes=function(){return this.bytes_},O.ByteBuffer.prototype.position=function(){return this.position_},O.ByteBuffer.prototype.setPosition=function(e){this.position_=e},O.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},O.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24},O.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]},O.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16},O.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8},O.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24},O.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0},O.ByteBuffer.prototype.readInt64=function(e){return new O.Long(this.readInt32(e),this.readInt32(e+4))},O.ByteBuffer.prototype.readUint64=function(e){return new O.Long(this.readUint32(e),this.readUint32(e+4))},O.ByteBuffer.prototype.readFloat32=function(e){return O.int32[0]=this.readInt32(e),O.float32[0]},O.ByteBuffer.prototype.readFloat64=function(e){return O.int32[O.isLittleEndian?0:1]=this.readInt32(e),O.int32[O.isLittleEndian?1:0]=this.readInt32(e+4),O.float64[0]},O.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t},O.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t},O.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},O.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},O.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},O.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},O.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)},O.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)},O.ByteBuffer.prototype.writeFloat32=function(e,t){O.float32[0]=t,this.writeInt32(e,O.int32[0])},O.ByteBuffer.prototype.writeFloat64=function(e,t){O.float64[0]=t,this.writeInt32(e,O.int32[O.isLittleEndian?0:1]),this.writeInt32(e+4,O.int32[O.isLittleEndian?1:0])},O.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+O.SIZEOF_INT+O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<O.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+O.SIZEOF_INT+t));return e},O.ByteBuffer.prototype.__offset=function(e,t){var r=e-this.readInt32(e);return t<this.readInt16(r)?this.readInt16(r+t):0},O.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e},O.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var r=this.readInt32(e),n="",i=0;if(e+=O.SIZEOF_INT,t===O.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+r);for(;i<r;){var o,a=this.readUint8(e+i++);if(a<192)o=a;else{var s=this.readUint8(e+i++);if(a<224)o=(31&a)<<6|63&s;else{var u=this.readUint8(e+i++);if(a<240)o=(15&a)<<12|(63&s)<<6|63&u;else o=(7&a)<<18|(63&s)<<12|(63&u)<<6|63&this.readUint8(e+i++)}}o<65536?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296+(o>>10),56320+(1023&o)))}return n},O.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)},O.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+O.SIZEOF_INT},O.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))},O.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+O.FILE_IDENTIFIER_LENGTH);for(var t=0;t<O.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+O.SIZEOF_INT+t))return!1;return!0},O.ByteBuffer.prototype.createLong=function(e,t){return O.Long.create(e,t)}})),H,un=L((()=>{Jn(),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.AttributeType||={})[r.UNDEFINED=0]="UNDEFINED",r[r.FLOAT=1]="FLOAT",r[r.INT=2]="INT",r[r.STRING=3]="STRING",r[r.TENSOR=4]="TENSOR",r[r.GRAPH=5]="GRAPH",r[r.FLOATS=6]="FLOATS",r[r.INTS=7]="INTS",r[r.STRINGS=8]="STRINGS",r[r.TENSORS=9]="TENSORS",r[r.GRAPHS=10]="GRAPHS",r[r.SPARSE_TENSOR=11]="SPARSE_TENSOR",r[r.SPARSE_TENSORS=12]="SPARSE_TENSORS"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.DimensionValueType||={})[r.UNKNOWN=0]="UNKNOWN",r[r.VALUE=1]="VALUE",r[r.PARAM=2]="PARAM"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.TensorDataType||={})[r.UNDEFINED=0]="UNDEFINED",r[r.FLOAT=1]="FLOAT",r[r.UINT8=2]="UINT8",r[r.INT8=3]="INT8",r[r.UINT16=4]="UINT16",r[r.INT16=5]="INT16",r[r.INT32=6]="INT32",r[r.INT64=7]="INT64",r[r.STRING=8]="STRING",r[r.BOOL=9]="BOOL",r[r.FLOAT16=10]="FLOAT16",r[r.DOUBLE=11]="DOUBLE",r[r.UINT32=12]="UINT32",r[r.UINT64=13]="UINT64",r[r.COMPLEX64=14]="COMPLEX64",r[r.COMPLEX128=15]="COMPLEX128",r[r.BFLOAT16=16]="BFLOAT16",r[r.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",r[r.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",r[r.FLOAT8E5M2=19]="FLOAT8E5M2",r[r.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.NodeType||={})[r.Primitive=0]="Primitive",r[r.Fused=1]="Fused"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.TypeInfoValue||={})[r.NONE=0]="NONE",r[r.tensor_type=1]="tensor_type",r[r.sequence_type=2]="sequence_type",r[r.map_type=3]="map_type"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsShape(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsShape(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}dim(t,r){let n=this.bb.__offset(this.bb_pos,4);return n?(r||new e.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}dimLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}static startShape(e){e.startObject(1)}static addDim(e,t){e.addFieldOffset(0,t,0)}static createDimVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startDimVector(e,t){e.startVector(4,t,4)}static endShape(e){return e.endObject()}static createShape(e,t){return r.startShape(e),r.addDim(e,t),r.endShape(e)}}t.Shape=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimension(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDimension(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}value(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}denotation(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimension(e){e.startObject(2)}static addValue(e,t){e.addFieldOffset(0,t,0)}static addDenotation(e,t){e.addFieldOffset(1,t,0)}static endDimension(e){return e.endObject()}static createDimension(e,t,n){return r.startDimension(e),r.addValue(e,t),r.addDenotation(e,n),r.endDimension(e)}}t.Dimension=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimensionValue(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDimensionValue(e,r){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}dimType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):0}dimValue(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}dimParam(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimensionValue(e){e.startObject(3)}static addDimType(e,t){e.addFieldInt8(0,t,0)}static addDimValue(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}static addDimParam(e,t){e.addFieldOffset(2,t,0)}static endDimensionValue(e){return e.endObject()}static createDimensionValue(e,r,n,i){return t.startDimensionValue(e),t.addDimType(e,r),t.addDimValue(e,n),t.addDimParam(e,i),t.endDimensionValue(e)}}e.DimensionValue=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensorTypeAndShape(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTensorTypeAndShape(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}elemType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}shape(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startTensorTypeAndShape(e){e.startObject(2)}static addElemType(e,t){e.addFieldInt32(0,t,0)}static addShape(e,t){e.addFieldOffset(1,t,0)}static endTensorTypeAndShape(e){return e.endObject()}static createTensorTypeAndShape(e,t,n){return r.startTensorTypeAndShape(e),r.addElemType(e,t),r.addShape(e,n),r.endTensorTypeAndShape(e)}}t.TensorTypeAndShape=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMapType(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMapType(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}keyType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}valueType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startMapType(e){e.startObject(2)}static addKeyType(e,t){e.addFieldInt32(0,t,0)}static addValueType(e,t){e.addFieldOffset(1,t,0)}static endMapType(e){return e.endObject()}static createMapType(e,t,n){return r.startMapType(e),r.addKeyType(e,t),r.addValueType(e,n),r.endMapType(e)}}t.MapType=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSequenceType(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSequenceType(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}elemType(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startSequenceType(e){e.startObject(1)}static addElemType(e,t){e.addFieldOffset(0,t,0)}static endSequenceType(e){return e.endObject()}static createSequenceType(e,t){return r.startSequenceType(e),r.addElemType(e,t),r.endSequenceType(e)}}t.SequenceType=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(t=e.fbs||={}).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(e,t,r,n){return e.prep(4,12),e.writeInt32(n),e.writeInt32(r),e.writeInt32(t),e.offset()}}})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNodeEdge(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNodeEdge(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}nodeIndex(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb_pos+e):0}inputEdges(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null}inputEdgesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}outputEdges(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null}outputEdgesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNodeEdge(e){e.startObject(3)}static addNodeIndex(e,t){e.addFieldInt32(0,t,0)}static addInputEdges(e,t){e.addFieldOffset(1,t,0)}static startInputEdgesVector(e,t){e.startVector(12,t,4)}static addOutputEdges(e,t){e.addFieldOffset(2,t,0)}static startOutputEdgesVector(e,t){e.startVector(12,t,4)}static endNodeEdge(e){return e.endObject()}static createNodeEdge(e,t,n,i){return r.startNodeEdge(e),r.addNodeIndex(e,t),r.addInputEdges(e,n),r.addOutputEdges(e,i),r.endNodeEdge(e)}}t.NodeEdge=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNode(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNode(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}sinceVersion(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}index(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb_pos+e):0}opType(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readInt32(this.bb_pos+e):0}executionProviderType(e){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__string(this.bb_pos+t,e):null}inputs(e,t){let r=this.bb.__offset(this.bb_pos,20);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let r=this.bb.__offset(this.bb_pos,22);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}attributes(t,r){let n=this.bb.__offset(this.bb_pos,24);return n?(r||new e.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}attributesLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCounts(e){let t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}inputArgCountsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCountsArray(){let e=this.bb.__offset(this.bb_pos,26);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}implicitInputs(e,t){let r=this.bb.__offset(this.bb_pos,28);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}implicitInputsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNode(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDomain(e,t){e.addFieldOffset(2,t,0)}static addSinceVersion(e,t){e.addFieldInt32(3,t,0)}static addIndex(e,t){e.addFieldInt32(4,t,0)}static addOpType(e,t){e.addFieldOffset(5,t,0)}static addType(e,t){e.addFieldInt32(6,t,0)}static addExecutionProviderType(e,t){e.addFieldOffset(7,t,0)}static addInputs(e,t){e.addFieldOffset(8,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(9,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addAttributes(e,t){e.addFieldOffset(10,t,0)}static createAttributesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startAttributesVector(e,t){e.startVector(4,t,4)}static addInputArgCounts(e,t){e.addFieldOffset(11,t,0)}static createInputArgCountsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addInt32(t[r]);return e.endVector()}static startInputArgCountsVector(e,t){e.startVector(4,t,4)}static addImplicitInputs(e,t){e.addFieldOffset(12,t,0)}static createImplicitInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startImplicitInputsVector(e,t){e.startVector(4,t,4)}static endNode(e){return e.endObject()}static createNode(e,t,n,i,o,a,s,u,l,h,c,d,f,p){return r.startNode(e),r.addName(e,t),r.addDocString(e,n),r.addDomain(e,i),r.addSinceVersion(e,o),r.addIndex(e,a),r.addOpType(e,s),r.addType(e,u),r.addExecutionProviderType(e,l),r.addInputs(e,h),r.addOutputs(e,c),r.addAttributes(e,d),r.addInputArgCounts(e,f),r.addImplicitInputs(e,p),r.endNode(e)}}t.Node=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsValueInfo(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsValueInfo(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(t){let r=this.bb.__offset(this.bb_pos,8);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startValueInfo(e){e.startObject(3)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(e,t){e.addFieldOffset(2,t,0)}static endValueInfo(e){return e.endObject()}static createValueInfo(e,t,n,i){return r.startValueInfo(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.endValueInfo(e)}}t.ValueInfo=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTypeInfo(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTypeInfo(e,r){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}denotation(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}valueType(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):0}value(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}static startTypeInfo(e){e.startObject(3)}static addDenotation(e,t){e.addFieldOffset(0,t,0)}static addValueType(e,t){e.addFieldInt8(1,t,0)}static addValue(e,t){e.addFieldOffset(2,t,0)}static endTypeInfo(e){return e.endObject()}static createTypeInfo(e,r,n,i){return t.startTypeInfo(e),t.addDenotation(e,r),t.addValueType(e,n),t.addValue(e,i),t.endTypeInfo(e)}}e.TypeInfo=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsOperatorSetId(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsOperatorSetId(e,r){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}domain(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}version(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}static startOperatorSetId(e){e.startObject(2)}static addDomain(e,t){e.addFieldOffset(0,t,0)}static addVersion(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}static endOperatorSetId(e){return e.endObject()}static createOperatorSetId(e,r,n){return t.startOperatorSetId(e),t.addDomain(e,r),t.addVersion(e,n),t.endOperatorSetId(e)}}e.OperatorSetId=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensor(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTensor(e,r){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}dataType(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}rawData(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0}rawDataLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}rawDataArray(){let e=this.bb.__offset(this.bb_pos,12);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}stringData(e,t){let r=this.bb.__offset(this.bb_pos,14);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}stringDataLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}static startTensor(e){e.startObject(6)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static addDataType(e,t){e.addFieldInt32(3,t,0)}static addRawData(e,t){e.addFieldOffset(4,t,0)}static createRawDataVector(e,t){e.startVector(1,t.length,1);for(let r=t.length-1;r>=0;r--)e.addInt8(t[r]);return e.endVector()}static startRawDataVector(e,t){e.startVector(1,t,1)}static addStringData(e,t){e.addFieldOffset(5,t,0)}static createStringDataVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startStringDataVector(e,t){e.startVector(4,t,4)}static endTensor(e){return e.endObject()}static createTensor(e,r,n,i,o,a,s){return t.startTensor(e),t.addName(e,r),t.addDocString(e,n),t.addDims(e,i),t.addDataType(e,o),t.addRawData(e,a),t.addStringData(e,s),t.endTensor(e)}}e.Tensor=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSparseTensor(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSparseTensor(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}values(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}indices(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSparseTensor(e){e.startObject(3)}static addValues(e,t){e.addFieldOffset(0,t,0)}static addIndices(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static endSparseTensor(e){return e.endObject()}static createSparseTensor(e,t,n,i){return r.startSparseTensor(e),r.addValues(e,t),r.addIndices(e,n),r.addDims(e,i),r.endSparseTensor(e)}}t.SparseTensor=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsAttribute(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsAttribute(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):0}f(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb_pos+e):0}i(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}s(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}t(t){let r=this.bb.__offset(this.bb_pos,16);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}g(t){let r=this.bb.__offset(this.bb_pos,18);return r?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}floats(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+4*e):0}floatsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}floatsArray(){let e=this.bb.__offset(this.bb_pos,20);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}ints(e){let t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}intsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}strings(e,t){let r=this.bb.__offset(this.bb_pos,24);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}stringsLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}tensors(t,r){let n=this.bb.__offset(this.bb_pos,26);return n?(r||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}tensorsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}graphs(t,r){let n=this.bb.__offset(this.bb_pos,28);return n?(r||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}graphsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startAttribute(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(e,t){e.addFieldInt32(2,t,0)}static addF(e,t){e.addFieldFloat32(3,t,0)}static addI(e,t){e.addFieldInt64(4,t,e.createLong(0,0))}static addS(e,t){e.addFieldOffset(5,t,0)}static addT(e,t){e.addFieldOffset(6,t,0)}static addG(e,t){e.addFieldOffset(7,t,0)}static addFloats(e,t){e.addFieldOffset(8,t,0)}static createFloatsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addFloat32(t[r]);return e.endVector()}static startFloatsVector(e,t){e.startVector(4,t,4)}static addInts(e,t){e.addFieldOffset(9,t,0)}static createIntsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startIntsVector(e,t){e.startVector(8,t,8)}static addStrings(e,t){e.addFieldOffset(10,t,0)}static createStringsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startStringsVector(e,t){e.startVector(4,t,4)}static addTensors(e,t){e.addFieldOffset(11,t,0)}static createTensorsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startTensorsVector(e,t){e.startVector(4,t,4)}static addGraphs(e,t){e.addFieldOffset(12,t,0)}static createGraphsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startGraphsVector(e,t){e.startVector(4,t,4)}static endAttribute(e){return e.endObject()}static createAttribute(e,t,n,i,o,a,s,u,l,h,c,d,f,p){return r.startAttribute(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.addF(e,o),r.addI(e,a),r.addS(e,s),r.addT(e,u),r.addG(e,l),r.addFloats(e,h),r.addInts(e,c),r.addStrings(e,d),r.addTensors(e,f),r.addGraphs(e,p),r.endAttribute(e)}}t.Attribute=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsGraph(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsGraph(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}initializers(t,r){let n=this.bb.__offset(this.bb_pos,4);return n?(r||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}initializersLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeArgs(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodeArgsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}nodes(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}maxNodeIndex(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb_pos+e):0}nodeEdges(t,r){let n=this.bb.__offset(this.bb_pos,12);return n?(r||new e.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodeEdgesLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}inputs(e,t){let r=this.bb.__offset(this.bb_pos,14);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let r=this.bb.__offset(this.bb_pos,16);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}sparseInitializers(t,r){let n=this.bb.__offset(this.bb_pos,18);return n?(r||new e.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}sparseInitializersLength(){let e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0}static startGraph(e){e.startObject(8)}static addInitializers(e,t){e.addFieldOffset(0,t,0)}static createInitializersVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInitializersVector(e,t){e.startVector(4,t,4)}static addNodeArgs(e,t){e.addFieldOffset(1,t,0)}static createNodeArgsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodeArgsVector(e,t){e.startVector(4,t,4)}static addNodes(e,t){e.addFieldOffset(2,t,0)}static createNodesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodesVector(e,t){e.startVector(4,t,4)}static addMaxNodeIndex(e,t){e.addFieldInt32(3,t,0)}static addNodeEdges(e,t){e.addFieldOffset(4,t,0)}static createNodeEdgesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodeEdgesVector(e,t){e.startVector(4,t,4)}static addInputs(e,t){e.addFieldOffset(5,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(6,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addSparseInitializers(e,t){e.addFieldOffset(7,t,0)}static createSparseInitializersVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startSparseInitializersVector(e,t){e.startVector(4,t,4)}static endGraph(e){return e.endObject()}static createGraph(e,t,n,i,o,a,s,u,l){return r.startGraph(e),r.addInitializers(e,t),r.addNodeArgs(e,n),r.addNodes(e,i),r.addMaxNodeIndex(e,o),r.addNodeEdges(e,a),r.addInputs(e,s),r.addOutputs(e,u),r.addSparseInitializers(e,l),r.endGraph(e)}}t.Graph=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsModel(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsModel(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}irVersion(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}opsetImport(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}opsetImportLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}producerName(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}producerVersion(e){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__string(this.bb_pos+t,e):null}modelVersion(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}docString(e){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__string(this.bb_pos+t,e):null}graph(t){let r=this.bb.__offset(this.bb_pos,18);return r?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}graphDocString(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__string(this.bb_pos+t,e):null}static startModel(e){e.startObject(9)}static addIrVersion(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addOpsetImport(e,t){e.addFieldOffset(1,t,0)}static createOpsetImportVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOpsetImportVector(e,t){e.startVector(4,t,4)}static addProducerName(e,t){e.addFieldOffset(2,t,0)}static addProducerVersion(e,t){e.addFieldOffset(3,t,0)}static addDomain(e,t){e.addFieldOffset(4,t,0)}static addModelVersion(e,t){e.addFieldInt64(5,t,e.createLong(0,0))}static addDocString(e,t){e.addFieldOffset(6,t,0)}static addGraph(e,t){e.addFieldOffset(7,t,0)}static addGraphDocString(e,t){e.addFieldOffset(8,t,0)}static endModel(e){return e.endObject()}static createModel(e,t,n,i,o,a,s,u,l,h){return r.startModel(e),r.addIrVersion(e,t),r.addOpsetImport(e,n),r.addProducerName(e,i),r.addProducerVersion(e,o),r.addDomain(e,a),r.addModelVersion(e,s),r.addDocString(e,u),r.addGraph(e,l),r.addGraphDocString(e,h),r.endModel(e)}}t.Model=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKernelCreateInfos(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKernelCreateInfos(e,r){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}nodeIndices(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb.__vector(this.bb_pos+t)+4*e):0}nodeIndicesLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeIndicesArray(){let e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}kernelDefHashes(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}kernelDefHashesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startKernelCreateInfos(e){e.startObject(2)}static addNodeIndices(e,t){e.addFieldOffset(0,t,0)}static createNodeIndicesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addInt32(t[r]);return e.endVector()}static startNodeIndicesVector(e,t){e.startVector(4,t,4)}static addKernelDefHashes(e,t){e.addFieldOffset(1,t,0)}static createKernelDefHashesVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startKernelDefHashesVector(e,t){e.startVector(8,t,8)}static endKernelCreateInfos(e){return e.endObject()}static createKernelCreateInfos(e,r,n){return t.startKernelCreateInfos(e),t.addNodeIndices(e,r),t.addKernelDefHashes(e,n),t.endKernelCreateInfos(e)}}e.KernelCreateInfos=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSubGraphSessionState(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSubGraphSessionState(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}graphId(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}sessionState(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startSubGraphSessionState(e){e.startObject(2)}static addGraphId(e,t){e.addFieldOffset(0,t,0)}static addSessionState(e,t){e.addFieldOffset(1,t,0)}static endSubGraphSessionState(e){let t=e.endObject();return e.requiredField(t,4),t}static createSubGraphSessionState(e,t,n){return r.startSubGraphSessionState(e),r.addGraphId(e,t),r.addSessionState(e,n),r.endSubGraphSessionState(e)}}t.SubGraphSessionState=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSessionState(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSessionState(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}kernels(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}subGraphSessionStates(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}subGraphSessionStatesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSessionState(e){e.startObject(2)}static addKernels(e,t){e.addFieldOffset(0,t,0)}static addSubGraphSessionStates(e,t){e.addFieldOffset(1,t,0)}static createSubGraphSessionStatesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startSubGraphSessionStatesVector(e,t){e.startVector(4,t,4)}static endSessionState(e){return e.endObject()}static createSessionState(e,t,n){return r.startSessionState(e),r.addKernels(e,t),r.addSubGraphSessionStates(e,n),r.endSessionState(e)}}t.SessionState=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInferenceSession(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInferenceSession(e,t){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static bufferHasIdentifier(e){return e.__has_identifier("ORTM")}ortVersion(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}model(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}sessionState(t){let r=this.bb.__offset(this.bb_pos,8);return r?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startInferenceSession(e){e.startObject(3)}static addOrtVersion(e,t){e.addFieldOffset(0,t,0)}static addModel(e,t){e.addFieldOffset(1,t,0)}static addSessionState(e,t){e.addFieldOffset(2,t,0)}static endInferenceSession(e){return e.endObject()}static finishInferenceSessionBuffer(e,t){e.finish(t,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(e,t){e.finish(t,"ORTM",!0)}static createInferenceSession(e,t,n,i){return r.startInferenceSession(e),r.addOrtVersion(e,t),r.addModel(e,n),r.addSessionState(e,i),r.endInferenceSession(e)}}t.InferenceSession=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={})})),Us=ye(((e,t)=>{t.exports=function(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,a){r[n]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,a(e))}}))}})),Hs=ye((e=>{var t=e;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};var r,n=new Array(64),i=new Array(123);for(r=0;r<64;)i[n[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;t.encode=function(e,t,r){for(var i,o=null,a=[],s=0,u=0;t<r;){var l=e[t++];switch(u){case 0:a[s++]=n[l>>2],i=(3&l)<<4,u=1;break;case 1:a[s++]=n[i|l>>4],i=(15&l)<<2,u=2;break;case 2:a[s++]=n[i|l>>6],a[s++]=n[63&l],u=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return u&&(a[s++]=n[i],a[s++]=61,1===u&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var o="invalid encoding";t.decode=function(e,t,r){for(var n,a=r,s=0,u=0;u<e.length;){var l=e.charCodeAt(u++);if(61===l&&s>1)break;if(void 0===(l=i[l]))throw Error(o);switch(s){case 0:n=l,s=1;break;case 1:t[r++]=n<<2|(48&l)>>4,n=l,s=2;break;case 2:t[r++]=(15&n)<<4|(60&l)>>2,n=l,s=3;break;case 3:t[r++]=(3&n)<<6|l,s=0}}if(1===s)throw Error(o);return r-a},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}})),qs=ye(((e,t)=>{function r(){this._listeners={}}t.exports=r,r.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}})),eu=ye(((e,t)=>{function r(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function s(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?a:s,e.readFloatBE=n?s:a}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,a=8388607&n;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,i),e.readFloatLE=r.bind(null,o),e.readFloatBE=r.bind(null,a)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function s(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?a:s,e.readDoubleBE=n?s:a}():function(){function t(e,t,r,n,i,o){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+r);else{var s;if(n<22250738585072014e-324)e((s=n/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+r);else{var u=Math.floor(Math.log(n)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=n*Math.pow(2,-u))>>>0,i,o+t),e((a<<31|u+1023<<20|1048576*s&1048575)>>>0,i,o+r)}}}function r(e,t,r,n,i){var o=e(n,i+t),a=e(n,i+r),s=2*(a>>31)+1,u=a>>>20&2047,l=4294967296*(1048575&a)+o;return 2047===u?l?NaN:s*(1/0):0===u?5e-324*s*l:s*Math.pow(2,u-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=r.bind(null,o,0,4),e.readDoubleBE=r.bind(null,a,4,0)}(),e}function n(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function i(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=r(r)})),tu=ye(((exports,module)=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire})),nu=ye((e=>{var t=e;t.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},t.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],a=0;t<r;)(n=e[t++])<128?o[a++]=n:n>191&&n<224?o[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(n>>10),o[a++]=56320+(1023&n)):o[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},t.write=function(e,t,r){for(var n,i,o=r,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&i),++a,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}})),iu=ye(((e,t)=>{t.exports=function(e,t,r){var n=r||8192,i=n>>>1,o=null,a=n;return function(r){if(r<1||r>i)return e(r);a+r>n&&(o=e(n),a=0);var s=t.call(o,a,a+=r);return 7&a&&(a=1+(7|a)),s}}})),su=ye(((e,t)=>{t.exports=n;var r=er();function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=n.zero=new n(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,o=(e-r)/4294967296>>>0;return t&&(o=~o>>>0,r=~r>>>0,++r>4294967295&&(r=0,++o>4294967295&&(o=0))),new n(r,o)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(r.isString(e)){if(!r.Long)return n.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):i},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var a=String.prototype.charCodeAt;n.fromHash=function(e){return e===o?i:new n((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}})),er=ye((e=>{var t=e;function r(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(void 0===e[n[i]]||!r)&&(e[n[i]]=t[n[i]]);return e}function n(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=Us(),t.base64=Hs(),t.EventEmitter=qs(),t.float=eu(),t.inquire=tu(),t.utf8=nu(),t.pool=iu(),t.LongBits=su(),t.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),t.global=t.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,r){var n=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)},t.merge=r,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},t.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}})),hi=ye(((e,t)=>{t.exports=h;var r,n=er(),i=n.LongBits,o=n.base64,a=n.utf8;function s(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new s(u,0,0),this.tail=this.head,this.states=null}var c=function(){return n.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function d(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function y(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=c(),h.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(h.alloc=n.pool(h.alloc,n.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new s(e,t,r),this.len+=t,this},f.prototype=Object.create(s.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(p,10,i.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=i.from(e);return this._push(p,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(p,t.length(),t)},h.prototype.bool=function(e){return this._push(d,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=i.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var g=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(n.isString(e)){var r=h.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(g,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(d,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new s(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=c(),r._configure()}})),bu=ye(((e,t)=>{t.exports=i;var r=hi();(i.prototype=Object.create(r.prototype)).constructor=i;var n=er();function i(){r.call(this)}function o(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=n._Buffer_allocUnsafe,i.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()})),gi=ye(((e,t)=>{t.exports=s;var r,n=er(),i=n.LongBits,o=n.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function s(e){this.buf=e,this.pos=0,this.len=e.length}var u,l=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new s(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new s(e);throw Error("illegal buffer")},h=function(){return n.Buffer?function(e){return(s.create=function(e){return n.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function c(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}s.create=h(),s.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,s.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),s.prototype.int32=function(){return 0|this.uint32()},s.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},s.prototype.bool=function(){return 0!==this.uint32()},s.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},s.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},s.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},s.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},s.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},s.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},s.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},s._configure=function(e){r=e,s.create=h(),r._configure();var t=n.Long?"toLong":"toNumber";n.merge(s.prototype,{int64:function(){return c.call(this)[t](!1)},uint64:function(){return c.call(this)[t](!0)},sint64:function(){return c.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}})),Iu=ye(((e,t)=>{t.exports=i;var r=gi();(i.prototype=Object.create(r.prototype)).constructor=i;var n=er();function i(e){r.call(this,e)}i._configure=function(){n.Buffer&&(i.prototype._slice=n.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()})),Au=ye(((e,t)=>{t.exports=n;var r=er();function n(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!n}(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return s.emit("error",e,t),a(e);if(null!==r){if(!(r instanceof i))try{r=i[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",r,t),a(null,r)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}})),Pu=ye((e=>{e.Service=Au()})),Lu=ye(((e,t)=>{t.exports={}})),$u=ye((e=>{var t=e;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=hi(),t.BufferWriter=bu(),t.Reader=gi(),t.BufferReader=Iu(),t.util=er(),t.rpc=Pu(),t.roots=Lu(),t.configure=r,r()})),ku=ye(((e,t)=>{t.exports=$u()})),Ur=ye(((e,t)=>{var r=ku(),n=r.Reader,i=r.Writer,o=r.util,a=r.roots.default||(r.roots.default={});a.onnx=function(){var e,t,s={};return s.Version=(e={},(t=Object.create(e))[e[0]="_START_VERSION"]=0,t[e[1]="IR_VERSION_2017_10_10"]=1,t[e[2]="IR_VERSION_2017_10_30"]=2,t[e[3]="IR_VERSION_2017_11_3"]=3,t[e[4]="IR_VERSION_2019_1_22"]=4,t[e[5]="IR_VERSION_2019_3_18"]=5,t[e[6]="IR_VERSION_2019_9_19"]=6,t[e[7]="IR_VERSION_2020_5_8"]=7,t[e[8]="IR_VERSION_2021_7_30"]=8,t[e[9]="IR_VERSION"]=9,t),s.AttributeProto=function(){function e(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.refAttrName="",e.prototype.docString="",e.prototype.type=0,e.prototype.f=0,e.prototype.i=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.s=o.newBuffer([]),e.prototype.t=null,e.prototype.g=null,e.prototype.sparseTensor=null,e.prototype.tp=null,e.prototype.floats=o.emptyArray,e.prototype.ints=o.emptyArray,e.prototype.strings=o.emptyArray,e.prototype.tensors=o.emptyArray,e.prototype.graphs=o.emptyArray,e.prototype.sparseTensors=o.emptyArray,e.prototype.typeProtos=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.f&&Object.hasOwnProperty.call(e,"f")&&t.uint32(21).float(e.f),null!=e.i&&Object.hasOwnProperty.call(e,"i")&&t.uint32(24).int64(e.i),null!=e.s&&Object.hasOwnProperty.call(e,"s")&&t.uint32(34).bytes(e.s),null!=e.t&&Object.hasOwnProperty.call(e,"t")&&a.onnx.TensorProto.encode(e.t,t.uint32(42).fork()).ldelim(),null!=e.g&&Object.hasOwnProperty.call(e,"g")&&a.onnx.GraphProto.encode(e.g,t.uint32(50).fork()).ldelim(),null!=e.floats&&e.floats.length){t.uint32(58).fork();for(var r=0;r<e.floats.length;++r)t.float(e.floats[r]);t.ldelim()}if(null!=e.ints&&e.ints.length){t.uint32(66).fork();for(r=0;r<e.ints.length;++r)t.int64(e.ints[r]);t.ldelim()}if(null!=e.strings&&e.strings.length)for(r=0;r<e.strings.length;++r)t.uint32(74).bytes(e.strings[r]);if(null!=e.tensors&&e.tensors.length)for(r=0;r<e.tensors.length;++r)a.onnx.TensorProto.encode(e.tensors[r],t.uint32(82).fork()).ldelim();if(null!=e.graphs&&e.graphs.length)for(r=0;r<e.graphs.length;++r)a.onnx.GraphProto.encode(e.graphs[r],t.uint32(90).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(106).string(e.docString),null!=e.tp&&Object.hasOwnProperty.call(e,"tp")&&a.onnx.TypeProto.encode(e.tp,t.uint32(114).fork()).ldelim(),null!=e.typeProtos&&e.typeProtos.length)for(r=0;r<e.typeProtos.length;++r)a.onnx.TypeProto.encode(e.typeProtos[r],t.uint32(122).fork()).ldelim();if(null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(160).int32(e.type),null!=e.refAttrName&&Object.hasOwnProperty.call(e,"refAttrName")&&t.uint32(170).string(e.refAttrName),null!=e.sparseTensor&&Object.hasOwnProperty.call(e,"sparseTensor")&&a.onnx.SparseTensorProto.encode(e.sparseTensor,t.uint32(178).fork()).ldelim(),null!=e.sparseTensors&&e.sparseTensors.length)for(r=0;r<e.sparseTensors.length;++r)a.onnx.SparseTensorProto.encode(e.sparseTensors[r],t.uint32(186).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.AttributeProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 21:i.refAttrName=e.string();break;case 13:i.docString=e.string();break;case 20:i.type=e.int32();break;case 2:i.f=e.float();break;case 3:i.i=e.int64();break;case 4:i.s=e.bytes();break;case 5:i.t=a.onnx.TensorProto.decode(e,e.uint32());break;case 6:i.g=a.onnx.GraphProto.decode(e,e.uint32());break;case 22:i.sparseTensor=a.onnx.SparseTensorProto.decode(e,e.uint32());break;case 14:i.tp=a.onnx.TypeProto.decode(e,e.uint32());break;case 7:if(i.floats&&i.floats.length||(i.floats=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.floats.push(e.float());else i.floats.push(e.float());break;case 8:if(i.ints&&i.ints.length||(i.ints=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.ints.push(e.int64());else i.ints.push(e.int64());break;case 9:i.strings&&i.strings.length||(i.strings=[]),i.strings.push(e.bytes());break;case 10:i.tensors&&i.tensors.length||(i.tensors=[]),i.tensors.push(a.onnx.TensorProto.decode(e,e.uint32()));break;case 11:i.graphs&&i.graphs.length||(i.graphs=[]),i.graphs.push(a.onnx.GraphProto.decode(e,e.uint32()));break;case 23:i.sparseTensors&&i.sparseTensors.length||(i.sparseTensors=[]),i.sparseTensors.push(a.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 15:i.typeProtos&&i.typeProtos.length||(i.typeProtos=[]),i.typeProtos.push(a.onnx.TypeProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&!o.isString(e.refAttrName))return"refAttrName: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:}if(null!=e.f&&e.hasOwnProperty("f")&&"number"!=typeof e.f)return"f: number expected";if(null!=e.i&&e.hasOwnProperty("i")&&!o.isInteger(e.i)&&!(e.i&&o.isInteger(e.i.low)&&o.isInteger(e.i.high)))return"i: integer|Long expected";if(null!=e.s&&e.hasOwnProperty("s")&&!(e.s&&"number"==typeof e.s.length||o.isString(e.s)))return"s: buffer expected";if(null!=e.t&&e.hasOwnProperty("t")&&(r=a.onnx.TensorProto.verify(e.t)))return"t."+r;if(null!=e.g&&e.hasOwnProperty("g")&&(r=a.onnx.GraphProto.verify(e.g)))return"g."+r;if(null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(r=a.onnx.SparseTensorProto.verify(e.sparseTensor)))return"sparseTensor."+r;if(null!=e.tp&&e.hasOwnProperty("tp")&&(r=a.onnx.TypeProto.verify(e.tp)))return"tp."+r;if(null!=e.floats&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var t=0;t<e.floats.length;++t)if("number"!=typeof e.floats[t])return"floats: number[] expected"}if(null!=e.ints&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(t=0;t<e.ints.length;++t)if(!(o.isInteger(e.ints[t])||e.ints[t]&&o.isInteger(e.ints[t].low)&&o.isInteger(e.ints[t].high)))return"ints: integer|Long[] expected"}if(null!=e.strings&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(t=0;t<e.strings.length;++t)if(!(e.strings[t]&&"number"==typeof e.strings[t].length||o.isString(e.strings[t])))return"strings: buffer[] expected"}if(null!=e.tensors&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(t=0;t<e.tensors.length;++t){if(r=a.onnx.TensorProto.verify(e.tensors[t]))return"tensors."+r}}if(null!=e.graphs&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(t=0;t<e.graphs.length;++t){if(r=a.onnx.GraphProto.verify(e.graphs[t]))return"graphs."+r}}if(null!=e.sparseTensors&&e.hasOwnProperty("sparseTensors")){if(!Array.isArray(e.sparseTensors))return"sparseTensors: array expected";for(t=0;t<e.sparseTensors.length;++t){if(r=a.onnx.SparseTensorProto.verify(e.sparseTensors[t]))return"sparseTensors."+r}}if(null!=e.typeProtos&&e.hasOwnProperty("typeProtos")){if(!Array.isArray(e.typeProtos))return"typeProtos: array expected";for(t=0;t<e.typeProtos.length;++t){var r;if(r=a.onnx.TypeProto.verify(e.typeProtos[t]))return"typeProtos."+r}}return null},e.fromObject=function(e){if(e instanceof a.onnx.AttributeProto)return e;var t=new a.onnx.AttributeProto;switch(null!=e.name&&(t.name=String(e.name)),null!=e.refAttrName&&(t.refAttrName=String(e.refAttrName)),null!=e.docString&&(t.docString=String(e.docString)),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"UNDEFINED":case 0:t.type=0;break;case"FLOAT":case 1:t.type=1;break;case"INT":case 2:t.type=2;break;case"STRING":case 3:t.type=3;break;case"TENSOR":case 4:t.type=4;break;case"GRAPH":case 5:t.type=5;break;case"SPARSE_TENSOR":case 11:t.type=11;break;case"TYPE_PROTO":case 13:t.type=13;break;case"FLOATS":case 6:t.type=6;break;case"INTS":case 7:t.type=7;break;case"STRINGS":case 8:t.type=8;break;case"TENSORS":case 9:t.type=9;break;case"GRAPHS":case 10:t.type=10;break;case"SPARSE_TENSORS":case 12:t.type=12;break;case"TYPE_PROTOS":case 14:t.type=14}if(null!=e.f&&(t.f=Number(e.f)),null!=e.i&&(o.Long?(t.i=o.Long.fromValue(e.i)).unsigned=!1:"string"==typeof e.i?t.i=parseInt(e.i,10):"number"==typeof e.i?t.i=e.i:"object"==typeof e.i&&(t.i=new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),null!=e.s&&("string"==typeof e.s?o.base64.decode(e.s,t.s=o.newBuffer(o.base64.length(e.s)),0):e.s.length>=0&&(t.s=e.s)),null!=e.t){if("object"!=typeof e.t)throw TypeError(".onnx.AttributeProto.t: object expected");t.t=a.onnx.TensorProto.fromObject(e.t)}if(null!=e.g){if("object"!=typeof e.g)throw TypeError(".onnx.AttributeProto.g: object expected");t.g=a.onnx.GraphProto.fromObject(e.g)}if(null!=e.sparseTensor){if("object"!=typeof e.sparseTensor)throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");t.sparseTensor=a.onnx.SparseTensorProto.fromObject(e.sparseTensor)}if(null!=e.tp){if("object"!=typeof e.tp)throw TypeError(".onnx.AttributeProto.tp: object expected");t.tp=a.onnx.TypeProto.fromObject(e.tp)}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");t.floats=[];for(var r=0;r<e.floats.length;++r)t.floats[r]=Number(e.floats[r])}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");t.ints=[];for(r=0;r<e.ints.length;++r)o.Long?(t.ints[r]=o.Long.fromValue(e.ints[r])).unsigned=!1:"string"==typeof e.ints[r]?t.ints[r]=parseInt(e.ints[r],10):"number"==typeof e.ints[r]?t.ints[r]=e.ints[r]:"object"==typeof e.ints[r]&&(t.ints[r]=new o.LongBits(e.ints[r].low>>>0,e.ints[r].high>>>0).toNumber())}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");t.strings=[];for(r=0;r<e.strings.length;++r)"string"==typeof e.strings[r]?o.base64.decode(e.strings[r],t.strings[r]=o.newBuffer(o.base64.length(e.strings[r])),0):e.strings[r].length>=0&&(t.strings[r]=e.strings[r])}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");t.tensors=[];for(r=0;r<e.tensors.length;++r){if("object"!=typeof e.tensors[r])throw TypeError(".onnx.AttributeProto.tensors: object expected");t.tensors[r]=a.onnx.TensorProto.fromObject(e.tensors[r])}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");t.graphs=[];for(r=0;r<e.graphs.length;++r){if("object"!=typeof e.graphs[r])throw TypeError(".onnx.AttributeProto.graphs: object expected");t.graphs[r]=a.onnx.GraphProto.fromObject(e.graphs[r])}}if(e.sparseTensors){if(!Array.isArray(e.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");t.sparseTensors=[];for(r=0;r<e.sparseTensors.length;++r){if("object"!=typeof e.sparseTensors[r])throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");t.sparseTensors[r]=a.onnx.SparseTensorProto.fromObject(e.sparseTensors[r])}}if(e.typeProtos){if(!Array.isArray(e.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");t.typeProtos=[];for(r=0;r<e.typeProtos.length;++r){if("object"!=typeof e.typeProtos[r])throw TypeError(".onnx.AttributeProto.typeProtos: object expected");t.typeProtos[r]=a.onnx.TypeProto.fromObject(e.typeProtos[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.floats=[],r.ints=[],r.strings=[],r.tensors=[],r.graphs=[],r.typeProtos=[],r.sparseTensors=[]),t.defaults){if(r.name="",r.f=0,o.Long){var n=new o.Long(0,0,!1);r.i=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.i=t.longs===String?"0":0;t.bytes===String?r.s="":(r.s=[],t.bytes!==Array&&(r.s=o.newBuffer(r.s))),r.t=null,r.g=null,r.docString="",r.tp=null,r.type=t.enums===String?"UNDEFINED":0,r.refAttrName="",r.sparseTensor=null}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.f&&e.hasOwnProperty("f")&&(r.f=t.json&&!isFinite(e.f)?String(e.f):e.f),null!=e.i&&e.hasOwnProperty("i")&&("number"==typeof e.i?r.i=t.longs===String?String(e.i):e.i:r.i=t.longs===String?o.Long.prototype.toString.call(e.i):t.longs===Number?new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),null!=e.s&&e.hasOwnProperty("s")&&(r.s=t.bytes===String?o.base64.encode(e.s,0,e.s.length):t.bytes===Array?Array.prototype.slice.call(e.s):e.s),null!=e.t&&e.hasOwnProperty("t")&&(r.t=a.onnx.TensorProto.toObject(e.t,t)),null!=e.g&&e.hasOwnProperty("g")&&(r.g=a.onnx.GraphProto.toObject(e.g,t)),e.floats&&e.floats.length){r.floats=[];for(var i=0;i<e.floats.length;++i)r.floats[i]=t.json&&!isFinite(e.floats[i])?String(e.floats[i]):e.floats[i]}if(e.ints&&e.ints.length){r.ints=[];for(i=0;i<e.ints.length;++i)"number"==typeof e.ints[i]?r.ints[i]=t.longs===String?String(e.ints[i]):e.ints[i]:r.ints[i]=t.longs===String?o.Long.prototype.toString.call(e.ints[i]):t.longs===Number?new o.LongBits(e.ints[i].low>>>0,e.ints[i].high>>>0).toNumber():e.ints[i]}if(e.strings&&e.strings.length){r.strings=[];for(i=0;i<e.strings.length;++i)r.strings[i]=t.bytes===String?o.base64.encode(e.strings[i],0,e.strings[i].length):t.bytes===Array?Array.prototype.slice.call(e.strings[i]):e.strings[i]}if(e.tensors&&e.tensors.length){r.tensors=[];for(i=0;i<e.tensors.length;++i)r.tensors[i]=a.onnx.TensorProto.toObject(e.tensors[i],t)}if(e.graphs&&e.graphs.length){r.graphs=[];for(i=0;i<e.graphs.length;++i)r.graphs[i]=a.onnx.GraphProto.toObject(e.graphs[i],t)}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.tp&&e.hasOwnProperty("tp")&&(r.tp=a.onnx.TypeProto.toObject(e.tp,t)),e.typeProtos&&e.typeProtos.length){r.typeProtos=[];for(i=0;i<e.typeProtos.length;++i)r.typeProtos[i]=a.onnx.TypeProto.toObject(e.typeProtos[i],t)}if(null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===a.onnx.AttributeProto.AttributeType[e.type]?e.type:a.onnx.AttributeProto.AttributeType[e.type]:e.type),null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&(r.refAttrName=e.refAttrName),null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(r.sparseTensor=a.onnx.SparseTensorProto.toObject(e.sparseTensor,t)),e.sparseTensors&&e.sparseTensors.length){r.sparseTensors=[];for(i=0;i<e.sparseTensors.length;++i)r.sparseTensors[i]=a.onnx.SparseTensorProto.toObject(e.sparseTensors[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.AttributeProto"},e.AttributeType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t[e[3]="STRING"]=3,t[e[4]="TENSOR"]=4,t[e[5]="GRAPH"]=5,t[e[11]="SPARSE_TENSOR"]=11,t[e[13]="TYPE_PROTO"]=13,t[e[6]="FLOATS"]=6,t[e[7]="INTS"]=7,t[e[8]="STRINGS"]=8,t[e[9]="TENSORS"]=9,t[e[10]="GRAPHS"]=10,t[e[12]="SPARSE_TENSORS"]=12,t[e[14]="TYPE_PROTOS"]=14,t}(),e}(),s.ValueInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.type=null,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&a.onnx.TypeProto.encode(e.type,t.uint32(18).fork()).ldelim(),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(26).string(e.docString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.ValueInfoProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 2:i.type=a.onnx.TypeProto.decode(e,e.uint32());break;case 3:i.docString=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type")){var t=a.onnx.TypeProto.verify(e.type);if(t)return"type."+t}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.ValueInfoProto)return e;var t=new a.onnx.ValueInfoProto;if(null!=e.name&&(t.name=String(e.name)),null!=e.type){if("object"!=typeof e.type)throw TypeError(".onnx.ValueInfoProto.type: object expected");t.type=a.onnx.TypeProto.fromObject(e.type)}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.name="",r.type=null,r.docString=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(r.type=a.onnx.TypeProto.toObject(e.type,t)),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ValueInfoProto"},e}(),s.NodeProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.name="",e.prototype.opType="",e.prototype.domain="",e.prototype.attribute=o.emptyArray,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.input&&e.input.length)for(var r=0;r<e.input.length;++r)t.uint32(10).string(e.input[r]);if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)t.uint32(18).string(e.output[r]);if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(26).string(e.name),null!=e.opType&&Object.hasOwnProperty.call(e,"opType")&&t.uint32(34).string(e.opType),null!=e.attribute&&e.attribute.length)for(r=0;r<e.attribute.length;++r)a.onnx.AttributeProto.encode(e.attribute[r],t.uint32(42).fork()).ldelim();return null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(58).string(e.domain),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.NodeProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.input&&i.input.length||(i.input=[]),i.input.push(e.string());break;case 2:i.output&&i.output.length||(i.output=[]),i.output.push(e.string());break;case 3:i.name=e.string();break;case 4:i.opType=e.string();break;case 7:i.domain=e.string();break;case 5:i.attribute&&i.attribute.length||(i.attribute=[]),i.attribute.push(a.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:i.docString=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.opType&&e.hasOwnProperty("opType")&&!o.isString(e.opType))return"opType: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t){var r=a.onnx.AttributeProto.verify(e.attribute[t]);if(r)return"attribute."+r}}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.NodeProto)return e;var t=new a.onnx.NodeProto;if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");t.input=[];for(var r=0;r<e.input.length;++r)t.input[r]=String(e.input[r])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");t.output=[];for(r=0;r<e.output.length;++r)t.output[r]=String(e.output[r])}if(null!=e.name&&(t.name=String(e.name)),null!=e.opType&&(t.opType=String(e.opType)),null!=e.domain&&(t.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");t.attribute=[];for(r=0;r<e.attribute.length;++r){if("object"!=typeof e.attribute[r])throw TypeError(".onnx.NodeProto.attribute: object expected");t.attribute[r]=a.onnx.AttributeProto.fromObject(e.attribute[r])}}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.input=[],r.output=[],r.attribute=[]),t.defaults&&(r.name="",r.opType="",r.docString="",r.domain=""),e.input&&e.input.length){r.input=[];for(var n=0;n<e.input.length;++n)r.input[n]=e.input[n]}if(e.output&&e.output.length){r.output=[];for(n=0;n<e.output.length;++n)r.output[n]=e.output[n]}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.opType&&e.hasOwnProperty("opType")&&(r.opType=e.opType),e.attribute&&e.attribute.length){r.attribute=[];for(n=0;n<e.attribute.length;++n)r.attribute[n]=a.onnx.AttributeProto.toObject(e.attribute[n],t)}return null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.NodeProto"},e}(),s.TrainingInfoProto=function(){function e(e){if(this.initializationBinding=[],this.updateBinding=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.initialization=null,e.prototype.algorithm=null,e.prototype.initializationBinding=o.emptyArray,e.prototype.updateBinding=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.initialization&&Object.hasOwnProperty.call(e,"initialization")&&a.onnx.GraphProto.encode(e.initialization,t.uint32(10).fork()).ldelim(),null!=e.algorithm&&Object.hasOwnProperty.call(e,"algorithm")&&a.onnx.GraphProto.encode(e.algorithm,t.uint32(18).fork()).ldelim(),null!=e.initializationBinding&&e.initializationBinding.length)for(var r=0;r<e.initializationBinding.length;++r)a.onnx.StringStringEntryProto.encode(e.initializationBinding[r],t.uint32(26).fork()).ldelim();if(null!=e.updateBinding&&e.updateBinding.length)for(r=0;r<e.updateBinding.length;++r)a.onnx.StringStringEntryProto.encode(e.updateBinding[r],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TrainingInfoProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.initialization=a.onnx.GraphProto.decode(e,e.uint32());break;case 2:i.algorithm=a.onnx.GraphProto.decode(e,e.uint32());break;case 3:i.initializationBinding&&i.initializationBinding.length||(i.initializationBinding=[]),i.initializationBinding.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 4:i.updateBinding&&i.updateBinding.length||(i.updateBinding=[]),i.updateBinding.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.initialization&&e.hasOwnProperty("initialization")&&(r=a.onnx.GraphProto.verify(e.initialization)))return"initialization."+r;if(null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(r=a.onnx.GraphProto.verify(e.algorithm)))return"algorithm."+r;if(null!=e.initializationBinding&&e.hasOwnProperty("initializationBinding")){if(!Array.isArray(e.initializationBinding))return"initializationBinding: array expected";for(var t=0;t<e.initializationBinding.length;++t){if(r=a.onnx.StringStringEntryProto.verify(e.initializationBinding[t]))return"initializationBinding."+r}}if(null!=e.updateBinding&&e.hasOwnProperty("updateBinding")){if(!Array.isArray(e.updateBinding))return"updateBinding: array expected";for(t=0;t<e.updateBinding.length;++t){var r;if(r=a.onnx.StringStringEntryProto.verify(e.updateBinding[t]))return"updateBinding."+r}}return null},e.fromObject=function(e){if(e instanceof a.onnx.TrainingInfoProto)return e;var t=new a.onnx.TrainingInfoProto;if(null!=e.initialization){if("object"!=typeof e.initialization)throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");t.initialization=a.onnx.GraphProto.fromObject(e.initialization)}if(null!=e.algorithm){if("object"!=typeof e.algorithm)throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");t.algorithm=a.onnx.GraphProto.fromObject(e.algorithm)}if(e.initializationBinding){if(!Array.isArray(e.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");t.initializationBinding=[];for(var r=0;r<e.initializationBinding.length;++r){if("object"!=typeof e.initializationBinding[r])throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");t.initializationBinding[r]=a.onnx.StringStringEntryProto.fromObject(e.initializationBinding[r])}}if(e.updateBinding){if(!Array.isArray(e.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");t.updateBinding=[];for(r=0;r<e.updateBinding.length;++r){if("object"!=typeof e.updateBinding[r])throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");t.updateBinding[r]=a.onnx.StringStringEntryProto.fromObject(e.updateBinding[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.initializationBinding=[],r.updateBinding=[]),t.defaults&&(r.initialization=null,r.algorithm=null),null!=e.initialization&&e.hasOwnProperty("initialization")&&(r.initialization=a.onnx.GraphProto.toObject(e.initialization,t)),null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(r.algorithm=a.onnx.GraphProto.toObject(e.algorithm,t)),e.initializationBinding&&e.initializationBinding.length){r.initializationBinding=[];for(var n=0;n<e.initializationBinding.length;++n)r.initializationBinding[n]=a.onnx.StringStringEntryProto.toObject(e.initializationBinding[n],t)}if(e.updateBinding&&e.updateBinding.length){r.updateBinding=[];for(n=0;n<e.updateBinding.length;++n)r.updateBinding[n]=a.onnx.StringStringEntryProto.toObject(e.updateBinding[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TrainingInfoProto"},e}(),s.ModelProto=function(){function e(e){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.irVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.opsetImport=o.emptyArray,e.prototype.producerName="",e.prototype.producerVersion="",e.prototype.domain="",e.prototype.modelVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.docString="",e.prototype.graph=null,e.prototype.metadataProps=o.emptyArray,e.prototype.trainingInfo=o.emptyArray,e.prototype.functions=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.irVersion&&Object.hasOwnProperty.call(e,"irVersion")&&t.uint32(8).int64(e.irVersion),null!=e.producerName&&Object.hasOwnProperty.call(e,"producerName")&&t.uint32(18).string(e.producerName),null!=e.producerVersion&&Object.hasOwnProperty.call(e,"producerVersion")&&t.uint32(26).string(e.producerVersion),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(34).string(e.domain),null!=e.modelVersion&&Object.hasOwnProperty.call(e,"modelVersion")&&t.uint32(40).int64(e.modelVersion),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.graph&&Object.hasOwnProperty.call(e,"graph")&&a.onnx.GraphProto.encode(e.graph,t.uint32(58).fork()).ldelim(),null!=e.opsetImport&&e.opsetImport.length)for(var r=0;r<e.opsetImport.length;++r)a.onnx.OperatorSetIdProto.encode(e.opsetImport[r],t.uint32(66).fork()).ldelim();if(null!=e.metadataProps&&e.metadataProps.length)for(r=0;r<e.metadataProps.length;++r)a.onnx.StringStringEntryProto.encode(e.metadataProps[r],t.uint32(114).fork()).ldelim();if(null!=e.trainingInfo&&e.trainingInfo.length)for(r=0;r<e.trainingInfo.length;++r)a.onnx.TrainingInfoProto.encode(e.trainingInfo[r],t.uint32(162).fork()).ldelim();if(null!=e.functions&&e.functions.length)for(r=0;r<e.functions.length;++r)a.onnx.FunctionProto.encode(e.functions[r],t.uint32(202).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.ModelProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.irVersion=e.int64();break;case 8:i.opsetImport&&i.opsetImport.length||(i.opsetImport=[]),i.opsetImport.push(a.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:i.producerName=e.string();break;case 3:i.producerVersion=e.string();break;case 4:i.domain=e.string();break;case 5:i.modelVersion=e.int64();break;case 6:i.docString=e.string();break;case 7:i.graph=a.onnx.GraphProto.decode(e,e.uint32());break;case 14:i.metadataProps&&i.metadataProps.length||(i.metadataProps=[]),i.metadataProps.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 20:i.trainingInfo&&i.trainingInfo.length||(i.trainingInfo=[]),i.trainingInfo.push(a.onnx.TrainingInfoProto.decode(e,e.uint32()));break;case 25:i.functions&&i.functions.length||(i.functions=[]),i.functions.push(a.onnx.FunctionProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&!o.isInteger(e.irVersion)&&!(e.irVersion&&o.isInteger(e.irVersion.low)&&o.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var t=0;t<e.opsetImport.length;++t){if(r=a.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+r}}if(null!=e.producerName&&e.hasOwnProperty("producerName")&&!o.isString(e.producerName))return"producerName: string expected";if(null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&!o.isString(e.producerVersion))return"producerVersion: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&!o.isInteger(e.modelVersion)&&!(e.modelVersion&&o.isInteger(e.modelVersion.low)&&o.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.graph&&e.hasOwnProperty("graph")&&(r=a.onnx.GraphProto.verify(e.graph)))return"graph."+r;if(null!=e.metadataProps&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(t=0;t<e.metadataProps.length;++t){if(r=a.onnx.StringStringEntryProto.verify(e.metadataProps[t]))return"metadataProps."+r}}if(null!=e.trainingInfo&&e.hasOwnProperty("trainingInfo")){if(!Array.isArray(e.trainingInfo))return"trainingInfo: array expected";for(t=0;t<e.trainingInfo.length;++t){if(r=a.onnx.TrainingInfoProto.verify(e.trainingInfo[t]))return"trainingInfo."+r}}if(null!=e.functions&&e.hasOwnProperty("functions")){if(!Array.isArray(e.functions))return"functions: array expected";for(t=0;t<e.functions.length;++t){var r;if(r=a.onnx.FunctionProto.verify(e.functions[t]))return"functions."+r}}return null},e.fromObject=function(e){if(e instanceof a.onnx.ModelProto)return e;var t=new a.onnx.ModelProto;if(null!=e.irVersion&&(o.Long?(t.irVersion=o.Long.fromValue(e.irVersion)).unsigned=!1:"string"==typeof e.irVersion?t.irVersion=parseInt(e.irVersion,10):"number"==typeof e.irVersion?t.irVersion=e.irVersion:"object"==typeof e.irVersion&&(t.irVersion=new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");t.opsetImport=[];for(var r=0;r<e.opsetImport.length;++r){if("object"!=typeof e.opsetImport[r])throw TypeError(".onnx.ModelProto.opsetImport: object expected");t.opsetImport[r]=a.onnx.OperatorSetIdProto.fromObject(e.opsetImport[r])}}if(null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.producerVersion&&(t.producerVersion=String(e.producerVersion)),null!=e.domain&&(t.domain=String(e.domain)),null!=e.modelVersion&&(o.Long?(t.modelVersion=o.Long.fromValue(e.modelVersion)).unsigned=!1:"string"==typeof e.modelVersion?t.modelVersion=parseInt(e.modelVersion,10):"number"==typeof e.modelVersion?t.modelVersion=e.modelVersion:"object"==typeof e.modelVersion&&(t.modelVersion=new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),null!=e.docString&&(t.docString=String(e.docString)),null!=e.graph){if("object"!=typeof e.graph)throw TypeError(".onnx.ModelProto.graph: object expected");t.graph=a.onnx.GraphProto.fromObject(e.graph)}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");t.metadataProps=[];for(r=0;r<e.metadataProps.length;++r){if("object"!=typeof e.metadataProps[r])throw TypeError(".onnx.ModelProto.metadataProps: object expected");t.metadataProps[r]=a.onnx.StringStringEntryProto.fromObject(e.metadataProps[r])}}if(e.trainingInfo){if(!Array.isArray(e.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");t.trainingInfo=[];for(r=0;r<e.trainingInfo.length;++r){if("object"!=typeof e.trainingInfo[r])throw TypeError(".onnx.ModelProto.trainingInfo: object expected");t.trainingInfo[r]=a.onnx.TrainingInfoProto.fromObject(e.trainingInfo[r])}}if(e.functions){if(!Array.isArray(e.functions))throw TypeError(".onnx.ModelProto.functions: array expected");t.functions=[];for(r=0;r<e.functions.length;++r){if("object"!=typeof e.functions[r])throw TypeError(".onnx.ModelProto.functions: object expected");t.functions[r]=a.onnx.FunctionProto.fromObject(e.functions[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.opsetImport=[],r.metadataProps=[],r.trainingInfo=[],r.functions=[]),t.defaults){if(o.Long){var n=new o.Long(0,0,!1);r.irVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.irVersion=t.longs===String?"0":0;if(r.producerName="",r.producerVersion="",r.domain="",o.Long){n=new o.Long(0,0,!1);r.modelVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.modelVersion=t.longs===String?"0":0;r.docString="",r.graph=null}if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&("number"==typeof e.irVersion?r.irVersion=t.longs===String?String(e.irVersion):e.irVersion:r.irVersion=t.longs===String?o.Long.prototype.toString.call(e.irVersion):t.longs===Number?new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),null!=e.producerName&&e.hasOwnProperty("producerName")&&(r.producerName=e.producerName),null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&(r.producerVersion=e.producerVersion),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&("number"==typeof e.modelVersion?r.modelVersion=t.longs===String?String(e.modelVersion):e.modelVersion:r.modelVersion=t.longs===String?o.Long.prototype.toString.call(e.modelVersion):t.longs===Number?new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.graph&&e.hasOwnProperty("graph")&&(r.graph=a.onnx.GraphProto.toObject(e.graph,t)),e.opsetImport&&e.opsetImport.length){r.opsetImport=[];for(var i=0;i<e.opsetImport.length;++i)r.opsetImport[i]=a.onnx.OperatorSetIdProto.toObject(e.opsetImport[i],t)}if(e.metadataProps&&e.metadataProps.length){r.metadataProps=[];for(i=0;i<e.metadataProps.length;++i)r.metadataProps[i]=a.onnx.StringStringEntryProto.toObject(e.metadataProps[i],t)}if(e.trainingInfo&&e.trainingInfo.length){r.trainingInfo=[];for(i=0;i<e.trainingInfo.length;++i)r.trainingInfo[i]=a.onnx.TrainingInfoProto.toObject(e.trainingInfo[i],t)}if(e.functions&&e.functions.length){r.functions=[];for(i=0;i<e.functions.length;++i)r.functions[i]=a.onnx.FunctionProto.toObject(e.functions[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ModelProto"},e}(),s.StringStringEntryProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.StringStringEntryProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.key=e.string();break;case 2:i.value=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!o.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!o.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.StringStringEntryProto)return e;var t=new a.onnx.StringStringEntryProto;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",r.value=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.StringStringEntryProto"},e}(),s.TensorAnnotation=function(){function e(e){if(this.quantParameterTensorNames=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.tensorName="",e.prototype.quantParameterTensorNames=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.tensorName&&Object.hasOwnProperty.call(e,"tensorName")&&t.uint32(10).string(e.tensorName),null!=e.quantParameterTensorNames&&e.quantParameterTensorNames.length)for(var r=0;r<e.quantParameterTensorNames.length;++r)a.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[r],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorAnnotation;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.tensorName=e.string();break;case 2:i.quantParameterTensorNames&&i.quantParameterTensorNames.length||(i.quantParameterTensorNames=[]),i.quantParameterTensorNames.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.tensorName&&e.hasOwnProperty("tensorName")&&!o.isString(e.tensorName))return"tensorName: string expected";if(null!=e.quantParameterTensorNames&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var t=0;t<e.quantParameterTensorNames.length;++t){var r=a.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[t]);if(r)return"quantParameterTensorNames."+r}}return null},e.fromObject=function(e){if(e instanceof a.onnx.TensorAnnotation)return e;var t=new a.onnx.TensorAnnotation;if(null!=e.tensorName&&(t.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");t.quantParameterTensorNames=[];for(var r=0;r<e.quantParameterTensorNames.length;++r){if("object"!=typeof e.quantParameterTensorNames[r])throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");t.quantParameterTensorNames[r]=a.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.quantParameterTensorNames=[]),t.defaults&&(r.tensorName=""),null!=e.tensorName&&e.hasOwnProperty("tensorName")&&(r.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){r.quantParameterTensorNames=[];for(var n=0;n<e.quantParameterTensorNames.length;++n)r.quantParameterTensorNames[n]=a.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorAnnotation"},e}(),s.GraphProto=function(){function e(e){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.node=o.emptyArray,e.prototype.name="",e.prototype.initializer=o.emptyArray,e.prototype.sparseInitializer=o.emptyArray,e.prototype.docString="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.valueInfo=o.emptyArray,e.prototype.quantizationAnnotation=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.node&&e.node.length)for(var r=0;r<e.node.length;++r)a.onnx.NodeProto.encode(e.node[r],t.uint32(10).fork()).ldelim();if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.initializer&&e.initializer.length)for(r=0;r<e.initializer.length;++r)a.onnx.TensorProto.encode(e.initializer[r],t.uint32(42).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(82).string(e.docString),null!=e.input&&e.input.length)for(r=0;r<e.input.length;++r)a.onnx.ValueInfoProto.encode(e.input[r],t.uint32(90).fork()).ldelim();if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)a.onnx.ValueInfoProto.encode(e.output[r],t.uint32(98).fork()).ldelim();if(null!=e.valueInfo&&e.valueInfo.length)for(r=0;r<e.valueInfo.length;++r)a.onnx.ValueInfoProto.encode(e.valueInfo[r],t.uint32(106).fork()).ldelim();if(null!=e.quantizationAnnotation&&e.quantizationAnnotation.length)for(r=0;r<e.quantizationAnnotation.length;++r)a.onnx.TensorAnnotation.encode(e.quantizationAnnotation[r],t.uint32(114).fork()).ldelim();if(null!=e.sparseInitializer&&e.sparseInitializer.length)for(r=0;r<e.sparseInitializer.length;++r)a.onnx.SparseTensorProto.encode(e.sparseInitializer[r],t.uint32(122).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.GraphProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.node&&i.node.length||(i.node=[]),i.node.push(a.onnx.NodeProto.decode(e,e.uint32()));break;case 2:i.name=e.string();break;case 5:i.initializer&&i.initializer.length||(i.initializer=[]),i.initializer.push(a.onnx.TensorProto.decode(e,e.uint32()));break;case 15:i.sparseInitializer&&i.sparseInitializer.length||(i.sparseInitializer=[]),i.sparseInitializer.push(a.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 10:i.docString=e.string();break;case 11:i.input&&i.input.length||(i.input=[]),i.input.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:i.output&&i.output.length||(i.output=[]),i.output.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:i.valueInfo&&i.valueInfo.length||(i.valueInfo=[]),i.valueInfo.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:i.quantizationAnnotation&&i.quantizationAnnotation.length||(i.quantizationAnnotation=[]),i.quantizationAnnotation.push(a.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var t=0;t<e.node.length;++t){if(r=a.onnx.NodeProto.verify(e.node[t]))return"node."+r}}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.initializer&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(t=0;t<e.initializer.length;++t){if(r=a.onnx.TensorProto.verify(e.initializer[t]))return"initializer."+r}}if(null!=e.sparseInitializer&&e.hasOwnProperty("sparseInitializer")){if(!Array.isArray(e.sparseInitializer))return"sparseInitializer: array expected";for(t=0;t<e.sparseInitializer.length;++t){if(r=a.onnx.SparseTensorProto.verify(e.sparseInitializer[t]))return"sparseInitializer."+r}}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(t=0;t<e.input.length;++t){if(r=a.onnx.ValueInfoProto.verify(e.input[t]))return"input."+r}}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t){if(r=a.onnx.ValueInfoProto.verify(e.output[t]))return"output."+r}}if(null!=e.valueInfo&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(t=0;t<e.valueInfo.length;++t){if(r=a.onnx.ValueInfoProto.verify(e.valueInfo[t]))return"valueInfo."+r}}if(null!=e.quantizationAnnotation&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(t=0;t<e.quantizationAnnotation.length;++t){var r;if(r=a.onnx.TensorAnnotation.verify(e.quantizationAnnotation[t]))return"quantizationAnnotation."+r}}return null},e.fromObject=function(e){if(e instanceof a.onnx.GraphProto)return e;var t=new a.onnx.GraphProto;if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");t.node=[];for(var r=0;r<e.node.length;++r){if("object"!=typeof e.node[r])throw TypeError(".onnx.GraphProto.node: object expected");t.node[r]=a.onnx.NodeProto.fromObject(e.node[r])}}if(null!=e.name&&(t.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");t.initializer=[];for(r=0;r<e.initializer.length;++r){if("object"!=typeof e.initializer[r])throw TypeError(".onnx.GraphProto.initializer: object expected");t.initializer[r]=a.onnx.TensorProto.fromObject(e.initializer[r])}}if(e.sparseInitializer){if(!Array.isArray(e.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");t.sparseInitializer=[];for(r=0;r<e.sparseInitializer.length;++r){if("object"!=typeof e.sparseInitializer[r])throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");t.sparseInitializer[r]=a.onnx.SparseTensorProto.fromObject(e.sparseInitializer[r])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");t.input=[];for(r=0;r<e.input.length;++r){if("object"!=typeof e.input[r])throw TypeError(".onnx.GraphProto.input: object expected");t.input[r]=a.onnx.ValueInfoProto.fromObject(e.input[r])}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");t.output=[];for(r=0;r<e.output.length;++r){if("object"!=typeof e.output[r])throw TypeError(".onnx.GraphProto.output: object expected");t.output[r]=a.onnx.ValueInfoProto.fromObject(e.output[r])}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");t.valueInfo=[];for(r=0;r<e.valueInfo.length;++r){if("object"!=typeof e.valueInfo[r])throw TypeError(".onnx.GraphProto.valueInfo: object expected");t.valueInfo[r]=a.onnx.ValueInfoProto.fromObject(e.valueInfo[r])}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");t.quantizationAnnotation=[];for(r=0;r<e.quantizationAnnotation.length;++r){if("object"!=typeof e.quantizationAnnotation[r])throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");t.quantizationAnnotation[r]=a.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.node=[],r.initializer=[],r.input=[],r.output=[],r.valueInfo=[],r.quantizationAnnotation=[],r.sparseInitializer=[]),t.defaults&&(r.name="",r.docString=""),e.node&&e.node.length){r.node=[];for(var n=0;n<e.node.length;++n)r.node[n]=a.onnx.NodeProto.toObject(e.node[n],t)}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.initializer&&e.initializer.length){r.initializer=[];for(n=0;n<e.initializer.length;++n)r.initializer[n]=a.onnx.TensorProto.toObject(e.initializer[n],t)}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.input&&e.input.length){r.input=[];for(n=0;n<e.input.length;++n)r.input[n]=a.onnx.ValueInfoProto.toObject(e.input[n],t)}if(e.output&&e.output.length){r.output=[];for(n=0;n<e.output.length;++n)r.output[n]=a.onnx.ValueInfoProto.toObject(e.output[n],t)}if(e.valueInfo&&e.valueInfo.length){r.valueInfo=[];for(n=0;n<e.valueInfo.length;++n)r.valueInfo[n]=a.onnx.ValueInfoProto.toObject(e.valueInfo[n],t)}if(e.quantizationAnnotation&&e.quantizationAnnotation.length){r.quantizationAnnotation=[];for(n=0;n<e.quantizationAnnotation.length;++n)r.quantizationAnnotation[n]=a.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[n],t)}if(e.sparseInitializer&&e.sparseInitializer.length){r.sparseInitializer=[];for(n=0;n<e.sparseInitializer.length;++n)r.sparseInitializer[n]=a.onnx.SparseTensorProto.toObject(e.sparseInitializer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.GraphProto"},e}(),s.TensorProto=function(){function e(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.dims=o.emptyArray,e.prototype.dataType=0,e.prototype.segment=null,e.prototype.floatData=o.emptyArray,e.prototype.int32Data=o.emptyArray,e.prototype.stringData=o.emptyArray,e.prototype.int64Data=o.emptyArray,e.prototype.name="",e.prototype.docString="",e.prototype.rawData=o.newBuffer([]),e.prototype.externalData=o.emptyArray,e.prototype.dataLocation=0,e.prototype.doubleData=o.emptyArray,e.prototype.uint64Data=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.dims&&e.dims.length){t.uint32(10).fork();for(var r=0;r<e.dims.length;++r)t.int64(e.dims[r]);t.ldelim()}if(null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.segment&&Object.hasOwnProperty.call(e,"segment")&&a.onnx.TensorProto.Segment.encode(e.segment,t.uint32(26).fork()).ldelim(),null!=e.floatData&&e.floatData.length){t.uint32(34).fork();for(r=0;r<e.floatData.length;++r)t.float(e.floatData[r]);t.ldelim()}if(null!=e.int32Data&&e.int32Data.length){t.uint32(42).fork();for(r=0;r<e.int32Data.length;++r)t.int32(e.int32Data[r]);t.ldelim()}if(null!=e.stringData&&e.stringData.length)for(r=0;r<e.stringData.length;++r)t.uint32(50).bytes(e.stringData[r]);if(null!=e.int64Data&&e.int64Data.length){t.uint32(58).fork();for(r=0;r<e.int64Data.length;++r)t.int64(e.int64Data[r]);t.ldelim()}if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(66).string(e.name),null!=e.rawData&&Object.hasOwnProperty.call(e,"rawData")&&t.uint32(74).bytes(e.rawData),null!=e.doubleData&&e.doubleData.length){t.uint32(82).fork();for(r=0;r<e.doubleData.length;++r)t.double(e.doubleData[r]);t.ldelim()}if(null!=e.uint64Data&&e.uint64Data.length){t.uint32(90).fork();for(r=0;r<e.uint64Data.length;++r)t.uint64(e.uint64Data[r]);t.ldelim()}if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(98).string(e.docString),null!=e.externalData&&e.externalData.length)for(r=0;r<e.externalData.length;++r)a.onnx.StringStringEntryProto.encode(e.externalData[r],t.uint32(106).fork()).ldelim();return null!=e.dataLocation&&Object.hasOwnProperty.call(e,"dataLocation")&&t.uint32(112).int32(e.dataLocation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:if(i.dims&&i.dims.length||(i.dims=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.dims.push(e.int64());else i.dims.push(e.int64());break;case 2:i.dataType=e.int32();break;case 3:i.segment=a.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(i.floatData&&i.floatData.length||(i.floatData=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.floatData.push(e.float());else i.floatData.push(e.float());break;case 5:if(i.int32Data&&i.int32Data.length||(i.int32Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.int32Data.push(e.int32());else i.int32Data.push(e.int32());break;case 6:i.stringData&&i.stringData.length||(i.stringData=[]),i.stringData.push(e.bytes());break;case 7:if(i.int64Data&&i.int64Data.length||(i.int64Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.int64Data.push(e.int64());else i.int64Data.push(e.int64());break;case 8:i.name=e.string();break;case 12:i.docString=e.string();break;case 9:i.rawData=e.bytes();break;case 13:i.externalData&&i.externalData.length||(i.externalData=[]),i.externalData.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:i.dataLocation=e.int32();break;case 10:if(i.doubleData&&i.doubleData.length||(i.doubleData=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.doubleData.push(e.double());else i.doubleData.push(e.double());break;case 11:if(i.uint64Data&&i.uint64Data.length||(i.uint64Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.uint64Data.push(e.uint64());else i.uint64Data.push(e.uint64());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var t=0;t<e.dims.length;++t)if(!(o.isInteger(e.dims[t])||e.dims[t]&&o.isInteger(e.dims[t].low)&&o.isInteger(e.dims[t].high)))return"dims: integer|Long[] expected"}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&!o.isInteger(e.dataType))return"dataType: integer expected";if(null!=e.segment&&e.hasOwnProperty("segment")&&(r=a.onnx.TensorProto.Segment.verify(e.segment)))return"segment."+r;if(null!=e.floatData&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(t=0;t<e.floatData.length;++t)if("number"!=typeof e.floatData[t])return"floatData: number[] expected"}if(null!=e.int32Data&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(t=0;t<e.int32Data.length;++t)if(!o.isInteger(e.int32Data[t]))return"int32Data: integer[] expected"}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(t=0;t<e.stringData.length;++t)if(!(e.stringData[t]&&"number"==typeof e.stringData[t].length||o.isString(e.stringData[t])))return"stringData: buffer[] expected"}if(null!=e.int64Data&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(t=0;t<e.int64Data.length;++t)if(!(o.isInteger(e.int64Data[t])||e.int64Data[t]&&o.isInteger(e.int64Data[t].low)&&o.isInteger(e.int64Data[t].high)))return"int64Data: integer|Long[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.rawData&&e.hasOwnProperty("rawData")&&!(e.rawData&&"number"==typeof e.rawData.length||o.isString(e.rawData)))return"rawData: buffer expected";if(null!=e.externalData&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(t=0;t<e.externalData.length;++t){var r;if(r=a.onnx.StringStringEntryProto.verify(e.externalData[t]))return"externalData."+r}}if(null!=e.dataLocation&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(null!=e.doubleData&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(t=0;t<e.doubleData.length;++t)if("number"!=typeof e.doubleData[t])return"doubleData: number[] expected"}if(null!=e.uint64Data&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(t=0;t<e.uint64Data.length;++t)if(!(o.isInteger(e.uint64Data[t])||e.uint64Data[t]&&o.isInteger(e.uint64Data[t].low)&&o.isInteger(e.uint64Data[t].high)))return"uint64Data: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof a.onnx.TensorProto)return e;var t=new a.onnx.TensorProto;if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");t.dims=[];for(var r=0;r<e.dims.length;++r)o.Long?(t.dims[r]=o.Long.fromValue(e.dims[r])).unsigned=!1:"string"==typeof e.dims[r]?t.dims[r]=parseInt(e.dims[r],10):"number"==typeof e.dims[r]?t.dims[r]=e.dims[r]:"object"==typeof e.dims[r]&&(t.dims[r]=new o.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber())}if(null!=e.dataType&&(t.dataType=0|e.dataType),null!=e.segment){if("object"!=typeof e.segment)throw TypeError(".onnx.TensorProto.segment: object expected");t.segment=a.onnx.TensorProto.Segment.fromObject(e.segment)}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");t.floatData=[];for(r=0;r<e.floatData.length;++r)t.floatData[r]=Number(e.floatData[r])}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");t.int32Data=[];for(r=0;r<e.int32Data.length;++r)t.int32Data[r]=0|e.int32Data[r]}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");t.stringData=[];for(r=0;r<e.stringData.length;++r)"string"==typeof e.stringData[r]?o.base64.decode(e.stringData[r],t.stringData[r]=o.newBuffer(o.base64.length(e.stringData[r])),0):e.stringData[r].length>=0&&(t.stringData[r]=e.stringData[r])}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");t.int64Data=[];for(r=0;r<e.int64Data.length;++r)o.Long?(t.int64Data[r]=o.Long.fromValue(e.int64Data[r])).unsigned=!1:"string"==typeof e.int64Data[r]?t.int64Data[r]=parseInt(e.int64Data[r],10):"number"==typeof e.int64Data[r]?t.int64Data[r]=e.int64Data[r]:"object"==typeof e.int64Data[r]&&(t.int64Data[r]=new o.LongBits(e.int64Data[r].low>>>0,e.int64Data[r].high>>>0).toNumber())}if(null!=e.name&&(t.name=String(e.name)),null!=e.docString&&(t.docString=String(e.docString)),null!=e.rawData&&("string"==typeof e.rawData?o.base64.decode(e.rawData,t.rawData=o.newBuffer(o.base64.length(e.rawData)),0):e.rawData.length>=0&&(t.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");t.externalData=[];for(r=0;r<e.externalData.length;++r){if("object"!=typeof e.externalData[r])throw TypeError(".onnx.TensorProto.externalData: object expected");t.externalData[r]=a.onnx.StringStringEntryProto.fromObject(e.externalData[r])}}switch(e.dataLocation){default:if("number"==typeof e.dataLocation){t.dataLocation=e.dataLocation;break}break;case"DEFAULT":case 0:t.dataLocation=0;break;case"EXTERNAL":case 1:t.dataLocation=1}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");t.doubleData=[];for(r=0;r<e.doubleData.length;++r)t.doubleData[r]=Number(e.doubleData[r])}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");t.uint64Data=[];for(r=0;r<e.uint64Data.length;++r)o.Long?(t.uint64Data[r]=o.Long.fromValue(e.uint64Data[r])).unsigned=!0:"string"==typeof e.uint64Data[r]?t.uint64Data[r]=parseInt(e.uint64Data[r],10):"number"==typeof e.uint64Data[r]?t.uint64Data[r]=e.uint64Data[r]:"object"==typeof e.uint64Data[r]&&(t.uint64Data[r]=new o.LongBits(e.uint64Data[r].low>>>0,e.uint64Data[r].high>>>0).toNumber(!0))}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dims=[],r.floatData=[],r.int32Data=[],r.stringData=[],r.int64Data=[],r.doubleData=[],r.uint64Data=[],r.externalData=[]),t.defaults&&(r.dataType=0,r.segment=null,r.name="",t.bytes===String?r.rawData="":(r.rawData=[],t.bytes!==Array&&(r.rawData=o.newBuffer(r.rawData))),r.docString="",r.dataLocation=t.enums===String?"DEFAULT":0),e.dims&&e.dims.length){r.dims=[];for(var n=0;n<e.dims.length;++n)"number"==typeof e.dims[n]?r.dims[n]=t.longs===String?String(e.dims[n]):e.dims[n]:r.dims[n]=t.longs===String?o.Long.prototype.toString.call(e.dims[n]):t.longs===Number?new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber():e.dims[n]}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&(r.dataType=e.dataType),null!=e.segment&&e.hasOwnProperty("segment")&&(r.segment=a.onnx.TensorProto.Segment.toObject(e.segment,t)),e.floatData&&e.floatData.length){r.floatData=[];for(n=0;n<e.floatData.length;++n)r.floatData[n]=t.json&&!isFinite(e.floatData[n])?String(e.floatData[n]):e.floatData[n]}if(e.int32Data&&e.int32Data.length){r.int32Data=[];for(n=0;n<e.int32Data.length;++n)r.int32Data[n]=e.int32Data[n]}if(e.stringData&&e.stringData.length){r.stringData=[];for(n=0;n<e.stringData.length;++n)r.stringData[n]=t.bytes===String?o.base64.encode(e.stringData[n],0,e.stringData[n].length):t.bytes===Array?Array.prototype.slice.call(e.stringData[n]):e.stringData[n]}if(e.int64Data&&e.int64Data.length){r.int64Data=[];for(n=0;n<e.int64Data.length;++n)"number"==typeof e.int64Data[n]?r.int64Data[n]=t.longs===String?String(e.int64Data[n]):e.int64Data[n]:r.int64Data[n]=t.longs===String?o.Long.prototype.toString.call(e.int64Data[n]):t.longs===Number?new o.LongBits(e.int64Data[n].low>>>0,e.int64Data[n].high>>>0).toNumber():e.int64Data[n]}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.rawData&&e.hasOwnProperty("rawData")&&(r.rawData=t.bytes===String?o.base64.encode(e.rawData,0,e.rawData.length):t.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length){r.doubleData=[];for(n=0;n<e.doubleData.length;++n)r.doubleData[n]=t.json&&!isFinite(e.doubleData[n])?String(e.doubleData[n]):e.doubleData[n]}if(e.uint64Data&&e.uint64Data.length){r.uint64Data=[];for(n=0;n<e.uint64Data.length;++n)"number"==typeof e.uint64Data[n]?r.uint64Data[n]=t.longs===String?String(e.uint64Data[n]):e.uint64Data[n]:r.uint64Data[n]=t.longs===String?o.Long.prototype.toString.call(e.uint64Data[n]):t.longs===Number?new o.LongBits(e.uint64Data[n].low>>>0,e.uint64Data[n].high>>>0).toNumber(!0):e.uint64Data[n]}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.externalData&&e.externalData.length){r.externalData=[];for(n=0;n<e.externalData.length;++n)r.externalData[n]=a.onnx.StringStringEntryProto.toObject(e.externalData[n],t)}return null!=e.dataLocation&&e.hasOwnProperty("dataLocation")&&(r.dataLocation=t.enums===String?void 0===a.onnx.TensorProto.DataLocation[e.dataLocation]?e.dataLocation:a.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto"},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="UINT8"]=2,t[e[3]="INT8"]=3,t[e[4]="UINT16"]=4,t[e[5]="INT16"]=5,t[e[6]="INT32"]=6,t[e[7]="INT64"]=7,t[e[8]="STRING"]=8,t[e[9]="BOOL"]=9,t[e[10]="FLOAT16"]=10,t[e[11]="DOUBLE"]=11,t[e[12]="UINT32"]=12,t[e[13]="UINT64"]=13,t[e[14]="COMPLEX64"]=14,t[e[15]="COMPLEX128"]=15,t[e[16]="BFLOAT16"]=16,t[e[17]="FLOAT8E4M3FN"]=17,t[e[18]="FLOAT8E4M3FNUZ"]=18,t[e[19]="FLOAT8E5M2"]=19,t[e[20]="FLOAT8E5M2FNUZ"]=20,t}(),e.Segment=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.begin=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.end=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.begin&&Object.hasOwnProperty.call(e,"begin")&&t.uint32(8).int64(e.begin),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int64(e.end),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorProto.Segment;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.begin=e.int64();break;case 2:i.end=e.int64();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null==e.begin||!e.hasOwnProperty("begin")||o.isInteger(e.begin)||e.begin&&o.isInteger(e.begin.low)&&o.isInteger(e.begin.high)?null==e.end||!e.hasOwnProperty("end")||o.isInteger(e.end)||e.end&&o.isInteger(e.end.low)&&o.isInteger(e.end.high)?null:"end: integer|Long expected":"begin: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.onnx.TensorProto.Segment)return e;var t=new a.onnx.TensorProto.Segment;return null!=e.begin&&(o.Long?(t.begin=o.Long.fromValue(e.begin)).unsigned=!1:"string"==typeof e.begin?t.begin=parseInt(e.begin,10):"number"==typeof e.begin?t.begin=e.begin:"object"==typeof e.begin&&(t.begin=new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber())),null!=e.end&&(o.Long?(t.end=o.Long.fromValue(e.end)).unsigned=!1:"string"==typeof e.end?t.end=parseInt(e.end,10):"number"==typeof e.end?t.end=e.end:"object"==typeof e.end&&(t.end=new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(o.Long){var n=new o.Long(0,0,!1);r.begin=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.begin=t.longs===String?"0":0;if(o.Long){n=new o.Long(0,0,!1);r.end=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.end=t.longs===String?"0":0}return null!=e.begin&&e.hasOwnProperty("begin")&&("number"==typeof e.begin?r.begin=t.longs===String?String(e.begin):e.begin:r.begin=t.longs===String?o.Long.prototype.toString.call(e.begin):t.longs===Number?new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber():e.begin),null!=e.end&&e.hasOwnProperty("end")&&("number"==typeof e.end?r.end=t.longs===String?String(e.end):e.end:r.end=t.longs===String?o.Long.prototype.toString.call(e.end):t.longs===Number?new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber():e.end),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto.Segment"},e}(),e.DataLocation=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="EXTERNAL"]=1,t}(),e}(),s.SparseTensorProto=function(){function e(e){if(this.dims=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.values=null,e.prototype.indices=null,e.prototype.dims=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.values&&Object.hasOwnProperty.call(e,"values")&&a.onnx.TensorProto.encode(e.values,t.uint32(10).fork()).ldelim(),null!=e.indices&&Object.hasOwnProperty.call(e,"indices")&&a.onnx.TensorProto.encode(e.indices,t.uint32(18).fork()).ldelim(),null!=e.dims&&e.dims.length){t.uint32(26).fork();for(var r=0;r<e.dims.length;++r)t.int64(e.dims[r]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.SparseTensorProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.values=a.onnx.TensorProto.decode(e,e.uint32());break;case 2:i.indices=a.onnx.TensorProto.decode(e,e.uint32());break;case 3:if(i.dims&&i.dims.length||(i.dims=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.dims.push(e.int64());else i.dims.push(e.int64());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t;if(null!=e.values&&e.hasOwnProperty("values")&&(t=a.onnx.TensorProto.verify(e.values)))return"values."+t;if(null!=e.indices&&e.hasOwnProperty("indices")&&(t=a.onnx.TensorProto.verify(e.indices)))return"indices."+t;if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var r=0;r<e.dims.length;++r)if(!(o.isInteger(e.dims[r])||e.dims[r]&&o.isInteger(e.dims[r].low)&&o.isInteger(e.dims[r].high)))return"dims: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof a.onnx.SparseTensorProto)return e;var t=new a.onnx.SparseTensorProto;if(null!=e.values){if("object"!=typeof e.values)throw TypeError(".onnx.SparseTensorProto.values: object expected");t.values=a.onnx.TensorProto.fromObject(e.values)}if(null!=e.indices){if("object"!=typeof e.indices)throw TypeError(".onnx.SparseTensorProto.indices: object expected");t.indices=a.onnx.TensorProto.fromObject(e.indices)}if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");t.dims=[];for(var r=0;r<e.dims.length;++r)o.Long?(t.dims[r]=o.Long.fromValue(e.dims[r])).unsigned=!1:"string"==typeof e.dims[r]?t.dims[r]=parseInt(e.dims[r],10):"number"==typeof e.dims[r]?t.dims[r]=e.dims[r]:"object"==typeof e.dims[r]&&(t.dims[r]=new o.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber())}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dims=[]),t.defaults&&(r.values=null,r.indices=null),null!=e.values&&e.hasOwnProperty("values")&&(r.values=a.onnx.TensorProto.toObject(e.values,t)),null!=e.indices&&e.hasOwnProperty("indices")&&(r.indices=a.onnx.TensorProto.toObject(e.indices,t)),e.dims&&e.dims.length){r.dims=[];for(var n=0;n<e.dims.length;++n)"number"==typeof e.dims[n]?r.dims[n]=t.longs===String?String(e.dims[n]):e.dims[n]:r.dims[n]=t.longs===String?o.Long.prototype.toString.call(e.dims[n]):t.longs===Number?new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber():e.dims[n]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.SparseTensorProto"},e}(),s.TensorShapeProto=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.dim=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.dim&&e.dim.length)for(var r=0;r<e.dim.length;++r)a.onnx.TensorShapeProto.Dimension.encode(e.dim[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorShapeProto;e.pos<r;){var o=e.uint32();if(o>>>3==1)i.dim&&i.dim.length||(i.dim=[]),i.dim.push(a.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()));else e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dim&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var t=0;t<e.dim.length;++t){var r=a.onnx.TensorShapeProto.Dimension.verify(e.dim[t]);if(r)return"dim."+r}}return null},e.fromObject=function(e){if(e instanceof a.onnx.TensorShapeProto)return e;var t=new a.onnx.TensorShapeProto;if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");t.dim=[];for(var r=0;r<e.dim.length;++r){if("object"!=typeof e.dim[r])throw TypeError(".onnx.TensorShapeProto.dim: object expected");t.dim[r]=a.onnx.TensorShapeProto.Dimension.fromObject(e.dim[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dim=[]),e.dim&&e.dim.length){r.dim=[];for(var n=0;n<e.dim.length;++n)r.dim[n]=a.onnx.TensorShapeProto.Dimension.toObject(e.dim[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto"},e.Dimension=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.dimValue=null,e.prototype.dimParam=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:o.oneOfGetter(t=["dimValue","dimParam"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.dimValue&&Object.hasOwnProperty.call(e,"dimValue")&&t.uint32(8).int64(e.dimValue),null!=e.dimParam&&Object.hasOwnProperty.call(e,"dimParam")&&t.uint32(18).string(e.dimParam),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(26).string(e.denotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorShapeProto.Dimension;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.dimValue=e.int64();break;case 2:i.dimParam=e.string();break;case 3:i.denotation=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.dimValue&&e.hasOwnProperty("dimValue")&&(t.value=1,!(o.isInteger(e.dimValue)||e.dimValue&&o.isInteger(e.dimValue.low)&&o.isInteger(e.dimValue.high))))return"dimValue: integer|Long expected";if(null!=e.dimParam&&e.hasOwnProperty("dimParam")){if(1===t.value)return"value: multiple values";if(t.value=1,!o.isString(e.dimParam))return"dimParam: string expected"}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.TensorShapeProto.Dimension)return e;var t=new a.onnx.TensorShapeProto.Dimension;return null!=e.dimValue&&(o.Long?(t.dimValue=o.Long.fromValue(e.dimValue)).unsigned=!1:"string"==typeof e.dimValue?t.dimValue=parseInt(e.dimValue,10):"number"==typeof e.dimValue?t.dimValue=e.dimValue:"object"==typeof e.dimValue&&(t.dimValue=new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber())),null!=e.dimParam&&(t.dimParam=String(e.dimParam)),null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.dimValue&&e.hasOwnProperty("dimValue")&&("number"==typeof e.dimValue?r.dimValue=t.longs===String?String(e.dimValue):e.dimValue:r.dimValue=t.longs===String?o.Long.prototype.toString.call(e.dimValue):t.longs===Number?new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber():e.dimValue,t.oneofs&&(r.value="dimValue")),null!=e.dimParam&&e.hasOwnProperty("dimParam")&&(r.dimParam=e.dimParam,t.oneofs&&(r.value="dimParam")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto.Dimension"},e}(),e}(),s.TypeProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.tensorType=null,e.prototype.sequenceType=null,e.prototype.mapType=null,e.prototype.optionalType=null,e.prototype.sparseTensorType=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:o.oneOfGetter(t=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.tensorType&&Object.hasOwnProperty.call(e,"tensorType")&&a.onnx.TypeProto.Tensor.encode(e.tensorType,t.uint32(10).fork()).ldelim(),null!=e.sequenceType&&Object.hasOwnProperty.call(e,"sequenceType")&&a.onnx.TypeProto.Sequence.encode(e.sequenceType,t.uint32(34).fork()).ldelim(),null!=e.mapType&&Object.hasOwnProperty.call(e,"mapType")&&a.onnx.TypeProto.Map.encode(e.mapType,t.uint32(42).fork()).ldelim(),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(50).string(e.denotation),null!=e.sparseTensorType&&Object.hasOwnProperty.call(e,"sparseTensorType")&&a.onnx.TypeProto.SparseTensor.encode(e.sparseTensorType,t.uint32(66).fork()).ldelim(),null!=e.optionalType&&Object.hasOwnProperty.call(e,"optionalType")&&a.onnx.TypeProto.Optional.encode(e.optionalType,t.uint32(74).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.tensorType=a.onnx.TypeProto.Tensor.decode(e,e.uint32());break;case 4:i.sequenceType=a.onnx.TypeProto.Sequence.decode(e,e.uint32());break;case 5:i.mapType=a.onnx.TypeProto.Map.decode(e,e.uint32());break;case 9:i.optionalType=a.onnx.TypeProto.Optional.decode(e,e.uint32());break;case 8:i.sparseTensorType=a.onnx.TypeProto.SparseTensor.decode(e,e.uint32());break;case 6:i.denotation=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(t.value=1,r=a.onnx.TypeProto.Tensor.verify(e.tensorType)))return"tensorType."+r;if(null!=e.sequenceType&&e.hasOwnProperty("sequenceType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=a.onnx.TypeProto.Sequence.verify(e.sequenceType))return"sequenceType."+r}if(null!=e.mapType&&e.hasOwnProperty("mapType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=a.onnx.TypeProto.Map.verify(e.mapType))return"mapType."+r}if(null!=e.optionalType&&e.hasOwnProperty("optionalType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=a.onnx.TypeProto.Optional.verify(e.optionalType))return"optionalType."+r}if(null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")){if(1===t.value)return"value: multiple values";var r;if(t.value=1,r=a.onnx.TypeProto.SparseTensor.verify(e.sparseTensorType))return"sparseTensorType."+r}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto)return e;var t=new a.onnx.TypeProto;if(null!=e.tensorType){if("object"!=typeof e.tensorType)throw TypeError(".onnx.TypeProto.tensorType: object expected");t.tensorType=a.onnx.TypeProto.Tensor.fromObject(e.tensorType)}if(null!=e.sequenceType){if("object"!=typeof e.sequenceType)throw TypeError(".onnx.TypeProto.sequenceType: object expected");t.sequenceType=a.onnx.TypeProto.Sequence.fromObject(e.sequenceType)}if(null!=e.mapType){if("object"!=typeof e.mapType)throw TypeError(".onnx.TypeProto.mapType: object expected");t.mapType=a.onnx.TypeProto.Map.fromObject(e.mapType)}if(null!=e.optionalType){if("object"!=typeof e.optionalType)throw TypeError(".onnx.TypeProto.optionalType: object expected");t.optionalType=a.onnx.TypeProto.Optional.fromObject(e.optionalType)}if(null!=e.sparseTensorType){if("object"!=typeof e.sparseTensorType)throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");t.sparseTensorType=a.onnx.TypeProto.SparseTensor.fromObject(e.sparseTensorType)}return null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(r.tensorType=a.onnx.TypeProto.Tensor.toObject(e.tensorType,t),t.oneofs&&(r.value="tensorType")),null!=e.sequenceType&&e.hasOwnProperty("sequenceType")&&(r.sequenceType=a.onnx.TypeProto.Sequence.toObject(e.sequenceType,t),t.oneofs&&(r.value="sequenceType")),null!=e.mapType&&e.hasOwnProperty("mapType")&&(r.mapType=a.onnx.TypeProto.Map.toObject(e.mapType,t),t.oneofs&&(r.value="mapType")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")&&(r.sparseTensorType=a.onnx.TypeProto.SparseTensor.toObject(e.sparseTensorType,t),t.oneofs&&(r.value="sparseTensorType")),null!=e.optionalType&&e.hasOwnProperty("optionalType")&&(r.optionalType=a.onnx.TypeProto.Optional.toObject(e.optionalType,t),t.oneofs&&(r.value="optionalType")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto"},e.Tensor=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&a.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Tensor;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.elemType=e.int32();break;case 2:i.shape=a.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=a.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Tensor)return e;var t=new a.onnx.TypeProto.Tensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=typeof e.shape)throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");t.shape=a.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=0,r.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(r.shape=a.onnx.TensorShapeProto.toObject(e.shape,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Tensor"},e}(),e.Sequence=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&a.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Sequence;e.pos<r;){var o=e.uint32();if(o>>>3==1)i.elemType=a.onnx.TypeProto.decode(e,e.uint32());else e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=a.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Sequence)return e;var t=new a.onnx.TypeProto.Sequence;if(null!=e.elemType){if("object"!=typeof e.elemType)throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");t.elemType=a.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=a.onnx.TypeProto.toObject(e.elemType,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Sequence"},e}(),e.Map=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.keyType=0,e.prototype.valueType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.keyType&&Object.hasOwnProperty.call(e,"keyType")&&t.uint32(8).int32(e.keyType),null!=e.valueType&&Object.hasOwnProperty.call(e,"valueType")&&a.onnx.TypeProto.encode(e.valueType,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Map;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.keyType=e.int32();break;case 2:i.valueType=a.onnx.TypeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.keyType&&e.hasOwnProperty("keyType")&&!o.isInteger(e.keyType))return"keyType: integer expected";if(null!=e.valueType&&e.hasOwnProperty("valueType")){var t=a.onnx.TypeProto.verify(e.valueType);if(t)return"valueType."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Map)return e;var t=new a.onnx.TypeProto.Map;if(null!=e.keyType&&(t.keyType=0|e.keyType),null!=e.valueType){if("object"!=typeof e.valueType)throw TypeError(".onnx.TypeProto.Map.valueType: object expected");t.valueType=a.onnx.TypeProto.fromObject(e.valueType)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.keyType=0,r.valueType=null),null!=e.keyType&&e.hasOwnProperty("keyType")&&(r.keyType=e.keyType),null!=e.valueType&&e.hasOwnProperty("valueType")&&(r.valueType=a.onnx.TypeProto.toObject(e.valueType,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Map"},e}(),e.Optional=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&a.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Optional;e.pos<r;){var o=e.uint32();if(o>>>3==1)i.elemType=a.onnx.TypeProto.decode(e,e.uint32());else e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=a.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Optional)return e;var t=new a.onnx.TypeProto.Optional;if(null!=e.elemType){if("object"!=typeof e.elemType)throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");t.elemType=a.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=a.onnx.TypeProto.toObject(e.elemType,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Optional"},e}(),e.SparseTensor=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&a.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.SparseTensor;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.elemType=e.int32();break;case 2:i.shape=a.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=a.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.SparseTensor)return e;var t=new a.onnx.TypeProto.SparseTensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=typeof e.shape)throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");t.shape=a.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=0,r.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(r.shape=a.onnx.TensorShapeProto.toObject(e.shape,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.SparseTensor"},e}(),e}(),s.OperatorSetIdProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.domain="",e.prototype.version=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(10).string(e.domain),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.OperatorSetIdProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.domain=e.string();break;case 2:i.version=e.int64();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null==e.version||!e.hasOwnProperty("version")||o.isInteger(e.version)||e.version&&o.isInteger(e.version.low)&&o.isInteger(e.version.high)?null:"version: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.onnx.OperatorSetIdProto)return e;var t=new a.onnx.OperatorSetIdProto;return null!=e.domain&&(t.domain=String(e.domain)),null!=e.version&&(o.Long?(t.version=o.Long.fromValue(e.version)).unsigned=!1:"string"==typeof e.version?t.version=parseInt(e.version,10):"number"==typeof e.version?t.version=e.version:"object"==typeof e.version&&(t.version=new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if(r.domain="",o.Long){var n=new o.Long(0,0,!1);r.version=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.version=t.longs===String?"0":0;return null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.version&&e.hasOwnProperty("version")&&("number"==typeof e.version?r.version=t.longs===String?String(e.version):e.version:r.version=t.longs===String?o.Long.prototype.toString.call(e.version):t.longs===Number?new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.OperatorSetIdProto"},e}(),s.OperatorStatus=function(){var e={},t=Object.create(e);return t[e[0]="EXPERIMENTAL"]=0,t[e[1]="STABLE"]=1,t}(),s.FunctionProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.attribute=o.emptyArray,e.prototype.attributeProto=o.emptyArray,e.prototype.node=o.emptyArray,e.prototype.docString="",e.prototype.opsetImport=o.emptyArray,e.prototype.domain="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.input&&e.input.length)for(var r=0;r<e.input.length;++r)t.uint32(34).string(e.input[r]);if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)t.uint32(42).string(e.output[r]);if(null!=e.attribute&&e.attribute.length)for(r=0;r<e.attribute.length;++r)t.uint32(50).string(e.attribute[r]);if(null!=e.node&&e.node.length)for(r=0;r<e.node.length;++r)a.onnx.NodeProto.encode(e.node[r],t.uint32(58).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(66).string(e.docString),null!=e.opsetImport&&e.opsetImport.length)for(r=0;r<e.opsetImport.length;++r)a.onnx.OperatorSetIdProto.encode(e.opsetImport[r],t.uint32(74).fork()).ldelim();if(null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(82).string(e.domain),null!=e.attributeProto&&e.attributeProto.length)for(r=0;r<e.attributeProto.length;++r)a.onnx.AttributeProto.encode(e.attributeProto[r],t.uint32(90).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.FunctionProto;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 4:i.input&&i.input.length||(i.input=[]),i.input.push(e.string());break;case 5:i.output&&i.output.length||(i.output=[]),i.output.push(e.string());break;case 6:i.attribute&&i.attribute.length||(i.attribute=[]),i.attribute.push(e.string());break;case 11:i.attributeProto&&i.attributeProto.length||(i.attributeProto=[]),i.attributeProto.push(a.onnx.AttributeProto.decode(e,e.uint32()));break;case 7:i.node&&i.node.length||(i.node=[]),i.node.push(a.onnx.NodeProto.decode(e,e.uint32()));break;case 8:i.docString=e.string();break;case 9:i.opsetImport&&i.opsetImport.length||(i.opsetImport=[]),i.opsetImport.push(a.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 10:i.domain=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected"}if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t)if(!o.isString(e.attribute[t]))return"attribute: string[] expected"}if(null!=e.attributeProto&&e.hasOwnProperty("attributeProto")){if(!Array.isArray(e.attributeProto))return"attributeProto: array expected";for(t=0;t<e.attributeProto.length;++t){if(r=a.onnx.AttributeProto.verify(e.attributeProto[t]))return"attributeProto."+r}}if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(t=0;t<e.node.length;++t){if(r=a.onnx.NodeProto.verify(e.node[t]))return"node."+r}}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(t=0;t<e.opsetImport.length;++t){var r;if(r=a.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+r}}return null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.FunctionProto)return e;var t=new a.onnx.FunctionProto;if(null!=e.name&&(t.name=String(e.name)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.FunctionProto.input: array expected");t.input=[];for(var r=0;r<e.input.length;++r)t.input[r]=String(e.input[r])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.FunctionProto.output: array expected");t.output=[];for(r=0;r<e.output.length;++r)t.output[r]=String(e.output[r])}if(e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");t.attribute=[];for(r=0;r<e.attribute.length;++r)t.attribute[r]=String(e.attribute[r])}if(e.attributeProto){if(!Array.isArray(e.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");t.attributeProto=[];for(r=0;r<e.attributeProto.length;++r){if("object"!=typeof e.attributeProto[r])throw TypeError(".onnx.FunctionProto.attributeProto: object expected");t.attributeProto[r]=a.onnx.AttributeProto.fromObject(e.attributeProto[r])}}if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.FunctionProto.node: array expected");t.node=[];for(r=0;r<e.node.length;++r){if("object"!=typeof e.node[r])throw TypeError(".onnx.FunctionProto.node: object expected");t.node[r]=a.onnx.NodeProto.fromObject(e.node[r])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");t.opsetImport=[];for(r=0;r<e.opsetImport.length;++r){if("object"!=typeof e.opsetImport[r])throw TypeError(".onnx.FunctionProto.opsetImport: object expected");t.opsetImport[r]=a.onnx.OperatorSetIdProto.fromObject(e.opsetImport[r])}}return null!=e.domain&&(t.domain=String(e.domain)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.input=[],r.output=[],r.attribute=[],r.node=[],r.opsetImport=[],r.attributeProto=[]),t.defaults&&(r.name="",r.docString="",r.domain=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.input&&e.input.length){r.input=[];for(var n=0;n<e.input.length;++n)r.input[n]=e.input[n]}if(e.output&&e.output.length){r.output=[];for(n=0;n<e.output.length;++n)r.output[n]=e.output[n]}if(e.attribute&&e.attribute.length){r.attribute=[];for(n=0;n<e.attribute.length;++n)r.attribute[n]=e.attribute[n]}if(e.node&&e.node.length){r.node=[];for(n=0;n<e.node.length;++n)r.node[n]=a.onnx.NodeProto.toObject(e.node[n],t)}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.opsetImport&&e.opsetImport.length){r.opsetImport=[];for(n=0;n<e.opsetImport.length;++n)r.opsetImport[n]=a.onnx.OperatorSetIdProto.toObject(e.opsetImport[n],t)}if(null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),e.attributeProto&&e.attributeProto.length){r.attributeProto=[];for(n=0;n<e.attributeProto.length;++n)r.attributeProto[n]=a.onnx.AttributeProto.toObject(e.attributeProto[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.FunctionProto"},e}(),s}(),t.exports=a}));function zr(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function dn(e){return(new TextDecoder).decode(e)}var we,Tr,Ti,Ke,ro,Ve,ot,z,pn,xr,wr,vr,fe=L((()=>{Jn(),ii(),we=Nr(Ur()),_r(),Tr=class{static arraysEqual(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}},Ti=class{static preprocessInputShapes(e,t){return[1===e.length?[1,e[0]]:e,1===t.length?[t[0],1]:t]}static postprocessOutputShape(e,t,r){1===t&&e.splice(e.length-2,1),1===r&&e.pop()}static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},Ke=class e{static calcShape(e,t,r=!1){let n=e.length,i=t.length;if(0===n)return t;if(0===i)return e;let o=Math.max(e.length,t.length),a=new Array(o);if(r){if(n<2||i<2)return;let r=Ti.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(void 0===r)return;[a[o-2],a[o-1]]=r}for(let s=r?3:1;s<=o;s++){let r=n-s<0?1:e[n-s],u=i-s<0?1:t[i-s];if(r!==u&&r>1&&u>1)return;a[o-s]=Math.max(r,u)}return a}static index(t,r){let n=new Array(r.length);return e.fillIndex(t,r,n),n}static fillIndex(e,t,r){let n=e.length-t.length;for(let i=0;i<t.length;i++)r[i]=e[n+i]%t[i]}static calc(t,r,n,i,o){let a=e.calcShape(t.dims,r.dims);if(a){if(i&&!z.areEqual(a,t.dims))return;let s=z.size(a),u=i?t:new Ce(a,o||t.type);if(0===a.length)u.set([],n(t.get([]),r.get([])));else{let i,o=new Array(a.length),l=new Array(t.dims.length),h=new Array(r.dims.length),c=0,d=0,f=!1,p=!1;0===t.dims.length&&(c=t.get([]),f=!0),0===r.dims.length&&(d=r.get([]),p=!0);for(let y=0;y<s;y++){i=y;for(let e=a.length-1;e>=0;e--)o[e]=i%a[e],i=Math.floor(i/a[e]);f||(e.fillIndex(o,t.dims,l),c=t.get(l)),p||(e.fillIndex(o,r.dims,h),d=r.get(h)),u.set(o,n(c,d))}}return u}}static isValidBroadcast(e,t){let r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(1!==e[r-i]&&e[r-i]!==t[n-i])return!1;return!0}static getBroadcastDims(e,t){let r=e.length,n=[];for(let i=0;i<r;i++){let o=r-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&n.unshift(o)}return n}},ro=class{static getShapeOfGemmResult(e,t,r,n,i){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");let o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);let u=-1;if(n?(s=r[0],u=1):(s=r[1],u=0),r[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!Ke.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]}},Ve=class e{static tensorDataTypeFromProto(e){switch(e){case we.onnx.TensorProto.DataType.INT8:return"int8";case we.onnx.TensorProto.DataType.UINT8:return"uint8";case we.onnx.TensorProto.DataType.BOOL:return"bool";case we.onnx.TensorProto.DataType.INT16:return"int16";case we.onnx.TensorProto.DataType.UINT16:return"uint16";case we.onnx.TensorProto.DataType.INT32:return"int32";case we.onnx.TensorProto.DataType.UINT32:return"uint32";case we.onnx.TensorProto.DataType.FLOAT:return"float32";case we.onnx.TensorProto.DataType.DOUBLE:return"float64";case we.onnx.TensorProto.DataType.STRING:return"string";case we.onnx.TensorProto.DataType.INT64:return"int32";case we.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${we.onnx.TensorProto.DataType[e]}`)}}static tensorDataTypeStringToEnum(e){switch(e){case"int8":return we.onnx.TensorProto.DataType.INT8;case"uint8":return we.onnx.TensorProto.DataType.UINT8;case"bool":return we.onnx.TensorProto.DataType.BOOL;case"int16":return we.onnx.TensorProto.DataType.INT16;case"uint16":return we.onnx.TensorProto.DataType.UINT16;case"int32":return we.onnx.TensorProto.DataType.INT32;case"uint32":return we.onnx.TensorProto.DataType.UINT32;case"float32":return we.onnx.TensorProto.DataType.FLOAT;case"float64":return we.onnx.TensorProto.DataType.DOUBLE;case"string":return we.onnx.TensorProto.DataType.STRING;case"int64":return we.onnx.TensorProto.DataType.INT64;case"uint64":return we.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${e}`)}}static tensorDimsFromProto(e){return e.map((e=>jt.isLong(e)?e.toNumber():e))}static tensorValueTypeFromProto(t){return{tensorType:e.tensorDataTypeFromProto(t.elemType),shape:{dims:e.tensorDimsFromProto(t.shape.dim.map((e=>e.dimValue)))}}}static tensorDimsFromORTFormat(e){let t=[];for(let r=0;r<e.dimsLength();r++)t.push(ot.longToNumber(e.dims(r)));return t}static tensorAttributesFromORTFormat(e){let t=[];for(let r=0;r<e.attributesLength();r++)t.push(e.attributes(r));return t}},ot=class{static longToNumber(e,t){return jt.isLong(e)?e.toNumber():e instanceof O.Long?jt.fromValue({low:e.low,high:e.high,unsigned:t??!1}).toNumber():e}static isLong(e){return jt.isLong(e)||e instanceof O.Long}},z=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(e,t,r){let n=1;for(let i=t;i<r;i++){if(e[i]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");n*=e[i]}return n}static computeStrides(e){let t=e.length;if(0===t)return[];if(1===t)return[1];let r=new Array(t);r[t-1]=1,r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}static transpose(e){return e.slice().reverse()}static indicesToOffset(e,t,r){void 0===r&&(r=e.length);let n=0;for(let i=0;i<r;++i)n+=t[i]*e[i];return n}static offsetToIndices(e,t){let r=t.length;if(0===r)return[];if(1===r)return[e*t[0]];let n=new Array(t.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/t[r]),e-=n[r]*t[r];return n[n.length-1]=e,n}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map((e=>this.normalizeAxis(e,t)))}static incrementIndex(e,t,r){if(0===t.length||0===e.length)throw new Error("Index incrementing unsupported for scalar Tensor");if(void 0===r)r=t.length;else if(r<=0||r>t.length)throw new Error("Incorrect axis to increment on");for(let n=r-1;n>=0&&(e[n]++,!(e[n]<t[n]));--n)e[n]=0}static calculateReshapedDims(t,r){if(0===r.length){if(0===t.length||1===e.size(t))return[];throw new Error("cannot reshape to a scalar Tensor")}let n=r.length,i=new Array(n),o=-1,a=1;for(let e=0;e<n;e++){if(r[e]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(-1===r[e]){if(-1!==o)throw new Error("at most one dimension in shape hints can be -1");o=e}else{if(0===r[e]){if(e>=t.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");i[e]=t[e]}else i[e]=r[e];a*=i[e]}}let s=e.size(t);if(-1!==o){if(s%a!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${t}] Output shape: [${r}]`);i[o]=s/a}else if(a!==s)throw new Error("reshapedDims and originalDims don't have matching sizes");return i}static sortBasedOnPerm(e,t){return t?t.map((t=>e[t])):e.slice().reverse()}static padShape(e,t){let r=e.length;return e.map(((e,n)=>e+t[n]+t[n+r]))}static areEqual(e,t){return e.length===t.length&&e.every(((e,r)=>e===t[r]))}static validateDimsAndCalcSize(e){if(e.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let t=1;for(let r of e){if(!Number.isInteger(r))throw new TypeError(`Invalid shape: ${r} is not an integer`);if(r<0||r>2147483647)throw new TypeError(`Invalid shape: length ${r} is not allowed`);t*=r}return t}static flattenShape(e,t){t<0&&(t+=e.length);let r=e.reduce(((e,t)=>e*t),1),n=e.slice(t).reduce(((e,t)=>e*t),1);return[r/n,n]}static squeezeShape(t,r){let n=new Array;r=e.normalizeAxes(r,t.length);for(let e=0;e<t.length;e++){let i=r.indexOf(e)>=0;if(i&&1!==t[e])throw new Error("squeeze an axis of size different than 1");(0===r.length&&t[e]>1||r.length>0&&!i)&&n.push(t[e])}return n}static unsqueezeShape(t,r){let n=new Array(t.length+r.length);n.fill(0);for(let t=0;t<r.length;t++){let i=e.normalizeAxis(r[t],n.length);if(i>=n.length)throw new Error("'axes' has an out of range axis");if(0!==n[i])throw new Error("'axes' has a duplicate axis");n[i]=1}let i=0;for(let e=0;e<n.length;e++)0===n[e]&&(n[e]=t[i++]);if(i!==t.length)throw new Error("the unsqueezed dimension could not be established");return n}},pn=class e{static splitShape(t,r,n,i){if(0===n.length){if(!i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");e.determineSplit(t[r],i,n)}let o=[],a=[0];for(let e=0;e<n.length;++e){0!==e&&a.push(a[e-1]+n[e-1]);let i=t.slice();i[r]=n[e],o.push(i)}return[o,a]}static determineSplit(e,t,r){if(e%t!=0)throw new Error("cannot split tensor to equal sized parts");for(let n=0;n<t;++n)r.push(e/t)}},xr=class e{static adjustPoolAttributes(e,t,r,n,i,o){if(!e&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=r.length?r.push(t[e+2]):r[e]=t[e+2];for(let e=0;e<r.length;e++)if(e<n.length){if(n[e]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let e=0;e<r.length;e++)if(e<i.length){if(i[e]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let e=0;e<2*r.length;e++)if(e<o.length){if(o[e]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<r.length;e++){if(r[e]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[e]>=r[e]||o[e+r.length]>=r[e])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,n,i,o,a){if(a){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let s=0;s<t.length-2;s++)e.adjustPadAndReturnShape(t[s+2],r[s],n[s],i[s],o,s,s+t.length-2,a)}}static computePoolOutputShape(t,r,n,i,o,a,s){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let u=[r[0],r[1]];return e.computeShapeHelper(t,r,u,n,i,o,a,s),u}static computeConvOutputShape(t,r,n,i,o,a,s){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],r[0]];return e.computeShapeHelper(!1,t,u,n,i,o,a,s),u}static computeShapeHelper(t,r,n,i,o,a,s,u){if(t)for(let e=0;e<r.length-2;e++)n.push(1);else for(let t=0;t<r.length-2;t++)n.push(e.adjustPadAndReturnShape(r[t+2],i[t],o[t],a[t],s,t,t+r.length-2,u))}static adjustPadAndReturnShape(e,t,r,n,i,o,a,s){let u=r*(n-1)+1;if(!s||"NOTSET"===s)return Math.floor((e+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let r=((e+t-1)/t-1)*t+n-e;return i[o]=Math.floor("SAME_LOWER"===s?(r+1)/2:r/2),i[a]=r-i[o],Math.floor((e+r-n)/t+1)}default:throw new Error("Unsupported AutoPad type")}}},wr=-34028234663852886e22,vr=34028234663852886e22}));function eh(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${e}`)}}function Ru(e){switch(e){case re.onnx.TensorProto.DataType.UINT8:case re.onnx.TensorProto.DataType.INT8:case re.onnx.TensorProto.DataType.BOOL:return 1;case re.onnx.TensorProto.DataType.UINT16:case re.onnx.TensorProto.DataType.INT16:return 2;case re.onnx.TensorProto.DataType.FLOAT:case re.onnx.TensorProto.DataType.INT32:case re.onnx.TensorProto.DataType.UINT32:return 4;case re.onnx.TensorProto.DataType.INT64:case re.onnx.TensorProto.DataType.DOUBLE:case re.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${re.onnx.TensorProto.DataType[e]}`)}}function th(e,t){return new(Uu(t))(e)}function Uu(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function wi(e,t){if(t===re.onnx.TensorProto.DataType.INT64||t===xi.TensorDataType.INT64){if(e.greaterThanOrEqual(2147483648)||e.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(t!==re.onnx.TensorProto.DataType.UINT32&&t!==xi.TensorDataType.UINT32&&t!==re.onnx.TensorProto.DataType.UINT64&&t!==xi.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${re.onnx.TensorProto.DataType[t]}`);if(e.greaterThanOrEqual(4294967296)||e.lessThan(0))throw new TypeError("uint64 is not supported")}return e.toNumber()}function Mu(e,t,r){switch(t){case re.onnx.TensorProto.DataType.BOOL:case re.onnx.TensorProto.DataType.UINT8:return e.getUint8(r);case re.onnx.TensorProto.DataType.INT8:return e.getInt8(r);case re.onnx.TensorProto.DataType.UINT16:return e.getUint16(r,!0);case re.onnx.TensorProto.DataType.INT16:return e.getInt16(r,!0);case re.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(r,!0);case re.onnx.TensorProto.DataType.INT32:return e.getInt32(r,!0);case re.onnx.TensorProto.DataType.UINT32:return e.getUint32(r,!0);case re.onnx.TensorProto.DataType.INT64:return wi(jt.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!1),t);case re.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(r,!0);case re.onnx.TensorProto.DataType.UINT64:return wi(jt.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!0),t);default:throw new Error(`cannot read from DataView for type ${re.onnx.TensorProto.DataType[t]}`)}}var Gu,re,xi,Ce,_r=L((()=>{Gu=Nr(Ps()),ii(),un(),re=Nr(Ur()),fe(),xi=H.experimental.fbs,Ce=class e{constructor(e,t,r,n,i,o=Gu.Guid.create()){this.dims=e,this.type=t,this.dataProvider=r,this.asyncDataProvider=n,this.cache=i,this.dataId=o,this.size=z.validateDimsAndCalcSize(e);let a=this.size,s=void 0===r&&void 0===n&&void 0===i;if(void 0!==i&&i.length!==a)throw new RangeError("Input dims doesn't match data length.");if("string"===t){if(!(void 0===i||Array.isArray(i)&&i.every((e=>"string"==typeof e))))throw new TypeError("cache should be a string array");s&&(this.cache=new Array(a))}else{if(void 0!==i){let e=Uu(t);if(!(i instanceof e))throw new TypeError(`cache should be type ${e.name}`)}if(s){let e=new ArrayBuffer(a*eh(t));this.cache=th(e,t)}}}get data(){if(void 0===this.cache){let e=this.dataProvider(this.dataId);if(e.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=e}return this.cache}get stringData(){if("string"!==this.type)throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if("string"!==this.type)return this.data;throw new TypeError("type cannot be non-number (string)")}get(e){return this.data[z.indicesToOffset(e,this.strides)]}set(e,t){this.data[z.indicesToOffset(e,this.strides)]=t}async getData(){return void 0===this.cache&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=z.computeStrides(this.dims)),this._strides}static fromProto(t){if(!t)throw new Error("cannot construct Value from an empty tensor");let r=Ve.tensorDataTypeFromProto(t.dataType),n=Ve.tensorDimsFromProto(t.dims),i=new e(n,r);if("string"===r)t.stringData.forEach(((e,t)=>{i.data[t]=dn(e)}));else if(t.rawData&&"number"==typeof t.rawData.byteLength&&t.rawData.byteLength>0){let e=i.data,r=new DataView(t.rawData.buffer,t.rawData.byteOffset,t.rawData.byteLength),n=Ru(t.dataType),o=t.rawData.byteLength/n;if(t.rawData.byteLength%n!=0)throw new Error("invalid buffer length");if(e.length!==o)throw new Error("buffer length mismatch");for(let i=0;i<o;i++){let o=Mu(r,t.dataType,i*n);e[i]=o}}else{let e;switch(t.dataType){case re.onnx.TensorProto.DataType.FLOAT:e=t.floatData;break;case re.onnx.TensorProto.DataType.INT32:case re.onnx.TensorProto.DataType.INT16:case re.onnx.TensorProto.DataType.UINT16:case re.onnx.TensorProto.DataType.INT8:case re.onnx.TensorProto.DataType.UINT8:case re.onnx.TensorProto.DataType.BOOL:e=t.int32Data;break;case re.onnx.TensorProto.DataType.INT64:e=t.int64Data;break;case re.onnx.TensorProto.DataType.DOUBLE:e=t.doubleData;break;case re.onnx.TensorProto.DataType.UINT32:case re.onnx.TensorProto.DataType.UINT64:e=t.uint64Data;break;default:throw new Error("unspecific error")}if(null==e)throw new Error("failed to populate data from a tensorproto value");let r=i.data;if(r.length!==e.length)throw new Error("array length mismatch");for(let n=0;n<e.length;n++){let i=e[n];jt.isLong(i)?r[n]=wi(i,t.dataType):r[n]=i}}return i}static fromData(t,r,n){return new e(r,n,void 0,void 0,t)}static fromOrtTensor(t){if(!t)throw new Error("cannot construct Value from an empty tensor");let r=Ve.tensorDimsFromORTFormat(t),n=Ve.tensorDataTypeFromProto(t.dataType()),i=new e(r,n);if("string"===n)for(let e=0;e<t.stringDataLength();e++)i.data[e]=t.stringData(e);else if(t.rawDataArray()&&"number"==typeof t.rawDataLength()&&t.rawDataLength()>0){let e=i.data,r=new DataView(t.rawDataArray().buffer,t.rawDataArray().byteOffset,t.rawDataLength()),n=Ru(t.dataType()),o=t.rawDataLength()/n;if(t.rawDataLength()%n!=0)throw new Error("invalid buffer length");if(e.length!==o)throw new Error("buffer length mismatch");for(let i=0;i<o;i++){let o=Mu(r,t.dataType(),i*n);e[i]=o}}return i}}}));function q(e){return 1===e?rh:nh}function zu(e){let t=q(e);return`${t.version}\n      precision highp float;\n      ${t.attribute} vec3 position;\n      ${t.attribute} vec2 textureCoord;\n\n      ${t.varyingVertex} vec2 TexCoords;\n\n      void main()\n      {\n          gl_Position = vec4(position, 1.0);\n          TexCoords = textureCoord;\n      }`}function Wu(e){let t=q(e);return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFrag} vec2 TexCoords;\n    ${t.outputDeclaration}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    // Custom vector types to handle higher dimenalities.\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    `}function Vu(e,t){return`\n  void main() {\n    int indices[${t}];\n    toVec(TexCoords, indices);\n    vec4 result = vec4(process(indices));\n    ${q(e).output} = result;\n  }\n  `}var rh,nh,ve=L((()=>{rh={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},nh={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}})),ae=L((()=>{}));async function vi(e,t=(e=>0),r){return new Promise(((n,i)=>{let o=0,a=()=>{if(e())return void n();o++;let s=t(o);null!=r&&o>=r?i():setTimeout(a,s)};a()}))}function no(e){return zr(typeof e<"u"&&0!==e.length,(()=>"empty string found for sampler name")),"get"+e.charAt(0).toUpperCase()+e.slice(1)}function Hu(e){return zr(typeof e<"u"&&0!==e.length,(()=>"empty string found for sampler name")),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords"}function Wr(e,t){let r=JSON.parse(JSON.stringify(e));return r=t,r}function Vr(e,t){return t.map((t=>e[t])).join(", ")}function Je(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function Dt(e=6){return["x","y","z","w","u","v"].slice(0,e)}var Bt=L((()=>{fe()}));function oh(e,t){return Dt(t).map((t=>`${e}.${t}`))}function Hr(e,t){return 1===t?[e]:oh(e,t)}function kt(){return"\n    float getChannel(vec4 frag, int dim) {\n      int modCoord = imod(dim, 2);\n      return modCoord == 0 ? frag.r : frag.g;\n    }\n\n    float getChannel(vec4 frag, vec2 innerDims) {\n      vec2 modCoord = mod(innerDims, 2.);\n      return modCoord.x == 0. ?\n        (modCoord.y == 0. ? frag.r : frag.g) :\n        (modCoord.y == 0. ? frag.b : frag.a);\n    }\n  "}var Or=L((()=>{Bt()}));function ah(e,t,r){if(0===e)return"false";if(1===e)return`rc > ${t[0]}`;let n="";for(let i=e-2;i<e;i++)n+=`${r[i]} >= ${t[i-e+2]}`,i<e-1&&(n+="||");return n}function sh(e,t){let r=e.length;if(0===r)return"getA(), 0, 0, 0";if(1===r)return`getA(rc),\n            rc + 1 >= ${e[0]} ? 0. : getA(rc + 1),\n            0, 0`;let n="";if(r>2)for(let e=0;e<r-2;++e)n+=`${t[e]},`;return`getA(${n}r, c),\n          rEdge ? 0. : getA(${n}rp1, c),\n          cEdge ? 0. : getA(${n}r, cp1),\n          rEdge || cEdge ? 0. : getA(${n}rp1, cp1)`}function uh(e,t,r,n){return 0===e||1===e?"":`\n    int r = ${t[e-2]};\n    int c = ${t[e-1]};\n    int rp1 = ${t[e-2]} + 1;\n    int cp1 = ${t[e-1]} + 1;\n    bool rEdge = rp1 >= ${n};\n    bool cEdge = cp1 >= ${r};\n    `}var ju,ih,qu,Yu=L((()=>{ve(),ae(),Bt(),Or(),ju={name:"pack",inputNames:["A"],inputTypes:[1]},ih=(e,t)=>{let r,n=q(e.session.backend.glContext.version),i=t.dims,o=i.length,a=t.dims.length,s=Je(a),u=Hr("rc",a),l=uh(a,u,i[i.length-2],i[i.length-1]);r=0===o?[1,1]:1===o?[i[0],1]:[i[a-1],i[a-2]];let h=ah(a,r,u),c=sh(i,u),d=`\n        void main() {\n          ${s} rc = getOutputCoords();\n\n          if(${h}) {\n            ${n.output} = vec4(0);\n          } else {\n            ${l}\n\n            ${n.output} = vec4(${c});\n          }\n        }\n      `;return{...ju,hasMain:!0,output:{dims:t.dims,type:t.type,textureType:2},shaderSource:d}},qu=(e,t)=>({...ju,get:()=>ih(e,t)})}));function _i(e){if(0===e.length)return[1,1,1];let t=1;for(let r=0;r<e.length-2;++r)t*=e[r];return[t,e.length>1?e[e.length-2]:1,e[e.length-1]]}function Ku(e,t){let r=!1;return r=0===e.length||0===t.length||(e.length<2||t.length<2?e[e.length-1]===t[t.length-1]:e[e.length-1]===t[t.length-1]&&e[e.length-2]===t[t.length-2]),r}function ch(e){let t=z.computeStrides(e),r=["b","r","c"],n="index";return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${t.map(((e,i)=>`${`int ${r[i]} = ${n} / ${e}`}; ${i===t.length-1?`int ${r[i+1]} = ${n} - ${r[i]} * ${e}`:`index -= ${r[i]} * ${e}`};`)).join("")}\n      return ivec3(b, r, c);\n    }\n  `}function ph(e){let t=z.computeStrides(e);return`\n  int getFlattenedIndex(ivec3 coords) {\n    // reverse y, z order\n    return coords.x * ${t[0]} + coords.z * ${t[1]} + coords.y;\n  }\n`}var lh,fh,Xu,Ju=L((()=>{fe(),ve(),ae(),Or(),lh=e=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${e}`}),fh=(e,t,r,n)=>{let i=t.dims,o=n,a="";for(let e=0;e<4;e++){let t="";switch(e){case 0:t="outputCoords = rc;";break;case 1:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:t="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}a+=`\n        ${t}\n        ${e>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}\n          int flattenedIndex = getFlattenedIndex(outputCoords);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);\n          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${e}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);\n\n        ${e>0?"}":""}\n      `}let s=q(e.session.backend.glContext.version),u=`\n      ${ch(i)}\n      ${ph(o)}\n      ${kt()}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.0);\n\n        ivec3 outputCoords;\n        int rows = ${o[2]};\n        int cols = ${o[1]};\n\n        ${a}\n        ${s.output} = result;\n      }\n    `;return{...r,output:{dims:o,type:t.type,textureType:2},shaderSource:u,hasMain:!0}},Xu=(e,t,r)=>{let n=lh(r);return{...n,get:()=>fh(e,t,n,r)}}})),Oi,Zu=L((()=>{ve(),ae(),Oi=(e,t)=>{let r=t.shape,n=q(e.session.backend.glContext.version),i=`\n    const float FLOAT_MAX = 1.70141184e38;\n    const float FLOAT_MIN = 1.17549435e-38;\n\n    bool isNaN(float val) {\n      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;\n    }\n\n    highp vec4 encodeAsUint8(highp float v) {\n      if (isNaN(v)) {\n        return vec4(255, 255, 255, 255);\n      }\n\n      highp float av = abs(v);\n\n      if(av < FLOAT_MIN) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n      } else if(v > FLOAT_MAX) {\n        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n      } else if(v < -FLOAT_MAX) {\n        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n      }\n\n      highp vec4 c = vec4(0,0,0,0);\n\n      highp float e = floor(log2(av));\n      highp float m = exp2(fract(log2(av))) - 1.0;\n\n      c[2] = floor(128.0 * m);\n      m -= c[2] / 128.0;\n      c[1] = floor(32768.0 * m);\n      m -= c[1] / 32768.0;\n      c[0] = floor(8388608.0 * m);\n\n      highp float ebias = e + 127.0;\n      c[3] = floor(ebias / 2.0);\n      ebias -= c[3] * 2.0;\n      c[2] += floor(ebias) * 128.0;\n\n      c[3] += 128.0 * step(0.0, -v);\n\n      return c / 255.0;\n    }\n\n    void main() {\n      float value = ${n.texture2D}(X,TexCoords).r;\n      ${n.output} = encodeAsUint8(value);\n    }`,o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:r,type:t.tensor.type,textureType:3},shaderSource:i,hasMain:!0};return e.executeProgram(o,[t.tensor])}}));function hh(e,t){if(1===e)return"rc";let r="";for(let n=0;n<e;n++)r+=t[n],n<e-1&&(r+=",");return r}var Qu,dh,el,tl=L((()=>{ve(),ae(),Bt(),Or(),Qu={name:"unpack",inputNames:["A"],inputTypes:[2]},dh=(e,t)=>{let r=t.dims.length,n=Hr("rc",r),i=n.slice(-2),o=Je(r),a=kt(),s=0===t.dims.length?"":hh(r,n),u=r<=1?"rc":`vec2(${i.join(",")})`,l=`\n    ${a}\n    void main() {\n      ${o} rc = getOutputCoords();\n\n       // Sample the texture with the coords to get the rgba channel value.\n       vec4 packedInput = getA(${s});\n\n       ${q(e.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${u}), 0, 0, 0);\n     }\n   `;return{...Qu,hasMain:!0,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l}},el=(e,t)=>({...Qu,get:()=>dh(e,t)})})),oo,hn,io,mn=L((()=>{dt(),oo=class{constructor(e,t=1){if(1===t)this.internalFormat=e.R32F,this.format=e.RED,this.textureType=e.FLOAT,this.channelSize=t;else{if(4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA32F,this.format=e.RGBA,this.textureType=e.FLOAT,this.channelSize=t}}encode(e,t){let r,n;return e.constructor!==Float32Array&&(pe.warning("Encoder","data was not of type Float32; creating new Float32Array"),n=new Float32Array(e)),t*this.channelSize>e.length?(pe.warning("Encoder","Source data too small. Allocating larger array"),n=e,r=this.allocate(t*this.channelSize),n.forEach(((e,t)=>r[t]=e))):(n=e,r=n),r}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter(((e,t)=>t%4==0)).subarray(0,t):e.subarray(0,t)}},hn=class{constructor(e,t=1,r){if(1!==t&&4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.channelSize=t,this.textureType=r||e.FLOAT}encode(e,t){let r=e;return 1===this.channelSize&&(pe.verbose("Encoder","Exploding into a larger array"),r=this.allocate(t),e.forEach(((e,t)=>r[4*t]=e))),r}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter(((e,t)=>t%4==0)).subarray(0,t):e.subarray(0,t)}},io=class{constructor(e,t=1){if(this.channelSize=4,1===t)this.internalFormat=e.ALPHA,this.format=e.ALPHA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else{if(4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t}}encode(e,t){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}allocate(e){return new Uint8Array(e*this.channelSize)}decode(e,t){if(e instanceof Uint8Array)return e.subarray(0,t);throw new Error(`Invalid array type: ${e.constructor}`)}}})),bn,rl,Ii,nl=L((()=>{fe(),ae(),bn=(e,t,r)=>{let n=0===r||1===r?1:4,i=2===r,o=1===r||2===r,a=4===r?t.length-1:void 0,s=4===r?t.map(((e,r)=>r===t.length-1?4*e:e)):void 0;return Ii(e,t,n,s,{isPacked:i,reverseWH:o,breakAxis:a})},rl=(e,t,r)=>{let n=bn(e,t,r);return[n.width,n.height]},Ii=(e,t,r=1,n,i)=>{let o=!(!i||!i.isPacked),[a,s]=e.computeTextureWH(o&&n||t,i),u=t.length,l=t.slice(0);if(0===u&&(l=[1]),1===r)n=t;else if(o){if(4!==r)throw new Error("a packed texture must be 4-channel");n=t,u>0&&(l[u-1]=Math.ceil(l[u-1]/2)),u>1&&(l[u-2]=Math.ceil(l[u-2]/2))}else if(!n)throw new Error("Unpacked shape is needed when using channels > 1");return{width:a,height:s,channels:r,isPacked:o,shape:l,strides:z.computeStrides(l),unpackedShape:n,reversedWH:i&&i.reverseWH}}})),bh,ao,il=L((()=>{dt(),_r(),fe(),Yu(),Ju(),Zu(),tl(),mn(),nl(),ae(),bh=(e,t)=>{let r=t.map((e=>`${e.unpackedShape.join(",")};${e.width}x${e.height}`)).join("_"),n=e.name;return e.cacheHint&&(n+="["+e.cacheHint+"]"),n+=":"+r,n},ao=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,t){return rl(this.session.layoutStrategy,e,t)}executeProgram(e,t){if(t.length<e.inputNames.length)throw new Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");let r=[];for(let n=0;n<e.inputNames.length;++n)r[n]=this.getOrCreateTextureData(t[n],e.inputTypes[n]);let n=bh(e,r),i=this.session.programManager.getArtifact(n),o=i?i.programInfo:"function"==typeof e.get?e.get():e,a=bn(this.session.layoutStrategy,o.output.dims,o.output.textureType),s=this.createTextureData(a,o.output.type);return i||(i=this.session.programManager.build(o,r,s),this.session.programManager.setArtifact(n,i)),this.runProgram(i,r,s),s}run(e,t){return this.executeProgram(e,t).tensor}runProgram(e,t,r){for(let r=0;r<t.length;++r)if(!!t[r].isPacked!=(2===e.programInfo.inputTypes[r]))throw new Error(`input[${r}] property packed inconsistent`);if(!!r.isPacked!=(2===e.programInfo.output.textureType))throw new Error("output property packed inconsistent");this.session.programManager.run(e,t,r)}getOrCreateTextureData(e,t){let r=this.getTextureData(e.dataId,2===t);if(!r&&(r=this.getTextureData(e.dataId,2!==t),r))return 2===t?this.pack(r):this.unpack(r);if(!r){let n=bn(this.session.layoutStrategy,e.dims,t);if(4===t){let r=e.dims;if(4===r.length){let n=[r[0],Math.ceil(r[1]*r[2]*r[3]/4)],i=bn(this.session.layoutStrategy,n,t),o=e.numberData;if(r[1]*r[2]*r[3]%4!=0){let t=r[0],n=r[1]*r[2]*r[3],i=4*Math.ceil(1*n/4);o=new Float32Array(t*i);for(let r=0;r<t;++r){let t=r*n,a=r*i+r%1*n;o.set(e.numberData.subarray(t,t+n),a)}}return this.createTextureData(i,e.type,o,e,1)}}if(2===t){let t=Ii(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),n=this.createTextureData(t,e.type,e.numberData,e,1);r=this.pack(n)}else r=this.createTextureData(n,e.type,e.numberData,e,1)}return r}createTextureDataFromLayoutBindTensor(e,t,r,n){return this.createTextureData(e,t,r,n,1)}createTextureData(e,t,r,n,i){pe.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);let o=this.session.textureManager.createTextureFromLayout(t,e,r,i);return this.createTextureDataFromTexture(e,t,o,n)}reshapeUnpacked(e,t){let r=this.getOrCreateTextureData(e,0),n={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t};return this.createTextureDataFromTexture(n,e.type,r.texture).tensor}reshapePacked(e,t){let r=this.getOrCreateTextureData(e,2);if(Ku(e.dims,t)){let n={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t,isPacked:!0};return this.createTextureDataFromTexture(n,e.type,r.texture).tensor}let n=_i(e.dims),i=_i(t),o=this.reshapePacked(e,n),a=this.run(Xu(this,o,i),[o]);return this.reshapePacked(a,t)}cast(e,t){let r=this.getOrCreateTextureData(e,0);return this.createTextureDataFromTexture(r,t,r.texture).tensor}createTextureDataFromTexture(e,t,r,n,i){let o={...e,tensor:n||new Ce(e.unpackedShape,t,(e=>this.readTexture(o)),(async e=>this.readTextureAsync(o)),void 0,i),texture:r};return this.setTextureData(o.tensor.dataId,o,e.isPacked),o}getTextureData(e,t=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,t):t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,r=!1){this.session.isInitializer(e)?this.session.setTextureData(e,t,r):(r?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,t)}isTextureLayoutCached(e,t=!1){return!!this.getTextureData(e.dataId,t)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((e=>this.session.textureManager.releaseTexture(e))),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((e=>this.session.textureManager.releaseTexture(e))),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(Oi(this,e))}async readTextureAsync(e){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(Oi(this,e))}pack(e){return this.executeProgram(qu(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram(el(this,e.tensor),[e.tensor])}}})),Si,te,Ge=L((()=>{Si=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map((e=>`${this[e]}`)).join(";")),this.key}},te=e=>new Si(e)})),al,sl,ul,gh,yh,ll=L((()=>{Ge(),ve(),ae(),al={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},sl=(e,t,r)=>(yh(t),[e.run({...al,cacheHint:r.cacheKey,get:()=>gh(e,t,r)},t)]),ul=e=>{let t=e.attributes.getFloat("epsilon",1e-5),r=e.attributes.getFloat("momentum",.9),n=e.attributes.getInt("spatial",1);return te({epsilon:t,momentum:r,spatial:n})},gh=(e,t,r)=>{let n=q(e.session.backend.glContext.version),i=t[0].dims.length,[o,a]=e.calculateTextureWidthAndHeight(t[1].dims,0),s=`\n  float process(int[${i}] indices) {\n    vec2 position = offsetToCoords(indices[1], ${o}, ${a});\n    float scale = getColorAsFloat(${n.texture2D}(Scale, position));\n    float mean = getColorAsFloat(${n.texture2D}(Mean, position));\n    float variance = getColorAsFloat(${n.texture2D}(Variance, position));\n    float b = getColorAsFloat(${n.texture2D}(B, position));\n\n    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${r.epsilon})) ) + b;\n  }`;return{...al,output:{dims:t[0].dims,type:t[0].type,textureType:0},shaderSource:s}},yh=e=>{if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs.");let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length||1!==i.dims.length||1!==o.dims.length)throw new Error("invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1]||i.dims[0]!==t.dims[1]||o.dims[0]!==t.dims[1])throw new Error("invalid input shape.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==i.type&&"float64"!==i.type||"float32"!==o.type&&"float64"!==o.type)throw new Error("invalid input tensor types.")}})),so,gt,G,gn,uo,qt=L((()=>{so=class{constructor(e,t,r,n){this.glContext=e,this.programInfo=t,this.inputTextureLayouts=r,this.outputTextureLayout=n}},gt=class{constructor(e){this.context=e}},G=class{constructor(e,t){this.routineBody=e,this.dependencies=t}},gn=class{constructor(e,t,r){this.name=e,this.dependencies=r||[],t&&(this.routineBody=t)}addDependency(e){e&&this.dependencies.push(e)}},uo=class{static returnOrderedNodes(e){if(!e||0===e.length)return[];if(1===e.length)return e;let t=new Set,r=new Set,n=new Array;return this.createOrderedNodes(e,t,r,n),n}static createOrderedNodes(e,t,r,n){for(let i=0;i<e.length;++i)this.dfsTraverse(e[i],t,r,n)}static dfsTraverse(e,t,r,n){if(!e||r.has(e.name))return;if(t.has(e.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");t.add(e.name);let i=e.dependencies;if(i&&i.length>0)for(let e=0;e<i.length;++e)this.dfsTraverse(i[e],t,r,n);n.push(e),r.add(e.name),t.delete(e.name)}}}));function xh(){let e="add_";return{body:`\n  float ${e}(float a, float b) {\n    return a + b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 + v2;\n  }\n  `,name:e,type:0}}function wh(){let e="div_";return{body:`\n  float ${e}(float a, float b) {\n    return a / b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 / v2;\n  }\n  `,name:e,type:0}}function vh(){let e="mul_";return{body:`\n  float ${e}(float a, float b) {\n    return a * b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 * v2;\n  }\n  `,name:e,type:0}}function _h(){let e="sub_";return{body:`\n  float ${e}(float a, float b) {\n    return a - b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 - v2;\n  }\n  `,name:e,type:0}}function Oh(){let e="equal_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a == b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4(equal(v1, v2));\n  }\n  `,name:e,type:0}}function Ih(){let e="greater_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a > b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4( v1.r > v2.r ,\n      v1.g > v2.g,\n      v1.b > v2.b,\n      v1.a > v2.a );\n  }\n  `,name:e,type:0}}function Sh(){let e="less_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a < b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4( v1.r < v2.r ,\n                v1.g < v2.g,\n                v1.b < v2.b,\n                v1.a < v2.a );\n  }\n  `,name:e,type:0}}function Ah(){let e="and_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) && bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r && b2.r ,\n                b1.g && b2.g,\n                b1.b && b2.b,\n                b1.a && b2.a );\n  }\n  `,name:e,type:0}}function Eh(){let e="or_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) || bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r || b2.r ,\n                b1.g || b2.g,\n                b1.b || b2.b,\n                b1.a || b2.a );\n  }\n  `,name:e,type:0}}function Ph(){let e="xor_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) ^^ bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r ^^ b2.r ,\n                b1.g ^^ b2.g,\n                b1.b ^^ b2.b,\n                b1.a ^^ b2.a );\n  }\n  `,name:e,type:0}}function Dh(){return Fh("pow")}function Lh(){let e="prelu_";return{body:`\n  float ${e}(float a, float b) {\n    return a < 0.0 ? a * b: a;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4(\n      v1.r < 0.0 ? v1.r * v2.r: v1.r,\n      v1.g < 0.0 ? v1.g * v2.g: v1.g,\n      v1.b < 0.0 ? v1.b * v2.b: v1.b,\n      v1.a < 0.0 ? v1.a * v2.a: v1.a\n      );\n  }\n  `,name:e,type:0}}function Fh(e){let t=`${e}_`;return{body:`\n  float ${t}(float a, float b) {\n    return ${e}(a, b);\n  }\n  vec4 ${t}(vec4 v1, vec4 v2) {\n    return ${e}(v1, v2);\n  }\n  `,name:t,type:0}}var yt,Ch,fl,cl,pl,dl,hl,ml,bl,gl,yl,Tl,xl,wl,vl=L((()=>{fe(),qt(),ve(),ae(),yt=(e,t,r,n=t[0].type,i)=>{let o=e.session.pack?2:0;return{name:r.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:i,get:()=>Ch(e,t,r,n)}},Ch=(e,t,r,n=t[0].type)=>{let i=e.session.pack?2:0,o=!z.areEqual(t[0].dims,t[1].dims),a=t[0].dims,s=e.session.pack;if(o){let o=Ke.calcShape(t[0].dims,t[1].dims,!1);if(!o)throw new Error("Can't perform binary op on the given tensors");a=o;let u=a.length,l=0!==t[0].dims.length?t[0].dims.length:1,h=0!==t[1].dims.length?t[1].dims.length:1,c=0!==t[0].dims.length?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",d=0!==t[1].dims.length?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",f=q(e.session.backend.glContext.version),p=s?`\n      ${r.body}\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n        vec4 result = ${r.name}(a, b);\n        ${f.output} = result;\n      }`:`\n      ${r.body}\n      float process(int indices[${u}]) {\n        int aindices[${l}];\n        int bindices[${h}];\n        ${c}\n        ${d}\n        return ${r.name}(_A(aindices), _B(bindices));\n      }`;return{name:r.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:a,type:n,textureType:i},shaderSource:p,hasMain:s}}let u=q(e.session.backend.glContext.version),l=`\n    ${r.body}\n    void main() {\n      vec4 v1 = ${u.texture2D}(A, TexCoords);\n      vec4 v2 = ${u.texture2D}(B, TexCoords);\n      vec4 result = ${r.name}(v1, v2);\n      ${u.output} = result;\n    }\n    `;return{name:r.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:t[0].dims,type:n,textureType:i},shaderSource:l,hasMain:!0}},fl=(e,t)=>[e.run(yt(e,t,xh()),t)],cl=(e,t)=>[e.run(yt(e,t,Ah(),"bool"),t)],pl=(e,t)=>[e.run(yt(e,t,wh()),t)],dl=(e,t)=>[e.run(yt(e,t,Oh(),"bool"),t)],hl=(e,t)=>[e.run(yt(e,t,Ih(),"bool"),t)],ml=(e,t)=>[e.run(yt(e,t,Sh(),"bool"),t)],bl=(e,t)=>[e.run(yt(e,t,vh()),t)],gl=(e,t)=>[e.run(yt(e,t,Eh(),"bool"),t)],yl=(e,t)=>[e.run(yt(e,t,Dh()),t)],Tl=(e,t)=>[e.run(yt(e,t,Lh()),t)],xl=(e,t)=>[e.run(yt(e,t,_h()),t)],wl=(e,t)=>[e.run(yt(e,t,Ph(),"bool"),t)]})),_l,Ol,Bh,Il=L((()=>{fe(),_l=(e,t,r)=>(Bh(t),[e.cast(t[0],r)]),Ol=e=>Ve.tensorDataTypeFromProto(e.attributes.getInt("to")),Bh=e=>{if(!e||1!==e.length)throw new Error("Cast requires 1 input.");if("string"===e[0].type)throw new Error("Invalid input type.")}})),kh,Nh,Sl,lo,Al=L((()=>{ve(),ae(),Bt(),Or(),kh=(e,t)=>({name:"Concat (packed)",inputNames:Array.from({length:e},((e,t)=>`X${t}`)),inputTypes:Array(e).fill(2),cacheHint:t}),Nh=(e,t,r,n)=>{let i=r[0].dims.slice();if(n>=i.length||n<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");n<0&&(n=i.length+n);let o=i.slice(0);for(let e=1;e<r.length;e++){let t=r[e].dims.slice();for(let e=0;e<i.length;e++)if(e===n)o[n]+=t[e];else if(i[e]!==t[e])throw new Error("non concat dimensions must match")}let a=o.length,s=Hr("coords",a),u=Je(a),l=kt(),h=r.map((e=>e.dims)),c=Dt(a),d=new Array(h.length-1);d[0]=h[0][n];for(let e=1;e<d.length;e++)d[e]=d[e-1]+h[e][n];let f=c[n],p=c.slice(-2),y=c.join(),g=`if (${f} < ${d[0]}) {\n        return getChannel(\n            getX0(${y}), vec2(${p.join()}));\n        }`;for(let e=1;e<d.length;e++){let t=d[e-1];g+=`\n            if (${f} < ${d[e]}  && ${f} >= ${d[e-1]}) {\n              return getChannel(\n                getX${e}(${lo(c,f,t)}),\n                vec2(${lo(p,f,t)}));\n            }`}let m=d.length,w=d[d.length-1];g+=`\n            return getChannel(\n              getX${m}(${lo(c,f,w)}),\n              vec2(${lo(p,f,w)}));`;let b=q(e.session.backend.glContext.version),v=`\n          ${l}\n          float getValue(${c.map((e=>"int "+e))}) {\n            ${g}\n          }\n\n          void main() {\n            ${u} coords = getOutputCoords();\n            int lastDim = coords.${c[a-1]};\n            coords.${c[a-1]} = coords.${c[a-2]};\n            coords.${c[a-2]} = lastDim;\n\n            vec4 result = vec4(getValue(${s}), 0., 0., 0.);\n\n            ${s[a-1]} = ${s[a-1]} + 1;\n            if (${s[a-1]} < ${o[a-1]}) {\n              result.g = getValue(${s});\n            }\n\n            ${s[a-2]} = ${s[a-2]} + 1;\n            if (${s[a-2]} < ${o[a-2]}) {\n              result.a = getValue(${s});\n            }\n\n            ${s[a-1]} = ${s[a-1]} - 1;\n            if (${s[a-2]} < ${o[a-2]} &&\n                ${s[a-1]} < ${o[a-1]}) {\n              result.b = getValue(${s});\n            }\n            ${b.output} = result;\n          }\n        `;return{...t,output:{dims:o,type:r[0].type,textureType:2},shaderSource:v,hasMain:!0}},Sl=(e,t,r)=>{let n=kh(t.length,r.cacheKey);return{...n,get:()=>Nh(e,n,t,r.axis)}},lo=(e,t,r)=>{let n=e.indexOf(t);return e.map(((e,t)=>t===n?`${e} - ${r}`:e)).join()}})),El,Rh,Mh,Gh,Pl,Uh,zh,Wh,Dl,Vh,Ll=L((()=>{Ge(),ae(),Al(),El=(e,t,r)=>(Vh(t),e.session.pack&&t[0].dims.length>1?[e.run(Sl(e,t,r),t)]:[e.run(Gh(e,t,r),t)]),Rh=(e,t)=>({name:"Concat",inputNames:Array.from({length:e},((e,t)=>`X${t}`)),inputTypes:Array(e).fill(0),cacheHint:t}),Mh=(e,t,r,n)=>{let i=r[0].dims.slice();if(n>=i.length||n<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");n<0&&(n=i.length+n);let o=i.slice(0);for(let e=1;e<r.length;e++){let t=r[e].dims.slice();for(let e=0;e<i.length;e++)if(e===n)o[n]+=t[e];else if(i[e]!==t[e])throw new Error("non concat dimensions must match")}let a=o.length,s=new Array(r.length),u=0;for(let e=0;e<s.length;++e)u+=r[e].dims[n],s[e]=u;let l="";l=r.length<5?Pl(s):Uh(s);let h=`\n        ${zh(r.length,a)}\n        ${Wh(s)}\n        ${l}\n        float process(int indices[${a}]) {\n          int textureIndex = getTextureWhereDataResides (indices[${n}]);\n\n          if(textureIndex != 0) {\n            indices[${n}] = indices[${n}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));\n          }\n\n          return fetchDataFromCorrectTexture(textureIndex, indices);\n        }`;return{...t,output:{dims:o,type:r[0].type,textureType:0},shaderSource:h}},Gh=(e,t,r)=>{let n=Rh(t.length,r.cacheKey);return{...n,get:()=>Mh(e,n,t,r.axis)}},Pl=e=>`int getTextureWhereDataResides(int index) {\n      ${e.map(((e,t)=>`if(index<${e}) {return ${t};}\n`)).join("")}\n    }`,Uh=e=>Pl(e),zh=(e,t)=>{let r=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${t}]) {`];for(let t=0;t<e;++t)0===t?r.push(`\tif (textureIndex == ${t}) { return _X${t}(indices); }`):t===e-1?r.push(`\telse { return _X${t}(indices); }`):r.push(`\telse if (textureIndex == ${t}) { return _X${t}(indices); }`);return r.push("\t}"),r.join("\n")},Wh=e=>{let t=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let r=0;r<e.length;++r)0===r?t.push(`\tif (index == ${r}) { return ${e[r]}; }`):r===e.length-1?t.push(`\telse { return ${e[r]}; }`):t.push(`\telse if (index == ${r}) { return ${e[r]}; }`);return t.push("\t}"),t.join("\n")},Dl=e=>te({axis:e.attributes.getInt("axis")}),Vh=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].type,r=e[0].dims.length;if("string"===t)throw new Error("string tensor is not supported yet");for(let n of e){if(n.type!==t)throw new Error("input tensors should be one type");if(n.dims.length!==r)throw new Error("input tensors should have the same shape")}}}));function Hh(){return Tt("abs")}function jh(){return Tt("acos")}function qh(){return Tt("asin")}function Yh(){return Tt("atan")}function Xh(){return Tt("ceil")}function Kh(){return Tt("cos")}function Jh(e){let t="elu";return{body:`\n  const float alpha = float(${e});\n\n  float ${t}_(float a) {\n    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;\n  }\n  vec4 ${t}_(vec4 v) {\n    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));\n  }\n  `,name:t,type:0}}function Zh(){return Tt("exp")}function Qh(){return Tt("floor")}function Ai(e,t){let r="clip";return{body:`\n  const float min = float(${e});\n  const float max = float(${t});\n\n  float ${r}_(float a) {\n    return clamp(a, min, max);\n  }\n  vec4 ${r}_(vec4 v) {\n    return clamp(v, min, max);\n  }\n  `,name:r,type:0}}function em(){let e="indentity";return{body:`\n  float ${e}_(float a) {\n    return a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return v;\n  }\n  `,name:e,type:0}}function tm(e){let t="leakyRelu";return{body:`\n  const float alpha = float(${e});\n\n  float ${t}_(float a) {\n    return a < 0.0 ? a * alpha : a;\n  }\n  vec4 ${t}_(vec4 v) {\n    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));\n  }\n  `,name:t,type:0}}function rm(){return Tt("log")}function nm(){let e="neg";return{body:`\n  float ${e}_(float a) {\n    return -a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return -v;\n  }\n  `,name:e,type:0}}function om(){let e="not";return{body:`\n  float ${e}_(float a) {\n    return float( ! bool(a) );\n  }\n  bool ${e}_(bool a) {\n    return !a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));\n  }\n  bvec4 ${e}_(bvec4 v) {\n    return bvec4(!v.x, !v.y, !v.z, !v.w);\n  }\n  `,name:e,type:0}}function im(){return Tt("sin")}function Ei(){let e="relu";return{body:`\n  float ${e}_(float a) {\n    return max( a, 0.0 );\n  }\n  vec4 ${e}_(vec4 v) {\n    return max( v, 0.0 );\n  }\n  `,name:e,type:0}}function Pi(){let e="sigmoid";return{body:`\n  float ${e}_(float a) {\n    return 1.0 / (1.0 + exp(-a));\n  }\n  vec4 ${e}_(vec4 v) {\n    return 1.0 / (1.0 + exp(-v));\n  }\n  `,name:e,type:0}}function am(){return Tt("sqrt")}function sm(){return Tt("tan")}function um(){let e="tanh";return{body:`\n  float ${e}_(float a) {\n    a = clamp(a, -10., 10.);\n    a = exp(2.*a);\n    return (a - 1.) / (a + 1.);\n  }\n  vec4 ${e}_(vec4 v) {\n    v = clamp(v, -10., 10.);\n    v = exp(2.*v);\n    return (v - 1.) / (v + 1.);\n  }\n  `,name:e,type:0}}function Tt(e){return{body:`\n  float ${e}_(float a) {\n    return ${e}(a);\n  }\n  vec4 ${e}_(vec4 v) {\n    return ${e}(v);\n  }\n  `,name:e,type:0}}var lm,Le,Fl,Cl,$l,Bl,Di,kl,Nl,fm,Rl,Ml,Gl,Ul,zl,Wl,Li,Vl,Hl,jl,ql,Yl,Xl,Kl,Jl,Zl,Ql,ef,Fi=L((()=>{Ge(),fe(),qt(),ve(),ae(),lm=(e,t,r,n)=>{let i=e.session.pack?2:0,o=q(e.session.backend.glContext.version);return{...t,output:{dims:r.dims,type:r.type,textureType:i},shaderSource:`\n     ${n.body}\n     void main() {\n       vec4 v = ${o.texture2D}(A, TexCoords);\n       v = ${n.name}_(v);\n       ${o.output} = v;\n     }\n     `,hasMain:!0}},Le=(e,t,r,n)=>{let i=e.session.pack?2:0,o={name:r.name,inputTypes:[i],inputNames:["A"],cacheHint:n};return{...o,get:()=>lm(e,o,t,r)}},Fl=(e,t)=>[e.run(Le(e,t[0],Hh()),t)],Cl=(e,t)=>[e.run(Le(e,t[0],jh()),t)],$l=(e,t)=>[e.run(Le(e,t[0],qh()),t)],Bl=(e,t)=>[e.run(Le(e,t[0],Yh()),t)],Di=(e,t,r)=>[e.run(Le(e,t[0],Ai(r.min,r.max),r.cacheKey),t)],kl=e=>te({min:e.attributes.getFloat("min",wr),max:e.attributes.getFloat("max",vr)}),Nl=(e,t)=>{let r=fm(e,t);return Di(e,[t[0]],r)},fm=(e,t)=>{if(t.length>=3&&(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)))throw new Error("dynamic clip attributes are not allowed");let r=t.length>=3?t[1].numberData[0]:wr,n=t.length>=3?t[2].numberData[0]:vr;return te({min:r,max:n})},Rl=(e,t)=>[e.run(Le(e,t[0],Xh()),t)],Ml=(e,t)=>[e.run(Le(e,t[0],Kh()),t)],Gl=(e,t,r)=>[e.run(Le(e,t[0],Jh(r.alpha),r.cacheKey),t)],Ul=e=>te({alpha:e.attributes.getFloat("alpha",1)}),zl=(e,t)=>[e.run(Le(e,t[0],Zh()),t)],Wl=(e,t)=>[e.run(Le(e,t[0],Qh()),t)],Li=(e,t)=>[e.run(Le(e,t[0],em()),t)],Vl=(e,t,r)=>[e.run(Le(e,t[0],tm(r.alpha),r.cacheKey),t)],Hl=e=>te({alpha:e.attributes.getFloat("alpha",.01)}),jl=(e,t)=>[e.run(Le(e,t[0],rm()),t)],ql=(e,t)=>[e.run(Le(e,t[0],nm()),t)],Yl=(e,t)=>[e.run(Le(e,t[0],om()),t)],Xl=(e,t)=>[e.run(Le(e,t[0],Ei()),t)],Kl=(e,t)=>[e.run(Le(e,t[0],Pi()),t)],Jl=(e,t)=>[e.run(Le(e,t[0],im()),t)],Zl=(e,t)=>[e.run(Le(e,t[0],am()),t)],Ql=(e,t)=>[e.run(Le(e,t[0],sm()),t)],ef=(e,t)=>[e.run(Le(e,t[0],um()),t)]}));function Nt(e){let t;switch(e.activation){case"Relu":t=Ei();break;case"Sigmoid":t=Pi();break;case"Clip":t=Ai(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let r=t.name;return{activationFunction:t.body,applyActivation:`value = ${r}_(value);`}}var jr,Ir=L((()=>{fe(),Fi(),jr=e=>{let t=e.getString("activation","");if("Clip"===t){let[r,n]=e.getFloats("activation_params",[wr,vr]);return{activation:t,clipMax:n,clipMin:r,activationCacheKey:`${t}:${r},${n}`}}return{activation:t,activationCacheKey:t}}})),pm,dm,tf,rf=L((()=>{dt(),ve(),ae(),fo(),Ir(),pm=(e,t)=>({name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),dm=(e,t,r,n)=>{let i=t.length>2?"value += getBias(output_channel);":"",o=t[0].dims.slice(),a=t[1].dims.slice(),s=a[0]/n.group;pe.verbose("GroupedConv",`autpPad:${n.autoPad}, dilations:${n.dilations}, group:${n.group}, kernelShape:${n.kernelShape}, pads:${n.pads}, strides:${n.strides}`);let u=qr(o,a,n.dilations,n.pads,n.strides),l=q(e.session.backend.glContext.version),{activationFunction:h,applyActivation:c}=Nt(n),d=`\n  const ivec2 strides = ivec2(${n.strides[0]}, ${n.strides[1]});\n  const ivec2 pads = ivec2(${n.pads[0]}, ${n.pads[1]});\n  ${h}\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n    ivec2 xRCCorner = coords.zw * strides - pads;\n    int group_id = output_channel / ${s};\n\n    float value = 0.0;\n    for (int wInChannel = 0; wInChannel < ${a[1]}; wInChannel++) {\n      int input_channel = group_id * ${a[1]} + wInChannel;\n      for (int wHeight = 0; wHeight < ${a[2]}; wHeight++) {\n        int xHeight = xRCCorner.x + wHeight * ${n.dilations[0]};\n\n        if (xHeight < 0 || xHeight >= ${o[2]}) {\n          continue;\n        }\n\n        for (int wWidth = 0; wWidth < ${a[3]}; wWidth++) {\n          int xWidth = xRCCorner.y + wWidth * ${n.dilations[1]};\n          if (xWidth < 0 || xWidth >= ${o[3]}) {\n            continue;\n          }\n\n          float xVal = getX(batch, input_channel, xWidth, xHeight);\n          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${i}\n    ${c}\n    ${l.output} = vec4(value, .0, .0, .0);\n  }\n`;return{...r,output:{dims:u,type:t[0].type,textureType:0},shaderSource:d,hasMain:!0}},tf=(e,t,r)=>{let n=pm(t.length>2,r.cacheKey);return{...n,get:()=>dm(e,t,n,r)}}})),hm,mm,nf,of=L((()=>{ve(),ae(),Or(),hm=e=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:e}),mm=(e,t,r,n,i,o)=>{let a=r.dims,s=n.dims,u=i.length,l=[s[1]*s[2]*s[3],i[2]*i[3]],h=s[2]*s[3],c=kt(),d=q(e.session.backend.glContext.version),f="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)f+=`\n            blockIndex = rc.x + ${t};\n            pos = rc.y + ${e};\n\n            if(blockIndex < ${l[1]} && pos < ${l[0]}) {\n              offsetY = int(blockIndex / (${i[u-1]})) * ${o.strides[0]} -\n                ${o.pads[0]};\n              d0 = offsetY + ${o.dilations[0]} * (imod(pos, ${h}) / ${s[2]});\n\n              if(d0 < ${a[2]} && d0 >= 0) {\n                offsetX = imod(blockIndex, ${i[u-1]}) * ${o.strides[1]} -\n                  ${o.pads[1]};\n                d1 = offsetX + ${o.dilations[1]} * imod(imod(pos, ${h}), ${s[2]});\n\n                if(d1 < ${a[3]} && d1 >= 0) {\n\n                  ch = int(float(pos)/ ${h}.);\n                    innerDims = vec2(d0, d1);\n                    result[${2*e+t}] = getChannel(\n                      getA(0, ch, int(innerDims.x),\n                      int(innerDims.y)), innerDims);\n                }\n              }\n            }\n\n          `;let p=`\n      ${c}\n\n      void main() {\n        ivec2 rc = getOutputCoords();\n          vec4 result = vec4(0.0);\n          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n          vec2 innerDims;\n          ${f}\n          ${d.output} = result;\n      }\n            `;return{...t,output:{dims:l,type:r.type,textureType:2},shaderSource:p,hasMain:!0}},nf=(e,t,r,n,i)=>{let o=hm(i.cacheKey);return{...o,get:()=>mm(e,o,t,r,n,i)}}}));function gm(e,t,r){let n=t[0].dims,i=t[1].dims,o=Ke.calcShape(n,i,!0);if(!o)throw new Error("Can't use matmul on the given tensors");let a=Je(o.length),s=Dt(),{activationFunction:u,applyActivation:l}=Nt(r),h=t.length>2,c=h?"value += getBiasForMatmul();":"",d=h?`${$i(a,s,t[2].dims,o,!1)}`:"",f=o.length,p=n.length,y=i.length,g=`\n    ${u}\n    ${d}\n    float process(int indices[${f}]) {\n        int a[${p}];\n        int b[${y}];\n        bcastMatmulIndices_A(indices, a);\n        bcastMatmulIndices_B(indices, b);\n\n        float value;\n        for (int k=0; k<${n[n.length-1]}; ++k) {\n            a[${p-1}] = k;\n            b[${y-2}] = k;\n            value += _A(a) * _B(b);\n        }\n        ${c}\n        ${l}\n        return value;\n    }`;return{...e,output:{dims:o,type:t[0].type,textureType:0},shaderSource:g}}function Ci(e,t){let r=bm(e.length>2,t.activationCacheKey);return{...r,get:()=>gm(r,e,t)}}function $i(e,t,r,n,i){let o="",a=r.length,s=n.length,u=s-a;o=s<2&&a>0?"coords":r.map(((e,r)=>`coords.${t[r+u]}`)).join(", ");let l=Ke.getBroadcastDims(r,n).map((e=>`coords.${t[e+u]} = 0;`)).join("\n"),h="vec4(outputValue.xx, outputValue.yy)";return 1===z.size(r)&&(h="vec4(outputValue.x)"),i?`\nvec4 getBiasForMatmul() {\n  ${e} coords = getOutputCoords();\n  ${l}\n  vec4 outputValue = getBias(${o});\n  return ${h};\n}`:`\nfloat getBiasForMatmul() {\n  ${e} coords = getOutputCoords();\n  ${l}\n  return getBias(coords.x);\n}`}var af,sf,bm,ym,co=L((()=>{fe(),ae(),Bt(),Ir(),Bi(),af=(e,t,r)=>(ym(t),e.session.pack?[e.run(po(e,t,r),t)]:[e.run(Ci(t,r),t)]),sf=e=>jr(e.attributes),bm=(e,t)=>({name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),ym=e=>{if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type)throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match")}}));function wm(e,t,r,n){let i=[],o=[],a=r[0].dims,s=r[1].dims,u=a.length,l=s.length,h=n.length,c=h-u,d=h-l;i=a.map(((e,r)=>`coords.${t[r+c]}`)),i[u-1]="i*2",i.join(", "),o=s.map(((e,r)=>`coords.${t[r+d]}`)),o[l-2]="i*2",o.join(", ");let f=Ke.getBroadcastDims(a,n),p=Ke.getBroadcastDims(s,n),y=f.map((e=>`coords.${t[e+c]} = 0;`)).join("\n"),g=p.map((e=>`coords.${t[e+d]} = 0;`)).join("\n"),m=`int lastDim = coords.${t[h-1]};\n  coords.${t[h-1]} = coords.${t[h-2]};\n  coords.${t[h-2]} = lastDim;`;return`\nvec4 getAAtOutCoordsMatmul(int i) {\n  ${e} coords = getOutputCoords();\n  ${m}\n  ${y}\n  vec4 outputValue = getA(${i});\n  return outputValue;\n}\n\nvec4 getBAtOutCoordsMatmul(int i) {\n  ${e} coords = getOutputCoords();\n  ${m}\n  ${g}\n  vec4 outputValue = getB(${o});\n  return outputValue;\n}`}function vm(e,t){let r="";for(let n=0;n<t-2;n++)r+=`rc.${e[n]}, `;return r+=`rc.${e[t-2]}, i*2`,r}function _m(e,t){let r="";for(let n=0;n<t-2;n++)r+=`rc.${e[n]}, `;return r+=`i*2, rc.${e[t-1]}`,r}var Tm,xm,po,Bi=L((()=>{fe(),ve(),ae(),Bt(),Ir(),co(),Tm=(e,t)=>({name:"MatMul (packed)",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[2,2,2]:[2,2],cacheHint:t}),xm=(e,t,r,n)=>{let i=r.length>2,o=i?"value += getBiasForMatmul();":"",a=r[0].dims,s=r[1].dims,u=Ke.calcShape(a,s,!0),l=!z.areEqual(r[0].dims,r[1].dims);if(!u)throw new Error("Can't use matmul on the given tensors");let h=a[a.length-1],c=Math.ceil(h/2),d=a.length,f=s.length,p=q(e.session.backend.glContext.version),y=Je(u.length),g=u.length,m=Dt(),{activationFunction:w,applyActivation:b}=Nt(n),v=i?`${$i(y,m,r[2].dims,u,!0)}`:"",x=l?`${wm(y,m,r,u)}`:"",_=l?"getAAtOutCoordsMatmul(i)":`getA(${vm(m,d)})`,I=l?"getBAtOutCoordsMatmul(i)":`getB(${_m(m,f)})`,A=`\n            ${x}\n            ${v}\n            ${w}\n            void main() {\n              ${l?"":`${y} rc =\n          getOutputCoords(); int lastDim = rc.${m[g-1]}; rc.${m[g-1]} =\n          rc.${m[g-2]}; rc.${m[g-2]} = lastDim;\n      `}\n\n              vec4 value = vec4(0);\n              for (int i = 0; i < ${c}; i++) {\n                vec4 a = ${_};\n                vec4 b = ${I};\n\n                value += (a.rrbb * b.rgrg);\n                value += (a.ggaa * b.baba);\n              }\n              ${o}\n              ${b}\n              ${p.output} = value;\n            }`;return{...t,output:{dims:u,type:r[0].type,textureType:2},shaderSource:A,hasMain:!0}},po=(e,t,r)=>{let n=Tm(t.length>2,r.activationCacheKey);return{...n,get:()=>xm(e,n,t,r)}}})),uf,lf=L((()=>{fo(),of(),Bi(),uf=(e,t,r)=>{let n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.run(nf(e,t[0],t[1],o,r),[t[0]]),s=e.reshapePacked(t[1],[i[0],i[1]*i[2]*i[3]]),u=3===t.length?[s,a,t[2]]:[s,a],l=e.run(po(e,u,r),u);return e.reshapePacked(l,o)}})),Om,Im,ff,ki,Ni=L((()=>{ae(),Om=e=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:e}),Im=(e,t,r,n,i,o)=>{let a=r.dims,s=n.dims,u=i.length,l=ki(a,s,i,4),h=`\n        const int XC = ${a[1]};\n        const int XH = ${a[2]};\n        const int XW = ${a[3]};\n        const int KH = ${o.kernelShape[0]};\n        const int KW = ${o.kernelShape[1]};\n        const int dilationH = ${o.dilations[0]};\n        const int dilationW = ${o.dilations[1]};\n        const int strideH = ${o.strides[0]};\n        const int strideW = ${o.strides[1]};\n        const int padH = ${o.pads[0]};\n        const int padW = ${o.pads[1]};\n        const int KHKW = KH*KW;\n        const int XCKHKW = XC * KHKW;\n        const int outputChannels = 4;\n        vec4 process(int indices[${u}]) {\n          int b  = indices[0]; // batch size\n          int oh = indices[1] * strideH - padH; //output height\n          int ow = indices[2] * strideW - padW; //output width\n          int p = indices[3] * outputChannels; //patch\n          vec4 value = vec4(0.0);\n          for(int i=0; i < outputChannels; ++i) {\n            if(p < XCKHKW) {\n              int patchC = p / KHKW;\n              int patchH = (p - patchC*KHKW) / KW;\n              int patchW = (p - patchC*KHKW) - patchH * KW;\n              int xh2 = oh + patchH * dilationH;\n              int xw2 = ow + patchW * dilationW;\n              int x[${a.length}];\n              x[0] = b;\n              x[1] = patchC;\n              x[2] = xh2;\n              x[3] = xw2;\n              if(xh2 >= 0 &&\n                  xh2 < XH &&\n                  xw2 >= 0 &&\n                  xw2 < XW) {\n                value[i] = _X(x);\n              }\n            }\n            ++p;\n          }\n          return value;\n        }\n        `;return{...t,output:{dims:l,type:r.type,textureType:4},shaderSource:h}},ff=(e,t,r,n,i)=>{let o=Om(i.cacheKey);return{...o,get:()=>Im(e,o,t,r,n,i)}},ki=(e,t,r,n=4)=>[r[0],r[2],r[3],Math.ceil(e[1]*t[2]*t[3]/n)]})),Sm,Am,cf,pf=L((()=>{fe(),ve(),ae(),Ir(),Ni(),Sm=(e,t)=>({name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[0,4,0]:[0,4],cacheKey:t.activationCacheKey}),Am=(e,t,r,n,i)=>{let o=r[0].dims,a=r[1].dims,s=[a[0],Math.ceil(o[1]*a[2]*a[3]/4)],u=ki(o,a,n),[l,h]=e.calculateTextureWidthAndHeight(s,4),c=z.computeStrides(u),[d,f]=e.calculateTextureWidthAndHeight(u,4),p=n.length,y=r.length<3?"0.0":"_B(b)",g=Math.ceil(o[1]*a[2]*a[3]/4),{activationFunction:m,applyActivation:w}=Nt(i),b=q(e.session.backend.glContext.version),v=`\n${m}\nfloat process(int indices[${p}]) {\n  int b[1];\n  b[0] = indices[1];\n  int im2col[4];\n  im2col[0] = indices[0];\n  im2col[1] = indices[2];\n  im2col[2] = indices[3];\n  int im2colOffset = im2col[0] * ${c[0]} + im2col[1] * ${c[1]} + im2col[2] * ${c[2]};\n  int kernelOffset = indices[1] * ${s[1]};\n  float value = ${y};\n  for (int i = 0; i < ${g}; ++i) {\n    vec2 im2colCoords = offsetToCoords(im2colOffset, ${d}, ${f});\n    vec2 kernelCoords = offsetToCoords(kernelOffset, ${l}, ${h});\n    value += dot(${b.texture2D}(Im2Col, im2colCoords), ${b.texture2D}(K, kernelCoords));\n    ++im2colOffset;\n    ++kernelOffset;\n  }\n  ${w}\n  return value;\n}`;return{...t,output:{dims:n,type:r[0].type,textureType:0},shaderSource:v}},cf=(e,t,r,n)=>{let i=Sm(t.length>2,n);return{...i,get:()=>Am(e,i,t,r,n)}}})),qr,Ri,Em,Pm,Dm,Lm,Mi,Fm,fo=L((()=>{Ge(),fe(),rf(),lf(),pf(),Ir(),Ni(),co(),qr=(e,t,r,n,i)=>{let o=e[0],a=e.slice(2),s=a.length,u=t[0],l=t.slice(2).map(((e,t)=>e+(e-1)*(r[t]-1))),h=a.map(((e,t)=>e+n[t]+n[t+s])).map(((e,t)=>Math.floor((e-l[t]+i[t])/i[t])));return[o,u].concat(...h)},Ri=(e,t,r)=>(Fm(t,r),Em(e,t,r)),Em=(e,t,r)=>{let n=Lm(r,t),i=e.session.pack,o=1===n.kernelShape[0]&&1===n.kernelShape[1];return n.group>1?[e.run(tf(e,t,n),t)]:o&&i?[Pm(e,t,n)]:i&&4===t[0].dims.length&&1===t[0].dims[0]&&!o?[uf(e,t,n)]:[Dm(e,t,n)]},Pm=(e,t,r)=>{let n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.reshapeUnpacked(t[0],[n[1],n[2]*n[3]]),s=e.reshapeUnpacked(t[1],[i[0],i[1]]),u=t.length>2?[s,a,t[2]]:[s,a],l=e.run(Ci(u,r),u);return e.reshapeUnpacked(l,o)},Dm=(e,t,r)=>{let n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.run(ff(e,t[0],t[1],o,r),[t[0]]),s=3===t.length?[a,t[1],t[2]]:[a,t[1]];return e.run(cf(e,t,o,r),s)},Lm=(e,t)=>{let r=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e]);let n=e.pads.slice();xr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n,cacheKey:e.cacheKey}),i},Mi=e=>{let t=e.attributes,r=jr(t),n=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("pads",[0,0,0,0]),u=t.getInts("strides",[1,1]);return te({autoPad:n,dilations:i,group:o,kernelShape:a,pads:s,strides:u,...r})},Fm=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error(`dilations should be ${r}D`);if(t.strides.length!==r)throw new Error(`strides should be ${r}D`);if(t.pads.length!==2*r)throw new Error(`pads should be ${2*r}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("Conv input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("Conv input(bias) should be float tensor")}})),Cm,$m,Bm,df,km,Nm,Rm,Mm,Gm,Um,hf,zm,mf=L((()=>{Ge(),ve(),ae(),Ir(),Cm=(e,t,r,n,i,o)=>(e-1)*t+r+(n-1)*i+1-o,$m=(e,t,r,n,i)=>{let o=Math.floor(e/2);"SAME_UPPER"===t?(r[n]=o,r[i]=e-o):"SAME_LOWER"===t&&(r[n]=e-o,r[i]=o)},Bm=(e,t,r,n,i,o,a,s)=>{let u=e.length-2,l=0===s.length;for(let h=0;h<u;++h){let c=l?e[h+2]*o[h]:s[h],d=Cm(e[h+2],o[h],i[h],t[h],r[h],c);$m(d,n,i,h,h+u),l&&s.push(o[h]*(e[h+2]-1)+a[h]+(t[h]-1)*r[h]+1-i[h]-i[h+u])}},df=(e,t,r)=>(zm(t,r),km(e,t,r)),km=(e,t,r)=>{let n=Um(r,t);return[Gm(e,t,n)]},Nm=(e,t)=>({name:"ConvTranspose",inputNames:e?["X","W","B"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),Rm=(e,t,r,n)=>{let i=t.length>2?"getB(output_channel)":"0.0",o=t[0].dims,a=t[1].dims,s=a[1],u=a[0]/n.group,l=[t[0].dims[0],t[1].dims[1]*n.group,...n.outputShape],h=q(e.session.backend.glContext.version),{activationFunction:c,applyActivation:d}=Nt(n),f=`\n  const ivec2 strides = ivec2(${n.strides[0]}, ${n.strides[1]});\n  const ivec2 pads = ivec2(${n.pads[0]}, ${n.pads[1]});\n  ${c}\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n\n    ivec2 loc = coords.zw + pads;\n\n    int group_id = output_channel / ${s};\n    int wOutChannel = output_channel - group_id * ${s};\n\n    float value = ${i};\n    for (int inChannelOffset = 0; inChannelOffset < ${u}; inChannelOffset++) {\n      int input_channel = group_id * ${u} + inChannelOffset;\n      for (int wWOff = 0; wWOff < ${a[2]}; wWOff++) {\n        for (int wHOff = 0; wHOff < ${a[3]}; wHOff++) {\n          ivec2 wOff = ivec2(wWOff * ${n.dilations[0]}, wHOff * ${n.dilations[1]});\n          ivec2 wLoc = loc - wOff;\n          ivec2 wLocIn = wLoc / strides;\n          if (\n            wLocIn * strides == wLoc &&\n            wLocIn.x >= 0 && wLocIn.x < ${o[2]} &&\n            wLocIn.y >= 0 && wLocIn.y < ${o[3]}\n          ) {\n            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);\n            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);\n            value += xVal * wVal;\n          }\n        }\n      }\n    }\n    ${d}\n    ${h.output} = vec4(value, .0, .0, .0);\n  }\n`;return{...r,output:{dims:l,type:t[0].type,textureType:0},shaderSource:f,hasMain:!0}},Mm=(e,t,r)=>{let n=Nm(t.length>2,r.cacheKey);return{...n,get:()=>Rm(e,t,n,r)}},Gm=(e,t,r)=>e.run(Mm(e,t,r),t),Um=(e,t)=>{let r=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e]);let n=e.pads.slice(),i=e.outputShape.slice(),o=t[0].dims;Bm(o,r,e.dilations,e.autoPad,n,e.strides,e.outputPadding,i);let a=Object.assign({},e);return Object.assign(a,{kernelShape:r,pads:n,outputShape:i,cacheKey:e.cacheKey}),a},hf=e=>{let t=e.attributes,r=jr(t),n=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("output_padding",[0,0]),u=t.getInts("output_shape",[]),l=t.getInts("pads",[0,0,0,0]),h=t.getInts("strides",[1,1]);return te({autoPad:n,dilations:i,group:o,kernelShape:a,outputPadding:s,outputShape:u,pads:l,strides:h,...r})},zm=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let r=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==r))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==2*n)throw new Error(`pads should be ${2*n}D`);if(t.outputPadding.length!==n)throw new Error(`output_padding should be ${n}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("ConvTranspose input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("ConvTranspose input(bias) should be float tensor")}})),bf,Sr,gf,Wm,yf,Vm,Hm,jm,ho=L((()=>{Ge(),fe(),ae(),bf={name:"Transpose",inputNames:["A"],inputTypes:[0]},Sr=(e,t,r)=>(jm(t),[e.run({...bf,cacheHint:r.cacheKey,get:()=>Wm(e,t[0],r.perm)},t)]),gf=e=>te({perm:e.attributes.getInts("perm",[])}),Wm=(e,t,r)=>{let n=t.dims;r=yf(n,r);let i=Vm(n,r),o=n.length,a=`\n      ${Hm("perm",r,o)}\n      float process(int indices[${o}]) {\n        int a[${o}];\n        perm(a, indices);\n        return _A(a);\n      }`;return{...bf,output:{dims:i,type:t.type,textureType:0},shaderSource:a}},yf=(e,t)=>(t&&t.length!==e.length&&(t=[...e.keys()].reverse()),t),Vm=(e,t)=>(t=yf(e,t),z.sortBasedOnPerm(e,t)),Hm=(e,t,r)=>{let n=[];n.push(`void ${e}(out int a[${r}], int src[${r}]) {`);for(let e=0;e<r;++e)n.push(`\ta[${t[e]}]=src[${e}];`);return n.push("\t}"),n.join("\n")},jm=e=>{if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("input should be float tensor")}})),Tf,xf,qm,wf=L((()=>{ho(),Tf=(e,t,r)=>{qm(t);let n=r.blocksize,i=n*n,o="DCR"===r.mode?[0,3,4,1,5,2]:[0,1,4,2,5,3],a="DCR"===r.mode?[t[0].dims[0],n,n,t[0].dims[1]/i,t[0].dims[2],t[0].dims[3]]:[t[0].dims[0],t[0].dims[1]/i,n,n,t[0].dims[2],t[0].dims[3]],s=e.reshapeUnpacked(t[0],a),u={perm:o,cacheKey:`${o}`},[l]=Sr(e,[s],u),h=[t[0].dims[0],t[0].dims[1]/i,t[0].dims[2]*n,t[0].dims[3]*n];return[e.reshapeUnpacked(l,h)]},xf=e=>{let t=e.attributes.getInt("blocksize");if(t<1)throw new Error(`blocksize must be >= 1, but got : ${t} for DepthToSpace`);let r=e.attributes.getString("mode","DCR");if("DCR"!==r&&"CRD"!==r)throw new Error(`unrecognized mode: ${r} for DepthToSpace`);return{mode:r,blocksize:t}},qm=e=>{if(1!==e.length)throw new Error(`DepthToSpace expect 1 inputs, but got ${e.length}`);if("string"===e[0].type||4!==e[0].dims.length)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}})),vf,_f,Ym,Of=L((()=>{fe(),vf=(e,t,r)=>{Ym(t,r);let n=z.flattenShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)]},_f=e=>e.attributes.getInt("axis",1),Ym=(e,t)=>{if(!e||1!==e.length)throw new Error("Flatten requires 1 input.");let r=e[0].dims.length;if(0===r)throw new Error("scalar tensor is not supported.");if(t<-r||t>r)throw new Error("Invalid axis");if("string"===e[0].type)throw new Error("string tensor is not supported.")}})),rr,yn=L((()=>{rr=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]})),If,Sf,Xm,Km,Jm,Zm,Af=L((()=>{Ge(),yn(),fe(),ae(),If=(e,t,r)=>(Zm(t,r.axis),[e.run(Jm(e,t,r),t)]),Sf=e=>te({axis:e.attributes.getInt("axis",0)}),Xm={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},Km=(e,t,r,n)=>{let i=r[0].dims.slice(),o=r[1].dims.slice(),a=new Array(i.length+o.length-1);n=z.normalizeAxis(n,i.length);let s=[];for(let e=0;e<a.length;e++)e<n?(a[e]=i[e],s.push(`inputIdx[${e}] = outputIdx[${e}];`)):e<n+o.length?(a[e]=o[e-n],s.push(`indexDataIdx[${e-n}] = outputIdx[${e}];`)):(a[e]=i[e-o.length+1],s.push(`inputIdx[${e-o.length+1}] = outputIdx[${e}];`));let u=`\n      float process(int outputIdx[${a.length||1}]) {\n        int inputIdx[${i.length}];\n        int indexDataIdx[${o.length||1}];\n        indexDataIdx[0] = 0;\n        ${s.join("\n        ")}\n        int idx = int(_B(indexDataIdx));\n        inputIdx[${n}] = idx < 0 ? idx + ${i[n]} : idx;\n        return _A(inputIdx);\n      }`;return{...t,output:{dims:a,type:r[0].type,textureType:0},shaderSource:u}},Jm=(e,t,r)=>{let n={...Xm,cacheHint:r.cacheKey};return{...n,get:()=>Km(e,n,t,r.axis)}},Zm=(e,t)=>{if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.");let r=e[0].dims.length;if(r<1)throw new Error("Invalid input shape.");if(t<-r||t>r-1)throw new Error("Invalid axis.");if(-1===rr.indexOf(e[0].type))throw new Error("Invaid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invaid input type.")}})),Gi,Ef,Pf,Df,Qm,eb,tb,Lf=L((()=>{Ge(),fe(),ae(),Gi=(e,t,r)=>(tb(t,r),[e.run(Qm(t,r),t)]),Ef=(e,t)=>{let r=0!==e.attributes.getInt("transA",0),n=0!==e.attributes.getInt("transB",0),i=e.attributes.getFloat("alpha",1),o=e.attributes.getFloat("beta",1);return te({transA:r,transB:n,alpha:i,beta:o,isOptionalC:t})},Pf=e=>Ef(e,!1),Df=e=>Ef(e,!0),Qm=(e,t)=>{let r={name:"Gemm",inputNames:3===e.length?["A","B","C"]:["A","B"],inputTypes:3===e.length?[0,0,0]:[0,0],key:t.cacheKey};return{...r,get:()=>eb(r,e,t)}},eb=(e,t,r)=>{let n=t[0].dims.slice(),i=t[1].dims.slice(),[o,a]=ro.getShapeOfGemmResult(n,r.transA,i,r.transB,3===t.length?t[2].dims:void 0),s=[o,a];if(!s)throw new Error("Can't use gemm on the given tensors");let u=n[n.length-1],l="";r.transA&&(u=n[0]),r.transA&&r.transB?l="value += _A_T(a) * _B_T(b);":r.transA&&!r.transB?l="value += _A_T(a) * _B(b);":!r.transA&&r.transB?l="value += _A(a) * _B_T(b);":!r.transA&&!r.transB&&(l="value += _A(a) * _B(b);");let h=s.length,c=`\n      float process(int indices[${h}]) {\n          int a[${h}];\n          int b[${h}];\n          ${3===t.length?`int c[${t[2].dims.length}];`:""}\n\n          copyVec(indices, a);\n          copyVec(indices, b);\n          ${3===t.length?"bcastIndices_C(indices, c);":""}\n\n          float value = 0.0;\n          for (int k=0; k<${u}; ++k) {\n              a[${h-1}] = k;\n              b[${h-2}] = k;\n              ${l}\n          }\n\n          value = value * alpha;\n          ${3===t.length?"value += beta * _C(c);":""}\n          return value;\n      }`;return{...e,output:{dims:s,type:t[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:r.alpha},{name:"beta",type:"float",data:r.beta}],shaderSource:c}},tb=(e,t)=>{if(!e)throw new Error("Input is missing");if(t.isOptionalC&&(e.length<2||e.length>3))throw new Error("Invaid input shape.");if(!t.isOptionalC&&3!==e.length)throw new Error("Gemm requires 3 inputs");if(3===e.length&&1!==e[2].dims.length&&2!==e[2].dims.length)throw new Error("Invalid input shape of C");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type||3===e.length&&"float32"!==e[2].type&&"float64"!==e[2].type)throw new Error("Invalid input type.");if(e[0].type!==e[1].type||3===e.length&&e[0].type!==e[2].type)throw new Error("Input types are mismatched")}})),Ff,Cf,rb,nb,ob,ib,ab,$f=L((()=>{Ge(),ae(),Ff=(e,t,r)=>(ab(t),[e.run(ob(e,t,r),t)]),Cf=e=>{let t=e.attributes.getFloat("scale"),r=e.attributes.getFloats("bias");return te({scale:t,bias:r})},rb={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},nb=(e,t,r,n)=>{let i=r[0].dims.slice(),o=i.length,a=`\n      ${ib(n.bias.length)}\n      float process(int indices[${o}]) {\n        return _X(indices) * scale + getBias(bias, indices[1]);\n      }`;return{...t,output:{dims:i,type:r[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:n.bias.length,data:n.bias},{name:"scale",type:"float",data:n.scale}],shaderSource:a}},ob=(e,t,r)=>{let n={...rb,cacheHint:r.cacheKey};return{...n,get:()=>nb(e,n,t,r)}},ib=e=>{let t=[`float getBias(float bias[${e}], int channel) {`];for(let r=0;r<e;++r)0===r?t.push(`\tif (channel == ${r}) { return bias[${r}]; }`):r===e-1?t.push(`\telse { return bias[${r}]; }`):t.push(`\telse if (channel == ${r}) { return bias[${r}]; }`);return t.push("\t}"),t.join("\n")},ab=e=>{if(!e||1!==e.length)throw new Error("ImageScaler requires 1 input.");if(4!==e[0].dims.length)throw new Error("Invalid input shape.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")}})),kf,Nf,Bf,sb,ub,lb,fb,cb,pb,Rf=L((()=>{ve(),ae(),kf=(e,t,r)=>{pb(t);let n=e.run(ub(t[0]),t);return[e.run(cb(e,t[0],r,n.dims),[t[0],n,t[1],t[2]])]},Nf=e=>e.attributes.getFloat("epsilon",1e-5),Bf={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},sb=(e,t)=>{let r=t.dims.slice(),n=r[1],i=r[2]*r[3],o=[r[0],n],a=`\n      vec4 process(int[2] indices) {\n        vec4 v = vec4(0.0);\n        int a[4];\n        a[0] = indices[0];\n        a[1] = indices[1];\n        float temp = 0.0;\n        for(int a2=0; a2<${r[2]}; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<${r[3]}; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += x;\n          }\n        }\n        float mean = temp / float(${i});\n        temp = 0.0;\n        for(int a2=0; a2<${r[2]}; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<${r[3]}; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += (x - mean) * (x - mean);\n          }\n        }\n        v.r = mean;\n        v.g = temp / float(${i});\n\n        return v;\n      }`;return{...e,output:{dims:o,type:t.type,textureType:4},shaderSource:a}},ub=e=>({...Bf,get:()=>sb(Bf,e)}),lb={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},fb=(e,t,r,n,i)=>{let o=q(e.session.backend.glContext.version),[a,s]=e.calculateTextureWidthAndHeight(i,4),[u,l]=[a/4,s],h=`\n      vec4 get_MeanAndVariance(int[2] mv) {\n        int offset = indicesToOffset_MeanAndVariance(mv);\n        vec2 coords = offsetToCoords(offset, ${u}, ${l});\n        return ${o.texture2D}(MeanAndVariance, coords);\n      }\n\n      float process(int[4] indices) {\n        int mv[2];\n        mv[0] = indices[0];\n        mv[1] = indices[1];\n        vec4 mean_and_variance = get_MeanAndVariance(mv);\n        float mean = mean_and_variance.r;\n        float variance = mean_and_variance.g;\n\n        int sb[1];\n        sb[0] = indices[1];\n        float scale = _Scale(sb);\n        float b = _B(sb);\n\n        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;\n      }`;return{...t,output:{dims:r.dims,type:r.type,textureType:0},variables:[{name:"epsilon",type:"float",data:n}],shaderSource:h}},cb=(e,t,r,n)=>{let i={...lb,cacheHint:`${r}`};return{...i,get:()=>fb(e,i,t,r,n)}},pb=e=>{if(!e||3!==e.length)throw new Error("InstanceNormalization requires 3 inputs.");let t=e[0],r=e[1],n=e[2];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length)throw new Error("Invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1])throw new Error("Input shapes are mismatched.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type)throw new Error("Invalid input type.");if(4!==e[0].dims.length)throw new Error("Only support 4-D input shape.")}}));function db(e,t){let r=e[0].dims[1],n=e[0].dims.length,i=-Math.floor((t.size-1)/2),o=Math.ceil((t.size-1)/2),a=`float(${t.alpha}) / float(${t.size})`,s=`\n    float process(int indices[${n}]) {\n        int c = indices[1];\n        float x = _X(indices);\n        float square_sum = 0.0;\n\n        for (int i = ${i}; i <= ${o}; i++) {\n          int idx = c + i;\n          if (c >= 0 && c < ${r}) {\n            indices[1] = idx;\n            float j = _X(indices);\n            square_sum += j * j;\n          }\n        }\n        return x / pow(${`float(${t.bias})`} + ${a} * square_sum, ${`float(${t.beta})`});\n    }`;return{...Uf,cacheHint:t.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:s}}function hb(e,t){return{...Uf,cacheHint:t.cacheKey,get:()=>db(e,t)}}var Mf,Gf,Uf,mb,zf=L((()=>{Ge(),ae(),Mf=(e,t,r)=>(mb(t),[e.run(hb(t,r),t)]),Gf=e=>{let t=e.attributes.getFloat("alpha",1e-4),r=e.attributes.getFloat("beta",.75),n=e.attributes.getFloat("bias",1),i=e.attributes.getInt("size");return te({alpha:t,beta:r,bias:n,size:i})},Uf={name:"LRN",inputNames:["X"],inputTypes:[0]},mb=e=>{if(!e||1!==e.length)throw new Error("LRN requires 1 input.");if(4!==e[0].dims.length)throw new Error('currently only support LRN for input with "NCHW" format');if("float32"!==e[0].type)throw new Error("input should be float type")}})),bb,Ui,Wf,Vf,Hf,gb,yb,Tb,xb,wb,vb,_b,Ob,jf=L((()=>{Ge(),fe(),ve(),ae(),bb={name:"Pad",inputNames:["A"],inputTypes:[0]},Ui=(e,t,r)=>(Tb(t),[e.run({...bb,cacheHint:r.cacheKey,get:()=>yb(e,t[0],r)},t)]),Wf=e=>{let t=e.attributes.getString("mode","constant"),r=e.attributes.getFloat("value",0),n=e.attributes.getInts("pads");return te({mode:t,value:r,pads:n})},Vf=(e,t,r)=>{xb(t);let n=gb(e,t,r);return Ui(e,[t[0]],n)},Hf=e=>e.attributes.getString("mode","constant"),gb=(e,t,r)=>{if(!e.session.isInitializer(t[1].dataId)||t.length>=3&&!e.session.isInitializer(t[2].dataId))throw new Error("dynamic pad attributes are not allowed");let n=Array.from(t[1].integerData),i=t.length>=3?t[2].floatData[0]:0;return te({mode:r,pads:n,value:i})},yb=(e,t,r)=>{let n=z.padShape(t.dims.slice(),r.pads),i=n.length,o=`\n      ${wb(e,t,r)}\n      float process(int[${i}] indices) {\n          return padA(indices);\n      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:n,type:t.type,textureType:0},shaderSource:o}},Tb=e=>{if(!e||1!==e.length)throw new Error("Pad requires 1 input");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},xb=e=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Pad requires 2 or 3 inputs");if("int32"!==e[1].type)throw new Error("Invalid input type.");if(e.length>=3&&"string"===e[2].type)throw new Error("Invalid input type.")},wb=(e,t,r)=>{let n=q(e.session.backend.glContext.version),[i,o]=e.calculateTextureWidthAndHeight(t.dims,0),a=z.computeStrides(t.dims);switch(r.mode){case"constant":return vb(n,t.dims,a,i,o,r.pads,r.value);case"reflect":return _b(n,t.dims,a,i,o,r.pads);case"edge":return Ob(n,t.dims,a,i,o,r.pads);default:throw new Error("Invalid mode")}},vb=(e,t,r,n,i,o,a)=>{let s=t.length,u="";for(let e=s-1;e>=0;--e)u+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0)  return constant;\n        if (k >= ${t[e]}) return constant;\n        offset += k * ${r[e]};\n        `;return`\n      float padA(int m[${s}]) {\n        const float constant = float(${a});\n        int offset = 0;\n        int k = 0;\n        ${u}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `},_b=(e,t,r,n,i,o)=>{let a=t.length,s="";for(let e=a-1;e>=0;--e)s+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0) { k = -k; }\n        {\n          const int _2n_1 = ${2*(t[e]-1)};\n          k = int( mod( float(k), float(_2n_1) ) ) ;\n          if(k >= ${t[e]}) { k = _2n_1 - k; }\n        }\n        offset += k * ${r[e]};\n        `;return`\n      float padA(int m[${a}]) {\n        int offset = 0;\n        int k = 0;\n        ${s}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `},Ob=(e,t,r,n,i,o)=>{let a=t.length,s="";for(let e=a-1;e>=0;--e)s+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0)  k = 0;\n        if (k >= ${t[e]}) k = ${t[e]-1};\n        offset += k * ${r[e]};\n      `;return`\n      float padA(int m[${a}]) {\n        int offset = 0;\n        int k = 0;\n        ${s}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `}})),Yf,Xf,Kf,Jf,Zf,Qf,ec,tc,rc,Ib,qf,nc,bo,oc,mo,Sb,ic=L((()=>{Ge(),fe(),ae(),Yf=(e,t,r)=>{bo(t);let n={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:r.cacheKey};return[e.run({...n,get:()=>Kf(t,n,!1,r)},t)]},Xf=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),n=0!==e.attributes.getInt("count_include_pad",0),i=e.attributes.getInts("kernel_shape"),o=e.attributes.getInts("strides",[]),a=e.attributes.getInts("pads",[]);if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return te({autoPad:t,ceilMode:r,countIncludePad:n,kernelShape:i,strides:o,pads:a})},Kf=(e,t,r,n)=>{let[i,o]=rc(e,n,r),a=z.size(i.kernelShape),s="";i.countIncludePad?s+=`value /= float(${a});`:s+=`value /= float(${a} - pad);`;let u=`\n        ${oc(e[0].dims,i,"value += _X(x);",s,"0.0")}\n      `;return{...t,output:{dims:o,type:e[0].type,textureType:0},shaderSource:u}},Jf=(e,t,r)=>{bo(t);let n={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${r.countIncludePad}`};return[e.run({...n,get:()=>Kf(t,n,!0,r)},t)]},Zf=e=>{let t=0!==e.attributes.getInt("count_include_pad",0);return te({autoPad:"",ceilMode:0,countIncludePad:t,kernelShape:[],strides:[],pads:[]})},Qf=(e,t,r)=>{bo(t);let n={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:r.cacheKey};return[e.run({...n,get:()=>tc(t,n,!1,r)},t)]},ec=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),n=e.attributes.getInts("kernel_shape"),i=e.attributes.getInts("strides",[]),o=e.attributes.getInts("pads",[]),a=e.attributes.getInt("storage_order",0),s=e.attributes.getInts("dilations",[]);if(0!==a)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return te({autoPad:t,ceilMode:r,countIncludePad:!1,kernelShape:n,strides:i,pads:o,storageOrder:a,dilations:s})},tc=(e,t,r,n)=>{let[i,o]=rc(e,n,r),a=`\n      ${oc(e[0].dims,i,"\n      value = max(_X(x), value);\n    ","","-1e5")}\n    `;return{...t,output:{dims:o,type:e[0].type,textureType:0},shaderSource:a}},rc=(e,t,r)=>{let n=e[0].dims.slice(),i=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),a=t.strides.slice(),s=i?t.dilations.slice():[],u=t.pads.slice();xr.adjustPoolAttributes(r,n,o,a,s,u);let l=xr.computePoolOutputShape(r,n,a,s,o,u,t.autoPad),h=Object.assign({},t);return i?Object.assign(h,{kernelShape:o,strides:a,pads:u,dilations:s,cacheKey:t.cacheKey}):Object.assign(h,{kernelShape:o,strides:a,pads:u,cacheKey:t.cacheKey}),[h,l]},Ib={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},qf={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},nc=(e,t)=>(bo(t),[e.run({...qf,get:()=>tc(t,qf,!0,Ib)},t)]),bo=e=>{if(!e||1!==e.length)throw new Error("Pool ops requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},oc=(e,t,r,n,i)=>{let o=e.length;if(t.kernelShape.length<=2){let a=t.kernelShape[t.kernelShape.length-1],s=t.strides[t.strides.length-1],u=t.pads[t.pads.length/2-1],l=t.pads[t.pads.length-1],h=e[o-1],c="",d="",f="";if(c=u+l!==0?`\n          for (int i = 0; i < ${a}; i++) {\n            x[${o} - 1] = indices[${o} - 1] * ${s} - ${u} + i;\n            if (x[${o} - 1] < 0 || x[${o} - 1] >= ${h}) {\n              pad++;\n              continue;\n            }\n            ${r}\n          }`:`\n          for (int i = 0; i < ${a}; i++) {\n            x[${o} - 1] = indices[${o} - 1] * ${s} - ${u} + i;\n            ${r}\n          }`,2===t.kernelShape.length){let r=t.kernelShape[t.kernelShape.length-2],n=t.strides[t.strides.length-2],i=t.pads[t.pads.length/2-2],s=t.pads[t.pads.length-2],u=e[o-2];d=i+s!==0?`\n            for (int j = 0; j < ${r}; j++) {\n              x[${o} - 2] = indices[${o} - 2] * ${n} - ${i} + j;\n              if (x[${o} - 2] < 0 || x[${o} - 2] >= ${u}) {\n                pad+= ${a};\n                continue;\n              }\n          `:`\n            for (int j = 0; j < ${r}; j++) {\n              x[${o} - 2] = indices[${o} - 2] * ${n} - ${i} + j;\n            `,f="\n          }\n        "}return`\n        float process(int indices[${o}]) {\n          int x[${o}];\n          copyVec(indices, x);\n\n          float value = ${i};\n          int pad = 0;\n          ${d}\n          ${c}\n          ${f}\n          ${n}\n          return value;\n        }\n      `}{let a=z.size(t.kernelShape),s=z.computeStrides(t.kernelShape),u=s.length,l=t.pads.length,h=Sb(u),c=mo(e,"inputDims"),d=mo(t.pads,"pads"),f=mo(s,"kernelStrides"),p=mo(t.strides,"strides"),y="";return y=t.pads.reduce(((e,t)=>e+t))?`\n            if (x[j] >= inputDims[j] || x[j] < 0) {\n              pad++;\n              isPad = true;\n              break;\n            }\n          }\n          if (!isPad) {\n            ${r}\n          }`:`\n          }\n          ${r}\n        `,`\n        ${h}\n        float process(int indices[${o}]) {\n          int x[${o}];\n          copyVec(indices, x);\n          int offset[${u}];\n          int pads[${l}];\n          int inputDims[${o}];\n          int kernelStrides[${u}];\n          int strides[${u}];\n          ${d}\n          ${c}\n          ${p}\n          ${f}\n\n          float value = ${i};\n          int pad = 0;\n          bool isPad = false;\n          for (int i = 0; i < ${a}; i++) {\n            offsetToIndices(i, kernelStrides, offset);\n            isPad = false;\n            for (int j = ${o} - ${u}; j < ${o}; j++) {\n              x[j] = indices[j] * strides[j - ${o} + ${u}]\n                + offset[j - ${o} + ${u}] - pads[j - 2];\n              ${y}\n          }\n          ${n}\n\n          return value;\n        }\n      `}},mo=(e,t)=>{let r="";for(let n=0;n<e.length;n++)r+=`\n      ${t}[${n}] = ${e[n]};\n    `;return r},Sb=e=>`\n  void offsetToIndices(int offset, int[${e}] strides, out int[${e}] indices) {\n    if (${e} == 0) {\n      return;\n    }\n    for (int i = 0; i < ${e} - 1; ++i) {\n      indices[i] = offset / strides[i];\n      offset -= indices[i] * strides[i];\n    }\n    indices[${e} - 1] = offset;\n  }`})),Ar,nr,Ab,Eb,ac,sc,uc,lc,fc,cc,pc,dc=L((()=>{Ge(),yn(),fe(),ae(),Ar=(e,t,r,n,i)=>{Eb(t);let o={name:n,inputNames:["A"],inputTypes:[0]};return[e.run({...o,cacheHint:r.cacheKey,get:()=>Ab(e,t,r,n,i,o)},t)]},nr=e=>{let t=e.attributes.getInts("axes",[]),r=1===e.attributes.getInt("keepdims",1);return te({axes:t,keepDims:r})},Ab=(e,t,r,n,i,o)=>{let a=[],s=t[0].dims.length||1,u=[],l=z.normalizeAxes(r.axes,t[0].dims.length),h=i(t,l),c=h[1];for(let e=0;e<t[0].dims.length;e++)l.indexOf(e)>=0||0===l.length?(r.keepDims&&a.push(1),c=`\n          for(int j${e} = 0; j${e} < ${t[0].dims[e]}; j${e}++) {\n            inputIdx[${e}] = j${e};\n            ${c}\n          }`):(u.push(`inputIdx[${e}] = outputIdx[${a.length}];`),a.push(t[0].dims[e]));let d=`\n      float process(int outputIdx[${a.length||1}]) {\n        float value;                 // final result\n        int inputIdx[${s}];      // addressing input data\n        ${u.join("\n")}\n        ${h[0]}       // init ops for reduce max/min\n        ${c}\n        ${h[2]}       // final computation for reduce mean\n        return value;\n      }`;return{...o,output:{dims:a,type:t[0].type,textureType:0},shaderSource:d}},Eb=e=>{if(!e||1!==e.length)throw new Error("Reduce op requires 1 input.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.")},ac=(e,t,r)=>Ar(e,t,r,"ReduceSum",(()=>["value = 0.0;","value += _A(inputIdx);",""])),sc=(e,t,r)=>Ar(e,t,r,"ReduceMean",((e,t)=>{let r=1;for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&(r*=e[0].dims[n]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${r}.;`]})),uc=(e,t,r)=>Ar(e,t,r,"ReduceMax",((e,t)=>{let r=[];for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&r.push(`inputIdx[${n}] = 0;`);return[`${r.join("\n")}\nvalue = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]})),lc=(e,t,r)=>Ar(e,t,r,"ReduceMin",((e,t)=>{let r=[];for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&r.push(`inputIdx[${n}] = 0;`);return[`${r.join("\n")}\nvalue = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]})),fc=(e,t,r)=>Ar(e,t,r,"ReduceProd",(()=>["value = 1.0;","value *= _A(inputIdx);",""])),cc=(e,t,r)=>Ar(e,t,r,"ReduceLogSum",(()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"])),pc=(e,t,r)=>Ar(e,t,r,"ReduceLogSumSquare",(()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""]))})),hc,mc=L((()=>{fe(),hc=(e,t)=>{let r=z.calculateReshapedDims(t[0].dims,t[1].integerData);return e.session.pack?[e.reshapePacked(t[0],r)]:[e.reshapeUnpacked(t[0],r)]}})),bc,zi,gc,yc,Tn,Pb,Wi,go,Vi=L((()=>{Ge(),ve(),ae(),bc={name:"Upsample",inputNames:["X"],inputTypes:[0]},zi=(e,t,r)=>(Wi(t,r),[e.run({...bc,cacheHint:r.cacheKey,get:()=>Pb(e,t,r)},t)]),gc=e=>Tn(e,7),yc=e=>Tn(e,9),Tn=(e,t)=>{let r=t>=10,n=e.attributes.getString("mode","nearest");if("nearest"!==n&&"linear"!==n&&(t<11||"cubic"!==n))throw new Error(`unrecognized mode: ${n}`);let i=[];t<9&&(i=e.attributes.getFloats("scales"),go(i,n,r));let o=e.attributes.getFloat("extrapolation_value",0),a=t>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(-1===["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(a))throw new Error(`coordinate_transform_mode '${a}' is not supported`);let s="tf_crop_and_resize"===a,u=s,l="nearest"===n&&t>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(-1===["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(l))throw new Error(`nearest_mode '${l}' is not supported`);let h=e.attributes.getFloat("cubic_coeff_a",-.75),c=0!==e.attributes.getInt("exclude_outside",0);if(c&&"cubic"!==n)throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");let d=t<11||"nearest"===n&&"asymmetric"===a&&"floor"===l,f=0,p=0,y=0;return t>10?e.inputs.length>2?(f=1,p=2,y=3):(p=1,y=2):9===t&&(p=1),te({opset:t,isResize:r,mode:n,scales:i,extrapolationValue:o,coordinateTransformMode:a,useExtrapolation:u,needRoiInput:s,nearestMode:l,cubicCoefficientA:h,excludeOutside:c,useNearest2xOptimization:d,roiInputIdx:f,scalesInputIdx:p,sizesInputIdx:y})},Pb=(e,t,r)=>{let n=q(e.session.backend.glContext.version),[i,o]=e.calculateTextureWidthAndHeight(t[0].dims,0),a=t[0].dims.map(((e,t)=>Math.floor(e*r.scales[t]))),[s,u]=e.calculateTextureWidthAndHeight(a,0),l=a.length,h=new Array(l),c=new Array(l),d=`\n      int output_pitches[${l}];\n      int input_pitches[${l}];\n      `;for(let e=l-1;e>=0;e--)h[e]=e===l-1?1:h[e+1]*a[e+1],c[e]=e===l-1?1:c[e+1]*t[0].dims[e+1],d+=`\n        output_pitches[${e}] = ${h[e]};\n        input_pitches[${e}] = ${c[e]};\n        `;let f=`\n      float getInputFloat(int index) {\n        vec2 coords = offsetToCoords(index, ${i}, ${o});\n        float value = getColorAsFloat(${n.texture2D}(X, coords));\n        return value;\n      }\n      `,p="nearest"===r.mode?`\n    ${f}\n    float process(int indices[${l}]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${s}, ${u});\n\n      ${d}\n\n      int d, m;\n      for (int dim = 0; dim < ${l}; ++dim) {\n        d = output_index / output_pitches[dim];\n        m = output_index - d * output_pitches[dim];\n        output_index = m;\n\n        if (scales[dim] != 1 && d > 0) {\n          int d2 = d / scales[dim];\n          m = d - d2 * scales[dim];\n          d = d2;\n        }\n        input_index += input_pitches[dim] * d;\n      }\n\n      return getInputFloat(input_index);\n    }`:4===l?`\n    ${f}\n    float process(int indices[4]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${s}, ${u});\n\n      ${d}\n\n      int m;\n      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m / output_pitches[1];\n      m = m - index_of_dim1 * output_pitches[1];\n      index_of_dim2 = m / output_pitches[2];\n      m = m - index_of_dim2 * output_pitches[2];\n      index_of_dim3 = m;\n\n      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;\n      index_of_input_dim2 = index_of_dim2 / scales[2];\n      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];\n      index_of_input_dim3 = index_of_dim3 / scales[3];\n      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];\n\n      input_index = index_of_dim0 * input_pitches[0] +\n            index_of_dim1 * input_pitches[1] +\n            index_of_input_dim2 * input_pitches[2] +\n            index_of_input_dim3;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim2 = false;\n      if (index_of_input_dim2 == (${t[0].dims[2]} - 1)) {\n        // It's the end in dimension 2\n        x01 = x00;\n        end_of_dim2 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[2]);\n      }\n\n      if (index_of_input_dim3 == (input_pitches[2] - 1)) {\n        // It's the end in dimension 3\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);\n    }`:`\n    ${f}\n    float process(int indices[2]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${s}, ${u});\n\n      ${d}\n\n      int m;\n      int index_of_dim0, index_of_dim1;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m;\n\n      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;\n      index_of_input_dim0 = index_of_dim0 / scales[0];\n      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];\n      index_of_input_dim1 = index_of_dim1 / scales[1];\n      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];\n\n      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim0 = false;\n      if (index_of_input_dim0 == (${t[0].dims[0]} - 1)) {\n        // It's the end in dimension 0\n        x01 = x00;\n        end_of_dim0 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[0]);\n      }\n\n      if (index_of_input_dim1 == (input_pitches[0] - 1)) {\n        // It's the end in dimension 1\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);\n    }`;return{...bc,output:{dims:a,type:t[0].type,textureType:0},shaderSource:p,variables:[{name:"scales",type:"int",arrayLength:r.scales.length,data:r.scales.map((e=>Math.ceil(e)))}]}},Wi=(e,t)=>{if(!e||t.opset<9&&1!==e.length||t.opset>=9&&t.opset<11&&2!==e.length||t.opset>=11&&e.length<2)throw new Error("invalid inputs.");if(t.scales.length>0&&e[0].dims.length!==t.scales.length)throw new Error("Invalid input shape.");if("string"===e[0].type)throw new Error("Invalid input tensor types.")},go=(e,t,r)=>{if(r){for(let t of e)if(t<=0)throw new Error("Scale value should be greater than 0.")}else for(let t of e)if(t<1)throw new Error("Scale value should be greater than or equal to 1.");if(!("linear"!==t&&"cubic"!==t||2===e.length||4===e.length&&1===e[0]&&1===e[1]))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${r?"Resize":"Upsample"} opeartor.`)}})),Hi,ji,Tc,xc,Db,Lb,Fb,Cb,wc=L((()=>{ve(),ae(),Bt(),Or(),Vi(),Hi={name:"Resize",inputNames:["A"],inputTypes:[2]},ji=(e,t,r)=>(Wi(t,r),[e.run({...Hi,cacheHint:r.cacheKey,get:()=>Db(e,t,r)},t)]),Tc=e=>Tn(e,10),xc=e=>Tn(e,11),Db=(e,t,r)=>{let n=q(e.session.backend.glContext.version),[i,o]=Lb(t,r);if(i.every((e=>1===e))&&"tf_crop_and_resize"!==r.coordinateTransformMode)return{...Hi,output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {\n                    vec4 v = ${n.texture2D}(X, TexCoords);\n                    ${n.output} = v;\n                }`};let a=o.length;if(a<2)throw new Error(`output dimension should be at least 2, but got ${a}`);let s=o[a-2],u=o[a-1],l=t[0].dims;if(a!==l.length)throw new Error(`output dimension should match input ${l.length}, but got ${a}`);let h=l[a-2],c=l[a-1],d=i[a-2],f=i[a-1],p="";if("linear"!==r.mode)throw new Error(`resize (packed) does not support mode: '${r.mode}'`);switch(r.coordinateTransformMode){case"asymmetric":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return vec4(coords) / scaleWHWH;\n                    }\n                ";break;case"half_pixel":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;\n                    }\n                ";break;case"pytorch_half_pixel":p=`\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 fcoords = vec4(coords);\n                        return vec4(\n                            ${u}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,\n                            ${s}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,\n                            ${u}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,\n                            ${s}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0\n                          );\n                    }\n                `;break;case"align_corners":p=`\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 resized = vec4(${u}.0 - 1.0, ${s}.0 - 1.0, ${u}.0 - 1.0,\n                            ${s}.0 - 1.0);\n                        vec4 original = vec4(${c}.0 - 1.0, ${h}.0 - 1.0, ${c}.0 - 1.0,\n                            ${h}.0 - 1.0);\n                        vec4 new_scale = original / resized;\n                        return vec4(coords) * new_scale;\n                    }\n                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${r.coordinateTransformMode}'`)}let y=Je(a),g=`\n            const vec2 inputWH = vec2(${h}.0, ${c}.0);\n            const vec4 scaleWHWH = vec4(float(${d}), float(${f}), float(${d}), float(${f}));\n            ${kt()}\n            ${p}\n            float getAValue(int x10, int r, int c, int d) {\n                return getChannel(getA(x10, r, c, d), vec2(c, d));\n            }\n            void main() {\n                ${y} rc = getOutputCoords();\n\n                int batch = rc[0];\n                int depth = rc[1];\n\n                // retrieve the 4 coordinates that is used in the 4 packed output values.\n                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);\n\n                // calculate the source index in fraction\n                vec4 sourceFrac = getSourceFracIndex(coords);\n\n                // get the lower and upper bound of the 4 values that will be packed into one texel.\n                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));\n                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));\n                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));\n                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));\n\n                bool hasNextRow = rc.w < ${s-1};\n                bool hasNextCol = rc.z < ${u-1};\n\n                // pack x00, x01, x10, x11's top-left corner into one vec4 structure\n                vec4 topLeft = vec4(\n                    getAValue(batch, depth, x00.x, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's top-right corner into one vec4 structure\n                vec4 topRight = vec4(\n                    getAValue(batch, depth, x00.x, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure\n                vec4 bottomLeft = vec4(\n                    getAValue(batch, depth, x00.z, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure\n                vec4 bottomRight = vec4(\n                    getAValue(batch, depth, x00.z, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);\n\n                // calculate the interpolation fraction on u and v direction\n                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);\n                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));\n\n                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);\n                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);\n                vec4 newValue = mix(top, bottom, clampFrac.xxzz);\n\n                ${n.output} = vec4(newValue);\n            }\n        `;return{...Hi,output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:g}},Lb=(e,t)=>{let r,n=e[0].dims,i=t.scales;if(0===i.length){let o=e[t.scalesInputIdx];if(o&&0!==o.size){if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");i=Fb(o,t.mode,t.isResize)}else{let o=e[t.sizesInputIdx];if(!o||0===o.size)throw new Error("Either scales or sizes MUST be provided as input.");r=Array.from(o.integerData),i=Cb(r,n,t.mode,t.isResize)}}else if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");let o=r||n.map(((e,t)=>Math.floor(e*i[t])));return[i,o]},Fb=(e,t,r)=>{let n=Array.from(e.floatData);return go(n,t,r),n},Cb=(e,t,r,n)=>{let i=t.length,o=new Array(i);for(let r=0,n=i;r<n;r++)if(0===t[r]){if(0!==e[r])throw new Error("Input dim is zero but required output dim is non-zero.");o[r]=1}else o[r]=e[r]/t[r];return go(o,r,n),o}})),vc,$b,_c=L((()=>{_r(),vc=(e,t)=>($b(t),[new Ce([t[0].dims.length],"int32",void 0,void 0,new Int32Array(t[0].dims))]),$b=e=>{if(!e||1!==e.length)throw new Error("Shape requires 1 input.")}})),qi,Oc,Ic,Sc,Bb,Ac,kb,Nb,Ec=L((()=>{Ge(),yn(),fe(),ae(),qi={name:"Slice",inputNames:["A"],inputTypes:[0]},Oc=(e,t,r)=>(Bb(t),[e.run({...qi,cacheHint:r.cacheKey,get:()=>Sc(e,t[0],r)},t)]),Ic=e=>{let t=e.attributes.getInts("starts"),r=e.attributes.getInts("ends"),n=e.attributes.getInts("axes",[]);return te({starts:t,ends:r,axes:n})},Sc=(e,t,r)=>{let n=0===r.axes.length?t.dims.slice(0).map(((e,t)=>t)):r.axes,i=z.normalizeAxes(n,t.dims.length),o=r.starts.map(((e,r)=>e>t.dims[i[r]]-1?t.dims[i[r]]:z.normalizeAxis(e,t.dims[i[r]]))),a=r.ends.map(((e,r)=>e>t.dims[i[r]]-1?t.dims[i[r]]:z.normalizeAxis(e,t.dims[i[r]]))),s=t.dims.slice(),u=[];for(let e=0;e<i.length;e++)s[i[e]]=a[e]-o[e],o[e]>0&&u.push(`outputIdx[${i[e]}] += ${o[e]};`);let l=`\n      float process(int outputIdx[${s.length}]) {\n        ${u.join("\n      ")}\n        return _A(outputIdx);\n      }`;return{...qi,output:{dims:s,type:t.type,textureType:0},shaderSource:l}},Bb=e=>{if(!e||1!==e.length)throw new Error("Slice requires 1 input.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.")},Ac=(e,t)=>{Nb(t);let r=kb(e,t);return[e.run({...qi,cacheHint:r.cacheKey,get:()=>Sc(e,t[0],r)},[t[0]])]},kb=(e,t)=>{if(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)||t.length>=4&&!e.session.isInitializer(t[3].dataId)||t.length>=5&&!e.session.isInitializer(t[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(t.length>=5&&t[4].integerData.some((e=>1!==e)))throw new Error("currently non-1 steps is not supported for Slice");let r=Array.from(t[1].integerData),n=Array.from(t[2].integerData),i=t.length>=4?Array.from(t[3].integerData):[];return{starts:r,ends:n,axes:i,cacheKey:`${i};${r};${n}`}},Nb=e=>{if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if("int32"!==e[1].type||1!==e[1].dims.length)throw new Error("Invalid input type.");if("int32"!==e[2].type||1!==e[2].dims.length)throw new Error("Invalid input type.");if(e.length>=4&&("int32"!==e[3].type||1!==e[3].dims.length))throw new Error("Invalid input type.");if(e.length>=5&&("int32"!==e[4].type||1!==e[4].dims.length))throw new Error("Invalid input type.")}})),Pc,Dc,Lc,Fc,Cc,$c,Bc,kc,Rb,Mb,Gb,Nc,Rc=L((()=>{Ge(),fe(),ve(),ae(),ho(),Pc={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},Dc={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},Lc={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},Fc=(e,t,r)=>{Nc(t);let n=t[0].dims.slice(),i=z.normalizeAxis(r.axis,n.length),o=z.sizeToDimension(n,i),a=z.sizeFromDimension(n,i);return kc(e,t,r,o,a)},Cc=e=>te({axis:e.attributes.getInt("axis",1)}),$c=e=>te({axis:e.attributes.getInt("axis",-1)}),Bc=(e,t,r)=>{Nc(t);let n,i=t[0].dims.slice(),o=z.normalizeAxis(r.axis,i.length),a=i.length,s=o!==a-1,u=[],l=[],h=[];s&&(l=Array.from({length:a}).map(((e,t)=>t)),l[o]=a-1,l[a-1]=o,l.map((e=>u.push(i[e]))),n=te({perm:l}),h=Sr(e,t,n));let c=s?z.sizeToDimension(u,a-1):z.sizeToDimension(i,a-1),d=s?z.sizeFromDimension(u,a-1):z.sizeFromDimension(i,a-1),f=kc(e,s?h:t,r,c,d);return s?Sr(e,f,n):f},kc=(e,t,r,n,i)=>{let o=Rb(e,t[0],n,i,[n]),a=e.run({...Pc,cacheHint:r.cacheKey,get:()=>o},t),s=Mb(e,t[0],n,i,o.output.dims,[n]),u=e.run({...Dc,cacheHint:r.cacheKey,get:()=>s},[t[0],a]),l=Gb(e,t[0],n,i,o.output.dims,s.output.dims);return[e.run({...Lc,cacheHint:r.cacheKey,get:()=>l},[t[0],a,u])]},Rb=(e,t,r,n,i)=>{let[o,a]=e.calculateTextureWidthAndHeight(t.dims,0),s=i.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length)throw new Error("Dimensionality of the output should be 1");if(i[0]!==r)throw new Error("Shape of the output should be equal to logical row count");let u=q(e.session.backend.glContext.version),l=`\n      float process(int[${s}] indices) {\n        int logical_row_start_offset = indices[0] * ${n};\n\n        float max = getColorAsFloat(${u.texture2D}(A, offsetToCoords(logical_row_start_offset, ${o},\n        ${a} )));\n        for(int i=1; i<${n}; ++i)\n        {\n          float current = getColorAsFloat(${u.texture2D}(A, offsetToCoords(logical_row_start_offset + i,\n            ${o}, ${a})));\n          if(current > max)\n          max = current;\n        }\n\n        return max;\n      }`;return{...Pc,output:{dims:i,type:t.type,textureType:0},shaderSource:l}},Mb=(e,t,r,n,i,o)=>{let[a,s]=e.calculateTextureWidthAndHeight(t.dims,0),u=o.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==o.length)throw new Error("Dimensionality of the output should be 1");if(o[0]!==r)throw new Error("Shape of the output should be equal to logical row count");if(1!==i.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");let l=`\n      float process(int[${u}] indices) {\n        int logical_row_start_offset = indices[0] * ${n};\n\n        float norm_factor = 0.0;\n        float max = _Max(indices);\n        for(int i=0; i<${n}; ++i)\n        {\n          norm_factor += exp(getColorAsFloat(${q(e.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,\n            ${a}, ${s}))) - max);\n        }\n\n        return norm_factor;\n      }`;return{...Dc,output:{dims:o,type:t.type,textureType:0},shaderSource:l}},Gb=(e,t,r,n,i,o)=>{let[a,s]=e.calculateTextureWidthAndHeight(t.dims,0),u=t.dims.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length||1!==o.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r||o[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");let l=`\n      float process(int[${u}] indices) {\n\n      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)\n      int offset = coordsToOffset(TexCoords, ${a}, ${s});\n\n      //determine the logical row for this index\n      int logical_row_index[1];\n      logical_row_index[0] = offset / ${n};\n\n      float norm_factor = _Norm(logical_row_index);\n\n      // avoid possible division by 0\n      // if norm_facor is 0, all elements are zero\n      // if so, return 0\n      if(norm_factor == 0.0)\n        return 0.0;\n\n      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;\n    }`;return{...Lc,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l}},Nc=e=>{if(!e||1!==e.length)throw new Error("Softmax requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type")}})),Mc,Gc,Uc,Ub,zb,Wb,zc=L((()=>{Ge(),fe(),ae(),Mc={name:"Split",inputNames:["A"],inputTypes:[0]},Gc=(e,t,r)=>{Wb(t);let n=z.normalizeAxis(r.axis,t[0].dims.length),i=Ub(e,t,n,r),o=[];for(let a=0;a<i;++a)o.push(e.run({...Mc,cacheHint:`${r.cacheKey};${a}`,get:()=>zb(e,t[0],r,n,a)},t));return o},Uc=e=>{let t=e.attributes.getInt("axis",0),r=e.attributes.getInts("split",[]),n=e.outputs.length;return te({axis:t,split:r,numOutputs:n})},Ub=(e,t,r,n)=>{let[,i]=pn.splitShape(t[0].dims,r,n.split,n.numOutputs);return i.length},zb=(e,t,r,n,i)=>{let[o,a]=pn.splitShape(t.dims,n,r.split,r.numOutputs),s=a[i],u=o[i],l=`\n      float process(int indices[${u.length}]) {\n        indices[${n}] += ${s};\n        return _A(indices);\n      }\n    `;return{...Mc,cacheHint:`${r.cacheKey}:${i}`,output:{dims:u,type:t.type,textureType:0},shaderSource:l}},Wb=e=>{if(!e||1!==e.length)throw new Error("Split requires one input.");if("int8"!==e[0].type&&"uint8"!==e[0].type&&"int16"!==e[0].type&&"uint16"!==e[0].type&&"int32"!==e[0].type&&"uint32"!==e[0].type&&"float32"!==e[0].type&&"float64"!==e[0].type&&"bool"!==e[0].type)throw new Error("Invalid input type.")}})),Yi,Wc,Vc,Vb,Hb,Hc=L((()=>{fe(),Yi=(e,t,r)=>{Vb(t);let n=z.squeezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)]},Wc=(e,t)=>(Hb(t),Yi(e,[t[0]],Array.from(t[1].integerData))),Vc=e=>e.attributes.getInts("axes"),Vb=e=>{if(!e||1!==e.length)throw new Error("Squeeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},Hb=e=>{if(!e||2!==e.length)throw new Error("Squeeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}})),jc,jb,qb,qc=L((()=>{ve(),ae(),jc=(e,t)=>{qb(t);let r={name:"Sum",inputNames:t.map(((e,t)=>`X${t}`)),inputTypes:new Array(t.length).fill(0)};return[e.run({...r,get:()=>jb(e,t,r)},t)]},jb=(e,t,r)=>{let n=q(e.session.backend.glContext.version),i=t[0].dims.slice(),o=`\n      void main() {\n        vec4 result = ${t.map(((e,t)=>`${n.texture2D}(X${t},TexCoords)`)).join(" + ")};\n        ${n.output} = result;\n      }\n    `;return{...r,output:{dims:i,type:t[0].type,textureType:0},hasMain:!0,shaderSource:o}},qb=e=>{if(!e||0===e.length)throw new Error("Sum requires inputs.");let t=e[0].dims.length;for(let r=1;r<e.length;r++){if(t!==e[r].dims.length)throw new Error("Input shapes are mismatched.");for(let n=0;n<t;n++)if(e[0].dims[n]!==e[r].dims[n])throw new Error("Input shapes are not matched.")}if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");for(let t=1;t<e.length;t++)if(e[0].type!==e[t].type)throw new Error("Input types are not matched.")}})),Yc,Yb,Xb,Xc=L((()=>{yn(),ae(),Yc=(e,t)=>{Xb(t);let r={name:"Tile",inputNames:["A"],inputTypes:[0]};return[e.run({...r,get:()=>Yb(e,t,r)},t)]},Yb=(e,t,r)=>{let n=t[0].dims.slice(),i=new Array(n.length),o=[];for(let e=0;e<n.length;e++)i[e]=n[e]*t[1].numberData[e],o.push(`inputIdx[${e}] = int(mod(float(outputIdx[${e}]), ${n[e]}.));`);let a=i.length,s=`\n      float process(int outputIdx[${a}]) {\n        int inputIdx[${a}];\n        ${o.join("\n")}\n        return _A(inputIdx);\n      }\n    `;return{...r,output:{dims:i,type:t[0].type,textureType:0},shaderSource:s}},Xb=e=>{if(!e||2!==e.length)throw new Error("Tile requires 2 input.");if(1!==e[1].dims.length)throw new Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw new Error("Invalid input shape.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invalid repeat type.")}})),Xi,Kc,Jc,Kb,Jb,Zc=L((()=>{fe(),Xi=(e,t,r)=>{Kb(t);let n=z.unsqueezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)]},Kc=(e,t)=>(Jb(t),Xi(e,[t[0]],Array.from(t[1].integerData))),Jc=e=>e.attributes.getInts("axes"),Kb=e=>{if(!e||1!==e.length)throw new Error("Unsqueeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},Jb=e=>{if(!e||2!==e.length)throw new Error("Unsqueeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}})),Qc,ep=L((()=>{ll(),vl(),Il(),Ll(),fo(),mf(),wf(),Of(),Af(),Lf(),$f(),Rf(),zf(),co(),jf(),ic(),dc(),mc(),wc(),_c(),Ec(),Rc(),zc(),Hc(),qc(),Xc(),ho(),Fi(),Zc(),Vi(),Qc=[["Abs","","6+",Fl],["Acos","","7+",Cl],["Add","","7+",fl],["And","","7+",cl],["Asin","","7+",$l],["Atan","","7+",Bl],["AveragePool","","7+",Yf,Xf],["BatchNormalization","","7+",sl,ul],["Cast","","6+",_l,Ol],["Ceil","","6+",Rl],["Clip","","6-10",Di,kl],["Clip","","11+",Nl],["Concat","","4+",El,Dl],["Conv","","1+",Ri,Mi],["ConvTranspose","","1+",df,hf],["Cos","","7+",Ml],["Div","","7+",pl],["Dropout","","7+",Li],["DepthToSpace","","1+",Tf,xf],["Equal","","7+",dl],["Elu","","6+",Gl,Ul],["Exp","","6+",zl],["Flatten","","1+",vf,_f],["Floor","","6+",Wl],["FusedConv","com.microsoft","1+",Ri,Mi],["Gather","","1+",If,Sf],["Gemm","","7-10",Gi,Pf],["Gemm","","11+",Gi,Df],["GlobalAveragePool","","1+",Jf,Zf],["GlobalMaxPool","","1+",nc],["Greater","","7+",hl],["Identity","","1+",Li],["ImageScaler","","1+",Ff,Cf],["InstanceNormalization","","6+",kf,Nf],["LeakyRelu","","6+",Vl,Hl],["Less","","7+",ml],["LRN","","1+",Mf,Gf],["Log","","6+",jl],["MatMul","","1+",af,sf],["MaxPool","","1+",Qf,ec],["Mul","","7+",bl],["Neg","","6+",ql],["Not","","1+",Yl],["Or","","7+",gl],["Pad","","2-10",Ui,Wf],["Pad","","11+",Vf,Hf],["Pow","","7+",yl],["PRelu","","7+",Tl],["ReduceLogSum","","1+",cc,nr],["ReduceMax","","1+",uc,nr],["ReduceMean","","1+",sc,nr],["ReduceMin","","1+",lc,nr],["ReduceProd","","1+",fc,nr],["ReduceSum","","1-12",ac,nr],["ReduceSumSquare","","1+",pc,nr],["Relu","","6+",Xl],["Reshape","","5+",hc],["Resize","","10",ji,Tc],["Resize","","11+",ji,xc],["Shape","","1+",vc],["Sigmoid","","6+",Kl],["Sin","","7+",Jl],["Slice","","10+",Ac],["Slice","","1-9",Oc,Ic],["Softmax","","1-12",Fc,Cc],["Softmax","","13+",Bc,$c],["Split","","2-12",Gc,Uc],["Sqrt","","6+",Zl],["Squeeze","","1-12",Yi,Vc],["Squeeze","","13+",Wc],["Sub","","7+",xl],["Sum","","6+",jc],["Tan","","7+",Ql],["Tanh","","6+",ef],["Tile","","6+",Yc],["Transpose","","1+",Sr,gf],["Upsample","","7-8",zi,gc],["Upsample","","9",zi,yc],["Unsqueeze","","1-12",Xi,Jc],["Unsqueeze","","13+",Kc],["Xor","","7+",wl]]}));function rp(e){let t,r={};for(;null!==(t=tp.exec(e));){let e=t[3].split(",").map((e=>{let t=e.trim().split(" ");return t&&2===t.length?{type:t[0],name:t[1]}:null})).filter((e=>null!==e));r[t[2]]={params:e,body:t[4]}}for(let n in r){let i=Zb.replace("__FUNC__",n),o=new RegExp(i,"gm");for(;null!==(t=o.exec(e));){let i=t[1],o=t[2],a=t[3].split(","),s=i?`${i} ${o};`:"",u=r[n].body,l="";r[n].params.forEach(((e,t)=>{e&&(l+=`${e.type} ${e.name} = ${a[t]};\n`)})),u=`${l}\n ${u}`,u=u.replace("return",`${o} = `);let h=`\n      ${s}\n      {\n        ${u}\n      }\n      `;e=e.replace(t[0],h)}}return e=e.replace(tp,"")}var tp,Zb,np=L((()=>{tp=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,Zb="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"}));function Yr(e,t){let r=[],n=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:Qb(t,e).sort(),a=0;for(let t=0;t<e.length;++t){if(null!=o){if(o[a]===t&&1!==e[t])throw new Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==o[a]||o[a]>t)&&1===e[t]&&(r.push(e[t]),n.push(t)),o[a]<=t&&a++}1!==e[t]&&(r.push(e[t]),n.push(t))}return{newShape:r,keptDims:n}}function Qb(e,t){let r=t.length;return zr((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-r&&e<r)),(()=>`All values in axis param must be in range [-${r}, ${r}) but got axis ${e}`)),zr(e.every(eg),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?r+e:e))}function eg(e){return e%1==0}function tg(e){if(0===e.length)return 1;let t=e[0];for(let r=1;r<e.length;r++)t*=e[r];return t}function op(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}var yo,Ki=L((()=>{dt(),fe(),yo=class{constructor(e){this.maxTextureSize=e}computeTextureWH(e,t){let r=this.computeTexture(e,t);return t&&t.isPacked&&(r[0]/=2,r[1]/=2),t&&t.reverseWH?[r[1],r[0]]:r}computeTexture(e,t){let r=t&&t.isPacked;if(0===e.length)return r?[2,2]:[1,1];let n=this.maxTextureSize;if(t&&void 0!==t.breakAxis){let r=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce(((e,t)=>e*t)),i=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce(((e,t)=>e*t));if(!(r>n||i>n))return[r,i];pe.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${e}, breakAxis:${t.breakAxis}`)}let i=e.slice(0);r&&(n*=2,i=i.map(((e,t)=>t>=i.length-2?i[t]%2==0?i[t]:i[t]+1:i[t])),1===i.length&&(i=[2,i[0]])),2!==i.length&&(i=Yr(i).newShape);let o=tg(i);return i.length<=1&&o<=n?[1,o]:2===i.length&&i[0]<=n&&i[1]<=n?i:3===i.length&&i[0]*i[1]<=n&&i[2]<=n?[i[0]*i[1],i[2]]:3===i.length&&i[0]<=n&&i[1]*i[2]<=n?[i[0],i[1]*i[2]]:4===i.length&&i[0]*i[1]*i[2]<=n&&i[3]<=n?[i[0]*i[1]*i[2],i[3]]:4===i.length&&i[0]<=n&&i[1]*i[2]*i[3]<=n?[i[0],i[1]*i[2]*i[3]]:r?op(o/4).map((e=>2*e)):op(o)}}})),To,ip=L((()=>{fe(),qt(),ve(),Ki(),Bt(),To=class extends gt{constructor(e){super(e)}getFunctions(){return{...this.offsetToCoords(),...this.coordsToOffset(),...this.toVec(),...this.valueFrom(),...this.getCommonUtilFuncs(),...this.getInputsSamplingSnippets(),...this.getOutputSamplingSnippet()}}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new G("\n      vec2 offsetToCoords(int offset, int width, int height) {\n        int t = offset / width;\n        int s = offset - t*width;\n        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);\n        return coords;\n      }\n      ")}}coordsToOffset(){return{coordsToOffset:new G("\n      int coordsToOffset(vec2 coords, int width, int height) {\n        float s = coords.s * float(width);\n        float t = coords.t * float(height);\n        int offset = int(t) * width + int(s);\n        return offset;\n      }\n      ")}}getOutputSamplingSnippet(){let e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e)}getPackedOutputSamplingSnippet(e){let t=e.unpackedShape,r=[e.width,e.height],n={},i="getOutputCoords";switch(t.length){case 0:n[i]=this.getOutputScalarCoords();break;case 1:n[i]=this.getOutputPacked1DCoords(t,r);break;case 2:n[i]=this.getOutputPacked2DCoords(t,r);break;case 3:n[i]=this.getOutputPacked3DCoords(t,r);break;default:n[i]=this.getOutputPackedNDCoords(t,r)}let o=`\n      void setOutput(vec4 val) {\n        ${q(this.context.glContext.version).output} = val;\n      }\n    `;return n.floatTextureSetRGBA=new G(o),n}getUnpackedOutputSamplingSnippet(e){let t=e.unpackedShape,r=[e.width,e.height],n={},i="getOutputCoords";switch(t.length){case 0:n[i]=this.getOutputScalarCoords();break;case 1:n[i]=this.getOutputUnpacked1DCoords(t,r);break;case 2:n[i]=this.getOutputUnpacked2DCoords(t,r);break;case 3:n[i]=this.getOutputUnpacked3DCoords(t,r);break;case 4:n[i]=this.getOutputUnpacked4DCoords(t,r);break;case 5:n[i]=this.getOutputUnpacked5DCoords(t,r);break;case 6:n[i]=this.getOutputUnpacked6DCoords(t,r);break;default:throw new Error(`Unsupported output dimensionality: ${t.length}`)}let o=`\n        void setOutput(float val) {\n          ${q(this.context.glContext.version).output} = vec4(val, 0, 0, 0);\n        }\n    `;return n.floatTextureSetR=new G(o),n}getOutputScalarCoords(){return new G("\n      int getOutputCoords() {\n        return 0;\n      }\n    ")}getOutputPacked1DCoords(e,t){let r=t,n="";return 1===r[0]?(n=`\n          int getOutputCoords() {\n            return 2 * int(TexCoords.y * ${r[1]}.0);\n          }\n        `,new G(n)):1===r[1]?(n=`\n          int getOutputCoords() {\n            return 2 * int(TexCoords.x * ${r[0]}.0);\n          }\n        `,new G(n)):(n=`\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                 vec2(${r[0]}, ${r[1]}));\n          return 2 * (resTexRC.y * ${r[0]} + resTexRC.x);\n        }\n      `,new G(n))}getOutputPacked2DCoords(e,t){let r="";if(Tr.arraysEqual(e,t))return r=`\n        ivec2 getOutputCoords() {\n          return 2 * ivec2(TexCoords.xy * vec2(${t[0]}, ${t[1]}));\n        }\n      `,new G(r);let n=t,i=Math.ceil(e[1]/2);return r=`\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${n[0]}, ${n[1]}));\n\n          int index = resTexRC.y * ${n[0]} + resTexRC.x;\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ${i}) * 2;\n          int c = 2 * (index / ${i});\n\n          return ivec2(r, c);\n        }\n      `,new G(r)}getOutputPacked3DCoords(e,t){let r=[t[0],t[1]],n=Math.ceil(e[2]/2),i=n*Math.ceil(e[1]/2);return new G(`\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${r[0]}, ${r[1]}));\n          int index = resTexRC.y * ${r[0]} + resTexRC.x;\n\n          int b = index / ${i};\n          index -= b * ${i};\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ${n}) * 2;\n          int c = 2 * (index / ${n});\n\n          return ivec3(b, r, c);\n        }\n      `)}getOutputPackedNDCoords(e,t){let r=[t[0],t[1]],n=Math.ceil(e[e.length-1]/2),i=n*Math.ceil(e[e.length-2]/2),o=i,a="",s="b, r, c";for(let t=2;t<e.length-1;t++)o*=e[e.length-t-1],a=`\n      int b${t} = index / ${o};\n      index -= b${t} * ${o};\n    `+a,s=`b${t}, `+s;let u=`\n      ivec${e.length} getOutputCoords() {\n        ivec2 resTexRC = ivec2(TexCoords.xy *\n                              vec2(${r[0]}, ${r[1]}));\n        int index = resTexRC.y * ${r[0]} + resTexRC.x;\n\n        ${a}\n\n        int b = index / ${i};\n        index -= b * ${i};\n\n        // reverse r and c order for packed texture\n        int r = imod(index, ${n}) * 2;\n        int c = 2 * (index / ${n});\n\n        return ivec${e.length}(${s});\n      }\n    `;return new G(u)}getOutputUnpacked1DCoords(e,t){let r=`\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          return resTexRC.y * ${t[0]} + resTexRC.x;\n        }\n      `;return new G(r)}getOutputUnpacked2DCoords(e,t){let r=`\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          int r = index / ${e[1]};\n          int c = index - r * ${e[1]};\n          return ivec2(r, c);\n        }\n      `;return new G(r)}getOutputUnpacked3DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec3(r, c, d);\n        }\n      `,new G(r)}getOutputUnpacked4DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d","d2"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n      ivec4 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec4(r, c, d, d2);\n        }\n      `,new G(r)}getOutputUnpacked5DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d","d2","d3"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n      ivec5 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec5(r, c, d, d2, d3);\n        }\n      `,new G(r)}getOutputUnpacked6DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d","d2","d3","d4"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n     ivec6 getOutputCoords() {\n         ivec2 resTexRC = ivec2(TexCoords.xy *\n                               vec2(${t[0]}, ${t[1]}));\n         int index = resTexRC.y * ${t[0]} + resTexRC.x;\n         ${a}\n         return ivec6(r, c, d, d2, d3, d4);\n       }\n     `,new G(r)}getCommonUtilFuncs(){let e={},t="uvFromFlat";e[t]=new G("\n    vec2 uvFromFlat(int texNumR, int texNumC, int index) {\n      int texC = index / texNumR;\n      int texR = index - texC * texNumR;\n      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to\n      //       v.\n      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);\n    }\n    "),t="packedUVfrom1D",e[t]=new G("\n      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n        int texelIndex = index / 2;\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom2D",e[t]=new G("\n      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {\n        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom3D",e[t]=new G("\n      vec2 packedUVfrom3D(int texNumR, int texNumC,\n          int texelsInBatch, int texelsInLogicalRow, int b,\n          int row, int col) {\n        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = index / texNumC;\n        int texC = index - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="sampleTexture";let r=q(this.context.glContext.version);return e[t]=new G(`\n        float sampleTexture(sampler2D textureSampler, vec2 uv) {\n            return ${r.texture2D}(textureSampler, uv).r;\n        }`),e}getInputsSamplingSnippets(){let e={},t=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n],o=no(r);i.isPacked?e[o]=this.getPackedSamplerFromInput(o,r,i):e[o]=this.getUnpackedSamplerFromInput(o,r,i);let a=Hu(r);i.unpackedShape.length<=t.unpackedShape.length&&(i.isPacked?e[a]=this.getPackedSamplerAtOutputCoords(a,i,t,r):e[a]=this.getUnpackedSamplerAtOutputCoords(a,i,t,r))})),e}getPackedSamplerAtOutputCoords(e,t,r,n){let i,o=t.unpackedShape,a=r.unpackedShape,s=no(n),u=o.length,l=a.length,h=Ke.getBroadcastDims(o,a),c=Je(l),d=l-u,f=Dt();i=0===u?"":l<2&&h.length>=1?"coords = 0;":h.map((e=>`coords.${f[e+d]} = 0;`)).join("\n");let p="";p=l<2&&u>0?"coords":o.map(((e,t)=>`coords.${f[t+d]}`)).join(", ");let y="return outputValue;",g=1===z.size(o),m=1===z.size(a);if(1!==u||g||m){if(g&&!m)y=1===l?"\n          return vec4(outputValue.x, outputValue.x, 0., 0.);\n        ":"\n          return vec4(outputValue.x);\n        ";else if(h.length){let e=u-2,t=u-1;h.indexOf(e)>-1&&h.indexOf(t)>-1?y="return vec4(outputValue.x);":h.indexOf(e)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":h.indexOf(t)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);")}}else y="\n        return vec4(outputValue.xy, outputValue.xy);\n      ";let w=`\n        int lastDim = coords.${f[l-1]};\n        coords.${f[l-1]} = coords.${f[l-2]};\n        coords.${f[l-2]} = lastDim;\n      `;return new G(`\n      vec4 ${e}() {\n        ${c} coords = getOutputCoords();\n        ${w}\n        ${i}\n        vec4 outputValue = ${s}(${p});\n        ${y}\n      }\n    `,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(e,t,r,n){let i=[r.width,r.height],o=[t.width,t.height],a=t.unpackedShape.length,s=r.unpackedShape.length,u=t.unpackedShape,l=r.unpackedShape,h=no(n);if(a===s&&Tr.arraysEqual(o,i)){return new G(`\n          float ${e}() {\n            return sampleTexture(${n}, TexCoords);\n          }\n        `,["coordinates.sampleTexture"])}let c,d=Je(s),f=Ke.getBroadcastDims(u,l),p=s-a,y=Dt();c=0===a?"":s<2&&f.length>=1?"coords = 0;":f.map((e=>`coords.${y[e+p]} = 0;`)).join("\n");let g="";return g=s<2&&a>0?"coords":t.unpackedShape.map(((e,t)=>`coords.${y[t+p]}`)).join(", "),new G(`\n        float ${e}() {\n          ${d} coords = getOutputCoords();\n          ${c}\n          return ${h}(${g});\n        }\n      `,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(e,t,r){switch(r.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,t);case 1:return this.getPackedSampler1D(e,t,r);case 2:return this.getPackedSampler2D(e,t,r);case 3:return this.getPackedSampler3D(e,t,r);default:return this.getPackedSamplerND(e,t,r)}}getUnpackedSamplerFromInput(e,t,r){let n=r.unpackedShape;switch(n.length){case 0:return this.getUnpackedSamplerScalar(e,t,r);case 1:return this.getUnpackedSampler1D(e,t,r);case 2:return this.getUnpackedSampler2D(e,t,r);case 3:return this.getUnpackedSampler3D(e,t,r);case 4:return this.getUnpackedSampler4D(e,t,r);case 5:return this.getUnpackedSampler5D(e,t,r);case 6:return this.getUnpackedSampler6D(e,t,r);default:throw new Error(`Unsupported dimension ${n.length}-D`)}}getPackedSamplerScalar(e,t){let r=`\n          vec4 ${e}() {\n            return ${q(this.context.glContext.version).texture2D}(${t}, halfCR);\n          }\n        `;return new G(r)}getPackedSampler1D(e,t,r){let n=[r.width,r.height],i=[n[1],n[0]],o=q(this.context.glContext.version),a=`vec4 ${e}(int index) {\n      vec2 uv = packedUVfrom1D(\n      ${i[0]}, ${i[1]}, index);\n      return ${o.texture2D}(${t}, uv);\n    }`;return new G(a,["coordinates.packedUVfrom1D"])}getPackedSampler2D(e,t,r){let n=r.unpackedShape,i=[r.width,r.height],o=q(this.context.glContext.version),a=i[0],s=i[1];if(null!=i&&Tr.arraysEqual(n,i)){let r=`vec4 ${e}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${a}.0);\n        return ${o.texture2D}(${t}, uv);\n      }`;return new G(r)}let u=i,l=Math.ceil(n[1]/2),h=`vec4 ${e}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${u[1]}, ${u[0]}, ${l}, row, col);\n      return ${o.texture2D}(${t}, uv);\n    }`;return new G(h,["coordinates.packedUVfrom2D"])}getPackedSampler3D(e,t,r){let n=r.unpackedShape,i=[r.width,r.height],o=[i[0],i[1]],a=q(this.context.glContext.version);if(1===n[0]){let i=n.slice(1),o=[1,2],a=Wr(n,i),s=["b","row","col"],u=JSON.parse(JSON.stringify(r));u.unpackedShape=a;let l=this.getPackedSamplerFromInput(e,t,u),h=`${l.routineBody}\n      vec4 ${e}(int b, int row, int col) {\n        return ${e}(${Vr(s,o)});\n      } `;return new G(h,l.dependencies)}let s=o[0],u=o[1],l=Math.ceil(n[2]/2),h=`vec4 ${e}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${u}, ${s}, ${l*Math.ceil(n[1]/2)}, ${l}, b, row, col);\n      return ${a.texture2D}(${t}, uv);}`;return new G(h,["coordinates.packedUVfrom3D"])}getPackedSamplerND(e,t,r){let n=r.unpackedShape,i=n.length,o=[r.width,r.height],a=q(this.context.glContext.version),s=[o[0],o[1]],u=s[1],l=s[0],h=Math.ceil(n[i-1]/2),c=h*Math.ceil(n[i-2]/2),d="int b, int row, int col",f=`b * ${c} + (row / 2) * ${h} + (col / 2)`;for(let e=2;e<i-1;e++)d=`int b${e}, `+d,c*=n[i-e-1],f=`b${e} * ${c} + `+f;let p=`vec4 ${e}(${d}) {\n      int index = ${f};\n      int texR = index / ${l};\n      int texC = index - texR * ${l};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${u});\n      return ${a.texture2D}(${t}, uv);\n    }`;return new G(p)}getUnpackedSamplerScalar(e,t,r){let[n,i]=[r.width,r.height];if(1===n&&1===i){return new G(`\n          float ${e}() {\n            return sampleTexture(${t}, halfCR);\n          }\n        `,["coordinates.sampleTexture"])}return new G(`\n        float ${e}() {\n          int offset_${t} = coordsToOffset(TexCoords, ${n}, ${i});\n          vec2 uv = uvFromFlat(${n}, ${i}, offset_${t});\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(e,t,r){let n=r.width,i=r.height;if(1===i&&1===n){return new G(`\n        float ${e}(int index) {\n          return sampleTexture(${t}, halfCR);\n        }\n      `,["coordinates.sampleTexture"])}if(1===i){return new G(`\n          float ${e}(int index) {\n            vec2 uv = vec2((float(index) + 0.5) / ${n}.0, 0.5);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.sampleTexture"])}if(1===n){return new G(`\n          float ${e}(int index) {\n            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${i}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.sampleTexture"])}return new G(`\n        float ${e}(int index) {\n          vec2 uv = uvFromFlat(${n}, ${i}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(e,t,r){let n=r.unpackedShape,i=[r.height,r.width];if(null!=i&&Tr.arraysEqual(n,i)){return new G(`\n          float ${e}(int row, int col) {\n            vec2 uv = (vec2(row, col) + halfCR) / vec2(${i[1]}.0, ${i[0]}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.sampleTexture"])}let{newShape:o,keptDims:a}=Yr(n),s=o;if(s.length<n.length){let i=Wr(n,s),o=JSON.parse(JSON.stringify(r));o.unpackedShape=i;let u=["col","row"],l=`\n          ${this.getUnpackedSamplerFromInput(e,t,o).routineBody}\n          float ${e}(int row, int col) {\n            return ${e}(${Vr(u,a)});\n          }\n        `;return new G(l,["coordinates.sampleTexture"])}let u=i[1],l=i[0];if(1===l){let r=`\n          float ${e}(int row, int col) {\n            int offset_${t} = coordsToOffset(TexCoords, ${u}, ${l});\n            float index = dot(vec3(row, col, offset_${t}), vec3(${n[1]}, 1, 1));\n            vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new G(r,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(1===u){let r=`\n          float ${e}(int row, int col) {\n            int offset_${t} = coordsToOffset(TexCoords, ${u}, ${l});\n            float index = dot(vec3(row, col, offset_${t}), vec3(${n[1]}, 1, 1));\n            vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new G(r,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let h=`\n        float ${e}(int row, int col) {\n          int index = col * ${n[1]} + row;\n          vec2 uv = uvFromFlat(${u}, ${l}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `;return new G(h,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(e,t,r){let n=r.unpackedShape,i=n[1]*n[2],o=n[2],{newShape:a,keptDims:s}=Yr(n),u=a;if(u.length<n.length){let i=Wr(n,u),o=["batch","col","row"],a=JSON.parse(JSON.stringify(r));a.unpackedShape=i;let l=this.getUnpackedSamplerFromInput(e,t,a),h=s.reverse(),c=`\n          ${l.routineBody}\n          float ${e}(int batch, int row, int col) {\n            return ${e}(${Vr(o,h)});\n          }\n        `;return new G(c,l.dependencies)}let l=r.width,h=r.height;return new G(`\n          float ${e}(int depth, int row, int col) {\n            // Explicitly use integer operations as dot() only works on floats.\n            int index = depth * ${i} + col * ${o} + row;\n            vec2 uv = uvFromFlat(${l}, ${h}, index);\n            return sampleTexture(${t}, uv);\n          }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(e,t,r){let n=r.unpackedShape,i=n[3],o=n[2]*i,a=n[1]*o,s=r.width,u=r.height;return new G(`\n        float ${e}(int row, int col, int depth, int depth2) {\n          int index = row * ${a} + col * ${o} +\n              depth2 * ${i} + depth;\n          vec2 uv = uvFromFlat(${s}, ${u}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(e,t,r){let n=r.unpackedShape,i=n[4],o=n[3]*i,a=n[2]*o,s=n[1]*a,{newShape:u,keptDims:l}=Yr(n);if(u.length<n.length){let i=Wr(n,u),o=["row","col","depth","depth2","depth3"],a=JSON.parse(JSON.stringify(r));a.unpackedShape=i;let s=`\n          ${this.getUnpackedSamplerFromInput(e,t,a).routineBody}\n          float ${e}(int row, int col, int depth, int depth2, int depth3) {\n            return ${e}(${Vr(o,l)});\n          }\n        `;return new G(s,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let h=r.width,c=r.height;return new G(`\n        float ${e}(int row, int col, int depth, int depth2, int depth3) {\n          int index = row * ${s} + col * ${a} + depth * ${o} +\n          depth3 * ${i} + depth2;\n          vec2 uv = uvFromFlat(${h}, ${c}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(e,t,r){let n=r.unpackedShape,i=n[5],o=n[4]*i,a=n[3]*o,s=n[2]*a,u=n[1]*s,{newShape:l,keptDims:h}=Yr(n);if(l.length<n.length){let i=Wr(n,l),o=["row","col","depth","depth2","depth3","depth4"],a=JSON.parse(JSON.stringify(r));a.unpackedShape=i;let s=`\n            ${this.getUnpackedSamplerFromInput(e,t,a).routineBody}\n            float ${e}(int row, int col, int depth,\n              int depth2, int depth3, int depth4) {\n              return ${e}(${Vr(o,h)});\n            }\n          `;return new G(s,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let c=r.width,d=r.height;return new G(`\n          float ${e}(int row, int col, int depth,\n            int depth2, int depth3, int depth4) {\n            int index = row * ${u} + col * ${s} + depth * ${a} +\n            depth2 * ${o} + depth3 * ${i} + depth4;\n            vec2 uv = uvFromFlat(${c}, ${d}, index);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let e=this.context.outputTextureLayout,t=e.shape.length,r=e.strides,n=e.width,i=e.height,o=[];for(let e=0;e<t-1;++e)o.push(`\n        c[${e}] = offset / ${r[e]};`),o.push(`\n        offset -= c[${e}] * ${r[e]};`);o.push(`\n        c[${t-1}] = offset;`);let a=`\n      void toVec(vec2 texCoords, out int c[${t}]) {\n        int offset = coordsToOffset(texCoords, ${n}, ${i});\n        ${o.join("")}\n      }\n      void toVec(int offset, out int c[${t}]) {\n        ${o.join("")}\n      }\n    `;return{toVec:new G(a,["coordinates.coordsToOffset"])}}valueFrom(){let e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{let n=this.context.inputTextureLayouts[r],i=(n.unpackedShape.length>0?n.unpackedShape:n.shape).length,o=`_${t}`;e[o]=new G(this.getValueFromSingle(t,i,n.width,n.height,!1),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),o+="_T",e[o]=new G(this.getValueFromSingle(t,i,n.width,n.height,!0),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])})),e}getValueFromSingle(e,t,r,n,i){let o=`_${e}`;return i&&(o+="_T"),`\n        float ${o}(int m[${t}]) {\n          int offset = indicesToOffset${o}(m);\n          vec2 coords = offsetToCoords(offset, ${r}, ${n});\n          float value = getColorAsFloat(${q(this.context.glContext.version).texture2D}(${e}, coords));\n          return value;\n        }\n        `}getPackedValueFrom(e,t,r,n,i){let o=`_${e}_Pack`;return i&&(o+="_T"),`\n        vec4 ${o}(int m[${t}]) {\n          int offset = indicesToOffset_${e}(m);\n          vec2 coords = offsetToCoords(offset, ${r}, ${n});\n          return ${q(this.context.glContext.version).texture2D}(${e}, coords);\n        }\n        `}}})),xo,ap=L((()=>{qt(),xo=class e extends gt{constructor(e){super(e)}getFunctions(){return{...this.encodeFloat32(),...this.decodeFloat32()}}getCustomTypes(){return{}}encodeFloat32(){return{encode:new G("highp vec4 encode(highp float f) {\n        return vec4(f, 0.0, 0.0, 0.0);\n      }\n        ")}}decodeFloat32(){return{decode:new G("highp float decode(highp vec4 rgba) {\n        return rgba.r;\n      }\n        ")}}encodeUint8(){let t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new G(`\n      highp vec4 encode(highp float f) {\n        highp float F = abs(f);\n        highp float Sign = step(0.0,-f);\n        highp float Exponent = floor(log2(F));\n        highp float Mantissa = (exp2(- Exponent) * F);\n        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));\n        highp vec4 rgba;\n        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));\n        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);\n        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));\n        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));\n        ${t}\n        rgba = rgba / 255.0; // values need to be normalized to [0,1]\n        return rgba;\n    }\n        `)}}decodeUint8(){let t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new G(`\n        highp float decode(highp vec4 rgba) {\n          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]\n          ${t}\n          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;\n          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;\n          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);\n          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));\n          return Result;\n      }\n        `)}}static isLittleEndian(){let e=new ArrayBuffer(4),t=new Uint32Array(e),r=new Uint8Array(e);if(t[0]=3735928559,239===r[0])return!0;if(222===r[0])return!1;throw new Error("unknown endianness")}}})),wo,sp=L((()=>{qt(),ve(),wo=class extends gt{constructor(e){super(e)}getFunctions(){return{...this.setFragColor(),...this.getColorAsFloat()}}getCustomTypes(){return{}}setFragColor(){let e=q(this.context.glContext.version);return{setFragColor:new G(`\n        void setFragColor(float value) {\n            ${e.output} = encode(value);\n        }\n        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new G("\n        float getColorAsFloat(vec4 color) {\n            return decode(color);\n        }\n        ",["encoding.decode"])}}}})),vo,up=L((()=>{qt(),vo=class e extends gt{constructor(e){super(e)}getFunctions(){return{...this.bcastIndex(),...this.bcastMatmulIndex(),...this.offsetToIndices(),...this.indicesToOffset(),...this.incrementIndices()}}getCustomTypes(){return{}}bcastIndex(){let e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].unpackedShape;if(i.length<=e){let n=i.length,o=e-n,a=`bcastIndices_${r}`,s="";for(let e=0;e<n;++e)s+=`\n          realIndices[${e}] = int( mod(float(bcastedIndices[${o+e}]), ${i[e]}.0) );\n          `;let u=`\n        void ${a} (int bcastedIndices[${e}], out int realIndices[${n}]) {\n          ${s}\n        }\n        `;t[a]=new G(u)}})),t}bcastMatmulIndex(){let e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].shape;if(!(i.length<2||i.length>e)){let n=i.length,o=e-n,a=`bcastMatmulIndices_${r}`,s="";for(let e=0;e<n-2;++e)s+=`\n          realIndices[${e}] = int( mod(float(bcastedIndices[${o+e}]), ${i[e]}.0) );\n          `;let u=`\n        void ${a}(int bcastedIndices[${e}], out int realIndices[${n}]) {\n          ${s}\n          realIndices[${n-1}] = bcastedIndices[${e-1}];\n          realIndices[${n-2}] = bcastedIndices[${e-2}];\n        }\n        `;t[a]=new G(u)}})),t}indicesToOffset(){let t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].shape,o=this.context.inputTextureLayouts[n].strides,a=i.length,s=`indicesToOffset_${r}`;t[s]=new G(e.indexToOffsetSingle(s,a,o)),s=`indicesToOffset_${r}_T`,t[s]=new G(e.indexToOffsetSingle(s,a,o.slice().reverse()))})),t}static indexToOffsetSingle(e,t,r){let n="";for(let e=t-1;e>=0;--e)n+=`\n        offset += indices[${e}] * ${r[e]};\n        `;return`\n      int ${e}(int indices[${t}]) {\n        int offset = 0;\n        ${n}\n        return offset;\n      }\n      `}offsetToIndices(){let t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].shape,o=this.context.inputTextureLayouts[n].strides,a=i.length,s=`offsetToIndices_${r}`;t[s]=new G(e.offsetToIndicesSingle(s,a,o)),s=`offsetToIndices_${r}_T`,t[s]=new G(e.offsetToIndicesSingle(s,a,o.slice().reverse()))})),t}static offsetToIndicesSingle(e,t,r){let n=[];for(let e=0;e<t-1;++e)n.push(`\n      indices[${e}] = offset / ${r[e]};`),n.push(`\n        offset -= indices[${e}] * ${r[e]};`);return n.push(`\n      indices[${t-1}] = offset;`),`\n      void ${e}(int offset, out int indices[${t}]) {\n        ${n.join("")}\n      }\n      `}incrementIndices(){let e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{let n=this.context.inputTextureLayouts[r].shape,i=n.length,o=`incrementIndices_${t}`,a="";for(let e=0;e<i;++e)a+=`\n        shape[${e}] = ${n[e]};`;let s=`\n        void ${o}(int axis, out int indices[${i}]) {\n          int shape[${i}];\n          ${a};\n          for(int i = ${i} -1 ; i >= 0; --i) {\n            if(i > axis) continue;\n            indices[i] += 1;\n            if(indices[i] < shape[i]) {\n              break;\n            }\n            indices[i] = 0;\n          }\n        }\n        `;e[o]=new G(s)})),e}}})),_o,lp=L((()=>{qt(),_o=class extends gt{constructor(e){super(e)}getCustomTypes(){return{}}getFunctions(){return{...this.binaryVecFunctions(),...this.copyVec(),...this.setVecItem(),...this.getVecItem()}}binaryVecFunctions(){let e=this.context.outputTextureLayout.shape.length,t={add:"+=",sub:"-=",mul:"*=",div:"/="},r={};for(let n in t){let i=`${n}Vec`,o="";for(let r=0;r<e;++r)o+=`\n          dest[${r}] ${t[n]} src[${r}];\n          `;let a=`\n        void ${i}(int src[${e}], out int dest[${e}]) {\n          ${o}\n        }\n        `;r[i]=new G(a)}return r}copyVec(){let e=this.context.outputTextureLayout.shape.length,t="";for(let r=0;r<e;++r)t+=`\n        dest[${r}] = src[${r}];\n        `;return{copyVec:new G(`\n      void copyVec(int src[${e}], out int dest[${e}]) {\n        ${t}\n      }\n      `)}}setVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`\n        if(index < 0)\n            index =${e} + index;\n        if (index == 0)\n            m[0] = value;\n        `;for(let r=1;r<e-1;++r)t+=`\n        else if (index == ${r})\n            m[${r}] = value;\n            `;return t+=`\n        else\n            m[${e-1}] = value;\n        `,{setVecItem:new G(`\n      void setVecItem(out int m[${e}], int index, int value) {\n        ${t}\n      }\n        `)}}getVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`\n        if(index < 0)\n            index = ${e} + index;\n        if (index == 0)\n            return m[0];\n      `;for(let r=1;r<e-1;++r)t+=`\n        else if (index == ${r})\n            return m[${r}];\n      `;return t+=`\n        else\n            return m[${e-1}];\n        `,{getVecItem:new G(`\n      int getVecItem(int m[${e}], int index) {\n        ${t}\n      }\n    `)}}}})),Ji,fp=L((()=>{ip(),ap(),sp(),up(),lp(),Ji={encoding:xo,fragcolor:wo,vec:_o,shapeUtils:vo,coordinates:To}})),Oo,cp=L((()=>{qt(),np(),fp(),ve(),Oo=class{constructor(e,t,r,n){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new so(e,t,r,n),Object.keys(Ji).forEach((e=>{let t=new Ji[e](this.context);this.libs[e]=t}));let i=this.glslLibRoutineDependencyGraph;for(let e in this.libs){let t=this.libs[e].getFunctions();for(let r in t){let n,o=e+"."+r;i[o]?(n=i[o],n.routineBody=t[r].routineBody):(n=new gn(o,t[r].routineBody),i[o]=n);let a=t[r].dependencies;if(a)for(let e=0;e<a.length;++e)if(i[a[e]])n.addDependency(i[a[e]]);else{let t=new gn(a[e]);i[a[e]]=t,n.addDependency(t)}}}}preprocess(){let e=this.context.programInfo,t=e.shaderSource;return this.context.programInfo.hasMain||(t=`${t}\n      ${Vu(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),t=rp(t),`${Wu(this.context.glContext.version)}\n    ${this.getUniforms(e.inputNames,e.variables)}\n    ${this.getImports(t)}\n    ${t}`}getImports(e){let t=this.selectGlslLibRoutinesToBeIncluded(e);if(0===t.length)return"";let r="";for(let e=0;e<t.length;++e){if(!t[e].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${t[e].name}`);r+=t[e].routineBody+"\n"}return r}selectGlslLibRoutinesToBeIncluded(e){let t=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach((r=>{let n=r.split(".")[1];-1!==e.indexOf(n)&&t.push(this.glslLibRoutineDependencyGraph[r])})),uo.returnOrderedNodes(t)}getUniforms(e,t){let r=[];if(e)for(let t of e)r.push(`uniform sampler2D ${t};`);if(t)for(let e of t)r.push(`uniform ${e.type} ${e.name}${e.arrayLength?`[${e.arrayLength}]`:""};`);return r.join("\n")}}})),Io,pp=L((()=>{It(),dt(),cp(),ve(),Io=class{constructor(e,t,r){this.profiler=e,this.glContext=t,this.textureLayoutStrategy=r,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r){this.profiler.event("op",`ProgramManager.run ${e.programInfo.name??"unknown kernel"}`,(()=>{let n=this.glContext.gl,i=e.program;n.useProgram(i);try{this.bindOutput(r),this.attributesBound||this.bindAttributes(e.attribLocations),this.bindUniforms(e.uniformLocations,e.programInfo.variables??[],t)}catch(t){throw pe.error("ProgramManager",e.programInfo.shaderSource),t}this.profiler.event("backend","GlContext.draw()",(()=>{this.glContext.draw()}))}),this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach((e=>this.glContext.deleteProgram(e.program)))}build(e,t,r){return this.profiler.event("backend","ProgramManager.build",(()=>{let n=new Oo(this.glContext,e,t,r),i=n.preprocess(),o=this.compile(i);return{programInfo:e,program:o,uniformLocations:this.getUniformLocations(o,n.context.programInfo.inputNames,n.context.programInfo.variables),attribLocations:this.getAttribLocations(o)}}))}compile(e){if(!this.vertexShader){pe.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let e=zu(this.glContext.version);this.vertexShader=this.glContext.compileShader(e,this.glContext.gl.VERTEX_SHADER)}ee.debug&&pe.verbose("ProrgramManager",`FragShader:\n${e}\n`);let t=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),r=this.glContext.createProgram(this.vertexShader,t);return this.glContext.deleteShader(t),r}bindOutput(e){let t=e.width,r=e.height;pe.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${t}/${r}, shape=${e.shape}, type=${e.tensor.type}`),this.glContext.attachFramebuffer(e.texture,t,r)}bindAttributes(e){let t=e.position,r=e.textureCoord;this.glContext.setVertexAttributes(t,r),this.attributesBound=!0}bindUniforms(e,t,r){let n=this.glContext.gl,i=0;for(let{name:o,type:a,location:s,arrayLength:u}of e){let e=t.find((e=>e.name===o))?.data;if("sampler2D"!==a&&!e)throw new Error(`variable '${o}' does not have data defined in program info`);switch(a){case"sampler2D":this.bindTexture(r[i],s,i),i++;break;case"float":u?n.uniform1fv(s,e):n.uniform1f(s,e);break;case"int":u?n.uniform1iv(s,e):n.uniform1i(s,e);break;default:throw new Error(`Uniform not implemented: ${a}`)}}}bindTexture(e,t,r){this.glContext.bindTextureToUniform(e.texture,r,t)}getAttribLocations(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")}}getUniformLocations(e,t,r){let n=[];if(t)for(let r of t)n.push({name:r,type:"sampler2D",location:this.getUniformLocation(e,r)});if(r)for(let t of r)n.push({...t,location:this.getUniformLocation(e,t.name)});return n}getUniformLocation(e,t){let r=this.glContext.gl.getUniformLocation(e,t);if(null===r)throw new Error(`Uniform ${t} not found.`);return r}getAttribLocation(e,t){return this.glContext.gl.getAttribLocation(e,t)}}})),So,dp=L((()=>{dt(),mn(),So=class{constructor(e,t,r,n){this.glContext=e,this.layoutStrategy=t,this.profiler=r,this.config=n,this.pendingRead=new Map,n.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(e,t,r,n){let i=this.toEncoderType(e),o=this.glContext.getEncoder(i,t.channels||1,n);if(t.isPacked&&1===n)throw new Error("not implemented");let a,s,u=t.width,l=t.height;if(this.config.reuseTextures){a=`${u}x${l}_${o.format}_${o.internalFormat}_${o.textureType}`,s=this.inUseTextures.get(a),s||(s=[],this.inUseTextures.set(a,s));let t=this.idleTextures.get(a);if(t&&t.length>0){let i=t.pop();return s.push(i),1===n&&this.glContext.updateTexture(i,u,l,o,this.toTextureData(e,r)),i}}pe.verbose("TextureManager",`Creating new texture of size ${t.width}x${t.height}`);let h=this.glContext.allocateTexture(u,l,o,this.toTextureData(e,r));return this.config.reuseTextures&&(s.push(h),this.textureLookup.set(h,a)),h}readTexture(e,t,r){return r||(r=1),this.profiler.event("backend","TextureManager.readTexture",(()=>{let n=e.shape.reduce(((e,t)=>e*t))*r,i=this.glContext.readTexture(e.texture,e.width,e.height,n,this.toEncoderType(t),r);return this.toTensorData(t,i)}))}async readTextureAsync(e,t,r){let n=e.tensor.dataId;if(r||(r=1),this.pendingRead.has(n)){let e=this.pendingRead.get(n);return new Promise((t=>e?.push(t)))}return this.profiler.event("backend","TextureManager.readTextureAsync",(async()=>{this.pendingRead.set(n,[]);let i=e.shape.reduce(((e,t)=>e*t))*r;await this.glContext.createAndWaitForFence();let o=this.glContext.readTexture(e.texture,e.width,e.height,i,this.toEncoderType(t),r),a=this.toTensorData(t,o),s=this.pendingRead.get(n);return this.pendingRead.delete(n),s?.forEach((e=>e(a))),a}))}readUint8TextureAsFloat(e){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",(()=>{let t=e.shape.reduce(((e,t)=>e*t)),r=this.glContext.readTexture(e.texture,e.width,e.height,4*t,"byte",4);return new Float32Array(r.buffer,r.byteOffset,t)}))}releaseTexture(e,t){let r;if(this.config.reuseTextures&&(r=this.textureLookup.get(e.texture),r)){t&&this.textureLookup.delete(r);let n=this.inUseTextures.get(r);if(n){let t=n.indexOf(e.texture);if(-1!==t){n.splice(t,1);let i=this.idleTextures.get(r);i||(i=[],this.idleTextures.set(r,i)),i.push(e.texture)}}}(!r||t)&&(pe.verbose("TextureManager",`Deleting texture of size ${e.width}x${e.height}`),this.glContext.deleteTexture(e.texture))}toTensorData(e,t){switch(e){case"int16":return t instanceof Int16Array?t:Int16Array.from(t);case"int32":return t instanceof Int32Array?t:Int32Array.from(t);case"int8":return t instanceof Int8Array?t:Int8Array.from(t);case"uint16":return t instanceof Uint16Array?t:Uint16Array.from(t);case"uint32":return t instanceof Uint32Array?t:Uint32Array.from(t);case"uint8":case"bool":return t instanceof Uint8Array?t:Uint8Array.from(t);case"float32":return t instanceof Float32Array?t:Float32Array.from(t);case"float64":return t instanceof Float64Array?t:Float64Array.from(t);default:throw new Error(`TensorData type ${e} is not supported`)}}toTextureData(e,t){if(t)return t instanceof Float32Array?t:new Float32Array(t)}toEncoderType(e){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}})),Ao,hp=L((()=>{dt(),Es(),il(),ep(),pp(),Ki(),dp(),Ao=class{constructor(e,t){this.backend=e,this.context=t,this.layoutStrategy=new yo(e.glContext.maxTextureSize),this.programManager=new Io(this.context.profiler,e.glContext,this.layoutStrategy),this.textureManager=new So(e.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:"full"===e.textureCacheMode}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=e.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new ao(this)}onGraphInitialized(e){let t=e.getValues().filter((e=>-1===e.from&&e.tensor)).map((e=>e.tensor.dataId));this.initializers=new Set(t)}isInitializer(e){return!!this.initializers&&this.initializers.has(e)}addInitializer(e){this.initializers.add(e)}getTextureData(e,t){return t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,r=!1){pe.verbose("WebGLSessionHandler","Storing Texture data in cache"),r?this.packedTextureDataCache.set(e,t):this.unpackedTextureDataCache.set(e,t)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((e=>this.textureManager.releaseTexture(e,!0))),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((e=>this.textureManager.releaseTexture(e,!0))),this.unpackedTextureDataCache=new Map}resolve(e,t,r){let n=As(e,t,Qc);return{impl:n.opImpl,context:n.opInit?n.opInit(e,r):e}}}}));function rg(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var xn,mp=L((()=>{It(),mn(),mn(),Bt(),xn=class{constructor(e,t){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=e,this.version=t,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(e,t,r,n){let i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);let a=n?r.encode(n,e*t):null;return i.texImage2D(i.TEXTURE_2D,0,r.internalFormat,e,t,0,r.format,r.textureType,a),this.checkError(),o}updateTexture(e,t,r,n,i){let o=this.gl;o.bindTexture(o.TEXTURE_2D,e);let a=n.encode(i,t*r);o.texSubImage2D(o.TEXTURE_2D,0,0,0,t,r,n.format,n.textureType,a),this.checkError()}attachFramebuffer(e,t,r){let n=this.gl;n.bindTexture(n.TEXTURE_2D,e),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.checkError(),n.viewport(0,0,t,r),n.scissor(0,0,t,r)}readTexture(e,t,r,n,i,o){let a=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(e,t,r);let s=this.getEncoder(i,o),u=s.allocate(t*r);return a.bindTexture(a.TEXTURE_2D,e),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.readPixels(0,0,t,r,a.RGBA,s.textureType,u),this.checkError(),s.decode(u,n)}isFramebufferReady(){return!0}getActiveTexture(){let e=this.gl;return"TEXTURE"+(e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(e,t){let r=this.gl;r.vertexAttribPointer(e,3,r.FLOAT,!1,20,0),r.enableVertexAttribArray(e),-1!==t&&(r.vertexAttribPointer(t,2,r.FLOAT,!1,20,12),r.enableVertexAttribArray(t)),this.checkError()}createProgram(e,t){let r=this.gl,n=r.createProgram();return r.attachShader(n,e),r.attachShader(n,t),r.linkProgram(n),n}compileShader(e,t){let r=this.gl,n=r.createShader(t);if(!n)throw new Error(`createShader() returned null with type ${t}`);if(r.shaderSource(n,e),r.compileShader(n),!1===r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(`Failed to compile shader: ${r.getShaderInfoLog(n)}\nShader source:\n${e}`);return n}deleteShader(e){this.gl.deleteShader(e)}bindTextureToUniform(e,t,r){let n=this.gl;n.activeTexture(n.TEXTURE0+t),this.checkError(),n.bindTexture(n.TEXTURE_2D,e),this.checkError(),n.uniform1i(r,t),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(ee.debug){let e=this.gl,t=e.getError(),r="";switch(t){case e.NO_ERROR:return;case e.INVALID_ENUM:r="INVALID_ENUM";break;case e.INVALID_VALUE:r="INVALID_VALUE";break;case e.INVALID_OPERATION:r="INVALID_OPERATION";break;case e.INVALID_FRAMEBUFFER_OPERATION:r="INVALID_FRAMEBUFFER_OPERATION";break;case e.OUT_OF_MEMORY:r="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:r="CONTEXT_LOST_WEBGL";break;default:r=`Unknown WebGL Error: ${t.toString(16)}`}throw new Error(r)}}deleteTexture(e){this.gl.deleteTexture(e)}deleteProgram(e){this.gl.deleteProgram(e)}getEncoder(e,t,r=0){if(2===this.version)return new oo(this.gl,t);switch(e){case"float":return 1===r||this.isRenderFloat32Supported?new hn(this.gl,t):new hn(this.gl,t,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new io(this.gl,t);default:throw new Error(`Invalid dataType: ${e}`)}}clearActiveTextures(){let e=this.gl;for(let t=0;t<this.maxTextureImageUnits;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let e=this.gl,t=e.createBuffer();if(!t)throw new Error("createBuffer() returned null");let r=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),this.checkError(),t}createFramebuffer(){let e=this.gl.createFramebuffer();if(!e)throw new Error("createFramebuffer returned null");return e}queryVitalParameters(){let e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),1===this.version&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){2===this.version?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let e=this.gl,t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);let r=2===this.version?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,r,1,1,0,e.RGBA,e.FLOAT,null);let n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);let i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(n),i}checkRenderFloat32(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let e,t,r,n,i,o=this.gl;try{e=o.createTexture(),t=o.createFramebuffer(),o.bindTexture(o.TEXTURE_2D,e);let a=2===this.version?o.RGBA32F:o.RGBA;return o.texImage2D(o.TEXTURE_2D,0,a,1,1,0,o.RGBA,o.FLOAT,null),o.bindFramebuffer(o.FRAMEBUFFER,t),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),o.enable(o.BLEND),r=o.createShader(o.VERTEX_SHADER),!!(r&&(o.shaderSource(r,"void main(){}"),o.compileShader(r),n=o.createShader(o.FRAGMENT_SHADER),n)&&(o.shaderSource(n,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),o.compileShader(n),i=o.createProgram(),i))&&(o.attachShader(i,r),o.attachShader(i,n),o.linkProgram(i),o.useProgram(i),o.drawArrays(o.POINTS,0,1),o.getError()===o.NO_ERROR)}finally{o.disable(o.BLEND),i&&o.deleteProgram(i),r&&o.deleteShader(r),n&&o.deleteShader(n),t&&(o.bindFramebuffer(o.FRAMEBUFFER,null),o.deleteFramebuffer(t)),e&&(o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(e))}}beginTimer(){if(2===this.version&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,t=this.disjointTimerQueryWebgl2Extension,r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{let e=this.gl,t=this.disjointTimerQueryWebgl2Extension;e.endQuery(t.TIME_ELAPSED_EXT)}}isTimerResultAvailable(e){let t=!1,r=!1;if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{let n=this.gl,i=this.disjointTimerQueryWebgl2Extension;t=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE),r=n.getParameter(i.GPU_DISJOINT_EXT)}return t&&!r}getTimerResult(e){let t=0;if(2!==this.version)throw new Error("WebGL1 profiling currently not supported");{let r=this.gl;t=r.getQueryParameter(e,r.QUERY_RESULT),r.deleteQuery(e)}return t/1e6}async waitForQueryAndGetTime(e){return await vi((()=>this.isTimerResultAvailable(e))),this.getTimerResult(e)}async createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r=e,n=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),t=null===n?()=>!0:()=>{let e=r.clientWaitSync(n,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},{query:n,isFencePassed:t}}async pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){let e=rg(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}async addItemToPoll(e,t){this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)&&await vi((()=>(this.pollItems(),0===this.itemsToPoll.length)))}}}));function Zi(e){let t;if(e&&"webgl2"!==e||!("webgl2"in Xr)?(!e||"webgl"===e)&&"webgl"in Xr&&(t=Xr.webgl):t=Xr.webgl2,!t)try{t=bp(og(),e)}catch{t=bp(ng(),e)}e=e||1===t.version?"webgl":"webgl2";let r=t.gl;return Xr[e]=t,r.isContextLost()?(delete Xr[e],Zi(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),t)}function bp(e,t){let r,n={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!t||"webgl2"===t)&&(r=e.getContext("webgl2",n),r))try{return new xn(r,2)}catch(e){pe.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${e}`)}if((!t||"webgl"===t)&&(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),r))try{return new xn(r,1)}catch(e){pe.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${e}`)}throw new Error("WebGL is not supported")}function ng(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");let e=document.createElement("canvas");return e.width=1,e.height=1,e}function og(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var Xr,gp=L((()=>{dt(),mp(),Xr={}})),Eo,yp=L((()=>{It(),dt(),hp(),gp(),Eo=class{get contextId(){return ee.webgl.contextId}set contextId(e){ee.webgl.contextId=e}get matmulMaxBatchSize(){return ee.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(e){ee.webgl.matmulMaxBatchSize=e}get textureCacheMode(){return ee.webgl.textureCacheMode}set textureCacheMode(e){ee.webgl.textureCacheMode=e}get pack(){return ee.webgl.pack}set pack(e){ee.webgl.pack=e}get async(){return ee.webgl.async}set async(e){ee.webgl.async=e}initialize(){try{return this.glContext=Zi(this.contextId),"number"!=typeof this.matmulMaxBatchSize&&(this.matmulMaxBatchSize=16),"string"!=typeof this.textureCacheMode&&(this.textureCacheMode="full"),"boolean"!=typeof this.pack&&(this.pack=!1),"boolean"!=typeof this.async&&(this.async=!1),pe.setWithEnv(ee),ee.webgl.context||Object.defineProperty(ee.webgl,"context",{value:this.glContext.gl}),pe.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(e){return pe.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${e}`),!1}}createSessionHandler(e){return new Ao(this,e)}dispose(){this.glContext.dispose()}}}));async function Qi(e){if(!e)return Qi(["webgl"]);{let t="string"==typeof e?[e]:e;for(let e of t){let t=Tp.get(e);if(t)return t;let r=await ag(e);if(r)return r}}throw new Error("no available backend to use")}async function ag(e){let t=ig;if(typeof t[e]<"u"&&sg(t[e])){let r=t[e],n=r.initialize();if("object"==typeof n&&"then"in n&&(n=await n),n)return Tp.set(e,r),r}}function sg(e){let t=e;return"initialize"in t&&"function"==typeof t.initialize&&"createSessionHandler"in t&&"function"==typeof t.createSessionHandler&&"dispose"in t&&"function"==typeof t.dispose}var Tp,ig,xp=L((()=>{yp(),Tp=new Map,ig={webgl:new Eo}})),ea,Po,wp=L((()=>{dt(),ea=class{constructor(e,t){this.op=e,this.node=t}},Po=class{constructor(e,t,r){this.graph=e,this.profiler=r,this.initialize(t)}initialize(e){this.profiler.event("session","ExecutionPlan.initialize",(()=>{let t=this.graph.getNodes();if(t.length!==e.length)throw new Error("The size of nodes and OPs do not match.");this._ops=e.map(((e,r)=>new ea(e,t[r]))),this.reset(),this._starter=[],this._ops.forEach(((e,t)=>{let r=!0;for(let t of e.node.inputs)if(!this._values[t]&&-1===this.graph.getInputIndices().indexOf(t)){r=!1;break}r&&this._starter.push(t)}))}))}reset(){this._values=this.graph.getValues().map((e=>e.tensor))}async execute(e,t){return this.profiler.event("session","ExecutionPlan.execute",(async()=>{this.reset();let r=e.createInferenceHandler(),n=this.graph.getInputIndices();if(t.length!==n.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${t.length} expected: ${n.length}`);t.forEach(((e,t)=>{let r=n[t];this._values[r]=e}));let i=this._starter.slice(0),o=this.graph.getValues(),a=this.graph.getNodes(),s=0;for(;s<i.length;){let e=i[s++],t=this._ops[e],n=t.node.inputs.map((e=>this._values[e]));if(-1!==n.indexOf(void 0))throw new Error(`unresolved input detected: op: ${t.node}`);let u=n;pe.verbose("ExecPlan",`Runing op:${t.node.name} (${u.map(((e,r)=>`'${t.node.inputs[r]}': ${e.type}[${e.dims.join(",")}]`)).join(", ")})`);let l=await this.profiler.event("node",t.node.name,(async()=>t.op.impl(r,u,t.op.context)));if(l.length!==t.node.outputs.length)throw new Error("the size of output does not match model definition.");l.forEach(((e,r)=>{let n=t.node.outputs[r];if(this._values[n])throw new Error(`output [${n}] already has value: op:${t.node.name}`);this._values[n]=e}));let h=new Set;l.forEach(((e,r)=>{let n=t.node.outputs[r];for(let e of o[n].to){let t=a[e],r=!0;for(let e of t.inputs)if(!this._values[e]){r=!1;break}r&&h.add(e)}})),i.push(...h)}let u=[];for(let e=0;e<this.graph.getOutputIndices().length;e++){let t=this.graph.getOutputIndices()[e],r=this._values[t];if(void 0===r)throw new Error(`required output [${t}] does not have value`);0===t?await r.getData():r.data,u.push(r)}return pe.verbose("ExecPlan","disposing of inferenceHandler"),r.dispose(),u}))}}})),oe,xt,wn,vp=L((()=>{un(),oe=Nr(Ur()),_r(),fe(),xt=H.experimental.fbs,wn=class e{constructor(t){if(this._attributes=new Map,null!=t){for(let r of t)r instanceof oe.onnx.AttributeProto?this._attributes.set(r.name,[e.getValue(r),e.getType(r)]):r instanceof xt.Attribute&&this._attributes.set(r.name(),[e.getValue(r),e.getType(r)]);if(this._attributes.size<t.length)throw new Error("duplicated attribute names")}}set(e,t,r){this._attributes.set(e,[r,t])}delete(e){this._attributes.delete(e)}getFloat(e,t){return this.get(e,"float",t)}getInt(e,t){return this.get(e,"int",t)}getString(e,t){return this.get(e,"string",t)}getTensor(e,t){return this.get(e,"tensor",t)}getFloats(e,t){return this.get(e,"floats",t)}getInts(e,t){return this.get(e,"ints",t)}getStrings(e,t){return this.get(e,"strings",t)}getTensors(e,t){return this.get(e,"tensors",t)}get(e,t,r){let n=this._attributes.get(e);if(void 0===n){if(void 0!==r)return r;throw new Error(`required attribute not found: ${e}`)}if(n[1]!==t)throw new Error(`type mismatch: expected ${t} but got ${n[1]}`);return n[0]}static getType(e){let t=e instanceof oe.onnx.AttributeProto?e.type:e.type();switch(t){case oe.onnx.AttributeProto.AttributeType.FLOAT:return"float";case oe.onnx.AttributeProto.AttributeType.INT:return"int";case oe.onnx.AttributeProto.AttributeType.STRING:return"string";case oe.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case oe.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case oe.onnx.AttributeProto.AttributeType.INTS:return"ints";case oe.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case oe.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${oe.onnx.AttributeProto.AttributeType[t]}`)}}static getValue(e){let t=e instanceof oe.onnx.AttributeProto?e.type:e.type();if(t===oe.onnx.AttributeProto.AttributeType.GRAPH||t===oe.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");let r=this.getValueNoCheck(e);if(t===oe.onnx.AttributeProto.AttributeType.INT&&ot.isLong(r))return ot.longToNumber(r);if(t===oe.onnx.AttributeProto.AttributeType.INTS){let e=r,t=new Array(e.length);for(let r=0;r<e.length;r++){let n=e[r];t[r]=ot.longToNumber(n)}return t}if(t===oe.onnx.AttributeProto.AttributeType.TENSOR)return e instanceof oe.onnx.AttributeProto?Ce.fromProto(r):Ce.fromOrtTensor(r);if(t===oe.onnx.AttributeProto.AttributeType.TENSORS){if(e instanceof oe.onnx.AttributeProto)return r.map((e=>Ce.fromProto(e)));if(e instanceof xt.Attribute)return r.map((e=>Ce.fromOrtTensor(e)))}return t===oe.onnx.AttributeProto.AttributeType.STRING&&e instanceof oe.onnx.AttributeProto?dn(r):t===oe.onnx.AttributeProto.AttributeType.STRINGS&&e instanceof oe.onnx.AttributeProto?r.map(dn):r}static getValueNoCheck(e){return e instanceof oe.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(e):this.getValueNoCheckFromOrtFormat(e)}static getValueNoCheckFromOnnxFormat(e){switch(e.type){case oe.onnx.AttributeProto.AttributeType.FLOAT:return e.f;case oe.onnx.AttributeProto.AttributeType.INT:return e.i;case oe.onnx.AttributeProto.AttributeType.STRING:return e.s;case oe.onnx.AttributeProto.AttributeType.TENSOR:return e.t;case oe.onnx.AttributeProto.AttributeType.GRAPH:return e.g;case oe.onnx.AttributeProto.AttributeType.FLOATS:return e.floats;case oe.onnx.AttributeProto.AttributeType.INTS:return e.ints;case oe.onnx.AttributeProto.AttributeType.STRINGS:return e.strings;case oe.onnx.AttributeProto.AttributeType.TENSORS:return e.tensors;case oe.onnx.AttributeProto.AttributeType.GRAPHS:return e.graphs;default:throw new Error(`unsupported attribute type: ${oe.onnx.AttributeProto.AttributeType[e.type]}`)}}static getValueNoCheckFromOrtFormat(e){switch(e.type()){case xt.AttributeType.FLOAT:return e.f();case xt.AttributeType.INT:return e.i();case xt.AttributeType.STRING:return e.s();case xt.AttributeType.TENSOR:return e.t();case xt.AttributeType.GRAPH:return e.g();case xt.AttributeType.FLOATS:return e.floatsArray();case xt.AttributeType.INTS:{let t=[];for(let r=0;r<e.intsLength();r++)t.push(e.ints(r));return t}case xt.AttributeType.STRINGS:{let t=[];for(let r=0;r<e.stringsLength();r++)t.push(e.strings(r));return t}case xt.AttributeType.TENSORS:{let t=[];for(let r=0;r<e.tensorsLength();r++)t.push(e.tensors(r));return t}default:throw new Error(`unsupported attribute type: ${xt.AttributeType[e.type()]}`)}}}})),ra,Do,na,Rt,Lo,ta,_p=L((()=>{vp(),un(),ra=Nr(Ur()),_r(),fe(),Do=H.experimental.fbs,na={from:(e,t)=>new ta(e,t)},Rt=class{constructor(e){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,e&&(this.type=Ve.tensorValueTypeFromProto(e.type.tensorType))}get from(){return this._from}get to(){return this._to}},Lo=class{constructor(e,t){e instanceof ra.onnx.NodeProto?(this.name=e.name,this.opType=e.opType,this.attributes=new wn(e.attribute)):e instanceof Do.Node&&(this.name=t??e.name(),this.opType=e.opType(),this.attributes=new wn(Ve.tensorAttributesFromORTFormat(e))),this.inputs=[],this.outputs=[],this.executeNode=!0}},ta=class{constructor(e,t){if(!e)throw new TypeError("graph is empty");this.buildGraph(e),this.transformGraph(t),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(e){if(e instanceof ra.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else{if(!(e instanceof Do.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(e)}}buildGraphFromOnnxFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let r=new Map;if(!e.input)throw new Error("missing information in graph: input");let n=[];for(let r of e.input){if(t.has(r.name))throw new Error(`duplicated input name: ${r.name}`);let e=this._allData.push(new Rt(r))-1;t.set(r.name,e),n.push(r.name)}if(!e.initializer)throw new Error("missing information in graph: initializer");for(let r of e.initializer){let e=t.get(r.name);if(void 0===e){let n=new Rt;n.type={shape:{dims:Ve.tensorDimsFromProto(r.dims)},tensorType:Ve.tensorDataTypeFromProto(r.dataType)},e=this._allData.push(n)-1,t.set(r.name,e)}this._allData[e]._from=-1,this._allData[e].tensor=Ce.fromProto(r)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(n[e]));if(!e.output)throw new Error("missing information in graph: output");for(let r of e.output){if(t.has(r.name))throw new Error(`duplicated output name: ${r.name}`);let e=this._allData.push(new Rt(r))-1;t.set(r.name,e),this._allOutputIndices.push(e),this._allOutputNames.push(r.name)}if(!e.node)throw new Error("missing information in graph: node");for(let t of e.node){if(!t.name)for(let e=0;;e++){let n=`unnamed_${t.opType}_${e}`;if(!r.has(n)){t.name=n;break}}if(r.has(t.name))throw new Error(`duplicated node name: ${t.name}`);let e=this._nodes.push(new Lo(t))-1;r.set(t.name,e)}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.node[r];if(!i.output)throw new Error(`missing output for node: ${i.name}`);for(let e of i.output){let o=t.get(e);if(typeof o>"u"&&(o=this._allData.push(new Rt)-1,t.set(e,o)),n.outputs.push(o),void 0!==this._allData[o]._from)throw new Error(`multiple nodes output to one data value: ${o}`);if(this._allData[o]._from=r,"Constant"===i.opType){if(!i.attribute||1!==i.attribute.length||!i.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!i.output||1!==i.output.length)throw new Error("missing output or incorrect number of outputs for this Constant operator");n.outputs.pop(),n.executeNode=!1,this._allData[o]._from=-1,this._allData[o].tensor=Ce.fromProto(i.attribute[0].t)}}}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.node[r];if(!i.input)throw new Error(`missing input for node: ${i.name}`);for(let e of i.input){let o=t.get(e);if(typeof o>"u"){if(""===e&&(3===i.input.length||4===i.input.length)&&"Resize"===i.opType)continue;throw new Error(`unrecognized input '${e}' for node: ${i.name}`)}n.inputs.push(o),this._allData[o]._to.push(r)}}return!0}buildGraphFromOrtFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let r=new Map,n=[];for(let r=0;r<e.inputsLength();r++){let i=e.inputs(r);if(t.has(i))throw new Error(`duplicated input name: ${i}`);for(let r=0;r<e.nodeArgsLength();r++)if(e.nodeArgs(r)?.name()===i){let o=new Rt;if(e.nodeArgs(r)?.type()?.valueType()!==Do.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");let a=e.nodeArgs(r).type().value(new Do.TensorTypeAndShape),s=Ve.tensorDataTypeFromProto(a.elemType()),u=a.shape(),l=[];for(let e=0;e<u.dimLength();e++)l.push(ot.longToNumber(u.dim(e).value().dimValue()));o.type={shape:{dims:l},tensorType:s};let h=this._allData.push(o)-1;t.set(i,h),n.push(i)}}for(let r=0;r<e.initializersLength();r++){let n=e.initializers(r),i=t.get(n.name());if(void 0===i){let e=new Rt,r=Ve.tensorDimsFromORTFormat(n),o=Ve.tensorDataTypeFromProto(n.dataType());e.type={shape:{dims:r},tensorType:o},i=this._allData.push(e)-1,t.set(n.name(),i)}this._allData[i]._from=-1,this._allData[i].tensor=Ce.fromOrtTensor(n)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(n[e]));for(let r=0;r<e.outputsLength();r++){let n=e.outputs(r);if(t.has(n))throw new Error(`duplicated output name: ${n}`);let i=this._allData.push(new Rt)-1;t.set(n,i),this._allOutputIndices.push(i),this._allOutputNames.push(n)}if(!e.nodes)throw new Error("missing information in graph: node");for(let t=0;t<e.nodesLength();t++){let n=e.nodes(t),i=n.name();if(!i)for(let e=0;i=`unnamed_${n.opType()}_${e}`,r.has(i);e++);if(r.has(i))throw new Error(`duplicated node name: ${i}`);let o=this._nodes.push(new Lo(n,i))-1;r.set(i,o)}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.nodes(r);if(null==i)throw new Error(`No node exists at index ${r}`);if(0===i?.outputsLength())throw new Error(`missing output for node: ${i.name}`);for(let e=0;e<i?.outputsLength();e++){let o=i?.outputs(e),a=t.get(o);if(typeof a>"u"&&(a=this._allData.push(new Rt)-1,t.set(o,a)),n.outputs.push(a),void 0!==this._allData[a]._from)throw new Error(`multiple nodes output to one data value: ${a}`);if(this._allData[a]._from=r,"Constant"===i.opType()){if(1!==i.attributesLength()||!i.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(1!==i.outputsLength())throw new Error("missing output or incorrect number of outputs for this Constant operator");n.outputs.pop(),n.executeNode=!1,this._allData[a]._from=-1,this._allData[a].tensor=Ce.fromOrtTensor(i.attributes(0).t())}}}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.nodes(r);if(0===i.inputsLength())throw new Error(`missing input for node: ${i.name}`);for(let e=0;e<i.inputsLength();e++){let o=i.inputs(e),a=t.get(o);if(typeof a>"u")throw new Error(`unrecognized input '${o}' for node: ${i.name()}`);n.inputs.push(a),this._allData[a]._to.push(r)}}}checkIsAcyclic(){let e=new Set;this._allInputIndices.forEach((t=>{this._allData[t]._to.forEach((t=>{e.add(t)}))}));let t=Array.from(e),r=new Array(this._nodes.length).fill("white");for(;t.length>0;){let e=t.pop();"gray"===r[e]?r[e]="black":(t.push(e),r[e]="gray",this._nodes[e].outputs.forEach((n=>{let i=this._allData[n];if(typeof i.tensor<"u")throw new Error("node outputs should not be initialized");if(i._from!==e)throw new Error("from property of the Value object doesn't match index of Node being processed");i._to.forEach((e=>{if("gray"===r[e])throw new Error("model graph is cyclic");"white"===r[e]&&t.push(e)}))})))}}transformGraph(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let e=0,t=new Array(this._nodes.length,0),r=0;for(let e=0;e<this._nodes.length;e++)t[e]=r,this._nodes[e].executeNode?(r!==e&&(this._nodes[r]=this._nodes[e]),r++):this._nodes[e].outputs.forEach((e=>{this._allData[e]._from=-2}));this._nodes.splice(r,this._nodes.length-r);for(let e=0;e<this._allData.length;e++){let r=this._allData[e];void 0!==r._from&&-1!==r._from&&-2!==r._from&&(r._from=t[r._from]);for(let e=0;e<r._to.length;e++){if(!(r._to[e]>=0))throw new Error("Trying to update a removed node");r._to[e]=t[r._to[e]]}}e=0;for(let t=0;t<this._allData.length;t++)if(-2!==this._allData[t].from||-1!==this._allOutputIndices.indexOf(t+e)){if(e>0){let r=-1;void 0!==this._allData[t].from&&-1!==this._allData[t].from?(r=this._nodes[this._allData[t].from].outputs.indexOf(t+e),-1!==r&&(this._nodes[this._allData[t].from].outputs[r]=t)):(r=this._allInputIndices.indexOf(t+e),-1!==r&&(this._allInputIndices[r]=t)),this._allData[t].to.forEach((n=>{r=this._nodes[n].inputs.indexOf(t+e),-1!==r&&(this._nodes[n].inputs[r]=t)})),0===this._allData[t].to.length&&(r=this._allOutputIndices.indexOf(t+e),-1!==r&&(this._allOutputIndices[r]=t))}}else e++,this._allData.splice(t,1),t--}deleteNode(e){let t=this._nodes[e];if(t.outputs.length>1)for(let e=1;e<t.outputs.length;e++)if(this._allData[t.outputs[e]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ");t.executeNode=!1;let r=t.inputs[0],n=t.outputs[0],i=this._allData[n].to;for(let r=0;r<t.inputs.length;r++){let n=this._allData[t.inputs[r]].to.indexOf(e);if(-1===n)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[t.inputs[r]].to.splice(n,1)}this._allData[n]._to=[];let o=this._allOutputIndices.indexOf(n);if(-1!==o&&(this._allOutputIndices[o]=r),i&&i.length>0)for(let e of i){let t=this._nodes[e].inputs.indexOf(n);if(-1===t)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[e].inputs[t]=r,this._allData[r].to.push(e)}}removeAllDropoutNodes(){let e=0;for(let t of this._nodes){if("Dropout"===t.opType){if(1!==t.inputs.length)throw new Error("Dropout nodes should only contain one input. ");if(1!==t.outputs.length&&2!==t.outputs.length)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(2===t.outputs.length&&0!==this._allData[t.outputs[1]]._to.length)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(e)}e++}}removeAllIdentityNodes(){let e=0;for(let t of this._nodes)"Identity"===t.opType&&this.deleteNode(e),e++}isActivation(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let e of this._nodes)if("Conv"===e.opType){let t=this._allData[e.outputs[0]]._to;if(1===t.length&&this.isActivation(this._nodes[t[0]])){let r=this._nodes[t[0]];if("Clip"===r.opType)if(1===r.inputs.length)try{e.attributes.set("activation_params","floats",[r.attributes.getFloat("min"),r.attributes.getFloat("max")])}catch{e.attributes.set("activation_params","floats",[wr,vr])}else{if(!(r.inputs.length>=3&&void 0!==this._allData[r.inputs[1]].tensor&&void 0!==this._allData[r.inputs[2]].tensor))continue;e.attributes.set("activation_params","floats",[this._allData[r.inputs[1]].tensor.floatData[0],this._allData[r.inputs[2]].tensor.floatData[0]])}e.attributes.set("activation","string",r.opType),this.deleteNode(t[0])}}}}})),Op,ug,Fo,Ip=L((()=>{Jn(),_p(),un(),Op=Nr(Ur()),fe(),ug=H.experimental.fbs,Fo=class{constructor(){}load(e,t,r){if(!r)try{return void this.loadFromOnnxFormat(e,t)}catch(e){if(void 0!==r)throw e}this.loadFromOrtFormat(e,t)}loadFromOnnxFormat(e,t){let r=Op.onnx.ModelProto.decode(e);if(ot.longToNumber(r.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=r.opsetImport.map((e=>({domain:e.domain,version:ot.longToNumber(e.version)}))),this._graph=na.from(r.graph,t)}loadFromOrtFormat(e,t){let r=new O.ByteBuffer(e),n=ug.InferenceSession.getRootAsInferenceSession(r).model();if(ot.longToNumber(n.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let e=0;e<n.opsetImportLength();e++){let t=n.opsetImport(e);this._opsets.push({domain:t?.domain(),version:ot.longToNumber(t.version())})}this._graph=na.from(n.graph(),t)}get graph(){return this._graph}get opsets(){return this._opsets}}})),Co,Sp=L((()=>{xp(),wp(),dt(),Ip(),Co=class{constructor(e={}){this._initialized=!1,this.backendHint=e.backendHint,this.profiler=Xn.create(e.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(e,t,r){await this.profiler.event("session","Session.loadModel",(async()=>{let n=await Qi(this.backendHint);if(this.sessionHandler=n.createSessionHandler(this.context),this._model=new Fo,"string"==typeof e){let t=e.endsWith(".ort");if(typeof process<"u"&&process.versions&&process.versions.node){let r=await(void 0)(e);this.initialize(r,t)}else{let r=await(await fetch(e)).arrayBuffer();this.initialize(new Uint8Array(r),t)}}else if(ArrayBuffer.isView(e))this.initialize(e);else{let n=new Uint8Array(e,t||0,r||e.byteLength);this.initialize(n)}}))}initialize(e,t){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",(()=>{let r=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(e,r,t),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new Po(this._model.graph,this._ops,this.profiler)})),this._initialized=!0}async run(e){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",(async()=>{let t=this.normalizeAndValidateInputs(e),r=await this._executionPlan.execute(this.sessionHandler,t);return this.createOutput(r)}))}normalizeAndValidateInputs(e){let t=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==t.length)throw new Error(`incorrect input array length: expected ${t.length} but got ${e.length}`)}else{if(e.size!==t.length)throw new Error(`incorrect input map size: expected ${t.length} but got ${e.size}`);let r=new Array(e.size),n=0;for(let i=0;i<t.length;++i){let o=e.get(t[i]);if(!o)throw new Error(`missing input tensor for: '${name}'`);r[n++]=o}e=r}if(this.context.graphInputTypes&&0!==this.context.graphInputTypes.length&&this.context.graphInputDims&&0!==this.context.graphInputDims.length)this.validateInputTensorDims(this.context.graphInputDims,e,!1);else{let t=this._model.graph.getInputIndices(),r=this._model.graph.getValues(),n=new Array(t.length);for(let i=0;i<t.length;++i){let o=r[t[i]];n[i]=o.type.shape.dims,this.context.graphInputTypes.push(o.type.tensorType),this.context.graphInputDims.push(e[i].dims)}this.validateInputTensorDims(n,e,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,e),e}validateInputTensorTypes(e,t){for(let r=0;r<t.length;r++){let n=e[r],i=t[r].type;if(n!==i)throw new Error(`input tensor[${r}] check failed: expected type '${n}' but got ${i}`)}}validateInputTensorDims(e,t,r){for(let n=0;n<t.length;n++){let i=e[n],o=t[n].dims;if(!this.compareTensorDims(i,o,r))throw new Error(`input tensor[${n}] check failed: expected shape '[${i.join(",")}]' but got [${o.join(",")}]`)}}compareTensorDims(e,t,r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n]&&(!r||0!==e[n]))return!1;return!0}createOutput(e){let t=this._model.graph.getOutputNames();if(e.length!==t.length)throw new Error("expected number of outputs do not match number of generated outputs");let r=new Map;for(let n=0;n<t.length;++n)r.set(t[n],e[n]);return r}initializeOps(e){let t=e.getNodes();this._ops=new Array(t.length);for(let r=0;r<t.length;r++)this._ops[r]=this.sessionHandler.resolve(t[r],this._model.opsets,e)}}})),$o,Ap=L((()=>{It(),_r(),$o=class{constructor(e){this.session=e,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(e,t,r){let n=new Map;for(let t in e)if(Object.hasOwnProperty.call(e,t)){let r=e[t];n.set(t,new Ce(r.dims,r.type,void 0,void 0,r.data))}let i=await this.session.run(n),o={};return i.forEach(((e,t)=>{o[t]=new Re(e.type,e.data,e.dims)})),o}async configure(e){return""}async auth(e){return""}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}})),Ep={};kr(Ep,{onnxjsBackend:()=>fg});var oa,fg,Pp=L((()=>{Sp(),Ap(),fg=new(oa=class{async init(){}async createInferenceSessionHandler(e,t){let r=new Co(t);return await r.loadModel(e),new $o(r)}})})),ia={};kr(ia,{createReadStream:()=>Dp,readFile:()=>cg,readFileSync:()=>pg});var cg,pg,Dp,aa=L((()=>{cg=void 0,pg=void 0,Dp=void 0})),sa={};kr(sa,{join:()=>dg});var dg,ua=L((()=>{dg=void 0})),Cp=ye(((e,t)=>{var r=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){var r,n,i=t;i.ready=new Promise(((e,t)=>{r=e,n=t}));var o,a,s,u=Object.assign({},i),l="./this.program",h="object"==typeof window,c="function"==typeof importScripts,d="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,f="";if(d){var p=(aa(),fr(ia)),y=(ua(),fr(sa));f=c?y.dirname(f)+"/":__dirname+"/",o=(e,t)=>(e=D(e)?new URL(e):y.normalize(e),p.readFileSync(e,t?void 0:"utf8")),s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),a=(e,t,r,n=!0)=>{e=D(e)?new URL(e):y.normalize(e),p.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!i.thisProgram&&1<process.argv.length&&(l=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),i.inspect=()=>"[Emscripten Module object]"}else(h||c)&&(c?f=self.location.href:typeof document<"u"&&document.currentScript&&(f=document.currentScript.src),e&&(f=e),f=0!==f.indexOf("blob:")?f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var g=console.log.bind(console),m=console.error.bind(console);Object.assign(i,u),u=null,"object"!=typeof WebAssembly&&$("no native wasm support detected");var w,b,v,x,_,I,A=!1;function S(){var e=w.buffer;i.HEAP8=b=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=v=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=x=new Int32Array(e),i.HEAPU32=_=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=I=new Float64Array(e)}var T=[],C=[],E=[],O=0,k=null,P=null;function $(e){throw m(e="Aborted("+e+")"),A=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var R,B=e=>e.startsWith("data:application/octet-stream;base64,"),D=e=>e.startsWith("file://");if(!B(R="ort-wasm.wasm")){var M=R;R=i.locateFile?i.locateFile(M,f):f+M}function L(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function F(e,t,r){return function(e){if(h||c){if("function"==typeof fetch&&!D(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>L(e)));if(a)return new Promise(((t,r)=>{a(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>L(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{m(`failed to asynchronously prepare wasm: ${e}`),$(e)}))}var N,U={882112:(e,t,r,n)=>{if(typeof i>"u"||!i.Ga)return 1;if((e=H(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ga.get(e)))return 2;if((t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return v.set(e.subarray(t,t+r),n>>>0>>>0),0}catch{return 4}}};function j(e){this.Da=e-24,this.Fa=function(e){_[this.Da+4>>>2>>>0]=e},this.Ea=function(e){_[this.Da+8>>>2>>>0]=e},this.La=function(e,t){this.Ma(),this.Fa(e),this.Ea(t)},this.Ma=function(){_[this.Da+16>>>2>>>0]=0}}var G,z=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,V=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&z)return z.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},H=(e,t)=>(e>>>=0)?V(v,e,t):"",W=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Y=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},K=e=>e%4==0&&(e%100!=0||e%400==0),X=[0,31,60,91,121,152,182,213,244,274,305,335],Z=[0,31,59,90,120,151,181,212,243,273,304,334],q=e=>{var t=W(e)+1,r=pe(t);return r&&Y(e,v,r,t),r},J=[],Q={},ee=()=>{if(!G){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(e in Q)void 0===Q[e]?delete t[e]:t[e]=Q[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);G=r}return G},te=[null,[],[]],re=e=>(re=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);if(d)try{var e=Ka("crypto");if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}$("initRandomDevice")})())(e),ne=[31,29,31,30,31,30,31,31,30,31,30,31],ie=[31,28,31,30,31,30,31,31,30,31,30,31];function oe(e,t,r,n){function i(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function o(e,t){return i(e,t,"0")}function a(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.ya;for(e=new Date(new Date(e.za+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(K(e.getFullYear())?ne:ie)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=a(t,e)?0>=a(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0;var l=_[(n>>>=0)+40>>>2>>>0];for(var h in n={Ja:x[n>>>2>>>0],Ia:x[n+4>>>2>>>0],Aa:x[n+8>>>2>>>0],Ca:x[n+12>>>2>>>0],Ba:x[n+16>>>2>>>0],za:x[n+20>>>2>>>0],xa:x[n+24>>>2>>>0],ya:x[n+28>>>2>>>0],Na:x[n+32>>>2>>>0],Ha:x[n+36>>>2>>>0],Ka:l?H(l):""},r=H(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(h,"g"),l[h]);var c="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d="January February March April May June July August September October November December".split(" ");for(h in l={"%a":e=>c[e.xa].substring(0,3),"%A":e=>c[e.xa],"%b":e=>d[e.Ba].substring(0,3),"%B":e=>d[e.Ba],"%C":e=>o((e.za+1900)/100|0,2),"%d":e=>o(e.Ca,2),"%e":e=>i(e.Ca,2," "),"%g":e=>u(e).toString().substring(2),"%G":e=>u(e),"%H":e=>o(e.Aa,2),"%I":e=>(0==(e=e.Aa)?e=12:12<e&&(e-=12),o(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.Ba-1;t+=(K(e.za+1900)?ne:ie)[r++]);return o(e.Ca+t,3)},"%m":e=>o(e.Ba+1,2),"%M":e=>o(e.Ia,2),"%n":()=>"\n","%p":e=>0<=e.Aa&&12>e.Aa?"AM":"PM","%S":e=>o(e.Ja,2),"%t":()=>"\t","%u":e=>e.xa||7,"%U":e=>o(Math.floor((e.ya+7-e.xa)/7),2),"%V":e=>{var t=Math.floor((e.ya+7-(e.xa+6)%7)/7);if(2>=(e.xa+371-e.ya-2)%7&&t++,t)53==t&&(4==(r=(e.xa+371-e.ya)%7)||3==r&&K(e.za)||(t=1));else{t=52;var r=(e.xa+7-e.ya-1)%7;(4==r||5==r&&K(e.za%400-1))&&t++}return o(t,2)},"%w":e=>e.xa,"%W":e=>o(Math.floor((e.ya+7-(e.xa+6)%7)/7),2),"%y":e=>(e.za+1900).toString().substring(2),"%Y":e=>e.za+1900,"%z":e=>(0<=(e=e.Ha)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.Ka,"%%":()=>"%"},r=r.replace(/%%/g,"\0\0"),l)r.includes(h)&&(r=r.replace(new RegExp(h,"g"),l[h](n)));return h=function(e){var t=Array(W(e)+1);return Y(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),h.length>t?0:(b.set(h,e>>>0),h.length-1)}var ae,se,ue=[],le=[],he=(e,t)=>{if(!se){se=new WeakMap;var r=ae.length;if(se)for(var n=0;n<0+r;n++){var i=n,o=ue[i];o||(i>=ue.length&&(ue.length=i+1),ue[i]=o=ae.get(i)),(i=o)&&se.set(i,n)}}if(r=se.get(e)||0)return r;if(le.length)r=le.pop();else{try{ae.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=ae.length-1}try{n=r,ae.set(n,e),ue[n]=ae.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,ae.set(n,t),ue[n]=ae.get(n)}return se.set(e,r),r},ce={a:function(e,t,r){throw new j(e>>>=0).La(t>>>0,r>>>0),e},e:function(){return 0},L:function(){},A:function(){},C:function(){},u:function(){return 0},J:function(){},E:function(){},I:function(){},k:function(){},B:function(){},y:function(){},K:function(){},z:function(){},l:()=>1,o:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),x[r>>>2>>>0]=e.getUTCSeconds(),x[r+4>>>2>>>0]=e.getUTCMinutes(),x[r+8>>>2>>>0]=e.getUTCHours(),x[r+12>>>2>>>0]=e.getUTCDate(),x[r+16>>>2>>>0]=e.getUTCMonth(),x[r+20>>>2>>>0]=e.getUTCFullYear()-1900,x[r+24>>>2>>>0]=e.getUTCDay(),x[r+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),x[r>>>2>>>0]=e.getSeconds(),x[r+4>>>2>>>0]=e.getMinutes(),x[r+8>>>2>>>0]=e.getHours(),x[r+12>>>2>>>0]=e.getDate(),x[r+16>>>2>>>0]=e.getMonth(),x[r+20>>>2>>>0]=e.getFullYear()-1900,x[r+24>>>2>>>0]=e.getDay(),x[r+28>>>2>>>0]=(K(e.getFullYear())?X:Z)[e.getMonth()]+e.getDate()-1|0,x[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();x[r+32>>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t))},q:function(e){e>>>=0;var t=new Date(x[e+20>>>2>>>0]+1900,x[e+16>>>2>>>0],x[e+12>>>2>>>0],x[e+8>>>2>>>0],x[e+4>>>2>>>0],x[e>>>2>>>0],0),r=x[e+32>>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>r?x[e+32>>>2>>>0]=+(i!=o&&a==n):0<r!=(a==n)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<r?a:i)-n))),x[e+24>>>2>>>0]=t.getDay(),x[e+28>>>2>>>0]=(K(t.getFullYear())?X:Z)[t.getMonth()]+t.getDate()-1|0,x[e>>>2>>>0]=t.getSeconds(),x[e+4>>>2>>>0]=t.getMinutes(),x[e+8>>>2>>>0]=t.getHours(),x[e+12>>>2>>>0]=t.getDate(),x[e+16>>>2>>>0]=t.getMonth(),x[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(x[fe()>>>2>>>0]=61,e=-1):e/=1e3,ge((N=e,1<=+Math.abs(N)?0<N?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)),e>>>0},m:function(){return-52},n:function(){},w:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}r>>>=0;var i=(new Date).getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();_[e>>>0>>>2>>>0]=60*Math.max(i,s),x[t>>>0>>>2>>>0]=+(i!=s),e=n(o),t=n(a),e=q(e),t=q(t),s<i?(_[r>>>2>>>0]=e,_[r+4>>>2>>>0]=t):(_[r>>>2>>>0]=t,_[r+4>>>2>>>0]=e)},d:()=>{$("")},D:function(e,t,r){e>>>=0,t>>>=0,r>>>=0,J.length=0;for(var n;n=v[t++>>>0];){var i=105!=n;r+=(i&=112!=n)&&r%8?4:0,J.push(112==n?_[r>>>2>>>0]:105==n?x[r>>>2>>>0]:I[r>>>3>>>0]),r+=i?8:4}return U[e].apply(null,J)},g:()=>Date.now(),x:function(){return 4294901760},b:()=>performance.now(),H:function(e,t,r){return t>>>=0,v.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0)},v:function(e){e>>>=0;var t=v.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var i=Math;n=Math.max(e,n);e:{i=(i.min.call(i,4294901760,n+(65536-n%65536)%65536)-w.buffer.byteLength+65535)/65536;try{w.grow(i),S();var o=1;break e}catch{}o=void 0}if(o)return!0}return!1},F:function(e,t){e>>>=0,t>>>=0;var r=0;return ee().forEach(((n,i)=>{var o=t+r;for(i=_[e+4*i>>>2>>>0]=o,o=0;o<n.length;++o)b[i++>>>0>>>0]=n.charCodeAt(o);b[i>>>0>>>0]=0,r+=n.length+1})),0},G:function(e,t){e>>>=0,t>>>=0;var r=ee();_[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),_[t>>>2>>>0]=n,0},f:()=>52,j:function(){return 52},r:function(){return 70},i:function(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var i=0,o=0;o<r;o++){var a=_[t>>>2>>>0],s=_[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var l=v[a+u>>>0],h=te[e];0===l||10===l?((1===e?g:m)(V(h,0)),h.length=0):h.push(l)}i+=s}return _[n>>>2>>>0]=i,0},s:function(e,t){return e>>>=0,re(v.subarray(e>>>0,e+(t>>>0)>>>0)),0},t:oe,c:function(e,t,r,n){return oe(e>>>0,t>>>0,r>>>0,n>>>0)},h:function(e,t,r,n){let i=ae.length;e=new Uint8Array(v.slice(e+t,e+r));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:w}});for(o in s.exports)he(s.exports[o]);return i<ae.length?i:n}catch(e){return console.log(e),n}}},de=function(){function e(e){return de=e.exports,de=function(){var e=de;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.pa=t(e.pa),e.qa=r(e.qa),e.ua=t(e.ua),e.wa=r(e.wa),e}(),w=de.M,S(),ae=de.sa,C.unshift(de.N),0==--O&&(null!==k&&(clearInterval(k),k=null),P&&(e=P,P=null,e())),de}var t={a:ce};if(O++,i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(e){m(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return function(e,t){var r=R;return"function"!=typeof WebAssembly.instantiateStreaming||B(r)||D(r)||d||"function"!=typeof fetch?F(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return m(`wasm streaming compile failed: ${n}`),m("falling back to ArrayBuffer instantiation"),F(r,e,t)}))))}(t,(function(t){e(t.instance)})).catch(n),{}}();i._OrtInit=(e,t)=>(i._OrtInit=de.O)(e,t),i._OrtGetLastError=(e,t)=>(i._OrtGetLastError=de.P)(e,t),i._OrtCreateSessionOptions=(e,t,r,n,o,a,s,u,l,h)=>(i._OrtCreateSessionOptions=de.Q)(e,t,r,n,o,a,s,u,l,h),i._OrtAppendExecutionProvider=(e,t)=>(i._OrtAppendExecutionProvider=de.R)(e,t),i._OrtAddFreeDimensionOverride=(e,t,r)=>(i._OrtAddFreeDimensionOverride=de.S)(e,t,r),i._OrtAddSessionConfigEntry=(e,t,r)=>(i._OrtAddSessionConfigEntry=de.T)(e,t,r),i._OrtReleaseSessionOptions=e=>(i._OrtReleaseSessionOptions=de.U)(e),i._OrtCreateSession=(e,t,r)=>(i._OrtCreateSession=de.V)(e,t,r),i._OrtReleaseSession=e=>(i._OrtReleaseSession=de.W)(e),i._OrtGetInputOutputCount=(e,t,r)=>(i._OrtGetInputOutputCount=de.X)(e,t,r),i._OrtGetInputName=(e,t)=>(i._OrtGetInputName=de.Y)(e,t),i._OrtGetOutputName=(e,t)=>(i._OrtGetOutputName=de.Z)(e,t),i._OrtFree=e=>(i._OrtFree=de._)(e),i._OrtCreateTensor=(e,t,r,n,o,a)=>(i._OrtCreateTensor=de.$)(e,t,r,n,o,a),i._OrtGetTensorData=(e,t,r,n,o)=>(i._OrtGetTensorData=de.aa)(e,t,r,n,o),i._OrtReleaseTensor=e=>(i._OrtReleaseTensor=de.ba)(e),i._OrtCreateRunOptions=(e,t,r,n)=>(i._OrtCreateRunOptions=de.ca)(e,t,r,n),i._OrtAddRunConfigEntry=(e,t,r)=>(i._OrtAddRunConfigEntry=de.da)(e,t,r),i._OrtReleaseRunOptions=e=>(i._OrtReleaseRunOptions=de.ea)(e),i._OrtCreateBinding=e=>(i._OrtCreateBinding=de.fa)(e),i._OrtBindInput=(e,t,r)=>(i._OrtBindInput=de.ga)(e,t,r),i._OrtBindOutput=(e,t,r,n)=>(i._OrtBindOutput=de.ha)(e,t,r,n),i._OrtClearBoundOutputs=e=>(i._OrtClearBoundOutputs=de.ia)(e),i._OrtReleaseBinding=e=>(i._OrtReleaseBinding=de.ja)(e),i._OrtRunWithBinding=(e,t,r,n,o)=>(i._OrtRunWithBinding=de.ka)(e,t,r,n,o),i._OrtRun=(e,t,r,n,o,a,s,u)=>(i._OrtRun=de.la)(e,t,r,n,o,a,s,u),i._OrtEndProfiling=e=>(i._OrtEndProfiling=de.ma)(e),i._OrtConfigure=(e,t)=>(i._OrtConfigure=de.na)(e,t),i._OrtAuth=(e,t)=>(i._OrtAuth=de.oa)(e,t);var fe=()=>(fe=de.pa)(),pe=i._malloc=e=>(pe=i._malloc=de.qa)(e);i._free=e=>(i._free=de.ra)(e);var ye,ge=e=>(ge=de.ta)(e),me=()=>(me=de.ua)(),we=e=>(we=de.va)(e),be=e=>(be=de.wa)(e);function ve(){if(!(0<O)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();T.unshift(e)}for(;0<T.length;)T.shift()(i);if(!(0<O||ye||(ye=!0,i.calledRun=!0,A))){for(;0<C.length;)C.shift()(i);for(r(i);0<E.length;)E.shift()(i)}}}return i.___start_em_js=882613,i.___stop_em_js=883225,i.stackAlloc=be,i.stackSave=me,i.stackRestore=we,i.addFunction=he,i.UTF8ToString=H,i.stringToUTF8=(e,t,r)=>Y(e,v,t,r),i.lengthBytesUTF8=W,P=function e(){ye||ve(),ye||(P=e)},ve(),t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=r:"function"==typeof define&&define.amd&&define([],(()=>r))})),$p=ye((()=>{})),Bp=ye((()=>{})),kp={};kr(kp,{cpus:()=>hg});var hg,Np=L((()=>{hg=void 0})),Gp=ye(((e,t)=>{var r=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){function r(){return E.buffer!=P.buffer&&L(),P}function n(){return E.buffer!=P.buffer&&L(),$}function i(){return E.buffer!=P.buffer&&L(),R}function o(){return E.buffer!=P.buffer&&L(),B}function a(){return E.buffer!=P.buffer&&L(),D}var s,u,l=t;l.ready=new Promise(((e,t)=>{s=e,u=t}));var h,c,d,f=Object.assign({},l),p="./this.program",y=(e,t)=>{throw t},g="object"==typeof window,m="function"==typeof importScripts,w="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,b=l.ENVIRONMENT_IS_PTHREAD||!1,v="";function x(e){return l.locateFile?l.locateFile(e,v):v+e}if(w){var _=(aa(),fr(ia)),I=(ua(),fr(sa));let e;v=m?I.dirname(v)+"/":__dirname+"/",h=(e,t)=>(e=X(e)?new URL(e):I.normalize(e),_.readFileSync(e,t?void 0:"utf8")),d=e=>((e=h(e,!0)).buffer||(e=new Uint8Array(e)),e),c=(e,t,r,n=!0)=>{e=X(e)?new URL(e):I.normalize(e),_.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!l.thisProgram&&1<process.argv.length&&(p=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),y=(e,t)=>{throw process.exitCode=e,t},l.inspect=()=>"[Emscripten Module object]";try{e=$p()}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}global.Worker=e.Worker}else(g||m)&&(m?v=self.location.href:typeof document<"u"&&document.currentScript&&(v=document.currentScript.src),typeof e<"u"&&e&&(v=e),v=0!==v.indexOf("blob:")?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"",w||(h=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},m&&(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),c=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}));w&&typeof performance>"u"&&(global.performance=Bp().performance);var A=console.log.bind(console),S=console.error.bind(console);w&&(A=(...e)=>_.writeSync(1,e.join(" ")+"\n"),S=(...e)=>_.writeSync(2,e.join(" ")+"\n"));var T=A,C=S;Object.assign(l,f),f=null,"object"!=typeof WebAssembly&&W("no native wasm support detected");var E,O,k,P,$,R,B,D,M=!1;function L(){var e=E.buffer;l.HEAP8=P=new Int8Array(e),l.HEAP16=new Int16Array(e),l.HEAPU8=$=new Uint8Array(e),l.HEAPU16=new Uint16Array(e),l.HEAP32=R=new Int32Array(e),l.HEAPU32=B=new Uint32Array(e),l.HEAPF32=new Float32Array(e),l.HEAPF64=D=new Float64Array(e)}var F=16777216;if(b)E=l.wasmMemory;else if(l.wasmMemory)E=l.wasmMemory;else if(!((E=new WebAssembly.Memory({initial:F/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw C("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),w&&C("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");L(),F=E.buffer.byteLength;var N=[],U=[],j=[],G=0,z=null,V=null;function H(){if(0==--G&&(null!==z&&(clearInterval(z),z=null),V)){var e=V;V=null,e()}}function W(e){throw C(e="Aborted("+e+")"),M=!0,k=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),u(e),e}var Y,K=e=>e.startsWith("data:application/octet-stream;base64,"),X=e=>e.startsWith("file://");function Z(e){if(d)return d(e);throw"both async and sync fetching of the wasm failed"}function q(e,t,r){return function(e){if(g||m){if("function"==typeof fetch&&!X(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>Z(e)));if(c)return new Promise(((t,r)=>{c(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>Z(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{C(`failed to asynchronously prepare wasm: ${e}`),W(e)}))}K(Y="ort-wasm-threaded.wasm")||(Y=x(Y));var J,Q={886500:(e,t,r,i)=>{if(typeof l>"u"||!l.hb)return 1;if((e=ae(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=l.hb.get(e)))return 2;if(i>>>=0,(t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return n().set(e.subarray(t,t+r),i>>>0),0}catch{return 4}}};function ee(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var te=e=>{e.terminate(),e.onmessage=()=>{}},re=e=>{0==fe.Ta.length&&(de(),fe.bb(fe.Ta[0]));var t=fe.Ta.pop();if(!t)return 6;fe.Ua.push(t),fe.Qa[e.Sa]=t,t.Sa=e.Sa;var r={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return w&&t.unref(),t.postMessage(r,e.ub),0},ne=0,ie=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,oe=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&ie)return ie.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},ae=(e,t)=>(e>>>=0)?oe(n(),e,t):"",se=e=>{var t=St();return e=e(),Tt(t),e};function ue(e,t){var r=arguments.length-2,n=arguments;return se((()=>{for(var i=Ct(8*r),o=i>>>3,s=0;s<r;s++){var u=n[2+s];a()[o+s>>>0]=u}return bt(e,r,i,t)}))}function le(e){if(b)return ue(0,1,e);k=e,0<ne||(fe.pb(),l.onExit?.(e),M=!0),y(e,new ee(e))}var he=e=>{if(k=e,b)throw ye(e),"unwind";le(e)};function ce(){for(var e=l.numThreads;e--;)de();N.unshift((()=>{G++,function(e){b?e():Promise.all(fe.Ta.map(fe.bb)).then(e)}((()=>H()))}))}function de(){var e=x("ort-wasm-threaded.worker.js");e=new Worker(e),fe.Ta.push(e)}var fe={Ta:[],Ua:[],gb:[],Qa:{},$a(){b?(fe.receiveObjectTransfer=fe.nb,fe.threadInitTLS=fe.fb,fe.setExitStatus=fe.eb):ce()},eb:e=>k=e,xb:["$terminateWorker"],pb:()=>{for(var e of fe.Ua)te(e);for(e of fe.Ta)te(e);fe.Ta=[],fe.Ua=[],fe.Qa=[]},cb:e=>{var t=e.Sa;delete fe.Qa[t],fe.Ta.push(e),fe.Ua.splice(fe.Ua.indexOf(e),1),e.Sa=0,vt(t)},nb(){},fb(){fe.gb.forEach((e=>e()))},bb:t=>new Promise((r=>{t.onmessage=e=>{var n=(e=e.data).cmd;if(e.targetThread&&e.targetThread!=yt()){var i=fe.Qa[e.targetThread];i?i.postMessage(e,e.transferList):C(`Internal error! Worker sent a message "${n}" to target pthread ${e.targetThread}, but that thread no longer exists!`)}else"checkMailbox"===n?Ne():"spawnThread"===n?re(e):"cleanupThread"===n?fe.cb(fe.Qa[e.thread]):"killThread"===n?(e=e.thread,n=fe.Qa[e],delete fe.Qa[e],te(n),vt(e),fe.Ua.splice(fe.Ua.indexOf(n),1),n.Sa=0):"cancelThread"===n?fe.Qa[e.thread].postMessage({cmd:"cancel"}):"loaded"===n?(t.loaded=!0,w&&!t.Sa&&t.unref(),r(t)):"alert"===n?alert(`Thread ${e.threadId}: ${e.text}`):"setimmediate"===e.target?t.postMessage(e):"callHandler"===n?l[e.handler](...e.args):n&&C(`worker sent an unknown command ${n}`)},t.onerror=e=>{throw C(`worker sent an error! ${e.filename}:${e.lineno}: ${e.message}`),e},w&&(t.on("message",(e=>t.onmessage({data:e}))),t.on("error",(e=>t.onerror(e))));var n,i=[];for(n of["onExit"])l.hasOwnProperty(n)&&i.push(n);t.postMessage({cmd:"load",handlers:i,urlOrBlob:l.mainScriptUrlOrBlob||e,wasmMemory:E,wasmModule:O})}))};l.PThread=fe;var pe=e=>{for(;0<e.length;)e.shift()(l)};function ye(e){if(b)return ue(1,0,e);he(e)}l.establishStackSpace=()=>{var e=yt(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],At(t,t-e),Tt(t)};var ge,me=[],we=e=>{var t=me[e];return t||(e>=me.length&&(me.length=e+1),me[e]=t=ge.get(e)),t};function be(e){this.Za=e-24,this.kb=function(e){o()[this.Za+4>>>2>>>0]=e},this.jb=function(e){o()[this.Za+8>>>2>>>0]=e},this.$a=function(e,t){this.ib(),this.kb(e),this.jb(t)},this.ib=function(){o()[this.Za+16>>>2>>>0]=0}}l.invokeEntryPoint=(e,t)=>{e=we(e)(t),0<ne?fe.eb(e):xt(e)};function ve(e,t,r,n){return b?ue(2,1,e,t,r,n):xe(e,t,r,n)}function xe(e,t,r,n){if(e>>>=0,t>>>=0,r>>>=0,n>>>=0,typeof SharedArrayBuffer>"u")return C("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return b&&0===i.length?ve(e,t,r,n):(e={ob:r,Sa:e,lb:n,ub:i},b?(e.wb="spawnThread",postMessage(e,i),0):re(e))}function _e(e,t,r){return b?ue(3,1,e,t,r):0}function Ie(e,t){if(b)return ue(4,1,e,t)}var Ae=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Se=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},Te=(e,t,r)=>Se(e,n(),t,r);function Ce(e,t){if(b)return ue(5,1,e,t)}function Ee(e,t,r){if(b)return ue(6,1,e,t,r)}function Oe(e,t,r){return b?ue(7,1,e,t,r):0}function ke(e,t){if(b)return ue(8,1,e,t)}function Pe(e,t,r){if(b)return ue(9,1,e,t,r)}function $e(e,t,r,n){if(b)return ue(10,1,e,t,r,n)}function Re(e,t,r,n){if(b)return ue(11,1,e,t,r,n)}function Be(e,t,r,n){if(b)return ue(12,1,e,t,r,n)}function De(e){if(b)return ue(13,1,e)}function Me(e,t){if(b)return ue(14,1,e,t)}function Le(e,t,r){if(b)return ue(15,1,e,t,r)}function Fe(e){e>>>=0,"function"==typeof Atomics.vb&&(Atomics.vb(i(),e>>>2,e).value.then(Ne),e+=128,Atomics.store(i(),e>>>2,1))}l.__emscripten_thread_mailbox_await=Fe;var Ne=()=>{var e=yt();if(e&&(Fe(e),e=_t,!M))try{if(e(),!(0<ne))try{b?xt(k):he(k)}catch(e){e instanceof ee||"unwind"==e||y(1,e)}}catch(e){e instanceof ee||"unwind"==e||y(1,e)}};l.checkMailbox=Ne;var Ue=[],je=e=>e%4==0&&(e%100!=0||e%400==0),Ge=[0,31,60,91,121,152,182,213,244,274,305,335],ze=[0,31,59,90,120,151,181,212,243,273,304,334];function Ve(e,t,r,n,i,o,a,s){return b?ue(16,1,e,t,r,n,i,o,a,s):-52}function He(e,t,r,n,i,o,a){if(b)return ue(17,1,e,t,r,n,i,o,a)}var We,Ye=e=>{var t=Ae(e)+1,r=gt(t);return r&&Te(e,r,t),r},Ke=[],Xe={},Ze=()=>{if(!We){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(e in Xe)void 0===Xe[e]?delete t[e]:t[e]=Xe[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);We=r}return We};function qe(e,t){if(b)return ue(18,1,e,t);e>>>=0,t>>>=0;var n=0;return Ze().forEach(((i,a)=>{var s=t+n;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)r()[a++>>>0>>>0]=i.charCodeAt(s);r()[a>>>0>>>0]=0,n+=i.length+1})),0}function Je(e,t){if(b)return ue(19,1,e,t);e>>>=0,t>>>=0;var r=Ze();o()[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),o()[t>>>2>>>0]=n,0}function Qe(e){return b?ue(20,1,e):52}function et(e,t,r,n){return b?ue(21,1,e,t,r,n):52}function tt(e,t,r,n,i){return b?ue(22,1,e,t,r,n,i):70}var rt=[null,[],[]];function nt(e,t,r,i){if(b)return ue(23,1,e,t,r,i);t>>>=0,r>>>=0,i>>>=0;for(var a=0,s=0;s<r;s++){var u=o()[t>>>2>>>0],l=o()[t+4>>>2>>>0];t+=8;for(var h=0;h<l;h++){var c=n()[u+h>>>0],d=rt[e];0===c||10===c?((1===e?T:C)(oe(d,0)),d.length=0):d.push(c)}a+=l}return o()[i>>>2>>>0]=a,0}var it=e=>(it=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>(e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e);if(w)try{var e=Ka("crypto");if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}W("initRandomDevice")})())(e),ot=[31,29,31,30,31,30,31,31,30,31,30,31],at=[31,28,31,30,31,30,31,31,30,31,30,31];function st(e,t,n,a){function s(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function u(e,t){return s(e,t,"0")}function l(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function h(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){var t=e.Va;for(e=new Date(new Date(e.Wa+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(je(e.getFullYear())?ot:at)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=h(new Date(e.getFullYear(),0,4)),r=h(r),0>=l(t,e)?0>=l(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0,a>>>=0;var d=o()[a+40>>>2>>>0];for(var f in a={sb:i()[a>>>2>>>0],rb:i()[a+4>>>2>>>0],Xa:i()[a+8>>>2>>>0],ab:i()[a+12>>>2>>>0],Ya:i()[a+16>>>2>>>0],Wa:i()[a+20>>>2>>>0],Ra:i()[a+24>>>2>>>0],Va:i()[a+28>>>2>>>0],yb:i()[a+32>>>2>>>0],qb:i()[a+36>>>2>>>0],tb:d?ae(d):""},n=ae(n),d={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(f,"g"),d[f]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(f in d={"%a":e=>p[e.Ra].substring(0,3),"%A":e=>p[e.Ra],"%b":e=>y[e.Ya].substring(0,3),"%B":e=>y[e.Ya],"%C":e=>u((e.Wa+1900)/100|0,2),"%d":e=>u(e.ab,2),"%e":e=>s(e.ab,2," "),"%g":e=>c(e).toString().substring(2),"%G":e=>c(e),"%H":e=>u(e.Xa,2),"%I":e=>(0==(e=e.Xa)?e=12:12<e&&(e-=12),u(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.Ya-1;t+=(je(e.Wa+1900)?ot:at)[r++]);return u(e.ab+t,3)},"%m":e=>u(e.Ya+1,2),"%M":e=>u(e.rb,2),"%n":()=>"\n","%p":e=>0<=e.Xa&&12>e.Xa?"AM":"PM","%S":e=>u(e.sb,2),"%t":()=>"\t","%u":e=>e.Ra||7,"%U":e=>u(Math.floor((e.Va+7-e.Ra)/7),2),"%V":e=>{var t=Math.floor((e.Va+7-(e.Ra+6)%7)/7);if(2>=(e.Ra+371-e.Va-2)%7&&t++,t)53==t&&(4==(r=(e.Ra+371-e.Va)%7)||3==r&&je(e.Wa)||(t=1));else{t=52;var r=(e.Ra+7-e.Va-1)%7;(4==r||5==r&&je(e.Wa%400-1))&&t++}return u(t,2)},"%w":e=>e.Ra,"%W":e=>u(Math.floor((e.Va+7-(e.Ra+6)%7)/7),2),"%y":e=>(e.Wa+1900).toString().substring(2),"%Y":e=>e.Wa+1900,"%z":e=>(0<=(e=e.qb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.tb,"%%":()=>"%"},n=n.replace(/%%/g,"\0\0"),d)n.includes(f)&&(n=n.replace(new RegExp(f,"g"),d[f](a)));return f=function(e){var t=Array(Ae(e)+1);return Se(e,t,0,t.length),t}(n=n.replace(/\0\0/g,"%")),f.length>t?0:(((e,t)=>{r().set(e,t>>>0)})(f,e),f.length-1)}var ut,lt=[],ht=(e,t)=>{if(!ut){ut=new WeakMap;var r=ge.length;if(ut)for(var n=0;n<0+r;n++){var i=we(n);i&&ut.set(i,n)}}if(r=ut.get(e)||0)return r;if(lt.length)r=lt.pop();else{try{ge.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=ge.length-1}try{n=r,ge.set(n,e),me[n]=ge.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]},a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,ge.set(n,t),me[n]=ge.get(n)}return ut.set(e,r),r};fe.$a();var ct=[le,ye,ve,_e,Ie,Ce,Ee,Oe,ke,Pe,$e,Re,Be,De,Me,Le,Ve,He,qe,Je,Qe,et,tt,nt],dt={b:function(e,t,r){throw new be(e>>>=0).$a(t>>>0,r>>>0),e},O:function(e){mt(e>>>0,!m,1,!g,131072,!1),fe.fb()},m:function(e){e>>>=0,b?postMessage({cmd:"cleanupThread",thread:e}):fe.cb(fe.Qa[e])},J:xe,h:_e,U:Ie,F:Ce,H:Ee,y:Oe,S:ke,L:Pe,R:$e,o:Re,G:Be,D:De,T:Me,E:Le,p:()=>1,B:function(e,t){(e>>>=0)==t>>>0?setTimeout((()=>Ne())):b?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=fe.Qa[e])&&e.postMessage({cmd:"checkMailbox"})},K:function(e,t,r,n){t>>>=0,Ue.length=r,n=n>>>0>>>3;for(var i=0;i<r;i++)Ue[i]=a()[n+i>>>0];return e=0>e?Q[-e-1]:ct[e],fe.mb=t,t=e.apply(null,Ue),fe.mb=0,t},M:Fe,W:function(e){w&&fe.Qa[e>>>0].ref()},s:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getUTCSeconds(),i()[r+4>>>2>>>0]=e.getUTCMinutes(),i()[r+8>>>2>>>0]=e.getUTCHours(),i()[r+12>>>2>>>0]=e.getUTCDate(),i()[r+16>>>2>>>0]=e.getUTCMonth(),i()[r+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[r+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[r+28>>>2>>>0]=e},t:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getSeconds(),i()[r+4>>>2>>>0]=e.getMinutes(),i()[r+8>>>2>>>0]=e.getHours(),i()[r+12>>>2>>>0]=e.getDate(),i()[r+16>>>2>>>0]=e.getMonth(),i()[r+20>>>2>>>0]=e.getFullYear()-1900,i()[r+24>>>2>>>0]=e.getDay(),t=(je(e.getFullYear())?Ge:ze)[e.getMonth()]+e.getDate()-1|0,i()[r+28>>>2>>>0]=t,i()[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t)),i()[r+32>>>2>>>0]=e},u:function(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),r=i()[e+32>>>2>>>0],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>r?i()[e+32>>>2>>>0]=+(o!=a&&s==n):0<r!=(s==n)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<r?s:o)-n))),i()[e+24>>>2>>>0]=t.getDay(),r=(je(t.getFullYear())?Ge:ze)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=r,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[pt()>>>2>>>0]=61,e=-1):e/=1e3,It((J=e,1<=+Math.abs(J)?0<J?+Math.floor(J/4294967296)>>>0:~~+Math.ceil((J-+(~~J>>>0))/4294967296)>>>0:0)),e>>>0},q:Ve,r:He,A:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}e>>>=0,t>>>=0,r>>>=0;var a=(new Date).getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var l=u.getTimezoneOffset(),h=Math.max(a,l);o()[e>>>2>>>0]=60*h,i()[t>>>2>>>0]=+(a!=l),e=n(s),t=n(u),e=Ye(e),t=Ye(t),l<a?(o()[r>>>2>>>0]=e,o()[r+4>>>2>>>0]=t):(o()[r>>>2>>>0]=t,o()[r+4>>>2>>>0]=e)},c:()=>{W("")},N:function(e,t,r){e>>>=0,t>>>=0,r>>>=0,Ke.length=0;for(var s;s=n()[t++>>>0];){var u=105!=s;r+=(u&=112!=s)&&r%8?4:0,Ke.push(112==s?o()[r>>>2>>>0]:105==s?i()[r>>>2>>>0]:a()[r>>>3>>>0]),r+=u?8:4}return Q[e].apply(null,Ke)},n:()=>{},i:()=>Date.now(),V:()=>{throw ne+=1,"unwind"},C:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>w?(Np(),fr(kp)).cpus().length:navigator.hardwareConcurrency,z:function(e){e>>>=0;var t=n().length;if(e<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var i=t*(1+.2/r);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-E.buffer.byteLength+65535)/65536;try{E.grow(o),L();var a=1;break e}catch{}a=void 0}if(a)return!0}return!1},P:qe,Q:Je,I:he,g:Qe,l:et,v:tt,k:nt,w:function(e,t){return e>>>=0,t>>>=0,it(n().subarray(e>>>0,e+t>>>0)),0},a:E||l.wasmMemory,x:st,d:function(e,t,r,n){return st(e>>>0,t>>>0,r>>>0,n>>>0)},j:function(e,t,r,i){let o=ge.length;e=new Uint8Array(n().slice(e+t,e+r));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:E}});for(a in u.exports)ht(u.exports[a]);return o<ge.length?o:i}catch(e){return console.log(e),i}}},ft=function(){function e(e,t){return ft=e.exports,ft=function(){var e=ft;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.za=t(e.za),e.Aa=t(e.Aa),e.Ba=r(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=r(e.Pa),e}(),fe.gb.push(ft.Da),ge=ft.Ea,U.unshift(ft.X),O=t,H(),ft}var t={a:dt};if(G++,l.instantiateWasm)try{return l.instantiateWasm(t,e)}catch(e){C(`Module.instantiateWasm callback failed with error: ${e}`),u(e)}return function(e,t){var r=Y;return"function"!=typeof WebAssembly.instantiateStreaming||K(r)||X(r)||w||"function"!=typeof fetch?q(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return C(`wasm streaming compile failed: ${n}`),C("falling back to ArrayBuffer instantiation"),q(r,e,t)}))))}(t,(function(t){e(t.instance,t.module)})).catch(u),{}}();l._OrtInit=(e,t)=>(l._OrtInit=ft.Y)(e,t),l._OrtGetLastError=(e,t)=>(l._OrtGetLastError=ft.Z)(e,t),l._OrtCreateSessionOptions=(e,t,r,n,i,o,a,s,u,h)=>(l._OrtCreateSessionOptions=ft._)(e,t,r,n,i,o,a,s,u,h),l._OrtAppendExecutionProvider=(e,t)=>(l._OrtAppendExecutionProvider=ft.$)(e,t),l._OrtAddFreeDimensionOverride=(e,t,r)=>(l._OrtAddFreeDimensionOverride=ft.aa)(e,t,r),l._OrtAddSessionConfigEntry=(e,t,r)=>(l._OrtAddSessionConfigEntry=ft.ba)(e,t,r),l._OrtReleaseSessionOptions=e=>(l._OrtReleaseSessionOptions=ft.ca)(e),l._OrtCreateSession=(e,t,r)=>(l._OrtCreateSession=ft.da)(e,t,r),l._OrtReleaseSession=e=>(l._OrtReleaseSession=ft.ea)(e),l._OrtGetInputOutputCount=(e,t,r)=>(l._OrtGetInputOutputCount=ft.fa)(e,t,r),l._OrtGetInputName=(e,t)=>(l._OrtGetInputName=ft.ga)(e,t),l._OrtGetOutputName=(e,t)=>(l._OrtGetOutputName=ft.ha)(e,t),l._OrtFree=e=>(l._OrtFree=ft.ia)(e),l._OrtCreateTensor=(e,t,r,n,i,o)=>(l._OrtCreateTensor=ft.ja)(e,t,r,n,i,o),l._OrtGetTensorData=(e,t,r,n,i)=>(l._OrtGetTensorData=ft.ka)(e,t,r,n,i),l._OrtReleaseTensor=e=>(l._OrtReleaseTensor=ft.la)(e),l._OrtCreateRunOptions=(e,t,r,n)=>(l._OrtCreateRunOptions=ft.ma)(e,t,r,n),l._OrtAddRunConfigEntry=(e,t,r)=>(l._OrtAddRunConfigEntry=ft.na)(e,t,r),l._OrtReleaseRunOptions=e=>(l._OrtReleaseRunOptions=ft.oa)(e),l._OrtCreateBinding=e=>(l._OrtCreateBinding=ft.pa)(e),l._OrtBindInput=(e,t,r)=>(l._OrtBindInput=ft.qa)(e,t,r),l._OrtBindOutput=(e,t,r,n)=>(l._OrtBindOutput=ft.ra)(e,t,r,n),l._OrtClearBoundOutputs=e=>(l._OrtClearBoundOutputs=ft.sa)(e),l._OrtReleaseBinding=e=>(l._OrtReleaseBinding=ft.ta)(e),l._OrtRunWithBinding=(e,t,r,n,i)=>(l._OrtRunWithBinding=ft.ua)(e,t,r,n,i),l._OrtRun=(e,t,r,n,i,o,a,s)=>(l._OrtRun=ft.va)(e,t,r,n,i,o,a,s),l._OrtEndProfiling=e=>(l._OrtEndProfiling=ft.wa)(e),l._OrtConfigure=(e,t)=>(l._OrtConfigure=ft.xa)(e,t),l._OrtAuth=(e,t)=>(l._OrtAuth=ft.ya)(e,t);var pt=()=>(pt=ft.za)(),yt=l._pthread_self=()=>(yt=l._pthread_self=ft.Aa)(),gt=l._malloc=e=>(gt=l._malloc=ft.Ba)(e);l._free=e=>(l._free=ft.Ca)(e),l.__emscripten_tls_init=()=>(l.__emscripten_tls_init=ft.Da)();var mt=l.__emscripten_thread_init=(e,t,r,n,i,o)=>(mt=l.__emscripten_thread_init=ft.Fa)(e,t,r,n,i,o);l.__emscripten_thread_crashed=()=>(l.__emscripten_thread_crashed=ft.Ga)();var wt,bt=(e,t,r,n)=>(bt=ft.Ha)(e,t,r,n),vt=e=>(vt=ft.Ia)(e),xt=l.__emscripten_thread_exit=e=>(xt=l.__emscripten_thread_exit=ft.Ja)(e),_t=()=>(_t=ft.Ka)(),It=e=>(It=ft.La)(e),At=(e,t)=>(At=ft.Ma)(e,t),St=()=>(St=ft.Na)(),Tt=e=>(Tt=ft.Oa)(e),Ct=e=>(Ct=ft.Pa)(e);function Et(){if(!(0<G))if(b)s(l),b||pe(U),startWorker(l);else{if(l.preRun)for("function"==typeof l.preRun&&(l.preRun=[l.preRun]);l.preRun.length;)N.unshift(l.preRun.shift());pe(N),0<G||wt||(wt=!0,l.calledRun=!0,M||(b||pe(U),s(l),b||pe(j)))}}return l.___start_em_js=887001,l.___stop_em_js=887613,l.wasmMemory=E,l.stackAlloc=Ct,l.stackSave=St,l.stackRestore=Tt,l.keepRuntimeAlive=()=>0<ne,l.addFunction=ht,l.UTF8ToString=ae,l.stringToUTF8=Te,l.lengthBytesUTF8=Ae,l.ExitStatus=ee,l.PThread=fe,V=function e(){wt||Et(),wt||(V=e)},Et(),t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=r:"function"==typeof define&&define.amd&&define([],(()=>r))})),Up=ye(((e,t)=>{t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n'})),Wp,bg,ca,pa,Bo,zp,gg,yg,Tg,Vp,Oe,Kr=L((()=>{Wp=Cp(),bg=Gp(),pa=!1,Bo=!1,zp=!1,gg=e=>{if(1===e)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},yg=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Tg=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Vp=async e=>{if(pa)return Promise.resolve();if(Bo)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(zp)throw new Error("previous call to 'initializeWebAssembly()' failed.");Bo=!0;let t=e.initTimeout,r=e.numThreads,n=e.simd,i=gg(r),o=n&&yg(),a=e.wasmPaths,s="string"==typeof a?a:void 0,u=Tg(o,i),l="object"==typeof a?a[u]:void 0,h=!1,c=[];if(t>0&&c.push(new Promise((e=>{setTimeout((()=>{h=!0,e()}),t)}))),c.push(new Promise(((e,t)=>{let n=i?bg:Wp,o={locateFile:(e,t)=>i&&e.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Up()],{type:"text/javascript"})):e.endsWith(".wasm")?l||(s??t)+u:t+e};if(i)if(o.numThreads=r,typeof Blob>"u")o.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let e=`var ortWasmThreaded=${n.toString()};`;o.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}n(o).then((t=>{Bo=!1,pa=!0,ca=t,e()}),(e=>{Bo=!1,zp=!0,t(e)}))}))),await Promise.race(c),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Oe=()=>{if(pa&&ca)return ca;throw new Error("WebAssembly is not initialized yet.")}})),Fe,vn,Se,ko=L((()=>{Kr(),Fe=(e,t)=>{let r=Oe(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i},vn=(e,t,r,n)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach((([e,i])=>{let o=t?t+e:e;if("object"==typeof i)vn(i,o+".",r,n);else if("string"==typeof i||"number"==typeof i)n(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can't handle extra config type: "+typeof i);n(o,i?"1":"0")}}))},Se=e=>{let t=Oe(),r=t.stackSave();try{let r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);let n=t.HEAP32[r/4],i=t.HEAPU32[r/4+1],o=i?t.UTF8ToString(i):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${o}`)}finally{t.stackRestore(r)}}})),Hp,jp=L((()=>{Kr(),ko(),Hp=e=>{let t=Oe(),r=0,n=[],i=e||{};try{if(void 0===e?.logSeverityLevel)i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===e?.logVerbosityLevel)i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===e?.terminate&&(i.terminate=!1);let o=0;return void 0!==e?.tag&&(o=Fe(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o),0===r&&Se("Can't create run options."),void 0!==e?.extra&&vn(e.extra,"",new WeakSet,((e,i)=>{let o=Fe(e,n),a=Fe(i,n);0!==t._OrtAddRunConfigEntry(r,o,a)&&Se(`Can't set a run config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach((e=>t._free(e))),e}}})),xg,wg,vg,_g,qp,Yp=L((()=>{Kr(),ko(),xg=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},wg=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},vg=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)},_g=(e,t,r)=>{for(let n of t){let t="string"==typeof n?n:n.name;switch(t){case"webnn":if(t="WEBNN","string"!=typeof n){let t=n;if(t?.deviceType){let n=Fe("deviceType",r),i=Fe(t.deviceType,r);0!==Oe()._OrtAddSessionConfigEntry(e,n,i)&&Se(`Can't set a session config entry: 'deviceType' - ${t.deviceType}.`)}if(t?.numThreads){let n=t.numThreads;("number"!=typeof n||!Number.isInteger(n)||n<0)&&(n=0);let i=Fe("numThreads",r),o=Fe(n.toString(),r);0!==Oe()._OrtAddSessionConfigEntry(e,i,o)&&Se(`Can't set a session config entry: 'numThreads' - ${t.numThreads}.`)}if(t?.powerPreference){let n=Fe("powerPreference",r),i=Fe(t.powerPreference,r);0!==Oe()._OrtAddSessionConfigEntry(e,n,i)&&Se(`Can't set a session config entry: 'powerPreference' - ${t.powerPreference}.`)}}break;case"webgpu":if(t="JS","string"!=typeof n){let t=n;if(t?.preferredLayout){if("NCHW"!==t.preferredLayout&&"NHWC"!==t.preferredLayout)throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${t.preferredLayout}`);let n=Fe("preferredLayout",r),i=Fe(t.preferredLayout,r);0!==Oe()._OrtAddSessionConfigEntry(e,n,i)&&Se(`Can't set a session config entry: 'preferredLayout' - ${t.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${t}`)}let i=Fe(t,r);0!==Oe()._OrtAppendExecutionProvider(e,i)&&Se(`Can't append execution provider: ${t}.`)}},qp=e=>{let t=Oe(),r=0,n=[],i=e||{};vg(i);try{let e=xg(i.graphOptimizationLevel??"all"),o=wg(i.executionMode??"sequential"),a="string"==typeof i.logId?Fe(i.logId,n):0,s=i.logSeverityLevel??2;if(!Number.isInteger(s)||s<0||s>4)throw new Error(`log serverity level is not valid: ${s}`);let u=i.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let l="string"==typeof i.optimizedModelFilePath?Fe(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(e,!!i.enableCpuMemArena,!!i.enableMemPattern,o,!!i.enableProfiling,0,a,s,u,l),0===r&&Se("Can't create session options."),i.executionProviders&&_g(r,i.executionProviders,n),i.freeDimensionOverrides)for(let[e,o]of Object.entries(i.freeDimensionOverrides)){if("string"!=typeof e)throw new Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof o||!Number.isInteger(o)||o<0)throw new Error(`free dimension override value must be a non-negative integer: ${o}`);let i=Fe(e,n);0!==t._OrtAddFreeDimensionOverride(r,i,o)&&Se(`Can't set a free dimension override: ${e} - ${o}.`)}return void 0!==i.extra&&vn(i.extra,"",new WeakSet,((e,i)=>{let o=Fe(e,n),a=Fe(i,n);0!==t._OrtAddSessionConfigEntry(r,o,a)&&Se(`Can't set a session config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseSessionOptions(r),n.forEach((e=>t._free(e))),e}}})),da,Xp,ha,Kp,Jp,No,Zp,ma=L((()=>{da=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},Xp=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},ha=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Kp=e=>{switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Jp=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},No=e=>"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e,Zp=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}})),_n,ba=L((()=>{_n=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);if(!(typeof process<"u"&&process.versions&&process.versions.node)){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let r,i=t.body.getReader();try{r=new ArrayBuffer(n)}catch(e){if(!(e instanceof RangeError))throw e;{let e=Math.ceil(n/65536);r=new WebAssembly.Memory({initial:e,maximum:e}).buffer}}let o=0;for(;;){let{done:e,value:t}=await i.read();if(e)break;let n=t.byteLength;new Uint8Array(r,o,n).set(t),o+=n}return new Uint8Array(r,0,n)}}try{return new Uint8Array(await(void 0)(e))}catch(t){if("ERR_FS_FILE_TOO_LARGE"===t.code){let t=(void 0)(e),r=[];for await(let e of t)r.push(e);return new Uint8Array(Buffer.concat(r))}throw t}}})),Og,ed,td,On,Ig,ga,rd,nd,Qp,od,id,ad,sd,ud,ld=L((()=>{jp(),Yp(),ma(),Kr(),ko(),ba(),Og=(e,t)=>{0!==Oe()._OrtInit(e,t)&&Se("Can't initialize onnxruntime.")},ed=async e=>{Og(e.wasm.numThreads,Jp(e.logLevel))},td=async(e,t)=>{},On=new Map,Ig=e=>{let t=Oe(),r=t.stackSave();try{let r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&Se("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(r)}},ga=e=>{let t=Oe(),r=t._malloc(e.byteLength);if(0===r)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},rd=async(e,t)=>{let r,n,i=Oe();Array.isArray(e)?[r,n]=e:e.buffer===i.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=ga(e);let o=0,a=0,s=[],u=[],l=[];try{if([a,s]=qp(t),t?.externalData&&i.mountExternalData){let e=[];for(let r of t.externalData){let t="string"==typeof r?r:r.path;e.push(_n("string"==typeof r?r:r.data).then((e=>{i.mountExternalData(t,e)})))}await Promise.all(e)}o=i._OrtCreateSession(r,n,a),0===o&&Se("Can't create a session.");let[e,h]=Ig(o),c=[],d=[];for(let t=0;t<e;t++){let e=i._OrtGetInputName(o,t);0===e&&Se("Can't get an input name."),u.push(e),c.push(i.UTF8ToString(e))}for(let e=0;e<h;e++){let t=i._OrtGetOutputName(o,e);0===t&&Se("Can't get an output name."),l.push(t);let r=i.UTF8ToString(t);d.push(r)}let f=null;return On.set(o,[o,u,l,f]),[o,c,d]}catch(e){throw u.forEach((e=>i._OrtFree(e))),l.forEach((e=>i._OrtFree(e))),0!==o&&i._OrtReleaseSession(o),e}finally{i._free(r),0!==a&&i._OrtReleaseSessionOptions(a),s.forEach((e=>i._free(e))),i.unmountExternalData?.()}},nd=e=>{let t=Oe(),r=On.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,i,o,a]=r;a&&t._OrtReleaseBinding(a.handle),t.jsepUnregisterBuffers?.(e),i.forEach((e=>t._OrtFree(e))),o.forEach((e=>t._OrtFree(e))),t._OrtReleaseSession(n),On.delete(e)},Qp=(e,t,r,n,i)=>{if(!e)return void t.push(0);let o,a,s=Oe(),u=e[0],l=e[1],h=e[3];if("string"===u&&"gpu-buffer"===h)throw new Error("String tensor is not supported on GPU.");if("gpu-buffer"===h){let t=e[2].gpuBuffer,r=ha(da(u));a=l.reduce(((e,t)=>e*t),1)*r,o=s.jsepRegisterBuffer(n,i,t,a)}else{let t=e[2];if(Array.isArray(t)){a=4*t.length,o=s._malloc(a),r.push(o);let e=o/4;for(let n=0;n<t.length;n++){if("string"!=typeof t[n])throw new TypeError(`tensor data at index ${n} is not a string`);s.HEAPU32[e++]=Fe(t[n],r)}}else a=t.byteLength,o=s._malloc(a),r.push(o),s.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,a),o)}let c=s.stackSave(),d=s.stackAlloc(4*l.length);try{let e=d/4;l.forEach((t=>s.HEAP32[e++]=t));let r=s._OrtCreateTensor(da(u),o,a,d,l.length,Zp(h));0===r&&Se(`Can't create tensor for input/output. session=${n}, index=${i}.`),t.push(r)}finally{s.stackRestore(c)}},od=e=>{let t=(new TextEncoder).encode(e),r=Oe(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtConfigure(n,t.byteLength);if(0===i)throw new Error("Can't get an configure key");let o=r.UTF8ToString(i);return r._OrtFree(i),o},id=e=>{let t=(new TextEncoder).encode(e),r=Oe(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtAuth(n,t.byteLength);if(0===i)throw new Error("Can't get an auth result");let o=r.UTF8ToString(i);return r._OrtFree(i),o},ad=async(e,t,r,n,i,o)=>{let a=Oe(),s=On.get(e);if(!s)throw new Error(`cannot run inference. invalid session id: ${e}`);let[u,l,h,c]=s,d=t.length,f=n.length,p=0,y=[],g=[],m=[],w=[],b=a.stackSave(),v=a.stackAlloc(4*d),x=a.stackAlloc(4*d),_=a.stackAlloc(4*f),I=a.stackAlloc(4*f);try{[p,y]=Hp(o);for(let n=0;n<d;n++)Qp(r[n],g,w,e,t[n]);for(let t=0;t<f;t++)Qp(i[t],m,w,e,d+n[t]);let s,b=v/4,A=x/4,S=_/4,T=I/4;for(let e=0;e<d;e++)a.HEAPU32[b++]=g[e],a.HEAPU32[A++]=l[t[e]];for(let e=0;e<f;e++)a.HEAPU32[S++]=m[e],a.HEAPU32[T++]=h[n[e]];s=await a._OrtRun(u,x,v,d,I,f,_,p),0!==s&&Se("failed to call OrtRun().");let C=[];for(let e=0;e<f;e++){let t=a.HEAPU32[_/4+e];if(t===m[e]){C.push(i[e]);continue}let r,o=a.stackSave(),s=a.stackAlloc(16),u=!1,l=0;try{0!==a._OrtGetTensorData(t,s,s+4,s+8,s+12)&&Se(`Can't access output tensor data on index ${e}.`);let i=s/4,o=a.HEAPU32[i++];l=a.HEAPU32[i++];let h=a.HEAPU32[i++],d=a.HEAPU32[i++],f=[];for(let e=0;e<d;e++)f.push(a.HEAPU32[h/4+e]);a._OrtFree(h);let p=f.reduce(((e,t)=>e*t),1);r=Xp(o);let y=c?.outputPreferredLocations[n[e]];if("string"===r){if("gpu-buffer"===y)throw new Error("String tensor is not supported on GPU.");let e=[],t=l/4;for(let r=0;r<p;r++){let n=a.HEAPU32[t++],i=r===p-1?void 0:a.HEAPU32[t]-n;e.push(a.UTF8ToString(n,i))}C.push([r,f,e,"cpu"])}else if("gpu-buffer"===y&&p>0){let e=a.jsepGetBuffer(l),n=ha(o);if(void 0===n||!No(r))throw new Error(`Unsupported data type: ${r}`);u=!0,C.push([r,f,{gpuBuffer:e,download:a.jsepCreateDownloader(e,p*n,r),dispose:()=>{a._OrtReleaseTensor(t)}},"gpu-buffer"])}else{let e=new(Kp(r))(p);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(a.HEAPU8.subarray(l,l+e.byteLength)),C.push([r,f,e,"cpu"])}}finally{a.stackRestore(o),"string"===r&&l&&a._free(l),u||a._OrtReleaseTensor(t)}}return c&&a._OrtClearBoundOutputs(c.handle),C}finally{a.stackRestore(b),g.forEach((e=>a._OrtReleaseTensor(e))),m.forEach((e=>a._OrtReleaseTensor(e))),w.forEach((e=>a._free(e))),0!==p&&a._OrtReleaseRunOptions(p),y.forEach((e=>a._free(e)))}},sd=e=>{let t=Oe(),r=On.get(e);if(!r)throw new Error("invalid session id");let n=r[0],i=t._OrtEndProfiling(n);0===i&&Se("Can't get an profile file name."),t._OrtFree(i)},ud=e=>{let t=[];for(let r of e){let e=r[2];!Array.isArray(e)&&"buffer"in e&&t.push(e.buffer)}return t}})),fd=ye(((e,t)=>{t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var xt=Object.defineProperty;var an=Object.getOwnPropertyDescriptor;var on=Object.getOwnPropertyNames;var sn=Object.prototype.hasOwnProperty;var yr=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(d,o)=>(typeof require<"u"?require:d)[o]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw Error(\'Dynamic require of "\'+i+\'" is not supported\')});var Ct=(i,d)=>()=>(i&&(d=i(i=0)),d);var st=(i,d)=>()=>(d||i((d={exports:{}}).exports,d),d.exports),Dt=(i,d)=>{for(var o in d)xt(i,o,{get:d[o],enumerable:!0})},un=(i,d,o,g)=>{if(d&&typeof d=="object"||typeof d=="function")for(let l of on(d))!sn.call(i,l)&&l!==o&&xt(i,l,{get:()=>d[l],enumerable:!(g=an(d,l))||g.enumerable});return i};var it=i=>un(xt({},"__esModule",{value:!0}),i);var Ft={};Dt(Ft,{createReadStream:()=>wr,readFile:()=>fn,readFileSync:()=>ln});var fn,ln,wr,Ut=Ct(()=>{fn=void 0,ln=void 0,wr=void 0});var Rt={};Dt(Rt,{join:()=>cn});var cn,Lt=Ct(()=>{cn=void 0});var vr=st((Or,Pt)=>{"use strict";var br=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){var o=d,g,l;o.ready=new Promise((r,a)=>{g=r,l=a});var b=Object.assign({},o),y="./this.program",f=typeof window=="object",M=typeof importScripts=="function",D=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",P="",W,U,R;if(D){var N=(Ut(),it(Ft)),I=(Lt(),it(Rt));P=M?I.dirname(P)+"/":__dirname+"/",W=(r,a)=>(r=be(r)?new URL(r):I.normalize(r),N.readFileSync(r,a?void 0:"utf8")),R=r=>(r=W(r,!0),r.buffer||(r=new Uint8Array(r)),r),U=(r,a,s,c=!0)=>{r=be(r)?new URL(r):I.normalize(r),N.readFile(r,c?void 0:"utf8",(O,_)=>{O?s(O):a(c?_.buffer:_)})},!o.thisProgram&&1<process.argv.length&&(y=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),o.inspect=()=>"[Emscripten Module object]"}else(f||M)&&(M?P=self.location.href:typeof document<"u"&&document.currentScript&&(P=document.currentScript.src),i&&(P=i),P.indexOf("blob:")!==0?P=P.substr(0,P.replace(/[?#].*/,"").lastIndexOf("/")+1):P="",W=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.send(null),a.responseText},M&&(R=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),U=(r,a,s)=>{var c=new XMLHttpRequest;c.open("GET",r,!0),c.responseType="arraybuffer",c.onload=()=>{c.status==200||c.status==0&&c.response?a(c.response):s()},c.onerror=s,c.send(null)});var E=console.log.bind(console),F=console.error.bind(console);Object.assign(o,b),b=null,typeof WebAssembly!="object"&&le("no native wasm support detected");var k,we=!1,ue,ee,S,G,fe;function We(){var r=k.buffer;o.HEAP8=ue=new Int8Array(r),o.HEAP16=new Int16Array(r),o.HEAPU8=ee=new Uint8Array(r),o.HEAPU16=new Uint16Array(r),o.HEAP32=S=new Int32Array(r),o.HEAPU32=G=new Uint32Array(r),o.HEAPF32=new Float32Array(r),o.HEAPF64=fe=new Float64Array(r)}var He=[],te=[],V=[],de=0,L=null,re=null;function le(r){throw r="Aborted("+r+")",F(r),we=!0,r=new WebAssembly.RuntimeError(r+". Build with -sASSERTIONS for more info."),l(r),r}var he=r=>r.startsWith("data:application/octet-stream;base64,"),be=r=>r.startsWith("file://"),Q;if(Q="ort-wasm.wasm",!he(Q)){var ce=Q;Q=o.locateFile?o.locateFile(ce,P):P+ce}function Ee(r){if(R)return R(r);throw"both async and sync fetching of the wasm failed"}function Ce(r){if(f||M){if(typeof fetch=="function"&&!be(r))return fetch(r,{credentials:"same-origin"}).then(a=>{if(!a.ok)throw"failed to load wasm binary file at \'"+r+"\'";return a.arrayBuffer()}).catch(()=>Ee(r));if(U)return new Promise((a,s)=>{U(r,c=>a(new Uint8Array(c)),s)})}return Promise.resolve().then(()=>Ee(r))}function De(r,a,s){return Ce(r).then(c=>WebAssembly.instantiate(c,a)).then(c=>c).then(s,c=>{F(`failed to asynchronously prepare wasm: ${c}`),le(c)})}function Pe(r,a){var s=Q;return typeof WebAssembly.instantiateStreaming!="function"||he(s)||be(s)||D||typeof fetch!="function"?De(s,r,a):fetch(s,{credentials:"same-origin"}).then(c=>WebAssembly.instantiateStreaming(c,r).then(a,function(O){return F(`wasm streaming compile failed: ${O}`),F("falling back to ArrayBuffer instantiation"),De(s,r,a)}))}var Me,pe={882112:(r,a,s,c)=>{if(typeof o>"u"||!o.Ga)return 1;if(r=Oe(r>>>0),r.startsWith("./")&&(r=r.substring(2)),r=o.Ga.get(r),!r)return 2;if(a>>>=0,s>>>=0,a+s>r.byteLength)return 3;try{return ee.set(r.subarray(a,a+s),c>>>0>>>0),0}catch{return 4}}};function Se(r){this.Da=r-24,this.Fa=function(a){G[this.Da+4>>>2>>>0]=a},this.Ea=function(a){G[this.Da+8>>>2>>>0]=a},this.La=function(a,s){this.Ma(),this.Fa(a),this.Ea(s)},this.Ma=function(){G[this.Da+16>>>2>>>0]=0}}var Ae=0,ne=0,Z=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Fe=(r,a,s)=>{a>>>=0;var c=a+s;for(s=a;r[s]&&!(s>=c);)++s;if(16<s-a&&r.buffer&&Z)return Z.decode(r.subarray(a,s));for(c="";a<s;){var O=r[a++];if(O&128){var _=r[a++]&63;if((O&224)==192)c+=String.fromCharCode((O&31)<<6|_);else{var A=r[a++]&63;O=(O&240)==224?(O&15)<<12|_<<6|A:(O&7)<<18|_<<12|A<<6|r[a++]&63,65536>O?c+=String.fromCharCode(O):(O-=65536,c+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else c+=String.fromCharCode(O)}return c},Oe=(r,a)=>(r>>>=0)?Fe(ee,r,a):"",Te=r=>{for(var a=0,s=0;s<r.length;++s){var c=r.charCodeAt(s);127>=c?a++:2047>=c?a+=2:55296<=c&&57343>=c?(a+=4,++s):a+=3}return a},ze=(r,a,s,c)=>{if(s>>>=0,!(0<c))return 0;var O=s;c=s+c-1;for(var _=0;_<r.length;++_){var A=r.charCodeAt(_);if(55296<=A&&57343>=A){var $=r.charCodeAt(++_);A=65536+((A&1023)<<10)|$&1023}if(127>=A){if(s>=c)break;a[s++>>>0]=A}else{if(2047>=A){if(s+1>=c)break;a[s++>>>0]=192|A>>6}else{if(65535>=A){if(s+2>=c)break;a[s++>>>0]=224|A>>12}else{if(s+3>=c)break;a[s++>>>0]=240|A>>18,a[s++>>>0]=128|A>>12&63}a[s++>>>0]=128|A>>6&63}a[s++>>>0]=128|A&63}}return a[s>>>0]=0,s-O},Ie=r=>r%4===0&&(r%100!==0||r%400===0),Ze=[0,31,60,91,121,152,182,213,244,274,305,335],lt=[0,31,59,90,120,151,181,212,243,273,304,334],Ue=r=>{var a=Te(r)+1,s=me(a);return s&&ze(r,ee,s,a),s},Ye=[],Be={},Ge=()=>{if(!Ve){var r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"},a;for(a in Be)Be[a]===void 0?delete r[a]:r[a]=Be[a];var s=[];for(a in r)s.push(`${a}=${r[a]}`);Ve=s}return Ve},Ve,Ne=[null,[],[]],ct=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return s=>crypto.getRandomValues(s);if(D)try{var r=yr("crypto");if(r.randomFillSync)return s=>r.randomFillSync(s);var a=r.randomBytes;return s=>(s.set(a(s.byteLength)),s)}catch{}le("initRandomDevice")},Ke=r=>(Ke=ct())(r),ke=[31,29,31,30,31,30,31,31,30,31,30,31],dt=[31,28,31,30,31,30,31,31,30,31,30,31];function z(r){var a=Array(Te(r)+1);return ze(r,a,0,a.length),a}function et(r,a,s,c){function O(p,H,Y){for(p=typeof p=="number"?p.toString():p||"";p.length<H;)p=Y[0]+p;return p}function _(p,H){return O(p,H,"0")}function A(p,H){function Y(Je){return 0>Je?-1:0<Je?1:0}var ve;return(ve=Y(p.getFullYear()-H.getFullYear()))===0&&(ve=Y(p.getMonth()-H.getMonth()))===0&&(ve=Y(p.getDate()-H.getDate())),ve}function $(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function oe(p){var H=p.ya;for(p=new Date(new Date(p.za+1900,0,1).getTime());0<H;){var Y=p.getMonth(),ve=(Ie(p.getFullYear())?ke:dt)[Y];if(H>ve-p.getDate())H-=ve-p.getDate()+1,p.setDate(1),11>Y?p.setMonth(Y+1):(p.setMonth(0),p.setFullYear(p.getFullYear()+1));else{p.setDate(p.getDate()+H);break}}return Y=new Date(p.getFullYear()+1,0,4),H=$(new Date(p.getFullYear(),0,4)),Y=$(Y),0>=A(H,p)?0>=A(Y,p)?p.getFullYear()+1:p.getFullYear():p.getFullYear()-1}r>>>=0,a>>>=0,s>>>=0,c>>>=0;var se=G[c+40>>>2>>>0];c={Ja:S[c>>>2>>>0],Ia:S[c+4>>>2>>>0],Aa:S[c+8>>>2>>>0],Ca:S[c+12>>>2>>>0],Ba:S[c+16>>>2>>>0],za:S[c+20>>>2>>>0],xa:S[c+24>>>2>>>0],ya:S[c+28>>>2>>>0],Na:S[c+32>>>2>>>0],Ha:S[c+36>>>2>>>0],Ka:se?Oe(se):""},s=Oe(s),se={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ie in se)s=s.replace(new RegExp(ie,"g"),se[ie]);var at="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ot="January February March April May June July August September October November December".split(" ");se={"%a":p=>at[p.xa].substring(0,3),"%A":p=>at[p.xa],"%b":p=>ot[p.Ba].substring(0,3),"%B":p=>ot[p.Ba],"%C":p=>_((p.za+1900)/100|0,2),"%d":p=>_(p.Ca,2),"%e":p=>O(p.Ca,2," "),"%g":p=>oe(p).toString().substring(2),"%G":p=>oe(p),"%H":p=>_(p.Aa,2),"%I":p=>(p=p.Aa,p==0?p=12:12<p&&(p-=12),_(p,2)),"%j":p=>{for(var H=0,Y=0;Y<=p.Ba-1;H+=(Ie(p.za+1900)?ke:dt)[Y++]);return _(p.Ca+H,3)},"%m":p=>_(p.Ba+1,2),"%M":p=>_(p.Ia,2),"%n":()=>`\n`,"%p":p=>0<=p.Aa&&12>p.Aa?"AM":"PM","%S":p=>_(p.Ja,2),"%t":()=>"\t","%u":p=>p.xa||7,"%U":p=>_(Math.floor((p.ya+7-p.xa)/7),2),"%V":p=>{var H=Math.floor((p.ya+7-(p.xa+6)%7)/7);if(2>=(p.xa+371-p.ya-2)%7&&H++,H)H==53&&(Y=(p.xa+371-p.ya)%7,Y==4||Y==3&&Ie(p.za)||(H=1));else{H=52;var Y=(p.xa+7-p.ya-1)%7;(Y==4||Y==5&&Ie(p.za%400-1))&&H++}return _(H,2)},"%w":p=>p.xa,"%W":p=>_(Math.floor((p.ya+7-(p.xa+6)%7)/7),2),"%y":p=>(p.za+1900).toString().substring(2),"%Y":p=>p.za+1900,"%z":p=>{p=p.Ha;var H=0<=p;return p=Math.abs(p)/60,(H?"+":"-")+("0000"+(p/60*100+p%60)).slice(-4)},"%Z":p=>p.Ka,"%%":()=>"%"},s=s.replace(/%%/g,"\\0\\0");for(ie in se)s.includes(ie)&&(s=s.replace(new RegExp(ie,"g"),se[ie](c)));return s=s.replace(/\\0\\0/g,"%"),ie=z(s),ie.length>a?0:(ue.set(ie,r>>>0),ie.length-1)}var xe=[],ye,Re,pt=[],x=(r,a)=>{if(!Re){Re=new WeakMap;var s=ye.length;if(Re)for(var c=0;c<0+s;c++){var O=c,_=xe[O];_||(O>=xe.length&&(xe.length=O+1),xe[O]=_=ye.get(O)),(O=_)&&Re.set(O,c)}}if(s=Re.get(r)||0)return s;if(pt.length)s=pt.pop();else{try{ye.grow(1)}catch($){throw $ instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":$}s=ye.length-1}try{c=s,ye.set(c,r),xe[c]=ye.get(c)}catch($){if(!($ instanceof TypeError))throw $;if(typeof WebAssembly.Function=="function"){c=WebAssembly.Function,O={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},_={parameters:[],results:a[0]=="v"?[]:[O[a[0]]]};for(var A=1;A<a.length;++A)_.parameters.push(O[a[A]]);a=new c(_,r)}else{for(c=[1],O=a.slice(0,1),a=a.slice(1),_={i:127,p:127,j:126,f:125,d:124,e:111},c.push(96),A=a.length,128>A?c.push(A):c.push(A%128|128,A>>7),A=0;A<a.length;++A)c.push(_[a[A]]);O=="v"?c.push(0):c.push(1,_[O]),a=[0,97,115,109,1,0,0,0,1],O=c.length,128>O?a.push(O):a.push(O%128|128,O>>7),a.push.apply(a,c),a.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),a=new WebAssembly.Module(new Uint8Array(a)),a=new WebAssembly.Instance(a,{e:{f:r}}).exports.f}c=s,ye.set(c,a),xe[c]=ye.get(c)}return Re.set(r,s),s},qe={a:function(r,a,s){throw r>>>=0,new Se(r).La(a>>>0,s>>>0),Ae=r,ne++,Ae},e:function(){return 0},L:function(){},A:function(){},C:function(){},u:function(){return 0},J:function(){},E:function(){},I:function(){},k:function(){},B:function(){},y:function(){},K:function(){},z:function(){},l:()=>1,o:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getUTCSeconds(),S[s+4>>>2>>>0]=r.getUTCMinutes(),S[s+8>>>2>>>0]=r.getUTCHours(),S[s+12>>>2>>>0]=r.getUTCDate(),S[s+16>>>2>>>0]=r.getUTCMonth(),S[s+20>>>2>>>0]=r.getUTCFullYear()-1900,S[s+24>>>2>>>0]=r.getUTCDay(),S[s+28>>>2>>>0]=(r.getTime()-Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getSeconds(),S[s+4>>>2>>>0]=r.getMinutes(),S[s+8>>>2>>>0]=r.getHours(),S[s+12>>>2>>>0]=r.getDate(),S[s+16>>>2>>>0]=r.getMonth(),S[s+20>>>2>>>0]=r.getFullYear()-1900,S[s+24>>>2>>>0]=r.getDay(),S[s+28>>>2>>>0]=(Ie(r.getFullYear())?Ze:lt)[r.getMonth()]+r.getDate()-1|0,S[s+36>>>2>>>0]=-(60*r.getTimezoneOffset()),a=new Date(r.getFullYear(),6,1).getTimezoneOffset();var c=new Date(r.getFullYear(),0,1).getTimezoneOffset();S[s+32>>>2>>>0]=(a!=c&&r.getTimezoneOffset()==Math.min(c,a))|0},q:function(r){r>>>=0;var a=new Date(S[r+20>>>2>>>0]+1900,S[r+16>>>2>>>0],S[r+12>>>2>>>0],S[r+8>>>2>>>0],S[r+4>>>2>>>0],S[r>>>2>>>0],0),s=S[r+32>>>2>>>0],c=a.getTimezoneOffset(),O=new Date(a.getFullYear(),6,1).getTimezoneOffset(),_=new Date(a.getFullYear(),0,1).getTimezoneOffset(),A=Math.min(_,O);return 0>s?S[r+32>>>2>>>0]=+(O!=_&&A==c):0<s!=(A==c)&&(O=Math.max(_,O),a.setTime(a.getTime()+6e4*((0<s?A:O)-c))),S[r+24>>>2>>>0]=a.getDay(),S[r+28>>>2>>>0]=(Ie(a.getFullYear())?Ze:lt)[a.getMonth()]+a.getDate()-1|0,S[r>>>2>>>0]=a.getSeconds(),S[r+4>>>2>>>0]=a.getMinutes(),S[r+8>>>2>>>0]=a.getHours(),S[r+12>>>2>>>0]=a.getDate(),S[r+16>>>2>>>0]=a.getMonth(),S[r+20>>>2>>>0]=a.getYear(),r=a.getTime(),isNaN(r)?(S[Le()>>>2>>>0]=61,r=-1):r/=1e3,tt((Me=r,1<=+Math.abs(Me)?0<Me?+Math.floor(Me/4294967296)>>>0:~~+Math.ceil((Me-+(~~Me>>>0))/4294967296)>>>0:0)),r>>>0},m:function(){return-52},n:function(){},w:function(r,a,s){function c(oe){return(oe=oe.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?oe[1]:"GMT"}s>>>=0;var O=new Date().getFullYear(),_=new Date(O,0,1),A=new Date(O,6,1);O=_.getTimezoneOffset();var $=A.getTimezoneOffset();G[r>>>0>>>2>>>0]=60*Math.max(O,$),S[a>>>0>>>2>>>0]=+(O!=$),r=c(_),a=c(A),r=Ue(r),a=Ue(a),$<O?(G[s>>>2>>>0]=r,G[s+4>>>2>>>0]=a):(G[s>>>2>>>0]=a,G[s+4>>>2>>>0]=r)},d:()=>{le("")},D:function(r,a,s){r>>>=0,a>>>=0,s>>>=0,Ye.length=0;for(var c;c=ee[a++>>>0];){var O=c!=105;O&=c!=112,s+=O&&s%8?4:0,Ye.push(c==112?G[s>>>2>>>0]:c==105?S[s>>>2>>>0]:fe[s>>>3>>>0]),s+=O?8:4}return pe[r].apply(null,Ye)},g:()=>Date.now(),x:function(){return 4294901760},b:()=>performance.now(),H:function(r,a,s){return a>>>=0,ee.copyWithin(r>>>0>>>0,a>>>0,a+(s>>>0)>>>0)},v:function(r){r>>>=0;var a=ee.length;if(4294901760<r)return!1;for(var s=1;4>=s;s*=2){var c=a*(1+.2/s);c=Math.min(c,r+100663296);var O=Math;c=Math.max(r,c);e:{O=(O.min.call(O,4294901760,c+(65536-c%65536)%65536)-k.buffer.byteLength+65535)/65536;try{k.grow(O),We();var _=1;break e}catch{}_=void 0}if(_)return!0}return!1},F:function(r,a){r>>>=0,a>>>=0;var s=0;return Ge().forEach((c,O)=>{var _=a+s;for(O=G[r+4*O>>>2>>>0]=_,_=0;_<c.length;++_)ue[O++>>>0>>>0]=c.charCodeAt(_);ue[O>>>0>>>0]=0,s+=c.length+1}),0},G:function(r,a){r>>>=0,a>>>=0;var s=Ge();G[r>>>2>>>0]=s.length;var c=0;return s.forEach(O=>c+=O.length+1),G[a>>>2>>>0]=c,0},f:()=>52,j:function(){return 52},r:function(){return 70},i:function(r,a,s,c){a>>>=0,s>>>=0,c>>>=0;for(var O=0,_=0;_<s;_++){var A=G[a>>>2>>>0],$=G[a+4>>>2>>>0];a+=8;for(var oe=0;oe<$;oe++){var se=ee[A+oe>>>0],ie=Ne[r];se===0||se===10?((r===1?E:F)(Fe(ie,0)),ie.length=0):ie.push(se)}O+=$}return G[c>>>2>>>0]=O,0},s:function(r,a){return r>>>=0,Ke(ee.subarray(r>>>0,r+(a>>>0)>>>0)),0},t:et,c:function(r,a,s,c){return et(r>>>0,a>>>0,s>>>0,c>>>0)},h:function(r,a,s,c){let O=ye.length;r=new Uint8Array(ee.slice(r+a,r+s));try{var _=new WebAssembly.Module(r),A=new WebAssembly.Instance(_,{env:{memory:k}}),$;for($ in A.exports)x(A.exports[$]);return O<ye.length?O:c}catch(oe){return console.log(oe),c}}},C=function(){function r(s){return C=s.exports,C=ht(),k=C.M,We(),ye=C.sa,te.unshift(C.N),de--,de==0&&(L!==null&&(clearInterval(L),L=null),re&&(s=re,re=null,s())),C}var a={a:qe};if(de++,o.instantiateWasm)try{return o.instantiateWasm(a,r)}catch(s){F(`Module.instantiateWasm callback failed with error: ${s}`),l(s)}return Pe(a,function(s){r(s.instance)}).catch(l),{}}();o._OrtInit=(r,a)=>(o._OrtInit=C.O)(r,a),o._OrtGetLastError=(r,a)=>(o._OrtGetLastError=C.P)(r,a),o._OrtCreateSessionOptions=(r,a,s,c,O,_,A,$,oe,se)=>(o._OrtCreateSessionOptions=C.Q)(r,a,s,c,O,_,A,$,oe,se),o._OrtAppendExecutionProvider=(r,a)=>(o._OrtAppendExecutionProvider=C.R)(r,a),o._OrtAddFreeDimensionOverride=(r,a,s)=>(o._OrtAddFreeDimensionOverride=C.S)(r,a,s),o._OrtAddSessionConfigEntry=(r,a,s)=>(o._OrtAddSessionConfigEntry=C.T)(r,a,s),o._OrtReleaseSessionOptions=r=>(o._OrtReleaseSessionOptions=C.U)(r),o._OrtCreateSession=(r,a,s)=>(o._OrtCreateSession=C.V)(r,a,s),o._OrtReleaseSession=r=>(o._OrtReleaseSession=C.W)(r),o._OrtGetInputOutputCount=(r,a,s)=>(o._OrtGetInputOutputCount=C.X)(r,a,s),o._OrtGetInputName=(r,a)=>(o._OrtGetInputName=C.Y)(r,a),o._OrtGetOutputName=(r,a)=>(o._OrtGetOutputName=C.Z)(r,a),o._OrtFree=r=>(o._OrtFree=C._)(r),o._OrtCreateTensor=(r,a,s,c,O,_)=>(o._OrtCreateTensor=C.$)(r,a,s,c,O,_),o._OrtGetTensorData=(r,a,s,c,O)=>(o._OrtGetTensorData=C.aa)(r,a,s,c,O),o._OrtReleaseTensor=r=>(o._OrtReleaseTensor=C.ba)(r),o._OrtCreateRunOptions=(r,a,s,c)=>(o._OrtCreateRunOptions=C.ca)(r,a,s,c),o._OrtAddRunConfigEntry=(r,a,s)=>(o._OrtAddRunConfigEntry=C.da)(r,a,s),o._OrtReleaseRunOptions=r=>(o._OrtReleaseRunOptions=C.ea)(r),o._OrtCreateBinding=r=>(o._OrtCreateBinding=C.fa)(r),o._OrtBindInput=(r,a,s)=>(o._OrtBindInput=C.ga)(r,a,s),o._OrtBindOutput=(r,a,s,c)=>(o._OrtBindOutput=C.ha)(r,a,s,c),o._OrtClearBoundOutputs=r=>(o._OrtClearBoundOutputs=C.ia)(r),o._OrtReleaseBinding=r=>(o._OrtReleaseBinding=C.ja)(r),o._OrtRunWithBinding=(r,a,s,c,O)=>(o._OrtRunWithBinding=C.ka)(r,a,s,c,O),o._OrtRun=(r,a,s,c,O,_,A,$)=>(o._OrtRun=C.la)(r,a,s,c,O,_,A,$),o._OrtEndProfiling=r=>(o._OrtEndProfiling=C.ma)(r),o._OrtConfigure=(r,a)=>(o._OrtConfigure=C.na)(r,a),o._OrtAuth=(r,a)=>(o._OrtAuth=C.oa)(r,a);var Le=()=>(Le=C.pa)(),me=o._malloc=r=>(me=o._malloc=C.qa)(r);o._free=r=>(o._free=C.ra)(r);var tt=r=>(tt=C.ta)(r),mt=()=>(mt=C.ua)(),rt=r=>(rt=C.va)(r),gt=r=>(gt=C.wa)(r);o.___start_em_js=882613,o.___stop_em_js=883225;function ht(){var r=C;r=Object.assign({},r);var a=c=>()=>c()>>>0,s=c=>O=>c(O)>>>0;return r.pa=a(r.pa),r.qa=s(r.qa),r.ua=a(r.ua),r.wa=s(r.wa),r}o.stackAlloc=gt,o.stackSave=mt,o.stackRestore=rt,o.addFunction=x,o.UTF8ToString=Oe,o.stringToUTF8=(r,a,s)=>ze(r,ee,a,s),o.lengthBytesUTF8=Te;var $e;re=function r(){$e||nt(),$e||(re=r)};function nt(){if(!(0<de)){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;){var r=o.preRun.shift();He.unshift(r)}for(;0<He.length;)He.shift()(o);if(!(0<de||$e||($e=!0,o.calledRun=!0,we))){for(;0<te.length;)te.shift()(o);for(g(o);0<V.length;)V.shift()(o)}}}return nt(),d.ready}})();typeof Or=="object"&&typeof Pt=="object"?Pt.exports=br:typeof define=="function"&&define.amd&&define([],()=>br)});var _r=st(()=>{});var Er=st(()=>{});var Sr={};Dt(Sr,{cpus:()=>dn});var dn,Ar=Ct(()=>{dn=void 0});var xr=st((Mr,It)=>{"use strict";var Tr=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){function o(){return V.buffer!=le.buffer&&Ee(),le}function g(){return V.buffer!=le.buffer&&Ee(),he}function l(){return V.buffer!=le.buffer&&Ee(),be}function b(){return V.buffer!=le.buffer&&Ee(),Q}function y(){return V.buffer!=le.buffer&&Ee(),ce}var f=d,M,D;f.ready=new Promise((e,t)=>{M=e,D=t});var P=Object.assign({},f),W="./this.program",U=(e,t)=>{throw t},R=typeof window=="object",N=typeof importScripts=="function",I=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",E=f.ENVIRONMENT_IS_PTHREAD||!1,F="";function k(e){return f.locateFile?f.locateFile(e,F):F+e}var we,ue,ee;if(I){var S=(Ut(),it(Ft)),G=(Lt(),it(Rt));F=N?G.dirname(F)+"/":__dirname+"/",we=(t,n)=>(t=Oe(t)?new URL(t):G.normalize(t),S.readFileSync(t,n?void 0:"utf8")),ee=t=>(t=we(t,!0),t.buffer||(t=new Uint8Array(t)),t),ue=(t,n,u,h=!0)=>{t=Oe(t)?new URL(t):G.normalize(t),S.readFile(t,h?void 0:"utf8",(w,v)=>{w?u(w):n(h?v.buffer:v)})},!f.thisProgram&&1<process.argv.length&&(W=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),U=(t,n)=>{throw process.exitCode=t,n},f.inspect=()=>"[Emscripten Module object]";let e;try{e=_r()}catch(t){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),t}global.Worker=e.Worker}else(R||N)&&(N?F=self.location.href:typeof document<"u"&&document.currentScript&&(F=document.currentScript.src),typeof i<"u"&&i&&(F=i),F.indexOf("blob:")!==0?F=F.substr(0,F.replace(/[?#].*/,"").lastIndexOf("/")+1):F="",I||(we=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},N&&(ee=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),ue=(e,t,n)=>{var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=()=>{u.status==200||u.status==0&&u.response?t(u.response):n()},u.onerror=n,u.send(null)}));I&&typeof performance>"u"&&(global.performance=Er().performance);var fe=console.log.bind(console),We=console.error.bind(console);I&&(fe=(...e)=>S.writeSync(1,e.join(" ")+`\n`),We=(...e)=>S.writeSync(2,e.join(" ")+`\n`));var He=fe,te=We;Object.assign(f,P),P=null,typeof WebAssembly!="object"&&Z("no native wasm support detected");var V,de,L=!1,re,le,he,be,Q,ce;function Ee(){var e=V.buffer;f.HEAP8=le=new Int8Array(e),f.HEAP16=new Int16Array(e),f.HEAPU8=he=new Uint8Array(e),f.HEAPU16=new Uint16Array(e),f.HEAP32=be=new Int32Array(e),f.HEAPU32=Q=new Uint32Array(e),f.HEAPF32=new Float32Array(e),f.HEAPF64=ce=new Float64Array(e)}var Ce=16777216;if(E)V=f.wasmMemory;else if(f.wasmMemory)V=f.wasmMemory;else if(V=new WebAssembly.Memory({initial:Ce/65536,maximum:65536,shared:!0}),!(V.buffer instanceof SharedArrayBuffer))throw te("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),I&&te("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ee(),Ce=V.buffer.byteLength;var De=[],Pe=[],Me=[],pe=0,Se=null,Ae=null;function ne(){if(pe--,pe==0&&(Se!==null&&(clearInterval(Se),Se=null),Ae)){var e=Ae;Ae=null,e()}}function Z(e){throw e="Aborted("+e+")",te(e),L=!0,re=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),D(e),e}var Fe=e=>e.startsWith("data:application/octet-stream;base64,"),Oe=e=>e.startsWith("file://"),Te;Te="ort-wasm-threaded.wasm",Fe(Te)||(Te=k(Te));function ze(e){if(ee)return ee(e);throw"both async and sync fetching of the wasm failed"}function Ie(e){if(R||N){if(typeof fetch=="function"&&!Oe(e))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at \'"+e+"\'";return t.arrayBuffer()}).catch(()=>ze(e));if(ue)return new Promise((t,n)=>{ue(e,u=>t(new Uint8Array(u)),n)})}return Promise.resolve().then(()=>ze(e))}function Ze(e,t,n){return Ie(e).then(u=>WebAssembly.instantiate(u,t)).then(u=>u).then(n,u=>{te(`failed to asynchronously prepare wasm: ${u}`),Z(u)})}function lt(e,t){var n=Te;return typeof WebAssembly.instantiateStreaming!="function"||Fe(n)||Oe(n)||I||typeof fetch!="function"?Ze(n,e,t):fetch(n,{credentials:"same-origin"}).then(u=>WebAssembly.instantiateStreaming(u,e).then(t,function(h){return te(`wasm streaming compile failed: ${h}`),te("falling back to ArrayBuffer instantiation"),Ze(n,e,t)}))}var Ue,Ye={886500:(e,t,n,u)=>{if(typeof f>"u"||!f.hb)return 1;if(e=ke(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=f.hb.get(e),!e)return 2;if(t>>>=0,n>>>=0,u>>>=0,t+n>e.byteLength)return 3;try{return g().set(e.subarray(t,t+n),u>>>0),0}catch{return 4}}};function Be(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var Ge=e=>{e.terminate(),e.onmessage=()=>{}},Ve=e=>{x.Ta.length==0&&(Re(),x.bb(x.Ta[0]));var t=x.Ta.pop();if(!t)return 6;x.Ua.push(t),x.Qa[e.Sa]=t,t.Sa=e.Sa;var n={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return I&&t.unref(),t.postMessage(n,e.ub),0},Ne=0,ct=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ke=(e,t,n)=>{t>>>=0;var u=t+n;for(n=t;e[n]&&!(n>=u);)++n;if(16<n-t&&e.buffer&&ct)return ct.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(u="";t<n;){var h=e[t++];if(h&128){var w=e[t++]&63;if((h&224)==192)u+=String.fromCharCode((h&31)<<6|w);else{var v=e[t++]&63;h=(h&240)==224?(h&15)<<12|w<<6|v:(h&7)<<18|w<<12|v<<6|e[t++]&63,65536>h?u+=String.fromCharCode(h):(h-=65536,u+=String.fromCharCode(55296|h>>10,56320|h&1023))}}else u+=String.fromCharCode(h)}return u},ke=(e,t)=>(e>>>=0)?Ke(g(),e,t):"",dt=e=>{var t=Tt();return e=e(),wt(t),e};function z(e,t){var n=arguments.length-2,u=arguments;return dt(()=>{for(var h=Mt(8*n),w=h>>>3,v=0;v<n;v++){var B=u[2+v];y()[w+v>>>0]=B}return fr(e,n,h,t)})}function et(e){if(E)return z(0,1,e);re=e,0<Ne||(x.pb(),f.onExit?.(e),L=!0),U(e,new Be(e))}var xe=e=>{if(re=e,E)throw C(e),"unwind";et(e)};function ye(){for(var e=f.numThreads;e--;)Re();De.unshift(()=>{pe++,pt(()=>ne())})}function Re(){var e=k("ort-wasm-threaded.worker.js");e=new Worker(e),x.Ta.push(e)}function pt(e){E?e():Promise.all(x.Ta.map(x.bb)).then(e)}var x={Ta:[],Ua:[],gb:[],Qa:{},$a(){E?(x.receiveObjectTransfer=x.nb,x.threadInitTLS=x.fb,x.setExitStatus=x.eb):ye()},eb:e=>re=e,xb:["$terminateWorker"],pb:()=>{for(var e of x.Ua)Ge(e);for(e of x.Ta)Ge(e);x.Ta=[],x.Ua=[],x.Qa=[]},cb:e=>{var t=e.Sa;delete x.Qa[t],x.Ta.push(e),x.Ua.splice(x.Ua.indexOf(e),1),e.Sa=0,St(t)},nb(){},fb(){x.gb.forEach(e=>e())},bb:e=>new Promise(t=>{e.onmessage=w=>{w=w.data;var v=w.cmd;if(w.targetThread&&w.targetThread!=yt()){var B=x.Qa[w.targetThread];B?B.postMessage(w,w.transferList):te(`Internal error! Worker sent a message "${v}" to target pthread ${w.targetThread}, but that thread no longer exists!`)}else v==="checkMailbox"?ve():v==="spawnThread"?Ve(w):v==="cleanupThread"?x.cb(x.Qa[w.thread]):v==="killThread"?(w=w.thread,v=x.Qa[w],delete x.Qa[w],Ge(v),St(w),x.Ua.splice(x.Ua.indexOf(v),1),v.Sa=0):v==="cancelThread"?x.Qa[w.thread].postMessage({cmd:"cancel"}):v==="loaded"?(e.loaded=!0,I&&!e.Sa&&e.unref(),t(e)):v==="alert"?alert(`Thread ${w.threadId}: ${w.text}`):w.target==="setimmediate"?e.postMessage(w):v==="callHandler"?f[w.handler](...w.args):v&&te(`worker sent an unknown command ${v}`)},e.onerror=w=>{throw te(`worker sent an error! ${w.filename}:${w.lineno}: ${w.message}`),w},I&&(e.on("message",w=>e.onmessage({data:w})),e.on("error",w=>e.onerror(w)));var n=[],u=["onExit"],h;for(h of u)f.hasOwnProperty(h)&&n.push(h);e.postMessage({cmd:"load",handlers:n,urlOrBlob:f.mainScriptUrlOrBlob||i,wasmMemory:V,wasmModule:de})})};f.PThread=x;var qe=e=>{for(;0<e.length;)e.shift()(f)};f.establishStackSpace=()=>{var e=yt(),t=b()[e+52>>>2>>>0];e=b()[e+56>>>2>>>0],dr(t,t-e),wt(t)};function C(e){if(E)return z(1,0,e);xe(e)}var Le=[],me,tt=e=>{var t=Le[e];return t||(e>=Le.length&&(Le.length=e+1),Le[e]=t=me.get(e)),t};f.invokeEntryPoint=(e,t)=>{e=tt(e)(t),0<Ne?x.eb(e):At(e)};function mt(e){this.Za=e-24,this.kb=function(t){b()[this.Za+4>>>2>>>0]=t},this.jb=function(t){b()[this.Za+8>>>2>>>0]=t},this.$a=function(t,n){this.ib(),this.kb(t),this.jb(n)},this.ib=function(){b()[this.Za+16>>>2>>>0]=0}}var rt=0,gt=0;function ht(e,t,n,u){return E?z(2,1,e,t,n,u):$e(e,t,n,u)}function $e(e,t,n,u){if(e>>>=0,t>>>=0,n>>>=0,u>>>=0,typeof SharedArrayBuffer>"u")return te("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var h=[];return E&&h.length===0?ht(e,t,n,u):(e={ob:n,Sa:e,lb:u,ub:h},E?(e.wb="spawnThread",postMessage(e,h),0):Ve(e))}function nt(e,t,n){return E?z(3,1,e,t,n):0}function r(e,t){if(E)return z(4,1,e,t)}var a=e=>{for(var t=0,n=0;n<e.length;++n){var u=e.charCodeAt(n);127>=u?t++:2047>=u?t+=2:55296<=u&&57343>=u?(t+=4,++n):t+=3}return t},s=(e,t,n,u)=>{if(n>>>=0,!(0<u))return 0;var h=n;u=n+u-1;for(var w=0;w<e.length;++w){var v=e.charCodeAt(w);if(55296<=v&&57343>=v){var B=e.charCodeAt(++w);v=65536+((v&1023)<<10)|B&1023}if(127>=v){if(n>=u)break;t[n++>>>0]=v}else{if(2047>=v){if(n+1>=u)break;t[n++>>>0]=192|v>>6}else{if(65535>=v){if(n+2>=u)break;t[n++>>>0]=224|v>>12}else{if(n+3>=u)break;t[n++>>>0]=240|v>>18,t[n++>>>0]=128|v>>12&63}t[n++>>>0]=128|v>>6&63}t[n++>>>0]=128|v&63}}return t[n>>>0]=0,n-h},c=(e,t,n)=>s(e,g(),t,n);function O(e,t){if(E)return z(5,1,e,t)}function _(e,t,n){if(E)return z(6,1,e,t,n)}function A(e,t,n){return E?z(7,1,e,t,n):0}function $(e,t){if(E)return z(8,1,e,t)}function oe(e,t,n){if(E)return z(9,1,e,t,n)}function se(e,t,n,u){if(E)return z(10,1,e,t,n,u)}function ie(e,t,n,u){if(E)return z(11,1,e,t,n,u)}function at(e,t,n,u){if(E)return z(12,1,e,t,n,u)}function ot(e){if(E)return z(13,1,e)}function p(e,t){if(E)return z(14,1,e,t)}function H(e,t,n){if(E)return z(15,1,e,t,n)}function Y(e){e>>>=0,typeof Atomics.vb=="function"&&(Atomics.vb(l(),e>>>2,e).value.then(ve),e+=128,Atomics.store(l(),e>>>2,1))}f.__emscripten_thread_mailbox_await=Y;var ve=()=>{var e=yt();if(e&&(Y(e),e=lr,!L))try{if(e(),!(0<Ne))try{E?At(re):xe(re)}catch(t){t instanceof Be||t=="unwind"||U(1,t)}}catch(t){t instanceof Be||t=="unwind"||U(1,t)}};f.checkMailbox=ve;var Je=[],Xe=e=>e%4===0&&(e%100!==0||e%400===0),$t=[0,31,60,91,121,152,182,213,244,274,305,335],jt=[0,31,59,90,120,151,181,212,243,273,304,334];function zt(e,t,n,u,h,w,v,B){return E?z(16,1,e,t,n,u,h,w,v,B):-52}function Yt(e,t,n,u,h,w,v){if(E)return z(17,1,e,t,n,u,h,w,v)}var Gt=e=>{var t=a(e)+1,n=ir(t);return n&&c(e,n,t),n},vt=[],_t={},Vt=()=>{if(!Et){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:W||"./this.program"},t;for(t in _t)_t[t]===void 0?delete e[t]:e[t]=_t[t];var n=[];for(t in e)n.push(`${t}=${e[t]}`);Et=n}return Et},Et;function qt(e,t){if(E)return z(18,1,e,t);e>>>=0,t>>>=0;var n=0;return Vt().forEach((u,h)=>{var w=t+n;for(h=b()[e+4*h>>>2>>>0]=w,w=0;w<u.length;++w)o()[h++>>>0>>>0]=u.charCodeAt(w);o()[h>>>0>>>0]=0,n+=u.length+1}),0}function Jt(e,t){if(E)return z(19,1,e,t);e>>>=0,t>>>=0;var n=Vt();b()[e>>>2>>>0]=n.length;var u=0;return n.forEach(h=>u+=h.length+1),b()[t>>>2>>>0]=u,0}function Xt(e){return E?z(20,1,e):52}function Qt(e,t,n,u){return E?z(21,1,e,t,n,u):52}function Zt(e,t,n,u,h){return E?z(22,1,e,t,n,u,h):70}var Qr=[null,[],[]];function Kt(e,t,n,u){if(E)return z(23,1,e,t,n,u);t>>>=0,n>>>=0,u>>>=0;for(var h=0,w=0;w<n;w++){var v=b()[t>>>2>>>0],B=b()[t+4>>>2>>>0];t+=8;for(var _e=0;_e<B;_e++){var ae=g()[v+_e>>>0],ge=Qr[e];ae===0||ae===10?((e===1?He:te)(Ke(ge,0)),ge.length=0):ge.push(ae)}h+=B}return b()[u>>>2>>>0]=h,0}var Zr=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return n=>(n.set(crypto.getRandomValues(new Uint8Array(n.byteLength))),n);if(I)try{var e=yr("crypto");if(e.randomFillSync)return n=>e.randomFillSync(n);var t=e.randomBytes;return n=>(n.set(t(n.byteLength)),n)}catch{}Z("initRandomDevice")},er=e=>(er=Zr())(e),tr=[31,29,31,30,31,30,31,31,30,31,30,31],rr=[31,28,31,30,31,30,31,31,30,31,30,31];function Kr(e){var t=Array(a(e)+1);return s(e,t,0,t.length),t}var en=(e,t)=>{o().set(e,t>>>0)};function nr(e,t,n,u){function h(m,j,J){for(m=typeof m=="number"?m.toString():m||"";m.length<j;)m=J[0]+m;return m}function w(m,j){return h(m,j,"0")}function v(m,j){function J(hr){return 0>hr?-1:0<hr?1:0}var je;return(je=J(m.getFullYear()-j.getFullYear()))===0&&(je=J(m.getMonth()-j.getMonth()))===0&&(je=J(m.getDate()-j.getDate())),je}function B(m){switch(m.getDay()){case 0:return new Date(m.getFullYear()-1,11,29);case 1:return m;case 2:return new Date(m.getFullYear(),0,3);case 3:return new Date(m.getFullYear(),0,2);case 4:return new Date(m.getFullYear(),0,1);case 5:return new Date(m.getFullYear()-1,11,31);case 6:return new Date(m.getFullYear()-1,11,30)}}function _e(m){var j=m.Va;for(m=new Date(new Date(m.Wa+1900,0,1).getTime());0<j;){var J=m.getMonth(),je=(Xe(m.getFullYear())?tr:rr)[J];if(j>je-m.getDate())j-=je-m.getDate()+1,m.setDate(1),11>J?m.setMonth(J+1):(m.setMonth(0),m.setFullYear(m.getFullYear()+1));else{m.setDate(m.getDate()+j);break}}return J=new Date(m.getFullYear()+1,0,4),j=B(new Date(m.getFullYear(),0,4)),J=B(J),0>=v(j,m)?0>=v(J,m)?m.getFullYear()+1:m.getFullYear():m.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0,u>>>=0;var ae=b()[u+40>>>2>>>0];u={sb:l()[u>>>2>>>0],rb:l()[u+4>>>2>>>0],Xa:l()[u+8>>>2>>>0],ab:l()[u+12>>>2>>>0],Ya:l()[u+16>>>2>>>0],Wa:l()[u+20>>>2>>>0],Ra:l()[u+24>>>2>>>0],Va:l()[u+28>>>2>>>0],yb:l()[u+32>>>2>>>0],qb:l()[u+36>>>2>>>0],tb:ae?ke(ae):""},n=ke(n),ae={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ge in ae)n=n.replace(new RegExp(ge,"g"),ae[ge]);var mr="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),gr="January February March April May June July August September October November December".split(" ");ae={"%a":m=>mr[m.Ra].substring(0,3),"%A":m=>mr[m.Ra],"%b":m=>gr[m.Ya].substring(0,3),"%B":m=>gr[m.Ya],"%C":m=>w((m.Wa+1900)/100|0,2),"%d":m=>w(m.ab,2),"%e":m=>h(m.ab,2," "),"%g":m=>_e(m).toString().substring(2),"%G":m=>_e(m),"%H":m=>w(m.Xa,2),"%I":m=>(m=m.Xa,m==0?m=12:12<m&&(m-=12),w(m,2)),"%j":m=>{for(var j=0,J=0;J<=m.Ya-1;j+=(Xe(m.Wa+1900)?tr:rr)[J++]);return w(m.ab+j,3)},"%m":m=>w(m.Ya+1,2),"%M":m=>w(m.rb,2),"%n":()=>`\n`,"%p":m=>0<=m.Xa&&12>m.Xa?"AM":"PM","%S":m=>w(m.sb,2),"%t":()=>"\t","%u":m=>m.Ra||7,"%U":m=>w(Math.floor((m.Va+7-m.Ra)/7),2),"%V":m=>{var j=Math.floor((m.Va+7-(m.Ra+6)%7)/7);if(2>=(m.Ra+371-m.Va-2)%7&&j++,j)j==53&&(J=(m.Ra+371-m.Va)%7,J==4||J==3&&Xe(m.Wa)||(j=1));else{j=52;var J=(m.Ra+7-m.Va-1)%7;(J==4||J==5&&Xe(m.Wa%400-1))&&j++}return w(j,2)},"%w":m=>m.Ra,"%W":m=>w(Math.floor((m.Va+7-(m.Ra+6)%7)/7),2),"%y":m=>(m.Wa+1900).toString().substring(2),"%Y":m=>m.Wa+1900,"%z":m=>{m=m.qb;var j=0<=m;return m=Math.abs(m)/60,(j?"+":"-")+("0000"+(m/60*100+m%60)).slice(-4)},"%Z":m=>m.tb,"%%":()=>"%"},n=n.replace(/%%/g,"\\0\\0");for(ge in ae)n.includes(ge)&&(n=n.replace(new RegExp(ge,"g"),ae[ge](u)));return n=n.replace(/\\0\\0/g,"%"),ge=Kr(n),ge.length>t?0:(en(ge,e),ge.length-1)}var Qe,ar=[],or=(e,t)=>{if(!Qe){Qe=new WeakMap;var n=me.length;if(Qe)for(var u=0;u<0+n;u++){var h=tt(u);h&&Qe.set(h,u)}}if(n=Qe.get(e)||0)return n;if(ar.length)n=ar.pop();else{try{me.grow(1)}catch(B){throw B instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":B}n=me.length-1}try{u=n,me.set(u,e),Le[u]=me.get(u)}catch(B){if(!(B instanceof TypeError))throw B;if(typeof WebAssembly.Function=="function"){u=WebAssembly.Function,h={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var w={parameters:[],results:t[0]=="v"?[]:[h[t[0]]]},v=1;v<t.length;++v)w.parameters.push(h[t[v]]);t=new u(w,e)}else{for(u=[1],h=t.slice(0,1),t=t.slice(1),w={i:127,p:127,j:126,f:125,d:124,e:111},u.push(96),v=t.length,128>v?u.push(v):u.push(v%128|128,v>>7),v=0;v<t.length;++v)u.push(w[t[v]]);h=="v"?u.push(0):u.push(1,w[h]),t=[0,97,115,109,1,0,0,0,1],h=u.length,128>h?t.push(h):t.push(h%128|128,h>>7),t.push.apply(t,u),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}u=n,me.set(u,t),Le[u]=me.get(u)}return Qe.set(e,n),n};x.$a();var tn=[et,C,ht,nt,r,O,_,A,$,oe,se,ie,at,ot,p,H,zt,Yt,qt,Jt,Xt,Qt,Zt,Kt],rn={b:function(e,t,n){throw e>>>=0,new mt(e).$a(t>>>0,n>>>0),rt=e,gt++,rt},O:function(e){ur(e>>>0,!N,1,!R,131072,!1),x.fb()},m:function(e){e>>>=0,E?postMessage({cmd:"cleanupThread",thread:e}):x.cb(x.Qa[e])},J:$e,h:nt,U:r,F:O,H:_,y:A,S:$,L:oe,R:se,o:ie,G:at,D:ot,T:p,E:H,p:()=>1,B:function(e,t){e>>>=0,e==t>>>0?setTimeout(()=>ve()):E?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=x.Qa[e])&&e.postMessage({cmd:"checkMailbox"})},K:function(e,t,n,u){t>>>=0,Je.length=n,u=u>>>0>>>3;for(var h=0;h<n;h++)Je[h]=y()[u+h>>>0];return e=0>e?Ye[-e-1]:tn[e],x.mb=t,t=e.apply(null,Je),x.mb=0,t},M:Y,W:function(e){I&&x.Qa[e>>>0].ref()},s:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getUTCSeconds(),l()[n+4>>>2>>>0]=e.getUTCMinutes(),l()[n+8>>>2>>>0]=e.getUTCHours(),l()[n+12>>>2>>>0]=e.getUTCDate(),l()[n+16>>>2>>>0]=e.getUTCMonth(),l()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,l()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,l()[n+28>>>2>>>0]=e},t:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getSeconds(),l()[n+4>>>2>>>0]=e.getMinutes(),l()[n+8>>>2>>>0]=e.getHours(),l()[n+12>>>2>>>0]=e.getDate(),l()[n+16>>>2>>>0]=e.getMonth(),l()[n+20>>>2>>>0]=e.getFullYear()-1900,l()[n+24>>>2>>>0]=e.getDay(),t=(Xe(e.getFullYear())?$t:jt)[e.getMonth()]+e.getDate()-1|0,l()[n+28>>>2>>>0]=t,l()[n+36>>>2>>>0]=-(60*e.getTimezoneOffset()),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var u=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=(t!=u&&e.getTimezoneOffset()==Math.min(u,t))|0,l()[n+32>>>2>>>0]=e},u:function(e){e>>>=0;var t=new Date(l()[e+20>>>2>>>0]+1900,l()[e+16>>>2>>>0],l()[e+12>>>2>>>0],l()[e+8>>>2>>>0],l()[e+4>>>2>>>0],l()[e>>>2>>>0],0),n=l()[e+32>>>2>>>0],u=t.getTimezoneOffset(),h=new Date(t.getFullYear(),6,1).getTimezoneOffset(),w=new Date(t.getFullYear(),0,1).getTimezoneOffset(),v=Math.min(w,h);return 0>n?l()[e+32>>>2>>>0]=+(h!=w&&v==u):0<n!=(v==u)&&(h=Math.max(w,h),t.setTime(t.getTime()+6e4*((0<n?v:h)-u))),l()[e+24>>>2>>>0]=t.getDay(),n=(Xe(t.getFullYear())?$t:jt)[t.getMonth()]+t.getDate()-1|0,l()[e+28>>>2>>>0]=n,l()[e>>>2>>>0]=t.getSeconds(),l()[e+4>>>2>>>0]=t.getMinutes(),l()[e+8>>>2>>>0]=t.getHours(),l()[e+12>>>2>>>0]=t.getDate(),l()[e+16>>>2>>>0]=t.getMonth(),l()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(l()[sr()>>>2>>>0]=61,e=-1):e/=1e3,cr((Ue=e,1<=+Math.abs(Ue)?0<Ue?+Math.floor(Ue/4294967296)>>>0:~~+Math.ceil((Ue-+(~~Ue>>>0))/4294967296)>>>0:0)),e>>>0},q:zt,r:Yt,A:function(e,t,n){function u(ae){return(ae=ae.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ae[1]:"GMT"}e>>>=0,t>>>=0,n>>>=0;var h=new Date().getFullYear(),w=new Date(h,0,1),v=new Date(h,6,1);h=w.getTimezoneOffset();var B=v.getTimezoneOffset(),_e=Math.max(h,B);b()[e>>>2>>>0]=60*_e,l()[t>>>2>>>0]=+(h!=B),e=u(w),t=u(v),e=Gt(e),t=Gt(t),B<h?(b()[n>>>2>>>0]=e,b()[n+4>>>2>>>0]=t):(b()[n>>>2>>>0]=t,b()[n+4>>>2>>>0]=e)},c:()=>{Z("")},N:function(e,t,n){e>>>=0,t>>>=0,n>>>=0,vt.length=0;for(var u;u=g()[t++>>>0];){var h=u!=105;h&=u!=112,n+=h&&n%8?4:0,vt.push(u==112?b()[n>>>2>>>0]:u==105?l()[n>>>2>>>0]:y()[n>>>3>>>0]),n+=h?8:4}return Ye[e].apply(null,vt)},n:()=>{},i:()=>Date.now(),V:()=>{throw Ne+=1,"unwind"},C:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>I?(Ar(),it(Sr)).cpus().length:navigator.hardwareConcurrency,z:function(e){e>>>=0;var t=g().length;if(e<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var u=t*(1+.2/n);u=Math.min(u,e+100663296);var h=Math;u=Math.max(e,u);e:{h=(h.min.call(h,4294901760,u+(65536-u%65536)%65536)-V.buffer.byteLength+65535)/65536;try{V.grow(h),Ee();var w=1;break e}catch{}w=void 0}if(w)return!0}return!1},P:qt,Q:Jt,I:xe,g:Xt,l:Qt,v:Zt,k:Kt,w:function(e,t){return e>>>=0,t>>>=0,er(g().subarray(e>>>0,e+t>>>0)),0},a:V||f.wasmMemory,x:nr,d:function(e,t,n,u){return nr(e>>>0,t>>>0,n>>>0,u>>>0)},j:function(e,t,n,u){let h=me.length;e=new Uint8Array(g().slice(e+t,e+n));try{var w=new WebAssembly.Module(e),v=new WebAssembly.Instance(w,{env:{memory:V}}),B;for(B in v.exports)or(v.exports[B]);return h<me.length?h:u}catch(_e){return console.log(_e),u}}},T=function(){function e(n,u){return T=n.exports,T=nn(),x.gb.push(T.Da),me=T.Ea,Pe.unshift(T.X),de=u,ne(),T}var t={a:rn};if(pe++,f.instantiateWasm)try{return f.instantiateWasm(t,e)}catch(n){te(`Module.instantiateWasm callback failed with error: ${n}`),D(n)}return lt(t,function(n){e(n.instance,n.module)}).catch(D),{}}();f._OrtInit=(e,t)=>(f._OrtInit=T.Y)(e,t),f._OrtGetLastError=(e,t)=>(f._OrtGetLastError=T.Z)(e,t),f._OrtCreateSessionOptions=(e,t,n,u,h,w,v,B,_e,ae)=>(f._OrtCreateSessionOptions=T._)(e,t,n,u,h,w,v,B,_e,ae),f._OrtAppendExecutionProvider=(e,t)=>(f._OrtAppendExecutionProvider=T.$)(e,t),f._OrtAddFreeDimensionOverride=(e,t,n)=>(f._OrtAddFreeDimensionOverride=T.aa)(e,t,n),f._OrtAddSessionConfigEntry=(e,t,n)=>(f._OrtAddSessionConfigEntry=T.ba)(e,t,n),f._OrtReleaseSessionOptions=e=>(f._OrtReleaseSessionOptions=T.ca)(e),f._OrtCreateSession=(e,t,n)=>(f._OrtCreateSession=T.da)(e,t,n),f._OrtReleaseSession=e=>(f._OrtReleaseSession=T.ea)(e),f._OrtGetInputOutputCount=(e,t,n)=>(f._OrtGetInputOutputCount=T.fa)(e,t,n),f._OrtGetInputName=(e,t)=>(f._OrtGetInputName=T.ga)(e,t),f._OrtGetOutputName=(e,t)=>(f._OrtGetOutputName=T.ha)(e,t),f._OrtFree=e=>(f._OrtFree=T.ia)(e),f._OrtCreateTensor=(e,t,n,u,h,w)=>(f._OrtCreateTensor=T.ja)(e,t,n,u,h,w),f._OrtGetTensorData=(e,t,n,u,h)=>(f._OrtGetTensorData=T.ka)(e,t,n,u,h),f._OrtReleaseTensor=e=>(f._OrtReleaseTensor=T.la)(e),f._OrtCreateRunOptions=(e,t,n,u)=>(f._OrtCreateRunOptions=T.ma)(e,t,n,u),f._OrtAddRunConfigEntry=(e,t,n)=>(f._OrtAddRunConfigEntry=T.na)(e,t,n),f._OrtReleaseRunOptions=e=>(f._OrtReleaseRunOptions=T.oa)(e),f._OrtCreateBinding=e=>(f._OrtCreateBinding=T.pa)(e),f._OrtBindInput=(e,t,n)=>(f._OrtBindInput=T.qa)(e,t,n),f._OrtBindOutput=(e,t,n,u)=>(f._OrtBindOutput=T.ra)(e,t,n,u),f._OrtClearBoundOutputs=e=>(f._OrtClearBoundOutputs=T.sa)(e),f._OrtReleaseBinding=e=>(f._OrtReleaseBinding=T.ta)(e),f._OrtRunWithBinding=(e,t,n,u,h)=>(f._OrtRunWithBinding=T.ua)(e,t,n,u,h),f._OrtRun=(e,t,n,u,h,w,v,B)=>(f._OrtRun=T.va)(e,t,n,u,h,w,v,B),f._OrtEndProfiling=e=>(f._OrtEndProfiling=T.wa)(e),f._OrtConfigure=(e,t)=>(f._OrtConfigure=T.xa)(e,t),f._OrtAuth=(e,t)=>(f._OrtAuth=T.ya)(e,t);var sr=()=>(sr=T.za)(),yt=f._pthread_self=()=>(yt=f._pthread_self=T.Aa)(),ir=f._malloc=e=>(ir=f._malloc=T.Ba)(e);f._free=e=>(f._free=T.Ca)(e),f.__emscripten_tls_init=()=>(f.__emscripten_tls_init=T.Da)();var ur=f.__emscripten_thread_init=(e,t,n,u,h,w)=>(ur=f.__emscripten_thread_init=T.Fa)(e,t,n,u,h,w);f.__emscripten_thread_crashed=()=>(f.__emscripten_thread_crashed=T.Ga)();var fr=(e,t,n,u)=>(fr=T.Ha)(e,t,n,u),St=e=>(St=T.Ia)(e),At=f.__emscripten_thread_exit=e=>(At=f.__emscripten_thread_exit=T.Ja)(e),lr=()=>(lr=T.Ka)(),cr=e=>(cr=T.La)(e),dr=(e,t)=>(dr=T.Ma)(e,t),Tt=()=>(Tt=T.Na)(),wt=e=>(wt=T.Oa)(e),Mt=e=>(Mt=T.Pa)(e);f.___start_em_js=887001,f.___stop_em_js=887613;function nn(){var e=T;e=Object.assign({},e);var t=u=>()=>u()>>>0,n=u=>h=>u(h)>>>0;return e.za=t(e.za),e.Aa=t(e.Aa),e.Ba=n(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=n(e.Pa),e}f.wasmMemory=V,f.stackAlloc=Mt,f.stackSave=Tt,f.stackRestore=wt,f.keepRuntimeAlive=()=>0<Ne,f.addFunction=or,f.UTF8ToString=ke,f.stringToUTF8=c,f.lengthBytesUTF8=a,f.ExitStatus=Be,f.PThread=x;var bt;Ae=function e(){bt||pr(),bt||(Ae=e)};function pr(){if(!(0<pe))if(E)M(f),E||qe(Pe),startWorker(f);else{if(f.preRun)for(typeof f.preRun=="function"&&(f.preRun=[f.preRun]);f.preRun.length;)De.unshift(f.preRun.shift());qe(De),0<pe||bt||(bt=!0,f.calledRun=!0,L||(E||qe(Pe),M(f),E||qe(Me)))}}return pr(),d.ready}})();typeof Mr=="object"&&typeof It=="object"?It.exports=Tr:typeof define=="function"&&define.amd&&define([],()=>Tr)});var Cr=st((Cn,pn)=>{pn.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Fr;Fr=vr();var mn=xr(),Bt,Wt=!1,Ot=!1,Dr=!1,gn=i=>{if(i===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+i+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},hn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},yn=(i,d)=>i?d?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":d?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Ur=async i=>{if(Wt)return Promise.resolve();if(Ot)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Dr)throw new Error("previous call to \'initializeWebAssembly()\' failed.");Ot=!0;let d=i.initTimeout,o=i.numThreads,g=i.simd,l=gn(o),b=g&&hn(),y=i.wasmPaths,f=typeof y=="string"?y:void 0,M=yn(b,l),D=typeof y=="object"?y[M]:void 0,P=!1,W=[];if(d>0&&W.push(new Promise(U=>{setTimeout(()=>{P=!0,U()},d)})),W.push(new Promise((U,R)=>{let N=l?mn:Fr,I={locateFile:(E,F)=>l&&E.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Cr()],{type:"text/javascript"})):E.endsWith(".wasm")?D||(f??F)+M:F+E};if(l)if(I.numThreads=o,typeof Blob>"u")I.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let E=`var ortWasmThreaded=${N.toString()};`;I.mainScriptUrlOrBlob=new Blob([E],{type:"text/javascript"})}N(I).then(E=>{Ot=!1,Wt=!0,Bt=E,U()},E=>{Ot=!1,Dr=!0,R(E)})})),await Promise.race(W),P)throw new Error(`WebAssembly backend initializing failed due to timeout: ${d}ms`)},q=()=>{if(Wt&&Bt)return Bt;throw new Error("WebAssembly is not initialized yet.")};var K=(i,d)=>{let o=q(),g=o.lengthBytesUTF8(i)+1,l=o._malloc(g);return o.stringToUTF8(i,l,g),d.push(l),l},ut=(i,d,o,g)=>{if(typeof i=="object"&&i!==null){if(o.has(i))throw new Error("Circular reference in options");o.add(i)}Object.entries(i).forEach(([l,b])=>{let y=d?d+l:l;if(typeof b=="object")ut(b,y+".",o,g);else if(typeof b=="string"||typeof b=="number")g(y,b.toString());else if(typeof b=="boolean")g(y,b?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof b}`)})},X=i=>{let d=q(),o=d.stackSave();try{let g=d.stackAlloc(8);d._OrtGetLastError(g,g+4);let l=d.HEAP32[g/4],b=d.HEAPU32[g/4+1],y=b?d.UTF8ToString(b):"";throw new Error(`${i} ERROR_CODE: ${l}, ERROR_MESSAGE: ${y}`)}finally{d.stackRestore(o)}};var Rr=i=>{let d=q(),o=0,g=[],l=i||{};try{if(i?.logSeverityLevel===void 0)l.logSeverityLevel=2;else if(typeof i.logSeverityLevel!="number"||!Number.isInteger(i.logSeverityLevel)||i.logSeverityLevel<0||i.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${i.logSeverityLevel}`);if(i?.logVerbosityLevel===void 0)l.logVerbosityLevel=0;else if(typeof i.logVerbosityLevel!="number"||!Number.isInteger(i.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${i.logVerbosityLevel}`);i?.terminate===void 0&&(l.terminate=!1);let b=0;return i?.tag!==void 0&&(b=K(i.tag,g)),o=d._OrtCreateRunOptions(l.logSeverityLevel,l.logVerbosityLevel,!!l.terminate,b),o===0&&X("Can\'t create run options."),i?.extra!==void 0&&ut(i.extra,"",new WeakSet,(y,f)=>{let M=K(y,g),D=K(f,g);d._OrtAddRunConfigEntry(o,M,D)!==0&&X(`Can\'t set a run config entry: ${y} - ${f}.`)}),[o,g]}catch(b){throw o!==0&&d._OrtReleaseRunOptions(o),g.forEach(y=>d._free(y)),b}};var wn=i=>{switch(i){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${i}`)}},bn=i=>{switch(i){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${i}`)}},On=i=>{i.extra||(i.extra={}),i.extra.session||(i.extra.session={});let d=i.extra.session;d.use_ort_model_bytes_directly||(d.use_ort_model_bytes_directly="1"),i.executionProviders&&i.executionProviders.some(o=>(typeof o=="string"?o:o.name)==="webgpu")&&(i.enableMemPattern=!1)},vn=(i,d,o)=>{for(let g of d){let l=typeof g=="string"?g:g.name;switch(l){case"webnn":if(l="WEBNN",typeof g!="string"){let y=g;if(y?.deviceType){let f=K("deviceType",o),M=K(y.deviceType,o);q()._OrtAddSessionConfigEntry(i,f,M)!==0&&X(`Can\'t set a session config entry: \'deviceType\' - ${y.deviceType}.`)}if(y?.numThreads){let f=y.numThreads;(typeof f!="number"||!Number.isInteger(f)||f<0)&&(f=0);let M=K("numThreads",o),D=K(f.toString(),o);q()._OrtAddSessionConfigEntry(i,M,D)!==0&&X(`Can\'t set a session config entry: \'numThreads\' - ${y.numThreads}.`)}if(y?.powerPreference){let f=K("powerPreference",o),M=K(y.powerPreference,o);q()._OrtAddSessionConfigEntry(i,f,M)!==0&&X(`Can\'t set a session config entry: \'powerPreference\' - ${y.powerPreference}.`)}}break;case"webgpu":if(l="JS",typeof g!="string"){let y=g;if(y?.preferredLayout){if(y.preferredLayout!=="NCHW"&&y.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${y.preferredLayout}`);let f=K("preferredLayout",o),M=K(y.preferredLayout,o);q()._OrtAddSessionConfigEntry(i,f,M)!==0&&X(`Can\'t set a session config entry: \'preferredLayout\' - ${y.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${l}`)}let b=K(l,o);q()._OrtAppendExecutionProvider(i,b)!==0&&X(`Can\'t append execution provider: ${l}.`)}},Lr=i=>{let d=q(),o=0,g=[],l=i||{};On(l);try{let b=wn(l.graphOptimizationLevel??"all"),y=bn(l.executionMode??"sequential"),f=typeof l.logId=="string"?K(l.logId,g):0,M=l.logSeverityLevel??2;if(!Number.isInteger(M)||M<0||M>4)throw new Error(`log serverity level is not valid: ${M}`);let D=l.logVerbosityLevel??0;if(!Number.isInteger(D)||D<0||D>4)throw new Error(`log verbosity level is not valid: ${D}`);let P=typeof l.optimizedModelFilePath=="string"?K(l.optimizedModelFilePath,g):0;if(o=d._OrtCreateSessionOptions(b,!!l.enableCpuMemArena,!!l.enableMemPattern,y,!!l.enableProfiling,0,f,M,D,P),o===0&&X("Can\'t create session options."),l.executionProviders&&vn(o,l.executionProviders,g),l.freeDimensionOverrides)for(let[W,U]of Object.entries(l.freeDimensionOverrides)){if(typeof W!="string")throw new Error(`free dimension override name must be a string: ${W}`);if(typeof U!="number"||!Number.isInteger(U)||U<0)throw new Error(`free dimension override value must be a non-negative integer: ${U}`);let R=K(W,g);d._OrtAddFreeDimensionOverride(o,R,U)!==0&&X(`Can\'t set a free dimension override: ${W} - ${U}.`)}return l.extra!==void 0&&ut(l.extra,"",new WeakSet,(W,U)=>{let R=K(W,g),N=K(U,g);d._OrtAddSessionConfigEntry(o,R,N)!==0&&X(`Can\'t set a session config entry: ${W} - ${U}.`)}),[o,g]}catch(b){throw o!==0&&d._OrtReleaseSessionOptions(o),g.forEach(y=>d._free(y)),b}};var Ht=i=>{switch(i){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${i}`)}},Pr=i=>{switch(i){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${i}`)}},Nt=i=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][i],Ir=i=>{switch(i){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${i}`)}},Br=i=>{switch(i){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${i}`)}},Wr=i=>i==="float32"||i==="int32"||i==="int64"||i==="bool"||i==="float16"||i==="uint32",Hr=i=>{switch(i){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${i}`)}};var Nr=async i=>{if(typeof i=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(i))}catch(d){if(d.code==="ERR_FS_FILE_TOO_LARGE"){let o=(void 0)(i),g=[];for await(let l of o)g.push(l);return new Uint8Array(Buffer.concat(g))}throw d}else{let d=await fetch(i);if(!d.ok)throw new Error(`failed to load external data file: ${i}`);let o=d.headers.get("Content-Length"),g=o?parseInt(o,10):0;if(g<1073741824)return new Uint8Array(await d.arrayBuffer());{if(!d.body)throw new Error(`failed to load external data file: ${i}, no response body.`);let l=d.body.getReader(),b;try{b=new ArrayBuffer(g)}catch(f){if(f instanceof RangeError){let M=Math.ceil(g/65536);b=new WebAssembly.Memory({initial:M,maximum:M}).buffer}else throw f}let y=0;for(;;){let{done:f,value:M}=await l.read();if(f)break;let D=M.byteLength;new Uint8Array(b,y,D).set(M),y+=D}return new Uint8Array(b,0,g)}}else return i instanceof Blob?new Uint8Array(await i.arrayBuffer()):i instanceof Uint8Array?i:new Uint8Array(i)};var _n=(i,d)=>{q()._OrtInit(i,d)!==0&&X("Can\'t initialize onnxruntime.")},$r=async i=>{_n(i.wasm.numThreads,Br(i.logLevel))},jr=async(i,d)=>{},ft=new Map,En=i=>{let d=q(),o=d.stackSave();try{let g=d.stackAlloc(8);return d._OrtGetInputOutputCount(i,g,g+4)!==0&&X("Can\'t get session input/output count."),[d.HEAP32[g/4],d.HEAP32[g/4+1]]}finally{d.stackRestore(o)}},kt=i=>{let d=q(),o=d._malloc(i.byteLength);if(o===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${i.byteLength}.`);return d.HEAPU8.set(i,o),[o,i.byteLength]},zr=async(i,d)=>{let o,g,l=q();Array.isArray(i)?[o,g]=i:i.buffer===l.HEAPU8.buffer?[o,g]=[i.byteOffset,i.byteLength]:[o,g]=kt(i);let b=0,y=0,f=0,M=[],D=[],P=[];try{if([y,M]=Lr(d),d?.externalData&&l.mountExternalData){let F=[];for(let k of d.externalData){let we=typeof k=="string"?k:k.path;F.push(Nr(typeof k=="string"?k:k.data).then(ue=>{l.mountExternalData(we,ue)}))}await Promise.all(F)}b=l._OrtCreateSession(o,g,y),b===0&&X("Can\'t create a session.");let[W,U]=En(b),R=[],N=[],I=[];for(let F=0;F<W;F++){let k=l._OrtGetInputName(b,F);k===0&&X("Can\'t get an input name."),D.push(k),R.push(l.UTF8ToString(k))}for(let F=0;F<U;F++){let k=l._OrtGetOutputName(b,F);k===0&&X("Can\'t get an output name."),P.push(k);let we=l.UTF8ToString(k);N.push(we)}let E=null;return ft.set(b,[b,D,P,E]),[b,R,N]}catch(W){throw D.forEach(U=>l._OrtFree(U)),P.forEach(U=>l._OrtFree(U)),f!==0&&l._OrtReleaseBinding(f),b!==0&&l._OrtReleaseSession(b),W}finally{l._free(o),y!==0&&l._OrtReleaseSessionOptions(y),M.forEach(W=>l._free(W)),l.unmountExternalData?.()}},Yr=i=>{let d=q(),o=ft.get(i);if(!o)throw new Error(`cannot release session. invalid session id: ${i}`);let[g,l,b,y]=o;y&&d._OrtReleaseBinding(y.handle),d.jsepUnregisterBuffers?.(i),l.forEach(f=>d._OrtFree(f)),b.forEach(f=>d._OrtFree(f)),d._OrtReleaseSession(g),ft.delete(i)},kr=(i,d,o,g,l)=>{if(!i){d.push(0);return}let b=q(),y=i[0],f=i[1],M=i[3],D,P;if(y==="string"&&M==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(M==="gpu-buffer"){let R=i[2].gpuBuffer,N=Nt(Ht(y));P=f.reduce((I,E)=>I*E,1)*N,D=b.jsepRegisterBuffer(g,l,R,P)}else{let R=i[2];if(Array.isArray(R)){P=4*R.length,D=b._malloc(P),o.push(D);let N=D/4;for(let I=0;I<R.length;I++){if(typeof R[I]!="string")throw new TypeError(`tensor data at index ${I} is not a string`);b.HEAPU32[N++]=K(R[I],o)}}else P=R.byteLength,D=b._malloc(P),o.push(D),b.HEAPU8.set(new Uint8Array(R.buffer,R.byteOffset,P),D)}let W=b.stackSave(),U=b.stackAlloc(4*f.length);try{let R=U/4;f.forEach(I=>b.HEAP32[R++]=I);let N=b._OrtCreateTensor(Ht(y),D,P,U,f.length,Hr(M));N===0&&X(`Can\'t create tensor for input/output. session=${g}, index=${l}.`),d.push(N)}finally{b.stackRestore(W)}},Gr=i=>{let o=new TextEncoder().encode(i),g=q(),l=g._malloc(o.byteLength);g.HEAPU8.set(o,l);let b=g._OrtConfigure(l,o.byteLength);if(b===0)throw new Error("Can\'t get an configure key");let y=g.UTF8ToString(b);return g._OrtFree(b),y},Vr=i=>{let o=new TextEncoder().encode(i),g=q(),l=g._malloc(o.byteLength);g.HEAPU8.set(o,l);let b=g._OrtAuth(l,o.byteLength);if(b===0)throw new Error("Can\'t get an auth result");let y=g.UTF8ToString(b);return g._OrtFree(b),y},qr=async(i,d,o,g,l,b)=>{let y=q(),f=ft.get(i);if(!f)throw new Error(`cannot run inference. invalid session id: ${i}`);let[M,D,P,W]=f,U=d.length,R=g.length,N=0,I=[],E=[],F=[],k=[],we=y.stackSave(),ue=y.stackAlloc(U*4),ee=y.stackAlloc(U*4),S=y.stackAlloc(R*4),G=y.stackAlloc(R*4);try{[N,I]=Rr(b);for(let L=0;L<U;L++)kr(o[L],E,k,i,d[L]);for(let L=0;L<R;L++)kr(l[L],F,k,i,U+g[L]);let fe=ue/4,We=ee/4,He=S/4,te=G/4;for(let L=0;L<U;L++)y.HEAPU32[fe++]=E[L],y.HEAPU32[We++]=D[d[L]];for(let L=0;L<R;L++)y.HEAPU32[He++]=F[L],y.HEAPU32[te++]=P[g[L]];let V;V=await y._OrtRun(M,ee,ue,U,G,R,S,N),V!==0&&X("failed to call OrtRun().");let de=[];for(let L=0;L<R;L++){let re=y.HEAPU32[S/4+L];if(re===F[L]){de.push(l[L]);continue}let le=y.stackSave(),he=y.stackAlloc(4*4),be=!1,Q,ce=0;try{y._OrtGetTensorData(re,he,he+4,he+8,he+12)!==0&&X(`Can\'t access output tensor data on index ${L}.`);let Ce=he/4,De=y.HEAPU32[Ce++];ce=y.HEAPU32[Ce++];let Pe=y.HEAPU32[Ce++],Me=y.HEAPU32[Ce++],pe=[];for(let ne=0;ne<Me;ne++)pe.push(y.HEAPU32[Pe/4+ne]);y._OrtFree(Pe);let Se=pe.reduce((ne,Z)=>ne*Z,1);Q=Pr(De);let Ae=W?.outputPreferredLocations[g[L]];if(Q==="string"){if(Ae==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let ne=[],Z=ce/4;for(let Fe=0;Fe<Se;Fe++){let Oe=y.HEAPU32[Z++],Te=Fe===Se-1?void 0:y.HEAPU32[Z]-Oe;ne.push(y.UTF8ToString(Oe,Te))}de.push([Q,pe,ne,"cpu"])}else if(Ae==="gpu-buffer"&&Se>0){let ne=y.jsepGetBuffer(ce),Z=Nt(De);if(Z===void 0||!Wr(Q))throw new Error(`Unsupported data type: ${Q}`);be=!0,de.push([Q,pe,{gpuBuffer:ne,download:y.jsepCreateDownloader(ne,Se*Z,Q),dispose:()=>{y._OrtReleaseTensor(re)}},"gpu-buffer"])}else{let ne=Ir(Q),Z=new ne(Se);new Uint8Array(Z.buffer,Z.byteOffset,Z.byteLength).set(y.HEAPU8.subarray(ce,ce+Z.byteLength)),de.push([Q,pe,Z,"cpu"])}}finally{y.stackRestore(le),Q==="string"&&ce&&y._free(ce),be||y._OrtReleaseTensor(re)}}return W&&y._OrtClearBoundOutputs(W.handle),de}finally{y.stackRestore(we),E.forEach(fe=>y._OrtReleaseTensor(fe)),F.forEach(fe=>y._OrtReleaseTensor(fe)),k.forEach(fe=>y._free(fe)),N!==0&&y._OrtReleaseRunOptions(N),I.forEach(fe=>y._free(fe))}},Jr=i=>{let d=q(),o=ft.get(i);if(!o)throw new Error("invalid session id");let g=o[0],l=d._OrtEndProfiling(g);l===0&&X("Can\'t get an profile file name."),d._OrtFree(l)},Xr=i=>{let d=[];for(let o of i){let g=o[2];!Array.isArray(g)&&"buffer"in g&&d.push(g.buffer)}return d};self.onmessage=i=>{let{type:d,in:o}=i.data;try{switch(d){case"init-wasm":Ur(o.wasm).then(()=>{$r(o).then(()=>{postMessage({type:d})},g=>{postMessage({type:d,err:g})})},g=>{postMessage({type:d,err:g})});break;case"init-ep":{let{epName:g,env:l}=o;jr(l,g).then(()=>{postMessage({type:d})},b=>{postMessage({type:d,err:b})});break}case"copy-from":{let{buffer:g}=o,l=kt(g);postMessage({type:d,out:l});break}case"create":{let{model:g,options:l}=o;zr(g,l).then(b=>{postMessage({type:d,out:b})},b=>{postMessage({type:d,err:b})});break}case"release":Yr(o),postMessage({type:d});break;case"run":{let{sessionId:g,inputIndices:l,inputs:b,outputIndices:y,options:f}=o;qr(g,l,b,y,new Array(y.length).fill(null),f).then(M=>{M.some(D=>D[3]!=="cpu")?postMessage({type:d,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:d,out:M},Xr(M))},M=>{postMessage({type:d,err:M})});break}case"configure":try{let g=Gr(i.data.in);postMessage({type:"configure",out:g})}catch(g){postMessage({type:"configure",err:g})}break;case"auth":try{let g=Vr(i.data.in);postMessage({type:"auth",out:g})}catch(g){postMessage({type:"auth",err:g})}break;case"end-profiling":Jr(o),postMessage({type:d});break;default:}}catch(g){postMessage({type:d,err:g})}};})();\n'})),Yt,it,In,Mo,Go,ya,Ta,or,ir,Eg,Ro,cd,pd,dd,hd,md,bd,gd,yd,Td,xa=L((()=>{It(),ld(),Kr(),Yt=()=>!!ee.wasm.proxy&&typeof document<"u",In=!1,Mo=!1,Go=!1,Ta=new Map,or=(e,t)=>{let r=Ta.get(e);r?r.push(t):Ta.set(e,[t])},ir=()=>{if(In||!Mo||Go||!it)throw new Error("worker not ready")},Eg=e=>{switch(e.data.type){case"init-wasm":In=!1,e.data.err?(Go=!0,ya[1](e.data.err)):(Mo=!0,ya[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"run":case"end-profiling":{let t=Ta.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},Ro=typeof document<"u"?document?.currentScript?.src:void 0,cd=async()=>{if(!Mo){if(In)throw new Error("multiple calls to 'initWasm()' detected.");if(Go)throw new Error("previous call to 'initWasm()' failed.");if(In=!0,Yt())return void 0===ee.wasm.wasmPaths&&Ro&&0!==Ro.indexOf("blob:")&&(ee.wasm.wasmPaths=Ro.substr(0,+Ro.lastIndexOf("/")+1)),new Promise(((e,t)=>{it?.terminate();let r=URL.createObjectURL(new Blob([fd()],{type:"text/javascript"}));(it=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=e=>t(e),it.onmessage=Eg,URL.revokeObjectURL(r),ya=[e,t];let n={type:"init-wasm",in:ee};it.postMessage(n)}));try{await Vp(ee.wasm),await ed(ee),Mo=!0}catch(e){throw Go=!0,e}finally{In=!1}}},pd=async e=>{if(Yt())return ir(),new Promise(((t,r)=>{or("init-ep",[t,r]);let n={type:"init-ep",in:{epName:e,env:ee}};it.postMessage(n)}));await td(ee,e)},dd=async e=>Yt()?(ir(),new Promise(((t,r)=>{or("copy-from",[t,r]);let n={type:"copy-from",in:{buffer:e}};it.postMessage(n,[e.buffer])}))):ga(e),hd=async(e,t)=>{if(Yt()){if(t?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return ir(),new Promise(((r,n)=>{or("create",[r,n]);let i={type:"create",in:{model:e,options:t}},o=[];e instanceof Uint8Array&&o.push(e.buffer),it.postMessage(i,o)}))}return rd(e,t)},md=async e=>{if(Yt())return ir(),new Promise(((t,r)=>{or("release",[t,r]);let n={type:"release",in:e};it.postMessage(n)}));nd(e)},bd=async e=>Yt()?(ir(),new Promise(((t,r)=>{or("configure",[t,r]);let n={type:"configure",in:e};it.postMessage(n)}))):od(e),gd=async e=>Yt()?(ir(),new Promise(((t,r)=>{or("auth",[t,r]);let n={type:"auth",in:e};it.postMessage(n)}))):id(e),yd=async(e,t,r,n,i,o)=>{if(Yt()){if(r.some((e=>"cpu"!==e[3])))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some((e=>e)))throw new Error("pre-allocated output tensor is not supported for proxy.");return ir(),new Promise(((i,a)=>{or("run",[i,a]);let s=r,u={type:"run",in:{sessionId:e,inputIndices:t,inputs:s,outputIndices:n,options:o}};it.postMessage(u,ud(s))}))}return ad(e,t,r,n,i,o)},Td=async e=>{if(Yt())return ir(),new Promise(((t,r)=>{or("end-profiling",[t,r]);let n={type:"end-profiling",in:e};it.postMessage(n)}));sd(e)}})),xd,Pg,Uo,wd=L((()=>{It(),xa(),ma(),ba(),xd=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},Pg=e=>{switch(e[3]){case"cpu":return new Re(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!No(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:i}=e[2];return Re.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:i})}default:throw new Error(`invalid data location: ${e[3]}`)}},Uo=class{async fetchModelAndCopyToWasmMemory(e){return dd(await _n(e))}async loadModel(e,t){let r;hr(),r="string"==typeof e?typeof process<"u"&&process.versions&&process.versions.node?await _n(e):await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames]=await hd(r,t),mr()}async dispose(){return md(this.sessionId)}async configure(e){return bd(e)}async auth(e){return gd(e)}async run(e,t,r){hr();let n=[],i=[];Object.entries(e).forEach((e=>{let t=e[0],r=e[1],o=this.inputNames.indexOf(t);if(-1===o)throw new Error(`invalid input '${t}'`);n.push(r),i.push(o)}));let o=[],a=[];Object.entries(t).forEach((e=>{let t=e[0],r=e[1],n=this.outputNames.indexOf(t);if(-1===n)throw new Error(`invalid output '${t}'`);o.push(r),a.push(n)}));let s=n.map(((e,t)=>xd(e,(()=>`input "${this.inputNames[i[t]]}"`)))),u=o.map(((e,t)=>e?xd(e,(()=>`output "${this.outputNames[a[t]]}"`)):null)),l=await yd(this.sessionId,i,s,a,u,r),h={};for(let e=0;e<l.length;e++)h[this.outputNames[a[e]]]=o[e]??Pg(l[e]);return mr(),h}startProfiling(){}endProfiling(){Td(this.sessionId)}}})),Dg,zo,vd=L((()=>{It(),xa(),wd(),Dg=()=>{if(("number"!=typeof ee.wasm.initTimeout||ee.wasm.initTimeout<0)&&(ee.wasm.initTimeout=0),"boolean"!=typeof ee.wasm.simd&&(ee.wasm.simd=!0),"boolean"!=typeof ee.wasm.proxy&&(ee.wasm.proxy=!1),"boolean"!=typeof ee.wasm.trace&&(ee.wasm.trace=!1),"number"!=typeof ee.wasm.numThreads||!Number.isInteger(ee.wasm.numThreads)||ee.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(ee.wasm.numThreads=1);let e=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;ee.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},zo=class{async init(e){Dg(),await cd(),await pd(e)}async createInferenceSessionHandler(e,t){let r=new Uo;return await r.loadModel(e,t),Promise.resolve(r)}}})),_d={};kr(_d,{wasmBackend:()=>Lg});var Lg,Od=L((()=>{vd(),Lg=new zo}));It(),It(),It();var Os="1.17.0",QO=Qo;{let e=(Pp(),fr(Ep)).onnxjsBackend;pr("webgl",e,-10)}{let e=(Od(),fr(_d)).wasmBackend;pr("cpu",e,10),pr("wasm",e,10),pr("webnn",e,9)}Object.defineProperty(ee.versions,"web",{value:Os,enumerable:!0})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.b=document.baseURI||self.location.href;var __webpack_exports__={},_tsvb__WEBPACK_IMPORTED_MODULE_0__;_tsvb__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3744),window.tsvb=_tsvb__WEBPACK_IMPORTED_MODULE_0__.O;